(function(){ window.BMapGL_loadScriptTime = (new Date).getTime(); document.write('window.TILE_VERSION={"ditu":{"normal":{"version":"088","updateDate":"20220414"},"satellite":{"version":"009","updateDate":"20220414"},"normalTraffic":{"version":"081","updateDate":"20220414"},"satelliteTraffic":{"version":"083","updateDate":"20220414"},"mapJS":{"version":"104","updateDate":"20220414"},"satelliteStreet":{"version":"083","updateDate":"20220414"},"earthVector":{"version":"001","updateDate":"20220414"}},"webapp":{"high_normal":{"version":"001","updateDate":"20220414"},"lower_normal":{"version":"002","updateDate":"20220414"}},"api_for_mobile":{"vector":{"version":"002","updateDate":"20220414"},"vectorIcon":{"version":"002","updateDate":"20220414"}}};window.MSV={"mapstyle":{"updateDate":"20220225","version":"001"}};window.BMAP_AUTHENTIC_KEY="u6i1RI6YZCjFR6t5hcgcoK9nVs8LgSO0";window.BMapGL=window.BMapGL||{};(function(br,eL){var D=D||{version:"20150702",emptyFn:function(){}};(function(){D._log=[];var i=0;var T={};D.BaseClass=function(h6){T[(this.hashCode=(h6||D.BaseClass.guid()))]=this};D.BaseClass.guid=function(){return"mz_"+(i++).toString(36)};D.BaseClass.create=function(){var h6=new D.BaseClass();h6.decontrol();return h6};var e=D.instance=D.I=function(h6){return T[h6]};D.BaseClass.prototype.dispose=function(){if(this.hashCode){delete T[this.hashCode]}for(var h6 in this){if(typeof this[h6]!="function"){delete this[h6]}}};D.BaseClass.prototype.getHashCode=function(){if(!this.hashCode){T[(this.hashCode=D.BaseClass.guid())]=this}return this.hashCode};D.BaseClass.prototype.decontrol=function(){delete T[this.hashCode]};D.BaseClass.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"};D.BaseClass.prototype._wlog=function(h7,h8){var h6=D._log;if(h6.length>100){h6.reverse().length=50;h6.reverse()}h6[h6.length]="["+h7+"]["+(this._className||"Object")+" "+this.hashCode+"] "+h8}})();Function.prototype.inherits=function(h6,T){var e,h7,h9=this.prototype,h8=function(){};h8.prototype=h6.prototype;h7=this.prototype=new h8();if(typeof(T)=="string"){h7._className=T}for(e in h9){h7[e]=h9[e]}this.prototype.constructor=h9.constructor;h9=h8=null;return h7};D.BaseEvent=function(e,i){this.type=e;this.returnValue=true;this.target=i||null;this.currentTarget=this.srcElement=null;this.cancelBubble=false;this.domEvent=null};D.BaseClass.prototype.on=D.BaseClass.prototype.addEventListener=function(T,i){if(typeof i!=="function"){return this._wlog("error","addEventListener:"+i+" is not a function")}if(!this._listeners){this._listeners={}}var e=this._listeners;if(T.indexOf("on")!==0){T="on"+T}if(typeof e[T]!=="object"){e[T]={}}var h6=i.hashCode||D.BaseClass.guid();i.hashCode=h6;if(e[T][h6]){this._wlog("warning","repeat key:"+h6)}e[T][h6]=i};D.BaseClass.prototype.off=D.BaseClass.prototype.removeEventListener=function(T,i){if(typeof i=="function"){i=i.hashCode}else{if(typeof i!=="string"&&typeof i!=="undefined"){return}}if(!this._listeners){this._listeners={}}if(T.indexOf("on")!=0){T="on"+T}var e=this._listeners;if(!e[T]){return}if(i===undefined){e[T]={};return}if(e[T][i]){delete e[T][i]}};D.BaseClass.prototype.fire=D.BaseClass.prototype.dispatchEvent=function(h6){if(!this._listeners){this._listeners={}}var T,e=this._listeners,h7=h6.type;h6.target=h6.srcElement=h6.target||h6.srcElement||this;h6.currentTarget=this;if(typeof this[h7]=="function"){this[h7](h6)}if(typeof e[h7]=="object"){for(T in e[h7]){if(typeof e[h7][T]=="function"){e[h7][T].call(this,h6)}}}return h6.returnValue};D.BaseEvent.prototype.inherit=function(T){var i=this;this.domEvent=T=window.event||T;i.clientX=T.clientX||T.pageX;i.clientY=T.clientY||T.pageY;i.offsetX=T.offsetX||T.layerX;i.offsetY=T.offsetY||T.layerY;i.screenX=T.screenX;i.screenY=T.screenY;i.ctrlKey=T.ctrlKey||T.metaKey;i.shiftKey=T.shiftKey;i.altKey=T.altKey;return i};D.Browser=(function(){var T=navigator.userAgent;var h7=0;var e=0;var h8=0;var i=0;var ic=0;var ia=0;var ib=0;var h9=0;var h6=0;var id=0;if(typeof window.opera==="object"&&/Opera(\s|\/)(\d+(\.\d+)?)/.test(T)){h8=parseFloat(RegExp.$2)}else{if(/OPR(\/(\d+)(\..?)?)/.test(T)){h8=parseInt(RegExp.$2,10)}else{if(/Edge\/((\d+)\.\d+)/.test(T)){h7=parseInt(RegExp.$2,10)}else{if(/MSIE (\d+(\.\d+)?)/.test(T)){e=parseFloat(RegExp.$1)}else{if(T.indexOf("Trident")>-1&&/rv:(\d+(\.\d+)?)/.test(T)){e=parseInt(RegExp.$1,10)}else{if(/Firefox(\s|\/)(\d+(\.\d+)?)/.test(T)){ic=parseFloat(RegExp.$2)}else{if(navigator.vendor==="Netscape"&&/Netscape(\s|\/)(\d+(\.\d+)?)/.test(T)){ib=parseFloat(RegExp.$2)}else{if(T.indexOf("Safari")>-1&&/Version\/(\d+(\.\d+)?)/.test(T)){i=parseFloat(RegExp.$1)}}}}}}}}if(T.indexOf("Trident")>-1&&/Trident\/(\d+(\.\d+)?)/.test(T)){h9=parseInt(RegExp.$1,10)}else{if(!e&&!h7&&T.indexOf("Gecko")>-1&&T.indexOf("KHTML")===-1&&/rv\:(\d+(\.\d+)?)/.test(T)){h6=parseFloat(RegExp.$1)}else{if(!h7&&/chrome\/(\d+(\.\d+)?)/i.test(T)){ia=parseFloat(RegExp.$1)}else{if(!h7&&/AppleWebKit\/(\d+(\.\d+)?)/.test(T)){id=parseInt(RegExp.$1,10)}}}}var ie={edge:h7,ie:e,firefox:ic,netscape:ib,opera:h8,safari:i,chrome:ia,gecko:h6,trident:h9,webkit:id};return ie})();window.FeBrowser=D.Browser;D.Dom={};D.Dom.createDom=function(i,e){if(D.isIE&&e&&e.name){i="<"+i+\' name="\'+D.String.escapeHTML(e.name)+\'">\'}var T=document.createElement(i);if(e){D.Dom.setProperties(T,e)}return T};D.Dom.getOffset=function(h6){var h9=D.Dom.getOwnerDocument(h6);var h8=D.isGecko>0&&h9.getBoxObjectFor&&D.Dom.getStyle(h6,"position")=="absolute"&&(h6.style.top===""||h6.style.left==="");var ia={left:0,top:0};var i=(D.isIE&&!D.isStrict)?h9.body:h9.documentElement;if(h6==i){return ia}var T=null;var h7;if(h6.getBoundingClientRect){h7=h6.getBoundingClientRect();ia.left=h7.left+Math.max(h9.documentElement.scrollLeft,h9.body.scrollLeft);ia.top=h7.top+Math.max(h9.documentElement.scrollTop,h9.body.scrollTop);ia.left-=h9.documentElement.clientLeft;ia.top-=h9.documentElement.clientTop;if(D.isIE&&!D.isStrict){ia.left-=2;ia.top-=2}}else{if(h9.getBoxObjectFor&&!h8){h7=h9.getBoxObjectFor(h6);var e=h9.getBoxObjectFor(i);ia.left=h7.screenX-e.screenX;ia.top=h7.screenY-e.screenY}else{T=h6;do{ia.left+=T.offsetLeft;ia.top+=T.offsetTop;if(D.isWebkit>0&&D.Dom.getStyle(T,"position")=="fixed"){ia.left+=h9.body.scrollLeft;ia.top+=h9.body.scrollTop;break}T=T.offsetParent}while(T&&T!=h6);if(D.isOpera>0||(D.isWebkit>0&&D.Dom.getStyle(h6,"position")=="absolute")){ia.top-=h9.body.offsetTop}T=h6.offsetParent;while(T&&T!=h9.body){ia.left-=T.scrollLeft;if(!D.isOpera||T.tagName!="TR"){ia.top-=T.scrollTop}T=T.offsetParent}}}return ia};D.Dom.getOwnerDocument=function(e){return e.nodeType==9?e:e.ownerDocument||e.document};D.Dom.setProperties=function(i,e){D.each(e,function(h6,T){D.Dom._setProperty(i,T,h6)})};D.Dom._setProperty=function(i,e,T){if(e=="style"){i.style.cssText=T}else{if(e=="class"){i.className=T}else{if(e=="for"){i.htmlFor=T}else{if(e in D.Dom._DIRECT_ATTRIBUTE_MAP){i.setAttribute(D.Dom._DIRECT_ATTRIBUTE_MAP[e],T)}else{i[e]=T}}}}};D.Dom._DIRECT_ATTRIBUTE_MAP={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder"};D.G=function(){for(var T=[],h6=arguments.length-1;h6>-1;h6--){var h7=arguments[h6];T[h6]=null;if(typeof h7=="object"&&h7&&h7.dom){T[h6]=h7.dom}else{if((typeof h7=="object"&&h7&&h7.tagName)||h7==window||h7==document){T[h6]=h7}else{if(typeof h7=="string"&&(h7=document.getElementById(h7))){T[h6]=h7}}}}return T.length<2?T[0]:T};D.ac=function(e,i){if(!(e=this.G(e))){return}i=this.trim(i);if(!new RegExp("(^| )"+i.replace(/(\W)/g,"\\$1")+"( |$)").test(e.className)){e.className=e.className.split(/\s+/).concat(i).join(" ")}};D.addClassName=D.ac;D.each=function(h8,e){if(typeof e!="function"){return h8}if(h8){if(h8.length===undefined){for(var T in h8){e.call(h8[T],h8[T],T)}}else{for(var h6=0,h7=h8.length;h6<h7;h6++){e.call(h8[h6],h8[h6],h6)}}}return h8};D.extend=function(h8,h6){if(h8&&h6&&typeof(h6)=="object"){for(var h7 in h6){h8[h7]=h6[h7]}var T=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];for(var e=0,i;e<T.length;e++){i=T[e];if(Object.prototype.hasOwnProperty.call(h6,i)){h8[i]=h6[i]}}}return h8};D.hide=function(){D.each(arguments,function(e){if(e=D.G(e)){e.style.display="none"}})};D.inherit=function(ia,h6,T){var h9=ia.prototype;var h8=function(){};h8.prototype=h6.prototype;var h7=ia.prototype=new h8();if(typeof T=="string"){h7._className=T}for(var e in h9){h7[e]=h9[e]}ia.prototype.constructor=h9.constructor;h9=null;return h7};D.isIE=0;(function(){if(navigator.userAgent.indexOf("MSIE")>0&&!window.opera){/MSIE (\d+(\.\d+)?)/.test(navigator.userAgent);D.isIE=parseFloat(RegExp.$1)}})();D.rc=function(e,i){if(!(e=this.G(e))){return}i=this.trim(i);var T=e.className.replace(new RegExp("(^| +)"+i.replace(/(\W)/g,"\\$1")+"( +|$)","g"),"$2");if(e.className!=T){e.className=T}};D.removeClassName=D.rc;D.show=function(){this.each(arguments,function(e){if(e=D.G(e)){e.style.display=""}})};D.trim=function(e){return e.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g,"")};D.getElementsByClassName=function(e,i){if(e.getElementsByClassName){return e.getElementsByClassName(i)}else{return(function T(id,ib){if(ib==null){ib=document}var ia=[],h9=ib.getElementsByTagName("*"),h6=h9.length,ic=new RegExp("(^|\\s)"+id+"(\\s|$)"),h8,h7;for(h8=0,h7=0;h8<h6;h8++){if(ic.test(h9[h8].className)){ia[h7]=h9[h8];h7++}}return ia})(i,e)}};D.toggleClass=function(e,i){if(D.hasClass(e,i)){D.removeClassName(e,i)}else{D.addClassName(e,i)}};D.hasClass=function(h6,T){if(!h6||!h6.className||typeof h6.className!="string"){return false}var i=-1;try{i=h6.className==T||h6.className.search(new RegExp("(\\s|^)"+T+"(\\s|$)"))}catch(h7){return false}return i>-1};D.insertHTML=function(h6,e,T){h6=D.G(h6);if(h6===null){return h6}var i,h7;if(h6.insertAdjacentHTML){h6.insertAdjacentHTML(e,T)}else{i=h6.ownerDocument.createRange();e=e.toUpperCase();if(e=="AFTERBEGIN"||e=="BEFOREEND"){i.selectNodeContents(h6);i.collapse(e=="AFTERBEGIN")}else{h7=e=="BEFOREBEGIN";i[h7?"setStartBefore":"setEndAfter"](h6);i.collapse(h7)}i.insertNode(i.createContextualFragment(T))}return h6};if(typeof HTMLElement!="undefined"&&HTMLElement.prototype.__lookupGetter__&&!HTMLElement.prototype.__lookupGetter__("children")&&!window.opera){try{HTMLElement.prototype.__defineGetter__("children",function(){for(var T=[],h6=0,h8,h7=0,e=this.childNodes.length;h7<e;h7++){h8=this.childNodes[h7];if(h8.nodeType==1){T[h6++]=h8;if(h8.name){if(!T[h8.name]){T[h8.name]=[]}T[h8.name][T[h8.name].length]=h8}if(h8.id){T[h8.id]=h8}}}return T})}catch(gJ){}}if(typeof(HTMLElement)!="undefined"&&!window.opera&&HTMLElement.prototype&&!HTMLElement.prototype.insertAdjacentHTML){HTMLElement.prototype.insertAdjacentHTML=function(i,T){var h6=this.ownerDocument.createRange();h6.setStartBefore(this);h6=h6.createContextualFragment(T);switch(i){case"beforeBegin":this.parentNode.insertBefore(h6,this);break;case"afterBegin":this.insertBefore(h6,this.firstChild);break;case"beforeEnd":this.appendChild(h6);break;case"afterEnd":if(!this.nextSibling){this.parentNode.appendChild(h6)}else{this.parentNode.insertBefore(h6,this.nextSibling)}break}}}if(typeof HTMLElement!="undefined"&&!window.opera){HTMLElement.prototype.contains=function(e){if(e==this){return true}while(e=e.parentNode){if(e==this){return true}}return false}}if(!D.Browser.ie&&typeof Event!="undefined"&&!window.opera){Event.prototype.__defineSetter__("returnValue",function(e){if(!e){this.preventDefault()}return e});Event.prototype.__defineSetter__("cancelBubble",function(e){if(e){this.stopPropagation()}return e})}D.each=function(h7,h6){if(bY(h6)){for(var T=0,e=h7.length;T<e;T++){if(h6.call(h7,h7[T],T)===false){break}}}return h7};D.Platform={x11:0,macintosh:0,windows:0,android:0,iphone:0,ipad:0};for(var gF in D.Platform){if(D.Platform.hasOwnProperty(gF)){D.Platform[gF]=new RegExp(gF,"i").test(window.navigator.userAgent)?1:0}}if(typeof(D.Dom)==="undefined"){D.Dom={}}D.Dom.getComputedStyle=function(i,e){var h6=i.nodeType==9?i:i.ownerDocument||i.document,T;if(h6.defaultView&&h6.defaultView.getComputedStyle){T=h6.defaultView.getComputedStyle(i,null);if(T){return T[e]||T.getPropertyValue(e)}}else{if(i.currentStyle){return i.currentStyle[e]||""}}return""};var be=D.BaseEvent;var em=D.BaseClass;em.prototype.toString=function(){return this._className||""};D.on=function(T,i,e){if(!(T=D.G(T))){return T}i=i.replace(/^on/,"");if(T.addEventListener){T.addEventListener(i,e,false)}else{if(T.attachEvent){T.attachEvent("on"+i,e)}}return T};D.un=function(T,i,e){if(!(T=D.G(T))){return T}i=i.replace(/^on/,"");if(T.removeEventListener){T.removeEventListener(i,e,false)}else{if(T.detachEvent){T.detachEvent("on"+i,e)}}return T};D.hc=function(h6,T){if(!h6||!h6.className||typeof h6.className!="string"){return false}var i=-1;try{i=h6.className==T||h6.className.search(new RegExp("(\\s|^)"+T+"(\\s|$)"))}catch(h7){return false}return i>-1};D.isEmptyObject=function(T){if(Object.prototype.toString.call(T)==="[object Object]"){for(var e in T){return false}return true}else{return false}};var gg=window.location.protocol==="http:"?"http:":"https:";var e6={fontFamily:\'Arial,Helvetica,"PingFang SC","Hiragino Sans GB",STHeiti,sans-serif\',mapStyleNameIdPair:{"default":0,"grayed-out":1},mapHost:gg+"//map.baidu.com",apiHost:gg+"//api.map.baidu.com",apiIMG:gg+"//api.map.baidu.com/images",staticHost:gg+"//webmap0.bdimg.com",imgPath:gg+"//webmap0.bdimg.com/image/api/",tileDomain:[gg+"//maponline0.bdimg.com",gg+"//maponline1.bdimg.com",gg+"//maponline2.bdimg.com",gg+"//maponline3.bdimg.com"],optDomain:"http://10.120.25.45:8017",rasterTilePath:"/tile/",vectorTilePath:"/pvd/",originTilePath:[gg+"//pcor.baidu.com"],stylePath:"//maponline0.bdimg.com/sty/",getIconSetPath:function(e){var i="map_icons2x/";if(typeof e==="string"&&this.mapStyleNameIdPair[e]>0){i="map_icons2x_"+(this.mapStyleNameIdPair[e]-1)+"/"}return gg+this.stylePath+i},getMapStyleFiles:function(T){var h7=true;if(typeof T==="string"&&T!=="default"){h7=false}var h8=h7?"":"_"+(this.mapStyleNameIdPair[T]-1);var i=fL();var h6="udt="+i.udt+"&v="+i.ver;var e=gg+this.stylePath;return[e+"icons_2x"+h8+".js?"+h6,e+"fs"+h8+".js?"+h6,e+"indoor_fs.js?"+h6]},tvc:{ditu:{normal:{version:"088",updateDate:"20210726"},satellite:{version:"009",updateDate:"20210726"},normalTraffic:{version:"081",updateDate:"20210726"},satelliteTraffic:{version:"083",updateDate:"20210726"},mapJS:{version:"104",updateDate:"20210726"},satelliteStreet:{version:"083",updateDate:"20210726"},panoClick:{version:"1033",updateDate:"20180108"},panoUdt:{version:"20180108",updateDate:"20180108"},panoSwfAPI:{version:"20150123",updateDate:"20150123"},panoSwfPlace:{version:"20141112",updateDate:"20141112"},earthVector:{version:"001",updateDate:"20210726"}}},msv:{mapstyle:{updateDate:"20210726",version:"001"}}};e6.imgResources={blankGIF:e6.staticHost+"/res/litemapapi/v1d1/images/blank.gif?20170501",markerPng:e6.staticHost+"/res/litemapapi/v1d1/images/marker.png?20170501",locPng:e6.staticHost+"/res/litemapapi/v1d1/images/loc.png?20180918",locNewPng:e6.staticHost+"/res/litemapapi/v1d1/images/loc_new.png?20190314",zoomPng:e6.staticHost+"/res/litemapapi/v1d1/images/zoombtn.png?20180918",mapLogoPng:e6.staticHost+"/res/litemapapi/v1d1/images/logo-2x.png?20190226"};var fe=e6;var a6="ruler.cur";if(D.Browser.ie||D.Browser.edge){D.extend(fe,{distCursor:"url("+fe.imgPath+a6+"),crosshair",defaultCursor:"url("+fe.imgPath+"openhand.cur),default",draggingCursor:"url("+fe.imgPath+"closedhand.cur),move"})}else{if(D.Browser.firefox){D.extend(fe,{distCursor:"url("+fe.imgPath+a6+"),crosshair",defaultCursor:"-moz-grab",draggingCursor:"-moz-grabbing"})}else{if(D.Browser.chrome||D.Browser.safari){D.extend(fe,{distCursor:"url("+fe.imgPath+a6+") 2 6,crosshair",defaultCursor:"url("+fe.imgPath+"openhand.cur) 8 8,default",draggingCursor:"url("+fe.imgPath+"closedhand.cur) 8 8,move"});if(D.Platform.macintosh){fe.defaultCursor="-webkit-grab";fe.draggingCursor="-webkit-grabbing"}}else{D.extend(fe,{distCursor:"url("+fe.imgPath+a6+"),crosshair",defaultCursor:"url("+fe.imgPath+"openhand.cur),default",draggingCursor:"url("+fe.imgPath+"closedhand.cur),move"})}}}br=br||{};br.version="gl";br._register=[];br.register=function(e){this._register[this._register.length]=e};br.guid=1;br.getGUID=function(e){return(e||"")+br.guid++};var gr=window.BMAP_AUTHENTIC_KEY||"";function dY(e,i,h6){var T=new Date();T.setTime(T.getTime()+h6*24*60*60*1000);document.cookie=e+"="+escape(i)+";expires="+T.toGMTString()}function ec(e,i){if(navigator.cookieEnabled){return dY(e,i,30)}if(localStorage){return localStorage.setItem(e,i)}if(sessionStorage){return sessionStorage.setItem(e,i)}}br.getSeckeyCid=function(){var i=+new Date();var e=gg+"//dlswbr.baidu.com/heicha/mw/abclite-2063-s.js?_t="+i;hB.load(e,eC)};function eC(){if(window.___abvk){ec("SECKEY_ABVK",window.___abvk)}}window.__abbaidu_2063_cb=function(i){var e=JSON.parse(i);ec("BMAP_SECKEY",e.data)};br.bmapVerifyCbk=function(e){if(e&&e.error!==0){if(typeof map!=="undefined"){map.getContainer().innerHTML="";map.__listeners={}}br=null;var i="百度未授权使用地图API，可能是因为您提供的密钥不是有效的百度地图开放平台密钥，或此密钥未对本应用的百度地图JavaScriptAPI授权。您可以访问如下网址了解如何获取有效的密钥：https://lbs.baidu.com/apiconsole/key#。";switch(e.error){case 101:i="您所使用的密钥ak有问题，不支持jsapi服务，可以访问该网址了解如何获取有效密钥：http://lbsyun.baidu.com/apiconsole/key#。";break;case 102:i="MCODE参数不存在，mobile类型MCODE参数必需，详情查看：http://lbsyun.baidu.com/apiconsole/key#。";break;case 200:i="APP不存在，AK有误请检查再重试，详情查看：http://lbsyun.baidu.com/apiconsole/key#。";break;case 201:i="APP被您禁用啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 202:i="APP被管理员删除啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 203:i="APP类型错误，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 210:i="APP IP校验失败，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 220:i="APP Referer校验失败。请检查该ak设置的白名单与访问所有的域名是否一致。详情查看：http://lbsyun.baidu.com/apiconsole/key#";break;case 230:i="APP Mcode码校验失败，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 240:i="APP服务被禁用了，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 250:i="该用户不存在... 请登录 https://lbs.baidu.com 的控制台，注册成为开发者申请ak吧。";break;case 251:i="该用户被自己删除啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情。";break;case 252:i="该用户被管理员删除啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 了解如何获取有效密钥，或请联系我们了解详情。";break;case 260:i="您所使用的密钥AK不包含该服务呢，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看服务选择情况，或请联系我们了解详情。";break;case 261:i="您所使用的密钥AK的该服务被禁用啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看服务选择情况，或请联系我们了解详情。";break;case 401:i="您所使用的AK并发超限了，请登录 http://lbsyun.baidu.com/cashier/quota#/home 了解详情。";break;case 302:i="您所使用的AK天配额超限了，请登录 http://lbsyun.baidu.com/cashier/quota#/home 了解详情。";break}alert(i)}};br.frequencyCbk=function(e){if(e){window.QTFrequency=e}};br.verify=function(){var e=fe.apiHost+"/?qt=verify&v=gl&type=webgl&ak="+gr+"&callback="+eL+".bmapVerifyCbk";hB.load(e)};br.frequency=function(){};br.apiLoad=br.apiLoad||function(){};function fW(i,e){this._size=i;this._cache=[];this._totalGetTimes=0;this._totalHitTimes=0;this._options={clearCallback:null,removeOldCallback:null};e=e||{};for(var T in e){if(e.hasOwnProperty(T)){this._options[T]=e[T]}}}fW.prototype.setData=function(T,h6){var e=this._cache;var i=this._size;if(i===0){return}if(e.length>i){this._removeOld()}if(!e[T]){e.push(h6)}e[T]=h6;h6._key_=T};fW.prototype.getHitRate=function(){return Math.round(this._totalHitTimes/this._totalGetTimes*1000)/1000};fW.prototype.getData=function(i){var e=this._cache[i];if(e){this._totalHitTimes++}this._totalGetTimes++;return e};fW.prototype.removeData=function(h7){if(this._options.clearCallback){this._options.clearCallback(this._cache[h7])}var T=this._cache;var h8=T[h7];for(var h6=0,e=T.length;h6<e;h6++){if(T[h6]===h8){T.splice(h6,1);break}}delete T[h7]};fW.prototype._removeOld=function(){var e=this._cache;var h7=Math.round(this._size*0.6);for(var h6=0;h6<h7;h6++){var T=e[h6]._key_;if(this._options.clearCallback){this._options.clearCallback(e[T])}delete e[T]}e.splice(0,h7);if(this._options.removeOldCallback){this._options.removeOldCallback()}};fW.prototype.clear=function(){var T=this._cache;for(var h7=0,e=T.length;h7<e;h7++){var h6=T[h7]._key_;if(this._options.clearCallback){this._options.clearCallback(T[h6])}delete T[h6]}this._cache=T=[]};fW.prototype.forEach=function(h6){var T=this._cache;for(var h8=0,e=T.length;h8<e;h8++){var h7=T[h8]._key_;h6(T[h7])}};fW.prototype.getBatch=function(h7){var e=[];for(var h6=0,T=h7.length;h6<T;h6++){if(this.getData(h7[h6])){e[e.length]=this.getData(h7[h6])}}return e};fW.prototype.clearExcept=function(h8){var T=this._cache;for(var e=T.length,h7=e-1;h7>=0;h7--){var h6=this._cache[h7]._key_;if(!h8[h6]){T.splice(h7,1);if(this._options.clearCallback){this._options.clearCallback(T[h6])}delete T[h6]}}};fW.prototype.getDataCount=function(){return this._cache.length};function aq(){}D.extend(aq.prototype,{centerAndZoomIn:function(ib,T,ic){var h9=this;if(!ib&&!T){return}ib=ib||this.centerPoint;T=T||this.zoomLevel;T=this._getProperZoom(T).zoom;if(this.mapType===BMAP_EARTH_MAP){if(!this._earth){this.mapType=BMAPGL_NORMAL_MAP;this.temp.originMapType=BMAP_EARTH_MAP;function ia(){h9._earth=new br.Earth(h9,{showRealSunlight:h9.config.showRealSunlight,showMilkyway:h9.config.showMilkyway,earthBackground:h9.config.earthBackground});h9._proxyEarthEvents();h9._changeEarthMapType(BMAP_EARTH_MAP);D.extend(h9,br.EarthView.prototype);if(!h9._navigationCtrl&&h9.config.showControls){h9._navigationCtrl=new br.NavigationControl3D(h9)}delete h9.temp.originMapType}ej.load("earth",function(){if(br["FeatureStyle"+h9.config.style]){ia()}else{h9.loadMapStyleFiles(function(){ia()})}})}}this.lastLevel=this.zoomLevel||T;this.zoomLevel=T;var h7=new be("onload");h7.point=ib;h7.zoom=T;this.centerPoint=this.restrictCenter(new hH(ib.lng,ib.lat));if(this.centerPoint.zoom){this.zoomLevel=this.centerPoint.zoom}this.defaultZoomLevel=this.defaultZoomLevel||this.zoomLevel;this.defaultCenter=this.defaultCenter||this.centerPoint;if(!this.loaded&&!(this.temp.originMapType===BMAP_EARTH_MAP)){var i=this.config.defaultMaxBounds;var h8=new c9(i,"baidu",this.mapType);var h6=new cV({mapType:this.mapType,copyright:h8,customLayer:false,baseLayer:true,tileTypeName:"web"});h6._isInnerLayer=true;this.addTileLayer(h6);if(this.mapType===BMAP_SATELLITE_MAP&&this._isHybridShow===true){this._addHybirdMap()}}this.dispatchEvent(h7);this.loaded=true;ic=ic||{};ic.callback&&ic.callback()},_setPlatformPosition:function(ic,ib,ig){ig=ig||{};if(ic===0&&ib===0&&!ig.point){return}if(isNaN(ig.initMapOffsetX)){ig.initMapOffsetX=this.offsetX}if(isNaN(ig.initMapOffsetY)){ig.initMapOffsetY=this.offsetY}var id=ic+ig.initMapOffsetX;var ia=ib+ig.initMapOffsetY;if(ig.point){var i=this.restrictCenter(ig.point);if(!i.equals(this.centerPoint)){this.centerPoint=i.clone();this.fire(new be("oncenter_changed"))}}else{var h6=this.offsetX-id;var e=this.offsetY-ia;var T=this.getZoomUnits();var h9=this.centerPoint.lng;var h8=this.centerPoint.lat;var h7=new hH(h9,h8);this.centerPoint=this.restrictCenter(new hH(h7.lng+h6*T,h7.lat-e*T),T);this.fire(new be("oncenter_changed"));if(this.zoomLevel<10){id=this.offsetX-(this.centerPoint.lng-h7.lng)/T;ia=this.offsetY+(this.centerPoint.lat-h7.lat)/T}}this.offsetX=id;this.offsetY=ia;var ie=this.platform.style;ie.left=id+"px";ie.top=ia+"px";this.maskLayer.style.left=-id+"px";this.maskLayer.style.top=-ia+"px";if(ig.dispatchEvent!==false){this.dispatchEvent(new be("onmoving"))}},zoomTo:function(e,h9,id){id=id||{};id.zoomCenter=h9;if(id.noAnimation!==true){this.deepZoomTo(e,id);return}if(typeof e!=="number"){return}var h7=b9[this.mapType];if(!h7){return}var T=e;e=this._getProperZoom(e).zoom;if(e===this.zoomLevel){var ia=new be("onzoomexceeded");ia.targetZoom=T;this.dispatchEvent(ia);id.callback&&id.callback();return}this.lastLevel=this.zoomLevel;if(h9){this.temp._cPoint=h9;this.temp._cPixel=this.pointToPixelIn(h9)}else{if(this.getInfoWindow()){var ic=this.getInfoWindow().getPoint();this.temp._cPixel=this.pointToPixelIn(ic);this.temp._cPoint=ic}}if(this.config.zoomCenter){h9=this.config.zoomCenter;this.temp._cPoint=h9;this.temp._cPixel=this.pointToPixelIn(h9)}if(h9||this.temp.infoWin&&this.temp.infoWin.isOpen()){var i=this.temp._cPoint;var ib=this.temp._cPixel;var h6=this.getZoomUnits(e);var h8=new hH(i.lng+h6*(this.width/2-ib.x),i.lat-h6*(this.height/2-ib.y));this.centerPoint=this.restrictCenter(h8,h6,e);if(this.centerPoint.zoom){e=this.centerPoint.zoom}}if(id.fireEvent!==false){this.dispatchEvent(new be("onzoomstart"))}if(e!==this.zoomLevel){this.zoomLevel=e;this.dispatchEvent(new be("onzooming"));this.dispatchEvent(new be("onzoomstartcode"))}if(id.fireEvent!==false){this.dispatchEvent(new be("onzoomend"))}if(id.callback){id.callback()}},deepZoomMedia:function(e){var i=this;if(!i.temp.isStdCtrlBusy){i.temp.isStdCtrlBusy=true;i.deepZoomTo(i.zoomLevel+e);setTimeout(function(){i.temp.isStdCtrlBusy=false},400)}},deepZoomTo:function(ia,h6){h6=h6||{};var h8=ia-this.zoomLevel;var h7=this._getProperZoom(ia);if(h7.exceeded){var e=new be("onzoomexceeded");e.targetZoom=ia;this.dispatchEvent(e);return}var i;if(h6.zoomCenter){i=this.pointToPixelIn(h6.zoomCenter)}else{if(this.getInfoWindow()){i=this.pointToPixelIn(this.getInfoWindow().getPoint(),{zoom:this.lastLevel})}else{var i=new es(this.width/2,this.height/2)}}this.lastLevel=this.zoomLevel;var h9=this.deepZoom||new bH(this);var T=h8>0?1:-1;h9.zoomMap(i,h8,T,null,h6)},flyToIn:function(ib,e){if(e===this.zoomLevel){this.panToIn(ib);return}var h8=this._getProperZoom(e);if(h8.exceeded){var ic=new be("onzoomexceeded");ic.targetZoom=e;this.dispatchEvent(ic);return}var ia=e-this.zoomLevel;var T=new es(this.width/2,this.height/2);var i=this.pointToPixelIn(ib);var h9=new ei(i.x-T.x,i.y-T.y);this.lastLevel=this.zoomLevel;if(Math.abs(ia)>=4||Math.abs(h9.width)>this.width||Math.abs(h9.height)>this.height){this.centerAndZoomIn(ib,e);return}var h7=this.deepZoom||new bH(this);var h6=ia>0?1:-1;h7.zoomMap(i,ia,h6,h9)},panToIn:function(i,T){T=T||{};if(!i||i.equals(this.centerPoint)){T.callback&&T.callback();return}var h6=this.pointToPixelIn(i);var e=Math.round(this.width/2);var h7=Math.round(this.height/2);if(Math.abs(e-h6.x)>this.width||Math.abs(h7-h6.y)>this.height||T.noAnimation===true){this._panToIn(e-h6.x,h7-h6.y,i);T.callback&&T.callback()}else{this._panBy(e-h6.x,h7-h6.y,T)}},_panToIn:function(i,e,h6){var T=this.temp;if(T.operating===true){return}if(T.dragAni){T.dragAni.stop();T.dragAni=null;this.dispatchEvent(new be("onmoveend"))}this.dispatchEvent(new be("onmovestart"));this._setPlatformPosition(i,e,{point:h6});this.dispatchEvent(new be("onmoveend"))},panBy:function(i,e,T){T=T||{};i=Math.round(i)||0;e=Math.round(e)||0;if(Math.abs(i)<=this.width&&Math.abs(e)<=this.height&&T.noAnimation!==true){this._panBy(i,e,T)}else{this._panToIn(i,e);T.callback&&T.callback()}},_panBy:function(i,e,h7){if(this.temp.operating===true){return}h7=h7||{};this.dispatchEvent(new be("onmovestart"));var h6=this;var T=h6.temp;T.pl=h6.offsetX;T.pt=h6.offsetY;if(T.tlPan){T.tlPan.cancel()}if(T.dragAni){T.dragAni.stop();T.dragAni=null;this.dispatchEvent(new be("onmoveend"))}T.tlPan=new p({fps:h7.fps||h6.config.fps,duration:h7.duration||h6.config.actionDuration,transition:h7.transition||cq.easeInOutQuad,render:function(h8){this.terminative=h6.temp.operating;if(h6.temp.operating){return}h6._setPlatformPosition(Math.ceil(i*h8),Math.ceil(e*h8),{initMapOffsetX:T.pl,initMapOffsetY:T.pt})},finish:function(h8){h6.dispatchEvent(new be("onmoveend"));h6.temp.tlPan=false;if(h6.temp.stopArrow===true){h6.temp.stopArrow=false;if(h6.temp.arrow!==0){h6._arrow()}}h7.callback&&h7.callback()}})},getCenterIn:function(){return this.centerPoint},getZoom:function(){return this.zoomLevel},setTilt:function(){},getTilt:function(){return this._tilt},setHeading:function(){},getHeading:function(){return this._heading},restrictCenter:function(ie,i,e){this.isRestrict=false;i=i||this.getZoomUnits();e=e||this.zoomLevel;var ic=this.pixelToPointIn(new es(this.width,0),{center:ie,zoom:e});var ia=this.pixelToPointIn(new es(0,this.height),{center:ie,zoom:e});var ig=ie.lng;var il=ie.lat;if(this.config.restrictBounds!==null&&!this.config.restrictBounds.isEmpty()){var ik=this.config.restrictBounds;var h6=ik.getSouthWest();var ii=ik.getNorthEast();var id=ew.convertLL2MC(h6);var h8=ew.convertLL2MC(ii);ie.lng=this.calcNewLngByBounds(ig,ia,ic,id.lng,h8.lng,i);ie.lat=this.calcNewLatByBounds(il,ia,ic,id.lat,h8.lat,i);return ie}var ib=this.pixelToPointIn(new es(0,0),{center:ie,zoom:e});var h7=this.pixelToPointIn(new es(0,this.height),{center:ie,zoom:e});if(this.zoomLevel<5){if(ib.lat>dd.MAX_LAT&&h7.lat<dd.MIN_LAT){this.isRestrict=true;var T=dd.MAX_LAT-ie.lat;var h9=ie.lat-dd.MIN_LAT;var ij;if(T<h9){ij=T/(this.height/2)}else{ij=h9/(this.height/2)}var ih=18-eN(ij);this.zoomLevel=Math.ceil(ih);ie.zoom=Math.ceil(ih);return ie}}if(ib.lat>dd.MAX_LAT){this.isRestrict=true;ie.lat=dd.MAX_LAT-this.height/2*i}else{if(h7.lat<dd.MIN_LAT){this.isRestrict=true;ie.lat=dd.MIN_LAT+this.height/2*i}}return ie}});function dd(e,T){if(typeof e==="string"){e=document.getElementById(e)}em.call(this);this.container=e;this.width=e.clientWidth;this.height=e.clientHeight;this.offsetX=0;this.offsetY=0;this._setStyle(e);e.unselectable="on";e.innerHTML="";D.ac(e,"bmap-container");e.appendChild(this.render());this._initDate=new Date();this.platform=e.children[0];this.maskLayer=this.platform.children[0];this._panes={};this.centerPoint=new hH(0,0);this.zoomLevel=0;this._heading=0;this._tilt=0;this._bounds=new dZ();this.lastLevel=0;this._lock=false;this._enableTiltZoom=7;this._enableHeadingZoom=7;this.defaultZoomLevel=null;this.defaultCenter=null;this.zoomEventStatus="idle";this.currentOperation=d1.idle;this._setConfig(T);this._initMapRenderType();this._animationInfo={};this._animationInfoUnstopable={};this.suspendLoad=false;this._customTileLabels=[];if(this._renderType==="webgl"){this._workerMgr=new gm(this);this._featureMgr=new dh();D.extend(this,db.prototype);this.jobScheduler=new f1(this);this.benchmark=new ae();this._setupWebGLMap();this.deviceInfo={hardwareInfo:{renderer:"",vendor:""}};if(bb.ifSupportWebGL._renderer){this.deviceInfo.hardwareInfo.renderer=bb.ifSupportWebGL._renderer;this.deviceInfo.hardwareInfo.vendor=bb.ifSupportWebGL._vendor}}else{D.extend(this,aq.prototype)}if(!b9[this.config.mapType]){this.config.mapType=BMAPGL_NORMAL_MAP}if(this.config.mapType===BMAP_EARTH_MAP&&!this.config.enableEarth){if(this.forceEnableEarth()===false){this.config.mapType=BMAPGL_NORMAL_MAP}}this.mapType=this.config.mapType;this.preMapType=null;if(this.config.enableEarth){var h8=this.maskLayer.style;h8.opacity=0;h8.background="#000";if(this.config.mapType===BMAP_EARTH_MAP){h8.opacity=1}setTimeout(function(){h8.WebkitTransition=h8.transition="opacity .4s"},100)}this._isHybridShow=this.config.showStreetLayer;this.temp={operating:false,arrow:0,lastDomMoveTime:0,lastLoadTileTime:0,lastMovingTime:0,canKeyboard:false,I:function(i){return D.I(i)},curSpots:[],curSpotsArray:[],curAreaSpot:null,spotsGuid:1,registerIndex:-1,hoverOnSpot:null,isStdCtrlBusy:false};window.InstanceCore=this.temp.I;this.platform.style.cursor=this.config.defaultCursor;this._bind();for(var h6=0;h6<br._register.length;h6++){br._register[h6](this)}this.temp.registerIndex=h6;var h7=this;if(this._renderType==="webgl"){ej.load("oppcgl",function(){h7._asyncRegister()})}else{ej.load("oppc",function(){h7._asyncRegister()})}if(this.config.mapType==="B_EARTH_MAP"){if(!br.Earth){ej.load("earth",function(){})}else{h7._syncAndChangeMapType("B_EARTH_MAP")}}}dd.MAX_TILT=87;dd.MAX_DRAG_TILT=73;dd.MAX_DRAG_TILT_L2=50;dd.MIN_TILT=0;dd.MAX_LAT=19431424;dd.MIN_LAT=-16023552;dd.WORLD_SIZE_MC_HALF=20037726.372307256;dd.WORLD_SIZE_MC=dd.WORLD_SIZE_MC_HALF*2;dd.RIGHT_EDGE_POINT=new hH(dd.WORLD_SIZE_MC_HALF,0);dd.LEFT_EDGE_POINT=new hH(-dd.WORLD_SIZE_MC_HALF,0);dd.HIGH_RES_MIN_RATIO=1.2;dd.inherits(em,"Map");var df={NORMAL:"B_NORMAL_MAP",EARTH:"B_EARTH_MAP",SATELLITE:"B_STREET_MAP"};br.MapTypeId=df;D.extend(dd.prototype,{render:function(){var e=U("div",{id:"platform"});var h6=e.style;h6.overflow="visible";h6.position="absolute";h6.zIndex=5;h6.top=h6.left="0px";var i=U("div",{id:"mask","class":"BMap_mask"});var T=i.style;T.position="absolute";T.top=T.left="0px";T.zIndex="9";T.overflow="hidden";T.WebkitUserSelect="none";T.width=this.width+"px";T.height=this.height+"px";e.appendChild(i);return e},_initMapRenderType:function(){var e=this.config.forceRenderType;if(e==="dom"){this._renderType="dom";return}else{if(e==="canvas"){if(bb.isModernBrowser&&!bb.ifCanvas2dInBlackList()){this._renderType="canvas";return}else{this._renderType="dom";return}}else{if(e==="webgl"){if(bb.ifSupportWebGL()){this._renderType="webgl";return}}}}if(bb.ifSupportWebGL()&&bb.ifEnableWebGLMap()){this._renderType="webgl";return}if(bb.isModernBrowser&&bb.ifEnableCanvas2dMap()){this._renderType="canvas";return}this._renderType="dom"},_setConfig:function(i){i=i||{};this.config={bottomOffset:0,clickInterval:200,enableDragging:true,enableRotate:true,enableTilt:true,enableKeyboard:false,enableDblclickZoom:true,enableContinuousZoom:true,enableWheelZoom:false,enableRotateGestures:true,enableTiltGestures:true,enablePinchZoom:true,fixCenterWhenPinch:false,enableAutoResize:true,zoomCenter:null,fps:D.Browser.ie?30:60,zoomerDuration:240,actionDuration:450,defaultCursor:fe.defaultCursor,draggingCursor:fe.draggingCursor,overlayMoveCursor:"pointer",coordType:BMAP_COORD_MERCATOR,mapType:BMAPGL_NORMAL_MAP,drawer:BMAP_SYS_DRAWER,enableInertialDragging:true,drawMargin:500,drawMarginGL:500,enableFulltimeSpotClick:false,enableResizeOnCenter:false,isModernBrowser:bb.isModernBrowser,forceRenderType:"",textRenderType:null,ratio:a9()>=dd.HIGH_RES_MIN_RATIO?2:1,enableEarth:bb.ifEnableEarth(),defaultMaxBounds:new dZ(new hH(-21364736,-10616832),new hH(23855104,15859712)),showControls:false,showRealSunlight:true,showMilkyway:true,earthBackground:null,showStreetLayer:true,minZoom:null,maxZoom:null,style:"default",backgroundColor:null,enableIconClick:false,autoSafeArea:false,ak:null,webgl2:false,restrictCenter:true,restrictBounds:null,smaa:true,preserveDrawingBuffer:false,privateOn:false,privateRegions:null};for(var T in i){if(i.hasOwnProperty(T)){this.config[T]=i[T];if(T==="fixCenterWhenResize"){this.config.enableResizeOnCenter=i[T]}}}if(i.style){if(i.style["styleId"]&&i.style["styleId"].length<32){this.config.style=i.style["styleId"]}else{this.config.style=i.style}}this._setTextRenderType();this._displayOptions={poi:true,poiText:true,poiIcon:true,overlay:true,layer:true,building:true,indoor:true,street:true,skyColors:["rgba(226, 237, 248, 0)","rgba(186, 211, 252, 1)"],isFlat:false,labelMargin:0};if(i.displayOptions){for(var e in i.displayOptions){if(i.displayOptions.hasOwnProperty(e)){this._displayOptions[e]=i.displayOptions[e]}}}if(this.config.restrictCenter===false){this._enableTiltZoom=0;this._enableHeadingZoom=0}},getMinZoom:function(){var T;if(b9[this.mapType][this._renderType]){T=b9[this.mapType][this._renderType].minZoom}else{T=b9[this.mapType].minZoom}if(this.config.minZoom!==null&&this.config.minZoom>=T){T=this.config.minZoom}if(this.mapType==="B_EARTH_MAP"){return T}var i=this.getSize();var e=this.worldSize(T);while(e<i.width){T++;e=this.worldSize(T)}return T},getMaxZoom:function(){var e;if(b9[this.mapType][this._renderType]){e=b9[this.mapType][this._renderType].maxZoom}else{e=b9[this.mapType].maxZoom}if(this.config.maxZoom!==null&&this.config.maxZoom<=e){e=this.config.maxZoom}else{if(this._renderType==="webgl"){e=21}}return e},_drawFrame:function(){this._webglMapScene._painter.draw()},_setupWebGLMap:function(){var e=this;ej.load("mapgl",function(){e._asyncRegister()})},_setStyle:function(i){var e=i.style;e.overflow="hidden";if(gb(i).position!=="absolute"){e.position="relative"}e.backgroundImage="url("+fe.imgPath+"bg.png)";e.textAlign="left";e.touchAction=e.MSTouchAction="none"},_bind:function(){var e=this;if(e._renderType!=="webgl"){e._watchSize=function(){var T=e.getContainerSize();if(e.width!==T.width||e.height!==T.height){var h9=(T.width-e.width)/2;var ib=(T.height-e.height)/2;var h6=e.getZoomUnits();var h8=e.centerPoint;if(h8&&!e.config.enableResizeOnCenter){e.centerPoint=new hH(h8.lng+h9*h6,h8.lat-ib*h6)}e.maskLayer.style.width=(e.width=T.width)+"px";e.maskLayer.style.height=(e.height=T.height)+"px";var h7=new be("onresize");h7.size=T;e.dispatchEvent(h7);e.fire(new be("onsize_changed"));var i=parseInt(e.platform.style.left,10)||0;var ia=parseInt(e.platform.style.top,10)||0;if(e.currentOperation!=="undefined"&&e.currentOperation!==d1.idle&&(e.offsetX!==i||e.offsetY!==ia)){e._setPlatformPosition(i,ia)}}}}else{e._watchSize=function(){var i=e.getContainerSize();if(e.width!==i.width||e.height!==i.height){var h6=e.getSize();e.maskLayer.style.width=(e.width=i.width)+"px";e.maskLayer.style.height=(e.height=i.height)+"px";if(a9()!==e.config.ratio){e.config.ratio=a9()}var h7=new be("onresize");h7.size=i;e.dispatchEvent(h7);var T=new be("onsize_changed");T.size=i;T.oldSize=h6;e.fire(T)}}}if(e.config.enableAutoResize){e.temp.autoResizeTimer=setInterval(e._watchSize,16)}this.on("size_changed",function(){var i=e.getMinZoom();if(e.zoomLevel<i){e.setZoomIn(i,{noAnimation:true})}});this.on("zoom_changed",function(){this.dispatchEvent(new be("onzooming"))})},addControl:function(e){if(e&&bY(e._i)){e._i(this);this.dispatchEvent(new be("onaddcontrol",e))}},removeControl:function(e){if(e&&bY(e.remove)){e.remove();this.dispatchEvent(new be("onremovecontrol",e))}},addContextMenu:function(e){if(e){e.initialize(this);this.dispatchEvent(new be("onaddcontextmenu",e))}},removeContextMenu:function(e){if(e){this.dispatchEvent(new be("onremovecontextmenu",e));e.remove()}},addDistrictLayer:function(e){if(e){e.initialize(this)}},removeDistrictLayer:function(e){if(e){e.removeDistrict(this,e)}},addOverlay:function(i){if(i&&bY(i._i)){var T=new be("onbeforeaddoverlay",i);T.overlay=i;this.dispatchEvent(T);i._i(this);T=new be("onaddoverlay",i);T.overlay=i;this.dispatchEvent(T)}},removeOverlay:function(i){if(i&&bY(i.remove)){var T=new be("onremoveoverlay",i);T.overlay=i;i.remove();this.dispatchEvent(T)}},clearOverlays:function(){this.dispatchEvent(new be("onclearoverlays"))},addTileLayer:function(h7){if(!h7){return}for(var h6=0,e=this.tileMgr.tileLayers.length;h6<e;h6++){var T=this.tileMgr.tileLayers[h6];if(T===h7||T.getMapType()===h7.getMapType()){return}}h7.initialize(this);this.dispatchEvent(new be("onaddtilelayer",h7))},removeTileLayer:function(e){if(e){e.remove();this.dispatchEvent(new be("onremovetilelayer",e))}},getTileLayer:function(e){if(this.tileMgr){return this.tileMgr.getTileLayer(e)}return null},setMapType:function(e){var i=this;if(this.mapType===e||this._mapTypeChanging){return}if(e===BMAP_EARTH_MAP&&!this.config.enableEarth){return}if(this._earth&&this._earth.getLock()){return}this._mapTypeChanging=true;this.preMapType=this.mapType;this._boundsInPreMapType=this.getBoundsIn();if(this.preMapType===BMAP_SATELLITE_MAP){this._preStreetLayerShow=this._isHybridShow}if(e===BMAP_EARTH_MAP){if(!br.Earth){ej.load("earth",function(){i._syncAndChangeMapType(e)});return}i._syncAndChangeMapType(e)}else{if(this.preMapType!==BMAP_EARTH_MAP){this._changeFlatMapType(e);this._mapTypeChanging=false}else{this._setMapTypeStatus(e,function(T,h6){var h7=i._earth.getEarthCanvas();i._changeFlatMapType(e,this.preMapType);if(i._mapTypeChangAni){i._mapTypeChangAni.stop()}i._mapTypeChangAni=fw.start({el:h7,style:"opacity",startValue:1,endValue:0,duration:200,callback:function(){i._mapTypeChangAni=null;i._mapTypeChanging=false}});T=ew.convertLL2MC(T);if(i._renderType==="webgl"){D.extend(i,db.prototype);i.setCenterIn(T,{noAnimation:true});i.setZoomIn(h6,{noAnimation:true})}else{D.extend(i,aq.prototype);i.centerAndZoomIn(T,h6)}})}}},_changeFlatMapType:function(h9){if(!h9||!b9[h9]){return}var ii=this.preMapType;this.mapType=h9;var h6=this.getTileLayer(ii);if(h6){this.removeTileLayer(h6)}else{if(this.tileMgr.tileLayers.length){var ih=this.getTileLayer("B_NORMAL_MAP");if(ih){this.removeTileLayer(ih)}else{ih=this.getTileLayer("B_SATELLITE_MAP");ih&&this.removeTileLayer(ih)}}}this._preStreetLayerShow=this.config.showStreetLayer;if(ii===BMAP_SATELLITE_MAP&&this._preStreetLayerShow){this._removeHybirdMap()}if(this.mapType!==BMAP_EARTH_MAP||this._renderType!=="webgl"||this.baseLayerAdded!==true){var T=new dZ(new hH(-21364736,-10616832),new hH(23855104,15859712));var ie=new c9(T,"baidu",h9);var h7=new cV({mapType:this.mapType,copyright:ie,dataType:this.mapType===BMAP_SATELLITE_MAP?eS:gG,customLayer:this.mapType===BMAP_SATELLITE_MAP,baseLayer:true,transparentPng:true,tileTypeName:this.mapType===BMAP_SATELLITE_MAP?"web":"na"});h7._isInnerLayer=true;h7.setZIndex(0);this.addTileLayer(h7);if(this._renderType==="webgl"&&!this.baseLayerAdded){this.baseLayerAdded=true}}if(h9===BMAP_SATELLITE_MAP){this._featureMgr.clearLabelOverlayData();this._featureMgr.setLabelData([]);if(this._preStreetLayerShow===true||typeof this._preStreetLayerShow==="undefined"){this._addHybirdMap()}}var ib=this.tileMgr.tileLayers;for(var ia=0,h8=ib.length;ia<h8;ia++){var ic=ib[ia];var ig=ic.tilesDiv;if(!ig){continue}if(!ic._isInnerLayer&&ig.style.visibility==="hidden"){ig.style.visibility=""}}var id=new be("onmaptypechange");id.zoomLevel=this.zoomLevel;id.mapType=h9;id.exMapType=ii;this.dispatchEvent(id)},showStreetLayer:function(e){e?this._addHybirdMap():this._removeHybirdMap()},hideStreetLayer:function(e){this._hideStreetLayerOptions=e;this._removeHybirdMap(e)},_addHybirdMap:function(){this._isHybridShow=true;if(this.mapType==="B_EARTH_MAP"){if(this._earth){this._earth.showStreetLayer()}return}if(this._hybridTileLayer){this.addTileLayer(this._hybridTileLayer);var h9=new be("onstreetlayer_show");this.dispatchEvent(h9);return}var h7=new dZ(new hH(-21364736,-10616832),new hH(23855104,15859712));var T=new c9(h7,"",BMAP_HYBRID_MAP);var i=new cV({copyright:T,transparentPng:true,tileTypeName:"web"});i._isInnerLayer=true;var h6=this.isCanvasMap();i.getTilesUrl=function(ia,ig){var id=b9.B_STREET_MAP;var ie=aG("ditu","satelliteStreet");var ib=ie.ver;var e=ie.udt;var ic=id.tileUrls[Math.abs(ia.x+ia.y)%id.tileUrls.length]+"?qt=vtile&x="+(ia.x+"").replace(/-/gi,"M")+"&y="+(ia.y+"").replace(/-/gi,"M")+"&z="+ig+"&styles=sl&v="+ib+"&udt="+e+"$scaler="+a9()+"&showtext="+(h6?0:1);return ic};this._isHybridShow=true;this.addTileLayer(i);this._hybridTileLayer=i;var h8=new be("onstreetlayer_show");this.dispatchEvent(h8)},_removeHybirdMap:function(i){this._isHybridShow=false;if(this.mapType==="B_EARTH_MAP"){if(this._earth){this._earth.hideStreetLayer(i)}return}if(this._hybridTileLayer){this.removeTileLayer(this._hybridTileLayer);var T=new be("onstreetlayer_hide");this.dispatchEvent(T)}},isStreetLayerShow:function(){return this._isHybridShow},getTileId:function(e,h8){var h6=b9[this.mapType];if(typeof h6!=="object"){return null}var T=h6.baseUnits*Math.pow(2,(h6.zoomLevelBase-h8));var h7=parseInt(e.lng/T,10);var i=parseInt(e.lat/T,10);return{row:h7,column:i,level:h8}},reset:function(){this.centerAndZoomIn(this.defaultCenter,this.defaultZoomLevel,true)},setOptions:function(i){i=i||{};var h7=this;for(var h6 in i){if(i.hasOwnProperty(h6)){var T=true;if(typeof i[h6]!=="object"){T=i[h6]!==this.config[h6]}this.config[h6]=i[h6];if(h6==="fixCenterWhenResize"){this.config.enableResizeOnCenter=i[h6]}if(!T){continue}switch(h6){case"style":case"styleUrl":var e={os:i.style.os,sv:i.style.sv};if(h6==="style"&&i.styleUrl){break}this.fire(new be("onstyle_willchange"));this.loadMapStyleFiles(function(){var h8=new be("onlayer_update");h8.name="na";h7.fire(h8)},e);break;case"enableAutoResize":if(i[h6]===true){this.enableAutoResize()}else{this.disableAutoResize()}break;case"displayOptions":this.setDisplayOptions(i[h6]);break}}}},setPrivateStatus:function(i){if(typeof i==="boolean"){if(this.config.privateOn!==i){this.config.privateOn=i;var e=new be("onlayer_update");e.name="na";this.fire(e)}}},getPrivateStatus:function(){return this.config.privateOn},setPrivateRegions:function(h7){if(h7&&h7 instanceof Array){var h6=true;for(var T=0;T<h7.length;T++){if(h7[T] instanceof dH){continue}else{h6=false;break}}if(h6){this.config.privateRegions=h7;var e=new be("onlayer_update");e.name="na";this.fire(e)}}},getPrivateRegions:function(){if(!this.config.privateRegions){return null}else{return this.config.privateRegions}},enableDragging:function(){this.config.enableDragging=true},disableDragging:function(){this.config.enableDragging=false},enableInertialDragging:function(){this.config.enableInertialDragging=true},disableInertialDragging:function(){this.config.enableInertialDragging=false},enableScrollWheelZoom:function(){this.config.enableWheelZoom=true},disableScrollWheelZoom:function(){this.config.enableWheelZoom=false},enableContinuousZoom:function(){this.config.enableContinuousZoom=true},disableContinuousZoom:function(){this.config.enableContinuousZoom=false},enableResizeOnCenter:function(){this.config.enableResizeOnCenter=true},disableResizeOnCenter:function(){this.config.enableResizeOnCenter=false},enableDoubleClickZoom:function(){this.config.enableDblclickZoom=true},disableDoubleClickZoom:function(){this.config.enableDblclickZoom=false},enableKeyboard:function(){this.config.enableKeyboard=true},disableKeyboard:function(){this.config.enableKeyboard=false},getSize:function(){return new ei(this.width,this.height)},enablePinchToZoom:function(){this.config.enablePinchZoom=true},disablePinchToZoom:function(){this.config.enablePinchZoom=false},enableTilt:function(){this.config.enableTilt=true},disableTilt:function(){this.config.enableTilt=false},enableRotate:function(){this.config.enableRotate=true},disableRotate:function(){this.config.enableRotate=false},enableAutoResize:function(){this.config.enableAutoResize=true;this._watchSize();if(!this.temp.autoResizeTimer){this.temp.autoResizeTimer=setInterval(this._watchSize,16)}},disableAutoResize:function(){this.config.enableAutoResize=false;if(this.temp.autoResizeTimer){clearInterval(this.temp.autoResizeTimer);this.temp.autoResizeTimer=null}},checkResize:function(){this._watchSize()},resize:function(){this._watchSize()},getContainerSize:function(){return new ei(this.container.clientWidth,this.container.clientHeight)},_getProperZoom:function(T){if(!T){T=this.zoomLevel}var i=this.getMinZoom();var e=this.getMaxZoom();var h6=false;if(T<i){h6=true;T=i}if(T>e){h6=true;T=e}if(this._renderType!=="webgl"){T=Math.round(T)}return{zoom:T,exceeded:h6}},getContainer:function(){return this.container},getZoomUnits:function(T){if(this.mapType===BMAP_EARTH_MAP){return Math.pow(2,18-this._earth.getImageZoom())}var e=b9[this.mapType];if(typeof e!=="object"){return null}var i=T||this.zoomLevel;return Math.pow(2,(e.zoomLevelBase-i))},pointToPixelIn:function(ii,ik){if(!ii){return}ik=ik||{};if(this.mapType===BMAP_EARTH_MAP){var h8;if(!ii._llPt){h8=ew.convertMC2LL(ii);ii._llPt=h8}h8=ii._llPt;var id=null;var h7=null;if(typeof ik.zoom==="number"){var ih=this._earth;var ij=ih._getEarthZoomByImgZoom(ik.zoom);if(ij<=3){id=ih._generateTmpPMatrix(ij)}h7=ih._generateTmpMVMatrix(ih.getCenter(),ij)}var h9=this._earth.fromLatLngToPixel(h8,{useRound:false,isCalcOnBack:true,matrixInfo:{modelViewMatrix:h7,projectionMatrix:id}});return h9}if((this._heading%360===0&&this._tilt===0)||!this._webglMapCamera){var ig=this.getZoomUnits(ik.zoom);var ib=ik.center||this.centerPoint;var h6=this.width/2;var ia=this.height/2;var ie;if(ii.lng*ib.lng<0){var i=Math.abs(ii.lng-ib.lng);var e=(ed._mc180X*2-i)/ig;if(ib.lng<0){ie=h6-e}else{ie=h6+e}}else{ie=(ii.lng-ib.lng)/ig+h6}var ic=(ib.lat-ii.lat)/ig+ia;if(ik.useRound!==false){ie=Math.round(ie);ic=Math.round(ic)}return new es(ie,ic)}var T=this._webglMapCamera.fromMCToScreenPixel(ii.lng,ii.lat,ik);if(ik.useRound===false){return T}T.x=Math.round(T.x);T.y=Math.round(T.y);return T},pixelToPointIn:function(e,id){if(!e){return}id=id||{};if(this.mapType===BMAP_EARTH_MAP){if(typeof id.zoom==="number"){var ib=this._earth;var h8=null;var T=null;var ic=ib._getEarthZoomByImgZoom(id.zoom);if(ic<=3){h8=ib._generateTmpPMatrix(ic)}T=ib._generateTmpMVMatrix(ib.getCenter(),ic)}var i=this._earth.fromPixelToLatLng(e,{matrixInfo:{modelViewMatrix:T,projectionMatrix:h8}});if(i===null){return null}return ew.convertLL2MC(i)}if((this._heading%360!==0||this._tilt>0)&&this._webglMapCamera){return this._webglMapCamera.fromScreenPixelToMC(e.x,e.y,id)}var h9=id.center||this.centerPoint;var ia=this.getZoomUnits(id.zoom);var h7=h9.lng+ia*(e.x-this.width/2);var h6=h9.lat-ia*(e.y-this.height/2);return new hH(h7,h6)},pointToOverlayPixelIn:function(e,h6){h6=h6||{};var T=this.pointToPixelIn(e,{zoom:h6.zoom,center:h6.center,forLabel:true,frustumTest:true,useRound:h6.useRound});if(!T){return}if(h6.fixPosition&&this.mapType!=="B_EARTH_MAP"){var h7=this.getSize();var i=this.worldSize(h6.zoom);if(T.x>h7.width){while(T.x>h7.width){T.x-=i}}else{if(T.x<0){while(T.x<0){T.x+=i}}}}if(this._renderType==="webgl"){return T}T.x-=this.offsetX;T.y-=this.offsetY;return T},overlayPixelToPointIn:function(i,e){if(!i){return}var T=i.clone();if(this._renderType!=="webgl"){T.x+=this.offsetX;T.y+=this.offsetY}return this.pixelToPointIn(T,e)},getProjection:function(){return new ew()},lnglatToMercator:function(e,h6){var i=new hH(e,h6);var T=ew.convertLL2MC(i);return[T.lng,T.lat]},mercatorToLnglat:function(i,e){if(isNaN(i)||isNaN(e)){return[]}i=parseFloat(i);e=parseFloat(e);var h6=new hH(i,e);var T=ew.convertMC2LL(h6);return[T.lng,T.lat]},getBoundsIn:function(){var ik=arguments[0];if(this.mapType===BMAP_EARTH_MAP&&this._earth){var id=this._earth.getCustomBounds();if(!id){return this.config.defaultMaxBounds}var ic=id.getSouthWest();var e=id.getNorthEast();if(ic.lng>e.lng){e.lng=180}var iD=ew.convertLL2MC(ic);var it=ew.convertLL2MC(e);var ih=this.config.defaultMaxBounds;var ir=Math.max(iD.lng,ih.sw.lng);var iq=Math.max(iD.lat,ih.sw.lat);var ij=Math.min(it.lng,ih.ne.lng);var ii=Math.min(it.lat,ih.ne.lat);var im=new dZ(new hH(ir,iq),new hH(ij,ii));im.pointBottomLeft=new hH(ir,iq);im.pointBottomRight=new hH(ij,iq);im.pointTopLeft=new hH(ir,ii);im.pointTopRight=new hH(ij,ii);im.setMinMax();im.makeNormalizedPoint(this._earth.getHeading());return im}ik=ik||{};var h7=ik.margins||[0,0,0,0];var iy=this.pixelToPointIn({x:h7[3],y:this.height-h7[2]},ik);var iC=this.pixelToPointIn({x:this.width-h7[1],y:h7[0]},ik);var ip=typeof ik.heading==="number"?ik.heading:(this._heading%360);var T=typeof ik.tilt==="number"?ik.tilt:this._tilt;var ig=this._webglMapCamera;if((ip===0&&T===0)||!ig){this._bounds.setSouthWest(iy);this._bounds.setNorthEast(iC);this._bounds.pointBottomLeft=iy;this._bounds.pointBottomRight=new hH(iC.lng,iy.lat);this._bounds.pointTopRight=iC;this._bounds.pointTopLeft=new hH(iy.lng,iC.lat);this._bounds.setMinMax();this._bounds.makeNormalizedPoint(ip);return this._bounds}var io=this.pixelToPointIn({x:h7[3],y:h7[0]},ik);var h6=ig.getPosition();var iE=Math.sqrt(Math.pow(io.lng-h6[0],2)+Math.pow(io.lat-h6[1],2));var iz=this.getZoomUnits();var iG=iE/iz;var iw=ig._frustumSideLen;var ib=ig._fovy;if(iG>iw||(90-T)<ib/2){var iF=[io.lng-h6[0],io.lat-h6[1]];if((90-T)<ib/2){iF[0]=-iF[0];iF[1]=-iF[1]}var ix=iw*iz;var ia=[iF[0]/iE*ix+h6[0],iF[1]/iE*ix+h6[1]];var iu=[iC.lng-h6[0],iC.lat-h6[1]];if((90-T)<ib/2){iu[0]=-iu[0];iu[1]=-iu[1]}var h8=[iu[0]/iE*ix+h6[0],iu[1]/iE*ix+h6[1]];io.lng=ia[0];io.lat=ia[1];iC.lng=h8[0];iC.lat=h8[1]}var il=this.pixelToPointIn({x:this.width-h7[1],y:this.height-h7[2]},ik);var iv=[iy,iC,io,il];var iB=iv[0].lng;var iH=iv[0].lat;var h9=iv[0].lng;var ie=iv[0].lat;for(var iA=1;iA<4;iA++){if(iv[iA].lng<iB){iB=iv[iA].lng}if(iv[iA].lng>h9){h9=iv[iA].lng}if(iv[iA].lat<iH){iH=iv[iA].lat}if(iv[iA].lat>ie){ie=iv[iA].lat}}this._bounds.setSouthWest(new hH(iB,iH));this._bounds.setNorthEast(new hH(h9,ie));this._bounds.pointTopLeft=io;this._bounds.pointTopRight=iC;this._bounds.pointBottomRight=il;this._bounds.pointBottomLeft=iy;this._bounds.makeNormalizedPoint(ip);this._bounds.setMinMax();return this._bounds},isLoaded:function(){return !!this.loaded},_getBestLevel:function(i,ig){var h8=0;if(this._renderType==="webgl"&&!gi()){h8=100}var h9=ig.margins||[10,10,10,10];var h6=ig.zoomFactor||0;var ia=h9[1]+h9[3];var h7=h9[0]+h9[2];var e=this.getMinZoom();var ie=this.getMaxZoom();var id=i.toSpan();var ic=id.width/(this.width-ia-h8);var ib=id.height/(this.height-h7-h8);var T=18-eN(Math.max(ic,ib));if(T<e){T=e}if(T>ie){T=ie}T+=h6;if(this._renderType!=="webgl"){T=Math.floor(T)}return T},getViewportIn:function(ig,h7){if(this.mapType===BMAP_EARTH_MAP){ig=ig||[];var h9=[];for(var ih=0;ih<ig.length;ih++){if(!ig[ih]){continue}h9.push(ew.convertMC2LL(ig[ih]))}var ii=this._earth.getViewportIn(h9,h7);var h6=ii.center;var id=ii.zoom;var im=ew.convertLL2MC(h6);return{center:im,zoom:id}}var ib={center:this.getCenterIn(),zoom:this.getZoom()};if(!ig||ig.length===0){return ib}h7=h7||{};var ia;if(ig instanceof dZ){ia=ig}else{var h8=ig;ia=new dZ();for(var ie=h8.length-1;ie>=0;ie--){ia.extend(h8[ie])}if(ia.isEmpty()){return ib}}var il=ia.getCenter();var e=this._getBestLevel(ia,h7);if(h7.margins){var T=h7.margins;var ik=(T[1]-T[3])/2;var ic=(T[0]-T[2])/2;var ij=this.getZoomUnits(e);il.lng=il.lng+ij*ik;il.lat=il.lat+ij*ic}return{center:il,zoom:e}},setViewportIn:function(h6,h7){if(this.mapType===BMAP_EARTH_MAP){var ib;if(h6&&h6.center){var T=ew.convertMC2LL(h6.center);var h9=this._earth._getEarthZoomByImgZoom(h6.zoom,T);ib={center:T,zoom:h9}}else{ib=[];for(var h8=0;h8<h6.length;h8++){var ia=ew.convertMC2LL(h6[h8]);ib[h8]=new c8(ia.lat,ia.lng)}}this._earth.setViewportIn(ib,h7);return}var e;if(h6&&h6.center){e=h6}else{e=this.getViewportIn(h6,h7)}h7=h7||{};if(this._renderType==="webgl"){this.centerAndZoomIn(e.center,e.zoom,h7);return}if(e.zoom===this.zoomLevel&&h7.enableAnimation!==false){this.panToIn(e.center,{duration:200,callback:h7.callback})}else{this.centerAndZoomIn(e.center,e.zoom,h7)}},addSpots:function(T,i){if(!T||T.length===0){return}i=i||{};var h8=i.zIndex||0;var h7=typeof i.enableMultiResponse==="undefined"?true:!!i.enableMultiResponse;this.spotsPool=this.spotsPool||{};var e="sp"+(this.temp.spotsGuid++);this.spotsPool[e]={spots:T.slice(0),zIndex:h8,enableMultiResponse:h7};var h6=this;ej.load("hotspot",function(){h6._asyncRegister()});return e},getSpots:function(e){return this.spotsPool[e]&&this.spotsPool[e].spots||[]},removeSpots:function(e){if(!e||!this.spotsPool[e]){return}delete this.spotsPool[e]},clearSpots:function(){delete this.spotsPool},getIconByClickPosition:function(i){if(!this.config.enableIconClick||!this._spotsMgr){return null}var e=this._spotsMgr.getSpotsByScreenPosition(i);if(e[0]&&e[0].userdata){var T=e[0].userdata;return{name:T.name,uid:T.uid,position:T.iconPoint||e[0].pt}}return null},setBounds:function(e){b9[this.mapType].bounds=e.clone()},getCoordType:function(){return this.config.coordType},getPanes:function(){return this._panes},getInfoWindow:function(){if(this.temp.infoWin&&this.temp.infoWin.isOpen()){return this.temp.infoWin}return null},getDistanceIn:function(h7,e){if(!h7||!e){return}if(h7.equals(e)){return 0}if(this.mapType===BMAP_EARTH_MAP){var h6=ew.convertMC2LL(h7);var T=ew.convertMC2LL(e);return this._earth.getDistance(h6,T)}var i=ew.getDistanceByMC(h7,e);return i},getOverlays:function(){var h8=[];var h9=this._overlays;var h7=this._customOverlays;if(h9){for(var h6 in h9){if(h9[h6] instanceof cZ){h8.push(h9[h6])}}}if(h7){for(var T=0,e=h7.length;T<e;T++){h8.push(h7[T])}}return h8},getMapType:function(){return this.mapType},_asyncRegister:function(){for(var e=this.temp.registerIndex;e<br._register.length;e++){br._register[e](this)}this.temp.registerIndex=e},setDefaultCursor:function(e){this.config.defaultCursor=e;if(this.platform){this.platform.style.cursor=this.config.defaultCursor}},getDefaultCursor:function(){return this.config.defaultCursor},setOverlayMoveCursor:function(e){this.config.overlayMoveCursor=e},getOverlayMoveCursor:function(){return this.config.overlayMoveCursor},setDraggingCursor:function(e){this.config.draggingCursor=e},getDraggingCursor:function(){return this.config.draggingCursor},_syncAndChangeMapType:function(e){var i=this;if(i._renderType==="webgl"&&i.getTilt()>dd.MAX_DRAG_TILT_L2){i.setTilt(dd.MAX_DRAG_TILT_L2,{callback:function(){i._changeEarthMapType(e)}})}else{i._changeEarthMapType(e)}},_changeEarthMapType:function(T){var h6=this;var h9=h6.tileMgr.tileLayers;if(this._mapTypeChangAni){this._mapTypeChangAni.stop()}var h8;if(this._earth){h8=this._earth.getEarthCanvas()}if(!this._earth){this.maskLayer.style.opacity=1;this.maskLayer.style.zIndex=999;this.maskLayer.style.background="#000"}this._mapTypeChangAni=new p({duration:400,render:function(e){if(!h6._earth){return}h8.style.opacity=e},finish:function(){for(var e=h9.length-1,ia=e;ia>=0;ia--){var ic=h9[ia].tilesDiv;if(ic){ic.style.visibility="hidden"}if(h9[ia]._isInnerLayer&&h6._renderType!=="webgl"){h6.removeTileLayer(h9[ia])}}h6._mapTypeChangAni=null;h6._mapTypeChanging=false;function ib(){var ih=h6.getZoom()-2;var ii=h6.getCenterIn();var ie=ew.convertMC2LL(ii);h6._earth=new br.Earth(h6,{center:ie,zoom:ih,showRealSunlight:h6.config.showRealSunlight,showMilkyway:h6.config.showMilkyway,earthBackground:h6.config.earthBackground});h6._proxyEarthEvents();var id=h6.mapType;h6.mapType=T;var ig=new be("onmaptypechange");ig.zoomLevel=this.zoomLevel;ig.mapType=T;ig.exMapType=id;h6.dispatchEvent(ig);h6._setMapTypeStatus(T);D.extend(h6,br.EarthView.prototype);if(!h6._navigationCtrl&&h6.config.showControls){h6._navigationCtrl=new e5(h6)}}if(!h6._earth){if(br["FeatureStyle"+h6.config.style]){ib()}else{h6.loadMapStyleFiles(function(){ib()})}}if(parseInt(h6.maskLayer.style.opacity,10)===1){setTimeout(function(){h6.maskLayer.style.zIndex=9;h6.maskLayer.style.opacity=0},1000)}}});if(!this._earth){return}var i=this.mapType;this.mapType=T;var h7=new be("onmaptypechange");h7.zoomLevel=this.zoomLevel;h7.mapType=T;h7.exMapType=i;this.dispatchEvent(h7);h6._setMapTypeStatus(T);D.extend(h6,br.EarthView.prototype)},getMapStyleId:function(){if(typeof this.config.style==="string"){return this.config.style}return this.config.mapStyleId||"custom"},_setMapTypeStatus:function(T){var ia=arguments[1];if(T===BMAP_EARTH_MAP){var h8=this._earth.getEarthCanvas();if(h8){h8.style.display=""}var ib={noAnimation:true};this._earth.setCenter(ew.convertMC2LL(this.centerPoint),ib);this._earth.setImageZoom(this.zoomLevel,ib);this._earth.setTilt(this.getTilt(),ib);this._earth.setHeading(this.getHeading(),ib)}else{if(this.preMapType===BMAP_EARTH_MAP&&this._earth){var h9=this._earth;var h6=h9.getMapZoom();var h7=h9._imageRawZoom||h6;var i=h7-h6;var e=h9.getCenter();if(this._renderType==="webgl"){this._tilt=h9.getTilt();if(this.zoomLevel>7){this._heading=h9.getHeading();ia&&ia(e,h6);return}if(h9.getHeading()!==0){h9.setTilt(this.getTilt());h9.setHeading(this.getHeading(),{callback:function(){ia&&ia(e,h6)}})}else{ia&&ia(e,h6)}return}if(i<0.1&&h9.getTilt()===0&&h9.getHeading()===0){ia&&ia(e,h6);return}h9.setTilt(0);h9.setHeading(0);h9.setZoom(h9.getZoom()-i,{callback:function(){ia&&ia(e,h6)}})}}},_proxyEarthEvents:function(){var h7=this;var h8=this._earth;h8.on("tilesload",function(i){h7.fire(i)});h8.on("centerandzoom",function(i){h7.dispatchEvent(new be("onmoveend"));h7.dispatchEvent(new be("onzoomend"))});function h6(i){h7.fire(i)}var e=["zoomstart","zoomend","tilesload","sunlighttime_change","sunlighttime_clear","centerandzoom","animation_start","animation_stop","movestart","moveend","moving","dragstart","dragend","dragging"];for(var T=0;T<e.length;T++){h8.on(e[T],h6)}},forceEnableEarth:function(){this.config.forceEnableEarth=true;this.config.enableEarth=bb.ifEnableEarth(true);this.dispatchEvent(new be("forceenableearth"));return this.config.enableEarth},setLock:function(e){if(this.mapType===BMAP_EARTH_MAP){this._earth.setLock(e)}this._lock=e},getLock:function(){if(this.mapType===BMAP_EARTH_MAP){return this._earth.getLock()}return this._lock},getEarth:function(){return this._earth},isSupportEarth:function(){return this.config.enableEarth},isCanvasMap:function(){return !!(this._renderType==="canvas"&&this.getMapType()!=="B_EARTH_MAP")},getCanvasMapCoordByUid:function(h7){if(this._renderType==="webgl"){var h8=this.tileMgr.tileLayers;for(var h6=0;h6<h8.length;h6++){if(h8[h6].labelProcessor){return h8[h6].labelProcessor.getLabelByUid(h7,"")}}return null}var e=this.canvas2dMapMgr._labelClick;var T=e.findLabelByUid(h7);return T?new hH(T.iconPos.geoX,T.iconPos.geoY):null},loadBizData:function(i){var e=new be("onloadbizdata");e.data=i;this.dispatchEvent(e)},unloadBizData:function(){var e=new be("onunloadbizdata");this.dispatchEvent(e)},zoomIn:function(e){this.setZoomIn(this.zoomLevel+1,{zoomCenter:e})},zoomOut:function(e){this.setZoomIn(this.zoomLevel-1,{zoomCenter:e})},setMaxZoom:function(e){if(this._renderType==="webgl"){this.config.maxZoom=e<=21?e:21}else{this.config.maxZoom=e<=19?e:19}},setMinZoom:function(e){this.config.minZoom=e>=3?e:3},setCenterIn:function(e,i){this.panToIn(e,i)},getRenderType:function(){return this._renderType},getSolarInfo:function(h6){h6=h6||this._initDate;var T=bC(h6);var e=ew.convertLL2MC(new hH(T[0],T[1]));var ie=e.latLng;var h9=br.Projection.convertMC2LL(this.centerPoint);var ib=h6.getUTCHours();var id=ib+24*h9.lng/360;var ic=id-12;var ia=ic*60*0.25;var h8=Math.asin(Math.sin(dQ(h9.lat))*Math.sin(dQ(ie.lat))+Math.cos(dQ(h9.lat))*Math.cos(dQ(ie.lat))*Math.cos(dQ(ia)));var h7=Math.asin(Math.sin(dQ(ia))*Math.cos(dQ(ie.lat))/Math.cos(h8));var i="north";if(h9.lat<ie.lat){i="south"}return{zenith:e,solarAltitude:h8,solarAzimuth:h7,centerPosition:i,position:e}},setDisplayOptions:function(T){if(!T){return}for(var e in this._displayOptions){if(this._displayOptions.hasOwnProperty(e)){if(typeof T[e]==="boolean"||(e==="skyColors"&&typeof T.skyColors==="object")||(e==="labelMargin"&&typeof T.labelMargin==="number")){this._displayOptions[e]=T[e]}}}var i=this.getMapType();if(i===df.NORMAL){this.fire(new be("ondisplayoptions_changed"))}else{if(i===df.EARTH&&this._earth){this._earth.fire(new be("ondisplayoptions_changed"))}}},getHorizonPosY:function(e){if(!e||!this._webglMapCamera){return null}var i=this._webglMapCamera.fromMCToScreenPixel(e.lng,e.lat,{heading:0});return i.y},getIndoorInfo:function(){if(!this._indoorMgr){return}return this._indoorMgr.getData()},showIndoor:function(e,T){var i=new be("onindoor_status_changed");i.uid=e;i.floor=T;this.fire(i)},addAreaSpot:function(e,T){if(!e||e.length===0){return}T=T||{};this.areaSpots=this.areaSpots||{};var i=T.id||("sp"+(this.temp.spotsGuid++));this.areaSpots[i]={spot:e,userData:T.userData};var h6=this;ej.load("hotspot",function(){h6._asyncRegister()});return i},getAreaSpot:function(e){if(this.areaSpots&&this.areaSpots[e]){return this.areaSpots[e]}return null},removeAreaSpot:function(e){if(!e||!this.areaSpots[e]){return}delete this.areaSpots[e]},clearAreaSpots:function(){this.areaSpots={}},resetSpotStatus:function(){this.fire(new be("onspot_status_reset"))},hightlightSpotByUid:function(e,T){var i=new be("onspot_highlight");i.uid=e;i.tilePosStr=T;this.fire(i)},setZoomIn:function(i,e){e=e||{};this.zoomTo(i,e.zoomCenter||null,e)},restrictBounds:function(e){if(e instanceof dZ){this.config.restrictBounds=e;this.restrictCenter(this.getCenterIn());this.fire(new be("oncenter_changed"))}},getCurrentMaxTilt:function(){var e=this.zoomLevel;if(this.mapType==="B_EARTH_MAP"){return dd.MAX_DRAG_TILT_L2}if(this.config.restrictCenter===false){return dd.MAX_DRAG_TILT}if(e>=19){return dd.MAX_DRAG_TILT}else{if(e<=18){if(e<this._enableTiltZoom){if(e>=this._enableTiltZoom-2){return(1-(this._enableTiltZoom-e)/2)*dd.MAX_DRAG_TILT_L2}return 0}return dd.MAX_DRAG_TILT_L2}else{return(dd.MAX_DRAG_TILT-dd.MAX_DRAG_TILT_L2)*(e-18)+dd.MAX_DRAG_TILT_L2}}},worldSize:function(i){var e=i||this.zoomLevel;return dd.WORLD_SIZE_MC/this.getZoomUnits(e)},setTrafficOn:function(e){if(e&&Number(e)>1){ch.setZIndex(Number(e))}this.addTileLayer(ch)},setTrafficOff:function(){this.removeTileLayer(ch)},showOverlayContainer:function(){this.setDisplayOptions({overlay:true})},hideOverlayContainer:function(){this.setDisplayOptions({overlay:false})},addLabelsToMapTile:function(T){for(var e=0;e<T.length;e++){if(typeof T[e].type==="undefined"){T[e].type="fixed"}if(typeof T[e].rank!=="number"){T[e].rank=50000}T[e].pt=T[e].position;T[e].custom=true;T[e].processedInZoom=0;this._customTileLabels.push(T[e])}this.dispatchEvent(new be("onadd_tile_labels"))},removeLabelsFromMapTile:function(T){for(var h6=0;h6<T.length;h6++){for(var e=0;e<this._customTileLabels.length;e++){if(this._customTileLabels[e].uid===T[h6]){this._customTileLabels.splice(e,1)}}}this.dispatchEvent(new be("onremove_tile_labels"))},clearLabels:function(){this._customTileLabels.length=0;this.dispatchEvent(new be("onclear_labels"))},loadMapStyleFiles:function(h8,e){this.customLoaded=false;var T=this.config.style;var h7=this.config.styleUrl;var h6=this;this._setTextRenderType();if(typeof T==="string"&&!h7){if(br["FeatureStyle"+T]){this.customLoaded=true;h6.fire(new be("onstyle_loaded"));h8();return}br["FeatureStyle"+T]=window.FeatureStyle;br["iconSetInfo"+T]=window.iconSetInfo_high;br.indoorStyle=window.indoorStyle;hB.load(fe.getMapStyleFiles(T),function(){if(h6.config.style===T){br["FeatureStyle"+T]=window.FeatureStyle;br["iconSetInfo"+T]=window.iconSetInfo_high;br.indoorStyle=window.indoorStyle;h6.customLoaded=true;h6.fire(new be("onstyle_loaded"));h8()}})}else{var i=T;f.init(h6);f.getStyleJson(i,function(ia){var ig=gr;var ii=br.getGUID("custom");h6.config.mapStyleId=ii;var id={};D.extend(id,ia);var ib=Math.floor(h6.getZoom());var ie;window["styleCbk_"+ii]=function(ij,ik){if(ik!==ie){return}if(typeof ij==="string"){ij=JSON.parse(ij)}f.onStyleDataBack(ij,ib,ii,id,ig,br["customStyleInfo_"+ii]);h6.customLoaded=true;h6.fire(new be("onstyle_loaded"));h8()};br["customStyleInfo_"+ii]={zoomRegion:{},zoomStyleBody:[],zoomFrontStyle:{}};var ih=f.getStyleUrl(ia,ig,"styleCbk_"+ii,ib,e,br["customStyleInfo_"+ii]);var h9=ih.split("?")[0];ie=ih.split("?")[1];if(h7){h9=h7;ie=h9.split("?")[1]}if(!br.iconSetInfoCustom){var ic=fe.getMapStyleFiles("default");ic.splice(1,1);hB.load(ic,function(){br.iconSetInfoCustom=window.iconSetInfo_high;br.indoorStyle=window.indoorStyle;if(h9.indexOf("jsonp")>"-1"){hB.load(h9)}else{br["customStyleInfo_"+ii].xhr=gN.post(h9,ie,window["styleCbk_"+ii])}})}else{if(h9.indexOf("jsonp")>"-1"){hB.load(h9)}else{br["customStyleInfo_"+ii].xhr=gN.post(h9,ie,window["styleCbk_"+ii])}}})}},getFeatureStyleTags:function(){var e=[];var h7=Object.keys(br);for(var h6=0;h6<h7.length;h6++){var T=h7[h6];if(T.indexOf("FeatureStyle")>-1&&br[T]){e.push(T)}}return e},setCopyrightOffset:function(h6,i){var T=new be("oncopyrightoffsetchange",{logo:h6,cpy:i});this.dispatchEvent(T)},_setTextRenderType:function(e){if(e){this.config.textRenderType=e;return}if(this.config.textRenderType!==null){return}if(gi()){this.config.textRenderType="canvas"}else{if(typeof this.config.style==="string"){this.config.textRenderType="image"}else{this.config.textRenderType="canvas"}}},destroy:function(){this._destroyed=true;this.fire(new be("ondestroy"))},centerAndZoom:function(e,h8,T){if(Object.prototype.toString.call(h8)!=="[object Undefined]"){h8=parseInt(h8,10)}if(typeof e==="string"){var h6=this;var h7=new W();h7.getPoint(e,function(h9){e=h9;var ia=ew.convertLL2MC(e);h6.centerAndZoomIn(ia,h8,T)})}else{var i=ew.convertLL2MC(e);this.centerAndZoomIn(i,h8,T)}},pointToPixel:function(e,T){var i=ew.convertLL2MC(e);var h6={};D.extend(h6,T);if(h6&&h6.center){h6.center=ew.convertLL2MC(h6.center)}return this.pointToPixelIn(i,h6)},pixelToPoint:function(T,i){var h6={};D.extend(h6,i);if(h6&&h6.center){h6.center=ew.convertLL2MC(h6.center)}var e=this.pixelToPointIn(T,h6);return ew.convertMC2LL(e)},pointToOverlayPixel:function(e,T){var i=ew.convertLL2MC(e);var h6={};D.extend(h6,T);if(h6&&h6.center){h6.center=ew.convertLL2MC(h6.center)}return this.pointToOverlayPixelIn(i,h6)},overlayPixelToPoint:function(T,i){var h6={};D.extend(h6,i);if(h6&&h6.center){h6.center=ew.convertLL2MC(h6.center)}var e=this.overlayPixelToPointIn(T,h6);return ew.convertMC2LL(e)},setViewport:function(T,h6){var e;if(T&&T.center){e={};D.extend(e,T);e.center=ew.convertLL2MC(e.center)}else{e=[];for(var h7=0;h7<T.length;h7++){e[h7]=ew.convertLL2MC(T[h7])}}this.setViewportIn(e,h6)},getViewport:function(h8,h6){var T;if(h8&&h8.length){T=[];for(var h7=0;h7<h8.length;h7++){T[h7]=ew.convertLL2MC(h8[h7])}}else{if(h8 instanceof dZ){T=new dZ(ew.convertLL2MC(h8.getSouthWest()),ew.convertLL2MC(h8.getNorthEast()));T.setMinMax()}}var e=this.getViewportIn(T,h6);e.center=ew.convertMC2LL(e.center);return e},getDistance:function(h7,T){var i=ew.convertLL2MC(h7);var h6=ew.convertLL2MC(T);var e=this.getDistanceIn(i,h6);return e},setCenter:function(e,T){if(typeof e==="string"){var h6=this;var h7=new W();h7.getPoint(e,function(h8){e=h8;var h9=ew.convertLL2MC(e);h6.setCenterIn(h9,T)})}else{var i=ew.convertLL2MC(e);this.setCenterIn(i,T)}},setZoom:function(T,e){var i={};D.extend(i,e);if(i&&i.zoomCenter){i.zoomCenter=ew.convertLL2MC(i.zoomCenter)}this.setZoomIn(T,i)},flyTo:function(e,h6,T){var i=ew.convertLL2MC(e);this.flyToIn(i,h6,T)},panTo:function(e,T){var i=ew.convertLL2MC(e);this.panToIn(i,T)},getCenter:function(){var e=this.getCenterIn();return ew.convertMC2LL(e)},getBounds:function(){var e=this.getBoundsIn();var i=new dZ(ew.convertMC2LL(e.getSouthWest()),ew.convertMC2LL(e.getNorthEast()));return i},setMapStyleV2:function(e){if(typeof e==="string"){this._setTextRenderType("image")}else{this._setTextRenderType("canvas")}this.setOptions({style:e})},startViewAnimation:function(T){var e=T._options.delay;var i=this;setTimeout(function(){T._start(i)},e)},pauseViewAnimation:function(e){e._pause(this)},continueViewAnimation:function(e){e._continue(this)},cancelViewAnimation:function(e){e._cancel(this)},getMapScreenshot:function(){return this._webglMapScene._painter._canvas.toDataURL()}});window.BMAP_NORMAL_MAP="B_NORMAL_MAP";window.BMAPGL_NORMAL_MAP="B_NORMAL_MAP";window.BMAP_SATELLITE_MAP="B_SATELLITE_MAP";window.BMAP_HYBRID_MAP="B_STREET_MAP";window.BMAP_EARTH_MAP="B_EARTH_MAP";window.BMAP_NONE_MAP="B_NONE_MAP";window.BMAP_COORD_MERCATOR=1;window.BMAP_SYS_DRAWER=0;window.BMAP_SVG_DRAWER=1;window.BMAP_VML_DRAWER=2;window.BMAP_CANVAS_DRAWER=3;var f={environment:"jsapi",map:null,ontilesloaded:false,onstyle_loaded:false,init:function(i){var e=this;e.map=i;this.changeCopyright();this.setEnvironment(e.map.config.style);this.resetEventListener()},resetEventListener:function(){var e=this;this.ontilesloaded=false;this.onstyle_loaded=false;e.map.addEventListener("ontilesloaded",e.checkLoadedStatus);e.map.addEventListener("onstyle_loaded",e.checkLoadedStatus)},checkLoadedStatus:function(i){f[i.type]=true;if(f.ontilesloaded&&f.onstyle_loaded){this.dispatchEvent(new be("onstylechangetilesloaded"));this.removeEventListener("ontilesloaded",f.checkLoadedStatus);this.removeEventListener("onstyle_loaded",f.checkLoadedStatus)}},changeCopyright:function(){var e=this;if(e.map.cpyCtrl){e.map.cpyCtrl.hide();if(e.environment!=="customEditor"){e.map.setCopyrightOffset(new ei(1,1))}}else{e.map.addEventListener("oncopyrightaddend",function(){e.map.cpyCtrl.hide();if(e.environment!=="customEditor"){e.map.setCopyrightOffset(new ei(1,1))}})}},setEnvironment:function(e){if(e.customEditor){this.environment="customEditor";bM.map=this.map}else{if(e.sharing){this.environment="sharing"}else{if(e.preview){this.environment="preview"}else{this.environment="jsapi"}}}},getStyleJson:function(h6,h8){var h7=this;if(h6.styleJson){h8&&h8(h6.styleJson)}else{if(h6.styleId){var i=h6.styleId;var e=(Math.random()*100000).toFixed(0);br["_cbk_si_phpui"+e]=function(ia){var h9=[];if(ia.result&&ia.result["error"]===0&&ia.content&&ia.content["status"]===0){h9=h7.parseJson(ia.content["data"]["json"]);h8&&h8(h9)}else{h8&&h8("default")}};br["_cbk_si_api"+e]=function(ia){var h9=[];if(ia.status===0){if(ia.info){h9=h7.parseJson(ia.info["json"])}else{h9=h7.parseJson(ia.data["json"])}h8&&h8(h9)}else{h8&&h8("default")}};var T="";switch(this.environment){case"jsapi":T=e6.apiHost+"/?qt=custom_map&v=3.0&style_id="+i+"&type=publish&ak="+gr;T+="&callback="+eL+"._cbk_si_phpui"+e;break;case"sharing":T+="/apiconsole/custommap/getSharingJson";T+="?styleid="+i+"&type=edit";T+="&ck="+eL+"._cbk_si_api"+e;break;case"preview":T+="/apiconsole/custommap/getJson";T+="?styleid="+i+"&type=edit";T+="&ck="+eL+"._cbk_si_api"+e;break}hB.load(T)}else{h8&&h8("default")}}},parseJson:function(T){if(T===null||T===""){return[]}var i={t:"featureType",e:"elementType",v:"visibility",c:"color",l:"lightness",s:"saturation",w:"weight",z:"level",h:"hue",f:"fontsize",zri:"curZoomRegionId",zr:"curZoomRegion"};var h7={all:"all",g:"geometry","g.f":"geometry.fill","g.s":"geometry.stroke",l:"labels","l.t.f":"labels.text.fill","l.t.s":"labels.text.stroke","l.t":"labels.text","l.i":"labels.icon","g.tf":"geometry.topfill","g.sf":"geometry.sidefill"};var h6=T.split(",");var e=h6.map(function(ib){var ia=ib.split("|").map(function(ii){var ig=i[ii.split(":")[0]];var ie=(h7[ii.split(":")[1]]?h7[ii.split(":")[1]]:ii.split(":")[1]);switch(ie){case"poi":ie="poilabel";break;case"districtlabel":ie="districtlabel";break}var ih={};ih[ig]=ie;return ih});var h8=ia[0];var id=1;if(ia[1]["elementType"]){id=2;D.extend(h8,ia[1])}var ic={};for(var h9=id;h9<ia.length;h9++){D.extend(ic,ia[h9])}return D.extend(h8,{stylers:ic})});return e},getStyleUrl:function(h7,ia,h8,i,e,h6){this.styleJson=h7;var T=fe.apiHost+"/custom/v2/mapstyle?version="+4+"&ak="+ia+"&is_all=true&is_new=1&";var h9=this.styleJson2styleStringV2(h7,i,h6);T+="styles="+encodeURIComponent(h9);if(e&&e.os&&e.sv){T+="&os="+e.os+"&sv="+e.sv}return T},styleJson2styleStringV2:function(e,ie,ia){var ig={featureType:"t",elementType:"e",visibility:"v",color:"c",lightness:"l",saturation:"s",weight:"w",level:"z",hue:"h",fontsize:"f"};var ih={all:"all",geometry:"g","geometry.fill":"g.f","geometry.stroke":"g.s",labels:"l","labels.text.fill":"l.t.f","labels.text.stroke":"l.t.s","labels.text":"l.t","labels.icon":"l.i","geometry.topfill":"g.tf","geometry.sidefill":"g.sf"};var ii=[];for(var h6=this.map.getMinZoom();h6<=this.map.getMaxZoom();h6++){ia.zoomFrontStyle[h6]={}}ia.zoomFrontStyle.main={};var T=false;for(var h6=0;!!e[h6];h6++){var id=e[h6];if(this.isOnlyZoomStyler(id)){continue}ie=this.getFrontZoom(id,ie);if((id.featureType==="land"||id.featureType==="all"||id.featureType==="background")&&typeof id.elementType==="string"&&(id.elementType==="geometry"||id.elementType==="geometry.fill"||id.elementType==="all")&&id.stylers&&!T){if(id.stylers["color"]){ia.bmapLandColor=id.stylers["color"]}if(id.stylers["visibility"]&&id.stylers["visibility"]==="off"){ia.bmapLandColor="#00000000"}if(id.featureType==="land"){T=true}}if(id.featureType==="building"&&typeof id.elementType==="string"&&id.elementType==="geometry.fill"){ia.buildingFill=true}if(id.featureType==="roadarrow"&&id.elementType==="labels.icon"&&id.stylers){var ib=id.stylers["visibility"];ia.zoomFrontStyle[ie]["bmapRoadarrowVisibility"]=ib}var h7={};D.extend(h7,id);var h9=h7.stylers;delete h7.stylers;D.extend(h7,h9);var h8=[];for(var ic in ig){if(h7[ic]){if(this.isEditorZoomKeys(ic)){continue}if(ic==="elementType"){h8.push(ig[ic]+":"+ih[h7[ic]])}else{switch(h7[ic]){case"poilabel":h7[ic]="poi";break;case"districtlabel":h7[ic]="label";break}h8.push(ig[ic]+":"+h7[ic])}}}if(h8.length>2){ii.push(h8.join("|"))}}return ii.join(",")},getFrontZoom:function(i,e){var T=i.stylers["level"];if(T===undefined){return"main"}else{return parseInt(T,10)}},isZoomConfig:function(e){var i=e.stylers["level"];if(i===undefined){return false}else{return true}},isOnlyZoomStyler:function(e){var i={};D.extend(i,e.stylers);delete i.curZoomRegionId;delete i.curZoomRegion;delete i.level;if(D.isEmptyObject(i)){return true}else{return false}},isSelectZoom:function(i,e){var T=i.stylers["level"];if(T===undefined){return true}else{if(T===e+""){return true}else{return false}}},isEditorZoomKeys:function(e){var i={curZoomRegionId:true,curZoomRegion:true};if(i[e]){return true}else{return false}},getZoomRegion:function(e,i){var h6=e.stylers["level"];var T={};D.extend(T,i);if(h6===undefined){return T}else{T[parseInt(h6,10)]=true;return T}},onStyleDataBack:function(h7,e,i,h6,h9,T){if(h7.status!==0){return}if(h7.data.style.length===3){if(!T.baseFs){T.baseFs=h7.data.style}br.StyleBody=h7.data.style[2]}else{br.StyleBody=h7.data.style}var h8=T.baseFs;br["FeatureStyle"+i]=h8;this.updateFrontFeatureStyle(T)},updateFrontFeatureStyle:function(T){if(T.zoomFrontStyle.main["bmapRoadarrowVisibility"]){for(var e=this.map.getMinZoom();e<=this.map.getMaxZoom();e++){if(!T.zoomFrontStyle[e]["bmapRoadarrowVisibility"]){T.zoomFrontStyle[e]["bmapRoadarrowVisibility"]=T.zoomFrontStyle.main["bmapRoadarrowVisibility"]}}}}};var bM={map:null,labelCache:{},calcDrawMc:function(T,i,e){var h6=[];switch(i){case"fill":h6=this.calcFill(T,e);break;case"line":break;case"building3d":h6=this.calcBuilding3d(T,e);break}return h6},calcFill:function(h7,T){var h8=[];for(var h6=0;h6<h7.length;h6=h6+5){var e=this.coordToMc({x:h7[h6],y:h7[h6+1]},T.row,T.col,T.mercatorSize,T.baseTileSize);h8.push(e[0],e[1])}return h8},calcLine:function(h7,T){var h8=[];var h9=new Int16Array(h7.buffer);for(var h6=0;h6<h9.length;h6=h6+10){var e=this.coordToMc({x:h9[h6]/10,y:h9[h6+1]/10},T.row,T.col,T.mercatorSize,T.baseTileSize);h8.push(e[0],e[1])}return h8},calcBuilding3d:function(h8,T){var h9=[];var h6={};for(var h7=0;h7<h8.length/2;h7=h7+7){if(h8[h7]===h8[h7-7]&&h8[h7+1]===h8[h7-6]){continue}if(h6[h8[h7].toString()+h8[h7+1].toString()]){continue}h6[h8[h7].toString()+h8[h7+1].toString()]=true;var e=this.coordToMc({x:h8[h7],y:h8[h7+1]},T.row,T.col,T.mercatorSize,T.baseTileSize);h9.push(e[0],e[1])}return h9},coordToMc:function(h7,h6,e,i,T){return[h7.x*(i/T)+e*i,h7.y*(i/T)+h6*i]},addDrawIntoAreaSpots:function(e,h7){if(f.environment!=="customEditor"){return}if(!h7.styleIds){return}for(var T=0;T<h7.styleIds.length;T++){var ia=0;if(T>0){ia=h7.verticesLength[T-1]}end=h7.verticesLength[T];var h8=[];var h6="";if(h7.vertex){h8=h7.vertex;h6="building3d"}else{if(h7.data[0]){h8=h7.data[0];h6=h7.type}else{continue}}var h9=this.calcDrawMc(h8.slice(ia,end),h6,e);this.map.addAreaSpot(h9,{userData:{styleId:h7.styleIds[T],type:"mapstyle"}})}},addLabelIntoAreaSpots:function(e){if(f.environment!=="customEditor"){return}for(var h7=0;h7<e.length;h7++){var h8=e[h7];for(var h6=0;h6<h8.fixedLabel.length;h6++){var T=h8.fixedLabel[h6];if(!T._mcBds){continue}var h9=[T._mcBds[0].lng,T._mcBds[0].lat,T._mcBds[0].lng,T._mcBds[1].lat,T._mcBds[1].lng,T._mcBds[1].lat,T._mcBds[1].lng,T._mcBds[0].lat];if(!this.labelCache[h9.join()]){this.labelCache[h9.join()]=true;this.map.addAreaSpot(h9,{userData:{styleId:T.styleId,type:"mapstyle",name:T.name}})}}}}};function bU(i,e,h6,T){this.cx=3*i;this.bx=3*(h6-i)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*e;this.by=3*(T-e)-this.cy;this.ay=1-this.cy-this.by;this.p1x=i;this.p1y=T;this.p2x=h6;this.p2y=T}bU.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e};bU.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e};bU.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx};bU.prototype.solveCurveX=function(e,ib){if(typeof ib==="undefined"){ib=0.000001}var ia;var h9;var h7;var T;var h6;for(h7=e,h6=0;h6<8;h6++){T=this.sampleCurveX(h7)-e;if(Math.abs(T)<ib){return h7}var h8=this.sampleCurveDerivativeX(h7);if(Math.abs(h8)<0.000001){break}h7=h7-T/h8}ia=0;h9=1;h7=e;if(h7<ia){return ia}if(h7>h9){return h9}while(ia<h9){T=this.sampleCurveX(h7);if(Math.abs(T-e)<ib){return h7}if(e>T){ia=h7}else{h9=h7}h7=(h9-ia)*0.5+ia}return h7};bU.prototype.solve=function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))};var cq={};function p(T){var e={duration:1000,fps:30,delay:0,transition:cq.linear,dropLastAnimation:false};if(T){for(var h6 in T){e[h6]=T[h6]}}if(T.beginTime){this._beginTime=T.beginTime}this._callbacks=[];this._options=e;if(e.delay){var h7=this;setTimeout(function(){h7._doStart()},e.delay)}else{this._doStart()}this._pauseTime=0}p.INFINITE="INFINITE";p.prototype._doStart=function(){if(this._isPausing){var e=performance.now()||new Date().getTime();this._pauseTime+=e-this._isPausing;this._isPausing=undefined}if(window.requestAnimationFrame){var i=this;i._timer=window.requestAnimationFrame(function(T){i._loop(T)})}else{this._beginTime=new Date().getTime();if(this._options.duration===p.INFINITE){this._endTime=null}else{this._endTime=this._beginTime+this._options.duration}this._loop()}};p.prototype._loop=function(h6){var h9=this;h6=h6||new Date().getTime();h6=h6-this._pauseTime;if(!this._beginTime){this._beginTime=h6}if(!this._endTime&&typeof this._options.duration==="number"){this._endTime=this._beginTime+this._options.duration}if(h9._endTime!==null&&h6>=h9._endTime){if(h9._options.dropLastAnimation===false){h9._options.render(h9._options.transition(1),1,h6)}if(typeof h9._options.finish==="function"){h9._options.finish(h6,this)}for(var h8=0,e=h9._callbacks.length;h8<e;h8++){h9._callbacks[h8]()}return}var h7;if(typeof h9._options.duration==="number"){h7=(h6-h9._beginTime)/h9._options.duration;h9.schedule=h9._options.transition(h7)}else{h7=h6-h9._beginTime;h9.schedule=0}h9._options.render(h9.schedule,h7,h6);if(!h9.terminative){if(window.requestAnimationFrame){h9._timer=requestAnimationFrame(function T(i){h9._loop(i)})}else{h9._timer=setTimeout(function(){h9._loop()},1000/h9._options.fps)}}};p.prototype.stop=function(i,e){this.terminative=true;if(this._timer){if(window.cancelAnimationFrame){cancelAnimationFrame(this._timer)}else{clearTimeout(this._timer)}this._timer=null;if(typeof this._options.onStop==="function"){this._options.onStop(e)}}if(i){this._endTime=this._beginTime;this._loop()}};p.prototype.pause=function(){if(!this._isPausing){this.stop();this.terminative=undefined;this._isPausing=performance.now()||new Date().getTime()}};p.prototype.cancel=function(){this.stop()};p.prototype.append=function(e){this._callbacks.push(e);return this};cq={_p1:1,_p2:1*1.525,linear:function(e){return e},reverse:function(e){return 1-e},easeInQuad:function(e){return e*e},easeInCubic:function(e){return Math.pow(e,3)},easeInBiquad:function(e){return Math.pow(e,4)},easeInBack:function(e){return e*e*((cq._p1+1)*e-cq._p1)},easeOutQuad:function(e){return -(e*(e-2))},easeOutCubic:function(e){return Math.pow((e-1),3)+1},easeOutBiquad:function(e){return 1-Math.pow((e-1),4)},easeOutBack:function(e){return((e=e-1)*e*((cq._p1+1)*e+cq._p1)+1)},easeInOutQuad:function(e){if(e<0.5){return e*e*2}else{return -2*(e-2)*e-1}},easeInOutCubic:function(e){if(e<0.5){return Math.pow(e,3)*4}else{return Math.pow(e-1,3)*4+1}},easeInOutBiquad:function(e){if(e<0.5){return Math.pow(e,4)*8}else{return 1-(Math.pow(e-1,4)*8)}},easeInOutSine:function(e){return(1-Math.cos(Math.PI*e))/2}};cq.ease=(function(){var e=new bU(0.4,0,0.6,1);return function(i){return e.solve(i)}})();cq["ease-in"]=cq.easeInQuad;cq["ease-out"]=cq.easeOutQuad;var fw={start:function(ic){var h6=ic.el;var e=ic.style;var i=ic.startValue;var h9=ic.endValue;var h7=ic.duration||1400;var h8=ic.transition||cq.linear;var ib=ic.callback;var ia=h9-i;var T=ic.unit||"";return new p({fps:60,duration:h7,transition:h8,render:function(id){h6.style[e]=i+ia*id+T},finish:function(){ib&&ib()}})}};function cQ(h7,T){em.call(this);this.keyframes=h7;var e={duration:1000,delay:0,transition:cq.linear,interation:1};if(T){for(var h6 in T){e[h6]=T[h6]}}this._options=e}cQ.inherits(em,"ViewAnimation");cQ.prototype._start=function(h8){var T=this;T.map=h8;var h7=new be("onanimationstart");T.dispatchEvent(h7);this._initStatus(T.map);var h6=this._options.duration;var i=this._options.interation;var h9=this._options.transition;var ia=0;T.poiStatus=T.map._displayOptions.poi;if(T.poiStatus){T.map.setDisplayOptions({poi:false})}T.map.viewAnimationTime=new Date().getTime();this.animation=new p({duration:h6,transition:h9,start:function(e){},render:function(ib,e){if(ib===0){T._initStatus(T.map)}else{T._setViewByRate(ib)}},finish:function(ic,ib){if(++ia<i||i==="INFINITE"){var id=new be("onanimationiterations");T.dispatchEvent(id);delete ib._beginTime;delete ib._endTime;ib._doStart()}else{var id=new be("onanimationend");T.dispatchEvent(id);delete T.map.viewAnimationTime;T.map.setDisplayOptions({poi:T.poiStatus})}}})};cQ.prototype._getTotalDuration=function(e,i){if(e===p.INFINITE){return p.INFINITE}else{return e*i}};cQ.prototype._initStatus=function(e){if(this.keyframes[0]){e.setCenter(this.keyframes[0].center,{noAnimation:true});e.setZoom(this.keyframes[0].zoom,{noAnimation:true});e.setTilt(this.keyframes[0].tilt,{noAnimation:true});e.setHeading(this.keyframes[0].heading,{noAnimation:true})}};cQ.prototype._setViewByRate=function(h6){for(var e=0;e<this.keyframes.length-1;e++){var h7=this.keyframes[e];var T=this.keyframes[e+1];if(h6>=h7.percentage&&h6<T.percentage){this.map.setHeading(this._getHeadingDelta(h7,T,h6),{noAnimation:true});this.map.setTilt(this._getTiltDelta(h7,T,h6),{noAnimation:true});this.map.setCenter(this._getCenterDelta(h7,T,h6),{noAnimation:true});this.map.setZoom(this._getZoomDelta(h7,T,h6),{noAnimation:true})}}};cQ.prototype._getHeadingDelta=function(T,i,e){var h7=(e-T.percentage)/(i.percentage-T.percentage);var h6=T.heading+(i.heading-T.heading)*h7;return h6};cQ.prototype._getTiltDelta=function(T,i,e){var h7=(e-T.percentage)/(i.percentage-T.percentage);var h6=T.tilt+(i.tilt-T.tilt)*h7;return h6};cQ.prototype._getCenterDelta=function(T,i,e){var h7=(e-T.percentage)/(i.percentage-T.percentage);var h6=T.center.add(i.center.sub(T.center).mult(h7));return h6};cQ.prototype._getZoomDelta=function(h6,T,i){var h7=(i-h6.percentage)/(T.percentage-h6.percentage);var e=h6.zoom+(T.zoom-h6.zoom)*h7;return e};cQ.prototype._pause=function(e){this.animation.pause()};cQ.prototype._continue=function(e){this.animation._doStart()};cQ.prototype._cancel=function(T){T.setDisplayOptions({poi:this.poiStatus});this.animation.cancel();delete T.viewAnimationTime;var i=new be("onanimationcancel");this.dispatchEvent(i)};var eF=undefined;var c4={is64Bit:function(){if(/Windows/.test(navigator.userAgent)){if(/Win64; x64/.test(navigator.userAgent)){return true}else{if(/WOW64/.test(navigator.userAgent)){return true}else{return false}}}return true},isIOS112:function cU(e){return/11_2/.test(navigator.userAgent)},canUseWebAssembly:function(i){if(eF!==undefined){i&&i(eF);return}if(window.WebAssembly&&this.is64Bit()){if(window.disableWebAssembly===true){eF=false;i&&i(eF)}else{if(!by()){eF=true;i&&i(eF)}else{if(this.isIOS112()){eF=false;i&&i(eF)}else{var e=new Uint8Array([0,97,115,109,1,0,0,0,1,133,128,128,128,0,1,96,0,1,127,3,130,128,128,128,0,1,0,4,132,128,128,128,0,1,112,0,0,5,131,128,128,128,0,1,0,1,6,129,128,128,128,0,0,7,145,128,128,128,0,2,6,109,101,109,111,114,121,2,0,4,109,97,105,110,0,0,10,138,128,128,128,0,1,132,128,128,128,0,0,65,42,11]);WebAssembly.instantiate(e).then(function(T){eF=true;i&&i(eF)},function(T){eF=false;i&&i(eF)})}}}}else{eF=false;i&&i(eF)}}};var dB={};br.Utils=dB;function di(e){return e.style}function ds(i){if(D.Browser.ie>0){i.unselectable="on";i.selectstart=function(){return false};i.onmousedown=function(T){T.preventDefault();return false}}else{var e=di(i);e.MozUserSelect="none";e.WebkitUserSelect="none";i.addEventListener("mousedown",function(T){T.preventDefault()},false)}}function hs(e){return e&&e.parentNode&&e.parentNode.nodeType!==11}function dO(i,e){i.insertAdjacentHTML("beforeEnd",e);return i.lastChild}function hQ(T,i){var h6=document.createElement("div");h6.innerHTML=i;var e=h6.childNodes[0];return T.parentNode.insertBefore(e,T)}function h(i){i=i||window.event;i.stopPropagation?i.stopPropagation():i.cancelBubble=true}function bX(i){i=i||window.event;i.preventDefault?i.preventDefault():i.returnValue=false;return false}function dg(i){h(i);return bX(i)}function fV(){var e=document.documentElement;var i=document.body;if(e&&(e.scrollTop||e.scrollLeft)){return[e.scrollTop,e.scrollLeft]}else{if(i){return[i.scrollTop,i.scrollLeft]}else{return[0,0]}}}function fC(h7){if(!h7){return}h7.onload=h7.onerror=null;var T=h7.attributes,h6,e,h8;if(T){e=T.length;for(h6=0;h6<e;h6+=1){h8=T[h6].name;if(typeof h7[h8]==="function"){h7[h8]=null}}}T=h7.children;if(T){e=T.length;for(h6=0;h6<e;h6+=1){fC(h7.children[h6])}}}function bJ(i,h9,h8){var h7=h9.lng-h8.lng;var h6=h9.lat-h8.lat;if(h7===0){return Math.abs(i.lng-h9.lng)}if(h6===0){return Math.abs(i.lat-h9.lat)}var T=h6/h7;var e=h9.lat-T*h9.lng;return Math.abs(T*i.lng-i.lat+e)/Math.sqrt(T*T+1)}function ha(i,e){if(!i||!e){return}return Math.round(Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2)))}function bS(i,e){if(!i||!e){return 0}return Math.round(Math.sqrt(Math.pow(i.lng-e.lng,2)+Math.pow(i.lat-e.lat,2)))}function c5(T,i){var e=Math.round((T.x+i.x)/2);var h6=Math.round((T.y+i.y)/2);return new es(e,h6)}function hy(e,T){var i=[];T=T||function(h7){return h7};for(var h6 in e){i.push(h6+"="+T(e[h6]))}return i.join("&")}function U(T,i,h8){var h9=document.createElement(T);if(h8){h9=document.createElementNS(h8,T)}i=i||{};for(var h6 in i){var h7={"for":"htmlFor","class":"cssClass"}[h6]||h6;if(h6==="style"){h9.style.cssText=i[h6];continue}if(h6==="class"){D.ac(h9,i[h6]);continue}if(h9.setAttribute){h9.setAttribute(h7,i[h6])}else{try{h9[h7]=i[h6]}catch(h9){}}}return h9}function gb(e){if(e.currentStyle){return e.currentStyle}else{if(e.ownerDocument&&e.ownerDocument.defaultView){return e.ownerDocument.defaultView.getComputedStyle(e,null)}}}function bY(e){return typeof e==="function"}function Y(e){return e===void 0}function gY(e,i){return Object.prototype.hasOwnProperty.call(e,i)}function cC(h7,h8){if(Y(h7.length)){for(var h6 in h7){if(gY(h7,h6)){h8.call(null,h6,h7[h6])}}}else{var T=h7.length;if(T){for(var e=0;e<T;e++){h8.call(null,e,h7[e])}}}}function dc(i,e){if(!e){return i}cC(e,function(T,h6){i[T]=h6});return i}var hD="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function hf(h7){var T="";var ie;var ic;var ia="";var id;var ib;var h9;var h8="";var h6=0;var e=/[^A-Za-z0-9+/=]/g;if(!h7||e.exec(h7)){return h7}h7=h7.replace(/[^A-Za-z0-9+/=]/g,"");do{id=hD.indexOf(h7.charAt(h6++));ib=hD.indexOf(h7.charAt(h6++));h9=hD.indexOf(h7.charAt(h6++));h8=hD.indexOf(h7.charAt(h6++));ie=(id<<2)|(ib>>4);ic=((ib&15)<<4)|(h9>>2);ia=((h9&3)<<6)|h8;T=T+String.fromCharCode(ie);if(h9!==64){T=T+String.fromCharCode(ic)}if(h8!==64){T=T+String.fromCharCode(ia)}ie=ic=ia="";id=ib=h9=h8=""}while(h6<h7.length);return T}function l(e){return btoa(encodeURIComponent(e))}function fX(e){return decodeURIComponent(atob(e))}(function(e){if(!e.Utils){e.Utils={}}var i=e.Utils;i.format=(function(){function T(h9,h8,ia){var h7=ia[+h8];return typeof(h7)==="function"?h7(h8):h7}function h6(h9,h8,ia){var ic=h8;var id=[];var h7=h8.split(":");if(h7.length===2){ic=h7[0];id.push(h7[1])}var ib=typeof(ia[ic]);if(ib==="function"){return ia[ic].apply(undefined,id)}else{if(ib==="undefined"){return h9}else{return String(ia[ic])}}}return function(h7,h8){var ia=h8.splice?T:h6;var h9=h7.splice?h7.join(""):h7;return h9.replace(/{([a-zA-Z0-9_$:.]+)}/g,function(ic,ib){return ia(ic,ib,h8)})}})();i.ErrorMonitor=function(h6,T,h7){};c4.canUseWebAssembly(function(T){i.canUseWebAssembly=T})})(br);function gi(){return(by()||eM())}function by(){var e=navigator.userAgent;if(e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1){return true}return false}function eM(){var e=navigator.userAgent;if(e.indexOf("Android")>-1){return true}return false}function dQ(e){return e*Math.PI/180}function dj(e){return e/Math.PI*180}function dU(e,h7){var h6=Math.pow(10,h7);if(typeof e==="number"){return Math.round(e*h6)/h6}for(var T=0;T<e.length;T++){e[T]=dU(e[T],h7)}return e}function fR(T,i,e){if(T<i){T=i}else{if(T>e){T=e}}return T}function gc(e,i){while(e<0){e+=i}return e%i}function eh(i,e){return(i>=0&&e>=0)||(i<0&&e<0)}function a8(i){if(i._gl){return i._gl}var e={alpha:true,antialias:false,failIfMajorPerformanceCaveat:false,preserveDrawingBuffer:false,stencil:false};var T=i.getContext("webgl",e)||i.getContext("experimental-webgl",e);i._gl=T;return T}function eV(h6,T){for(var e=0;e<T.length;e++){D.on(h6,T[e],h)}}function h5(i,T,e){T[e]=i.getUniformLocation(T,e)}function fc(h7,h8,e,T,i){var h6="";switch(i){case"mat4":h7.uniformMatrix4fv(h8[e],false,T);return;case"v3":h6="uniform3fv";break;case"f":h6="uniform1f";break;case"i":h6="uniform1i";break}if(h6===""){throw"error"}h7[h6](h8[e],T)}function L(ie,e){while(ie<0){ie+=360}ie=ie%360;var h6=e.width;var id=e.height;var h9=h6;var T=id;if(ie<90){var i=Math.sin(dQ(ie))*h6;var ib=Math.sin(dQ(ie))*id;var ic=Math.cos(dQ(ie))*h6;var h8=Math.cos(dQ(ie))*id;var h9=Math.ceil(ic+ib);var T=Math.ceil(i+h8)}else{if(ie<180){var ie=ie-90;var i=Math.sin(dQ(ie))*h6;var ib=Math.sin(dQ(ie))*id;var ic=Math.cos(dQ(ie))*h6;var h8=Math.cos(dQ(ie))*id;var h9=Math.ceil(i+h8);var T=Math.ceil(ic+ib)}else{if(ie<270){var ie=ie-180;var i=Math.sin(dQ(ie))*h6;var ib=Math.sin(dQ(ie))*id;var ic=Math.cos(dQ(ie))*h6;var h8=Math.cos(dQ(ie))*id;var h9=Math.ceil(ic+ib);var T=Math.ceil(i+h8)}else{var ie=ie-270;var i=Math.sin(dQ(ie))*h6;var ib=Math.sin(dQ(ie))*id;var ic=Math.cos(dQ(ie))*h6;var h8=Math.cos(dQ(ie))*id;var h9=Math.ceil(i+h8);var T=Math.ceil(ic+ib)}}}var ia=h9-h6;var h7=T-id;return[0-ia/2,0-h7/2,h6+ia/2,id+h7/2]}function gS(e){if(e.toDataURL()===gS._blankData){return true}return false}function gI(h7,h6,T){var i=[T.lng-h7.lng,T.lat-h7.lat];var e=[h6.lng-h7.lng,h6.lat-h7.lat];return i[0]*e[1]-i[1]*e[0]}function ck(h8,h7,T){var e;var h9;var h6;var i;if(h8.lng<h7.lng){e=h8.lng;h6=h7.lng}else{e=h7.lng;h6=h8.lng}if(h8.lat<h7.lat){h9=h8.lat;i=h7.lat}else{h9=h7.lat;i=h8.lat}if(T.lng<e||T.lng>h6||T.lat<h9||T.lat>i){return false}return true}function gK(ia,h9,h8,h6){var h7=gI(h8,h6,ia);var T=gI(h8,h6,h9);var i=gI(ia,h9,h8);var e=gI(ia,h9,h6);if(h7*T<0&&i*e<0){return true}else{if(h7===0&&ck(h8,h6,ia)){return true}else{if(T===0&&ck(h8,h6,h9)){return true}else{if(i===0&&ck(ia,h9,h8)){return true}else{if(e===0&&ck(ia,h9,h6)){return true}else{return false}}}}}}function hO(T,i){var e=i.parentNode;if(e.lastChild===i){e.appendChild(T)}else{e.insertBefore(T,i.nextSibling)}}function hU(ic,id){if(id===0){return ic}var ib=0;var h9=0;if(!ic){throw"异常"}if(ic.length===0){return[]}for(var h7=1,T=ic.length-1;h7<T;h7++){var ia=bJ(ic[h7],ic[0],ic[ic.length-1]);if(ia>ib){h9=h7;ib=ia}}var e=[];if(ib>=id){var ig=ic.slice(0,h9);var ie=ic.slice(h9,ic.length);var h8=hU(ig,id);var h6=hU(ie,id);for(var h7=0,T=h8.length;h7<T;h7++){e.push(h8[h7])}for(var h7=0,T=h6.length;h7<T;h7++){e.push(h6[h7])}}else{e.push(ic[0]);e.push(ic[ic.length-1])}return e}function eN(e){if(Math.log2){return Math.log2(e)}return Math.log(e)/Math.LN2}function bu(T,i,e){return Math.min(e,Math.max(i,T))}function cN(e,i){if(!i){return e}var h8=i[0];var h7=i[1];var h6=i[2];var T=i[3];var ia=[];var h9=[];ia[0]=T*e[0]+h6*e[2];ia[1]=e[1];ia[2]=-h6*e[0]+T*e[2];h9[0]=ia[0];h9[1]=h7*ia[1]-h8*ia[2];h9[2]=h8*ia[1]+h7*ia[2];return h9}var aS=Math.PI/180;var F=180/Math.PI;function bC(T){var i=(T-Date.UTC(2000,0,1,12))/86400000/36525;var e=(d3.utcDay.floor(T)-T)/86400000*360-180;return[e-V(i)*F,gP(i)*F]}function V(h6){var h7=gk(h6);var i=dR(h6);var T=al(h6);var h8=Math.tan(gf(h6)/2);h8*=h8;return h8*Math.sin(2*T)-2*h7*Math.sin(i)+4*h7*h8*Math.sin(i)*Math.cos(2*T)-0.5*h8*h8*Math.sin(4*T)-1.25*h7*h7*Math.sin(2*i)}function gP(e){return Math.asin(Math.sin(gf(e))*Math.sin(hd(e)))}function hd(e){return bk(e)-(0.00569+0.00478*Math.sin((125.04-1934.136*e)*aS))*aS}function bk(e){return al(e)+dX(e)}function dR(e){return(357.52911+e*(35999.05029-0.0001537*e))*aS}function al(i){var e=(280.46646+i*(36000.76983+i*0.0003032))%360;return(e<0?e+360:e)/180*Math.PI}function dX(i){var e=dR(i);return(Math.sin(e)*(1.914602-i*(0.004817+0.000014*i))+Math.sin(e+e)*(0.019993-0.000101*i)+Math.sin(e+e+e)*0.000289)*aS}function gf(e){return fo(e)+0.00256*Math.cos((125.04-1934.136*e)*aS)*aS}function fo(e){return(23+(26+(21.448-e*(46.815+e*(0.00059-e*0.001813)))/60)/60)*aS}function gk(e){return 0.016708634-e*(0.000042037+1.267e-7*e)}function a9(){return window.devicePixelRatio||1}function aI(T){var i;var e;var h6;if(T>=0){h6=Math.floor(T/65536)*65536;i=h6;e=T-h6}else{h6=Math.floor(-T/65536)*65536;i=-h6;e=T+h6}return[i,e]}function H(e){if(e.lng>=0&&e.lat>=0){return new hH(e.lng-10000000,e.lat-6000000)}if(e.lng>=0&&e.lat<0){return new hH(e.lng-10000000,e.lat+6000000)}if(e.lng<0&&e.lat>=0){return new hH(e.lng+10000000,e.lat-6000000)}if(e.lng<0&&e.lat<0){return new hH(e.lng+10000000,e.lat+6000000)}}var fN=null;if(window.performance&&window.performance.now){fN=function(){return performance.now()}}else{if(Date.now){fN=function(){return Date.now()}}else{fN=function(){return(new Date).getTime()}}}function bO(h6,e,i){var T="mouseWheel";if(D.Platform.macintosh){if(!isNaN(h6)&&(h6<10||h6!==120)&&(e%1===0&&e<5)){T="padScroll"}if(D.Browser.firefox&&(e%1===0&&e<5&&i===0)){T="padScroll"}}if(D.Browser.safari&&h6===12){T="mouseWheel"}return T}function dl(ig,ia){var ie=ig[0];var id=ig[1];var h6=false;for(var h9=0,h8=ia.length-2;h9<ia.length;h9+=2){var ic=ia[h9];var h7=ia[h9+1];var ib=ia[h8];var T=ia[h8+1];var e=((h7>id)!==(T>id))&&(ie<(ib-ic)*(id-h7)/(T-h7)+ic);if(e){h6=!h6}h8=h9}return h6}function cI(T,e,i,h6){h6=h6||0.4;if(T>i){T=Math.pow(T-i+1,h6)+i-1}else{if(T<e){T=e-Math.pow(e-T+1,h6)+1}}return T}function gy(ia){var h8="";for(var T=0;T<ia.length;T++){var ib=ia.charCodeAt(T)<<1;var e=ib.toString(2);var h7=e.length;var ie=e;if(h7<8){ie="00000000"+e;ie=ie.substr(e.length,8)}h8+=ie}var ic=5-h8.length%5;var h6=[];for(var T=0;T<ic;T++){h6[T]="0"}h8=h6.join("")+h8;var id=[];for(var T=0;T<h8.length/5;T++){var ib=h8.substr(T*5,5);var h9=parseInt(ib,2)+50;id.push(String.fromCharCode(h9))}return id.join("")+ic.toString()}function aG(T,i){var e=br.TILE_VERSION||window.TILE_VERSION;if(!e||!e[T]||!e[T][i]||!e[T][i].version||!e[T][i].updateDate){e=fe.tvc}return{ver:e[T][i].version,udt:e[T][i].updateDate}}function fL(){var e=br.MSV||window.MSV;if(!e||!e.mapstyle||!e.mapstyle.updateDate||!e.mapstyle.version){e=fe.msv}return{ver:e.mapstyle.version,udt:e.mapstyle.updateDate}}function eA(e,h7){var h6=e.slice(0);for(var T=0;T<h6.length;T++){h6[T]+=h7}return h6}var a7=null;function bB(e){if(a7){return}e.fire(new be("onloadtile"));a7=setTimeout(function(){a7=null},1000)}function fb(){if(cu("//map.baidu.com")||cu("//maps.baidu.com")||cu("//ditu.baidu.com")){return true}return false}dB.inMapHost=fb();if(typeof window._inMapHost==="boolean"){dB.inMapHost=window._inMapHost}function cu(i){var T=window.location;var e=document.createElement("a");e.href=i;return e.hostname===T.hostname&&e.port===T.port&&e.protocol===T.protocol}function ej(){}D.extend(ej,{Request:{INITIAL:-1,WAITING:0,LOADED:1,COMPLETED:2},Dependency:{poly:["marker"],hotspot:["poly"],infowindow:["marker","hotspot"],simpleInfowindow:["marker"],tools:["marker","poly"],mapgl:["glcommon","poly"],earth:["glcommon"],control:["scommon"],scommon:[],localSearch:["scommon"],otherSearch:["scommon"],route:["scommon"],buslineSearch:["route"],autocomplete:["scommon"]},MD5Mapping:{control:"u3taa5",marker:"yw3yro",poly:"blxtjs",infowindow:"kw25uf",simpleInfowindow:"l0phru",hotspot:"qzda3n",menu:"fa5dai",tools:"udzpu4",oppc:"oi11we",oppcgl:"crayln",mapgl:"ekpdzb",markeranimation:"pwwwha",earth:"r4tupe",glcommon:"givkh5",localSearch:"clge5y",scommon:"c2lx4l",otherSearch:"4dkees",route:"c0fapc",buslineSearch:"fmu2b5",autocomplete:"zrvia3"},Config:{baseUrl:fe.apiHost+"/getmodules?v=1.0&type=webgl",jsModPath:(dB.inMapHost?"":fe.mapHost)+"/res/newui/",timeout:5000},delayFlag:false,Module:{modules:{},modulesNeedToLoad:[]},_getMd5ModsStr:function(h8){var h7=[];for(var ia=0,T=h8.length;ia<T;ia++){var h9=h8[ia];var e=this.MD5Mapping[h9];var h6="$"+h9+"$";if(e!==h6){h7.push(h9+"_"+e)}}return h7.join(",")},load:function(i,h8,h6){var e=this.getModuleInfo(i);if(e.status===this.Request.COMPLETED){if(h6===true){h8()}}else{if(e.status===this.Request.INITIAL){this.combine(i);this.addToLoadQueue(i);var T=this;if(T.delayFlag===false){T.delayFlag=true;setTimeout(function(){var h9=T.Config.baseUrl+"&mod="+T._getMd5ModsStr(T.Module.modulesNeedToLoad);hB.load(h9);T.Module.modulesNeedToLoad.length=0;T.delayFlag=false},1)}e.status=this.Request.WAITING;function h7(ib){var ia=T.getModuleInfo(i);if(ia.status!==T.Request.COMPLETED){if(window.map){var h9=new be("onmod_timeout");h9.timeout=ib/1000;h9.moduleName=i;window.map.fire(h9)}}}setTimeout(h7,this.Config.timeout,this.Config.timeout);setTimeout(h7,this.Config.timeout*2,this.Config.timeout*2)}if(h8){e.callbacks.push(h8)}}},combine:function(e){if(e&&this.Dependency[e]){var h6=this.Dependency[e];for(var T=0;T<h6.length;T++){this.combine(h6[T]);if(!this.Module.modules[h6[T]]){this.addToLoadQueue(h6[T])}}}},addToLoadQueue:function(e){var i=this.getModuleInfo(e);if(i.status===this.Request.INITIAL){i.status=this.Request.WAITING;this.Module.modulesNeedToLoad.push(e)}},run:function(T,h6){var ia=this.getModuleInfo(T);var id=this.Dependency[T];if(id){for(var h8=0;h8<id.length;h8++){var h9=this.getModuleInfo(id[h8]);if(h9.status!==this.Request.COMPLETED){h9.modsNeedToRun.push({name:T,code:h6});return}}}try{eval(h6)}catch(ib){return}ia.status=this.Request.COMPLETED;for(var h8=0,h7=ia.callbacks.length;h8<h7;h8++){ia.callbacks[h8]()}ia.callbacks.length=0;for(h8=0;h8<ia.modsNeedToRun.length;h8++){var ic=ia.modsNeedToRun[h8];this.run(ic.name,ic.code)}ia.modsNeedToRun.length=0},getModuleInfo:function(i){var e;if(!this.Module.modules[i]){this.Module.modules[i]={status:this.Request.INITIAL,callbacks:[],modsNeedToRun:[]}}e=this.Module.modules[i];return e}});window._jsload=function(h7,h8){var i=ej.getModuleInfo(h7);i.status=ej.Request.LOADED;if(h8!==""){ej.run(h7,h8)}else{if(window.map){var e=new be("ongetmodules_fail");e.moduleName=h7;window.map.fire(e)}var T=document.createElement("script");var h6=ej.MD5Mapping[h7];T.src=ej.Config.jsModPath+h7+"_"+h6+".js";document.getElementsByTagName("head")[0].appendChild(T)}};function ae(){this._timeData={}}var fk;if(typeof window!=="undefined"){fk=window}else{fk=self}ae.prototype.mark=function(e){this._timeData[e]=this._getTime()};ae.prototype.getMark=function(e){return this._timeData[e]};ae.prototype.getTime=function(i,e){return parseFloat((this._timeData[e]-this._timeData[i]).toFixed(2))};ae.prototype.print=function(){};ae.prototype.clear=function(){this._timeData={}};if(fk.performance&&fk.performance.now){ae.prototype._getTime=function(){return performance.now()}}else{ae.prototype._getTime=function(){return Date.now()}}!function(i,T){T(i.d3=i.d3||{})}(window,function(iN){function i5(jb,jc,T,it){function e(i){return jb(i=new Date(+i)),i}return e.floor=e,e.ceil=function(i){return jb(i=new Date(i-1)),jc(i,1),jb(i),i},e.round=function(i){var jd=e(i),je=e.ceil(i);return je-i>i-jd?jd:je},e.offset=function(i,jd){return jc(i=new Date(+i),null==jd?1:Math.floor(jd)),i},e.range=function(je,i,jd){var jf=[];if(je=e.ceil(je),jd=null==jd?1:Math.floor(jd),!(i>je&&jd>0)){return jf}do{jf.push(new Date(+je))}while(jc(je,jd),jb(je),i>je);return jf},e.filter=function(i){return i5(function(jd){for(;jb(jd),!i(jd);){jd.setTime(jd-1)}},function(jd,je){for(;--je>=0;){for(;jc(jd,1),!i(jd);){}}})},T&&(e.count=function(i,jd){return iP.setTime(+i),iT.setTime(+jd),jb(iP),jb(iT),Math.floor(T(iP,iT))},e.every=function(i){return i=Math.floor(i),isFinite(i)&&i>0?i>1?e.filter(it?function(jd){return it(jd)%i===0}:function(jd){return e.count(0,jd)%i===0}):e:null}),e}function iU(e){return i5(function(i){i.setDate(i.getDate()-(i.getDay()+7-e)%7),i.setHours(0,0,0,0)},function(i,T){i.setDate(i.getDate()+7*T)},function(i,T){return(T-i-(T.getTimezoneOffset()-i.getTimezoneOffset())*iO)/i2})}function iM(e){return i5(function(i){i.setUTCDate(i.getUTCDate()-(i.getUTCDay()+7-e)%7),i.setUTCHours(0,0,0,0)},function(i,T){i.setUTCDate(i.getUTCDate()+7*T)},function(i,T){return(T-i)/i2})}var iP=new Date,iT=new Date,i0=i5(function(){},function(i,T){i.setTime(+i+T)},function(i,T){return T-i});i0.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i5(function(i){i.setTime(Math.floor(i/e)*e)},function(i,T){i.setTime(+i+T*e)},function(i,T){return(T-i)/e}):i0:null};var i9=i0.range,i7=1000,iO=60000,i4=3600000,iW=86400000,i2=604800000,ic=i5(function(e){e.setTime(Math.floor(e/i7)*i7)},function(i,T){i.setTime(+i+T*i7)},function(i,T){return(T-i)/i7},function(e){return e.getUTCSeconds()}),i6=ic.range,iV=i5(function(e){e.setTime(Math.floor(e/iO)*iO)},function(i,T){i.setTime(+i+T*iO)},function(i,T){return(T-i)/iO},function(e){return e.getMinutes()}),il=iV.range,iI=i5(function(i){var T=i.getTimezoneOffset()*iO%i4;0>T&&(T+=i4),i.setTime(Math.floor((+i-T)/i4)*i4+T)},function(i,T){i.setTime(+i+T*i4)},function(i,T){return(T-i)/i4},function(e){return e.getHours()}),i1=iI.range,iy=i5(function(e){e.setHours(0,0,0,0)},function(i,T){i.setDate(i.getDate()+T)},function(i,T){return(T-i-(T.getTimezoneOffset()-i.getTimezoneOffset())*iO)/iW},function(e){return e.getDate()-1}),ib=iy.range,iv=iU(0),ix=iU(1),h7=iU(2),ir=iU(3),ie=iU(4),iL=iU(5),iS=iU(6),h9=iv.range,iK=ix.range,ij=h7.range,iH=ir.range,iX=ie.range,iJ=iL.range,i8=iS.range,iZ=i5(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(i,T){i.setMonth(i.getMonth()+T)},function(i,T){return T.getMonth()-i.getMonth()+12*(T.getFullYear()-i.getFullYear())},function(e){return e.getMonth()}),ja=iZ.range,iq=i5(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(i,T){i.setFullYear(i.getFullYear()+T)},function(i,T){return T.getFullYear()-i.getFullYear()},function(e){return e.getFullYear()});iq.every=function(e){return isFinite(e=Math.floor(e))&&e>0?i5(function(i){i.setFullYear(Math.floor(i.getFullYear()/e)*e),i.setMonth(0,1),i.setHours(0,0,0,0)},function(i,T){i.setFullYear(i.getFullYear()+T*e)}):null};var ii=iq.range,iQ=i5(function(e){e.setUTCSeconds(0,0)},function(i,T){i.setTime(+i+T*iO)},function(i,T){return(T-i)/iO},function(e){return e.getUTCMinutes()}),iA=iQ.range,iz=i5(function(e){e.setUTCMinutes(0,0,0)},function(i,T){i.setTime(+i+T*i4)},function(i,T){return(T-i)/i4},function(e){return e.getUTCHours()}),iw=iz.range,iu=i5(function(e){e.setUTCHours(0,0,0,0)},function(i,T){i.setUTCDate(i.getUTCDate()+T)},function(i,T){return(T-i)/iW},function(e){return e.getUTCDate()-1}),ip=iu.range,io=iM(0),im=iM(1),ik=iM(2),ih=iM(3),ig=iM(4),ia=iM(5),h8=iM(6),h6=io.range,iG=im.range,i3=ik.range,iR=ih.range,iY=ig.range,iF=ia.range,iE=h8.range,iD=i5(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(i,T){i.setUTCMonth(i.getUTCMonth()+T)},function(i,T){return T.getUTCMonth()-i.getUTCMonth()+12*(T.getUTCFullYear()-i.getUTCFullYear())},function(e){return e.getUTCMonth()}),iC=iD.range,id=i5(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(i,T){i.setUTCFullYear(i.getUTCFullYear()+T)},function(i,T){return T.getUTCFullYear()-i.getUTCFullYear()},function(e){return e.getUTCFullYear()});id.every=function(e){return isFinite(e=Math.floor(e))&&e>0?i5(function(i){i.setUTCFullYear(Math.floor(i.getUTCFullYear()/e)*e),i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)},function(i,T){i.setUTCFullYear(i.getUTCFullYear()+T*e)}):null};var iB=id.range;iN.timeInterval=i5,iN.timeMillisecond=i0,iN.timeMilliseconds=i9,iN.utcMillisecond=i0,iN.utcMilliseconds=i9,iN.timeSecond=ic,iN.timeSeconds=i6,iN.utcSecond=ic,iN.utcSeconds=i6,iN.timeMinute=iV,iN.timeMinutes=il,iN.timeHour=iI,iN.timeHours=i1,iN.timeDay=iy,iN.timeDays=ib,iN.timeWeek=iv,iN.timeWeeks=h9,iN.timeSunday=iv,iN.timeSundays=h9,iN.timeMonday=ix,iN.timeMondays=iK,iN.timeTuesday=h7,iN.timeTuesdays=ij,iN.timeWednesday=ir,iN.timeWednesdays=iH,iN.timeThursday=ie,iN.timeThursdays=iX,iN.timeFriday=iL,iN.timeFridays=iJ,iN.timeSaturday=iS,iN.timeSaturdays=i8,iN.timeMonth=iZ,iN.timeMonths=ja,iN.timeYear=iq,iN.timeYears=ii,iN.utcMinute=iQ,iN.utcMinutes=iA,iN.utcHour=iz,iN.utcHours=iw,iN.utcDay=iu,iN.utcDays=ip,iN.utcWeek=io,iN.utcWeeks=h6,iN.utcSunday=io,iN.utcSundays=h6,iN.utcMonday=im,iN.utcMondays=iG,iN.utcTuesday=ik,iN.utcTuesdays=i3,iN.utcWednesday=ih,iN.utcWednesdays=iR,iN.utcThursday=ig,iN.utcThursdays=iY,iN.utcFriday=ia,iN.utcFridays=iF,iN.utcSaturday=h8,iN.utcSaturdays=iE,iN.utcMonth=iD,iN.utcMonths=iC,iN.utcYear=id,iN.utcYears=iB,Object.defineProperty(iN,"__esModule",{value:!0})});function gA(e){this._elemType=e;this._objCollection={}}gA.prototype.get=function(){var i=null;for(var e in this._objCollection){if(this._objCollection[e]&&this._objCollection[e]._free===true){this._objCollection[e]._free=false;return this._objCollection[e]}}i=U(this._elemType);e=br.getGUID("obj_pool_");this._objCollection[e]=i;return i};gA.prototype.free=function(e){if(!e){return}e._free=true;if(e.tagName.toLowerCase()==="img"){e.src="";e.crossOrigin=null;e.onload=e.onerror=null}};gA.prototype.clear=function(){for(var e in this._objCollection){if(this._objCollection[e]&&this._objCollection[e].tagName.toLowerCase==="img"){this._objCollection[e].onload=this._objCollection[e].onerror=null}}this._objCollection={}};var gN={get:function(i,h7,e,T){var h6=new XMLHttpRequest();h6.open("GET",i,true);h6.timeout=10000;h6.ontimeout=function(){T&&T()};h6.onreadystatechange=function(h8){if(this.readyState===4){if(this.status===200){h7&&h7(h6.responseText)}else{e&&e()}}};h6.send()},post:function(i,h8,h7,e,T){var h6=new XMLHttpRequest();h6.open("POST",i,true);h6.setRequestHeader("Content-type","application/x-www-form-urlencoded");h6.timeout=10000;h6.ontimeout=function(){T&&T()};h6.onreadystatechange=function(h9){if(this.readyState===4){if(this.status===200){h7&&h7(h6.responseText,h8)}else{e&&e()}}};h6.send(h8);return h6}};var hB=(function(e){function i(h8,T,h7){var h6=U("script",{src:h8,type:"text/javascript",charset:"utf-8"});if(h6.addEventListener){h6.addEventListener("load",function(ia){var h9=ia.target;h9.parentNode.removeChild(h9);T&&T()},false);h6.addEventListener("error",function(ia){if(ia){var h9=ia.target;h9&&h9.parentNode&&h9.parentNode.removeChild(h9)}h7&&h7(null)},false)}else{if(h6.attachEvent){h6.attachEvent("onreadystatechange",function(ia){var h9=window.event.srcElement;if(h9&&(h9.readyState==="loaded"||h9.readyState==="complete")){h9.parentNode.removeChild(h9)}T&&T()})}}e.getElementsByTagName("head")[0].appendChild(h6)}return{load:function(h9,T,h6){if(typeof h9==="string"){i(h9,T,h6)}else{if(h9.length>0){var h8=h9.length;for(var h7=0;h7<h8;h7++){i(h9[h7],function(){h8--;if(h8===0&&T){T()}})}}}}}})(window.document);function cP(){}cP.instances={};cP.getInstance=function(i,T){if(cP.instances[i]){return cP.instances[i]}var e=new dn(i,T);cP.instances[i]=e;return e};function dn(e,i){this._name=e;this._baseZoom=18;this._opts={tileSize:256};D.extend(this._opts,i||{})}dn.mapZoomBaseIndex=[8,8,8,8,7,7,6,6,5,5,4,3,3,3,2,2,1,1,0,0,0,0,0,0,0,0];dn.baseScaleZoom=[19,17,15,12,10,9,7,5,3];dn.baseScaleZoomMercatorSize=[512,2048,4096,32768,65536,262144,1048576,4194304,8388608];dn.mapZoomBaseZoomMapping=[3,3,3,3,5,5,7,7,9,9,10,12,12,12,15,15,17,17,19,19,19,19,19,19,19,19];dn.mapZoomStartZoomMapping=[3,3,3,3,4,4,6,6,8,8,10,11,11,11,14,14,16,16,18,18,18,18,18,18,18,18];dn.baseScaleTileSize=[1024,1024,512,512,256,512,512,512,256];dn.mapZoomTileSize=[256,256,256,256,256,512,256,512,256,512,256,256,512,1024,256,512,512,1024,512,1024,2048,4096,4096*2,4096*2*2,4096*2*2*2,4096*2*2*2*2];dn.baseZoomInfo={"3":[3],"5":[4,5],"7":[6,7],"9":[8,9],"10":[10],"12":[11,12,13],"15":[14,15],"17":[16,17],"19":[18,19,20,21,22,23,24,25]};dn.prototype={getName:function(){return this._name},getTileSize:function(e){e=Math.floor(e);if(e<3){e=3}if(this._name==="na"){return dn.mapZoomTileSize[e]}return this._opts.tileSize},getBaseTileSize:function(i){i=Math.floor(i);if(this._name==="na"){var e=dn.mapZoomBaseZoomMapping[i];return dn.mapZoomTileSize[e]}return this._opts.tileSize},getDataZoom:function(e){e=Math.floor(e);if(this._name==="na"){return dn.mapZoomBaseZoomMapping[e]}return e},getZoomUnits:function(e){return Math.pow(2,(this._baseZoom-e))},getMercatorSize:function(T,i){if(this._name==="na"){T=Math.floor(T);var e=dn.mapZoomBaseIndex[T];return dn.baseScaleZoomMercatorSize[e]}return this._opts.tileSize*this.getZoomUnits(i)},getBaseZoom:function(){return this._baseZoom},getParentTile:function(h6,ic,ib,T,i){if(this._name==="na"){var h7=dn.baseZoomInfo[ib];T--;if(h7.indexOf(T)>-1){return{col:h6,row:ic,zoom:ib,useZoom:T}}else{var h9=dn.mapZoomBaseIndex[ib];var h8=dn.baseScaleZoom[h9+1];if(!h8){return null}var ia=this.getFactorByZooms(h8,ib);var e=dn.baseZoomInfo[h8];return{col:Math.floor(h6/ia),row:Math.floor(ic/ia),zoom:h8,useZoom:e[e.length-1]}}return null}if(ib-1<i){return null}return{col:Math.floor(h6/2),row:Math.floor(ic/2),zoom:ib-1,useZoom:ib-1}},getChildTiles:function(h7,h9,e,T,ih,io){if(this._name==="na"){var h6=dn.baseZoomInfo[e];T+=io;if(h6.indexOf(T)>-1){return[{col:h7,row:h9,zoom:e,useZoom:T}]}else{var il=0;var ii=e;while(il<io){var im=dn.mapZoomBaseIndex[ii];var ib=dn.baseScaleZoom[im-1];if(!ib){return null}var ic=dn.baseZoomInfo[ib];if(ic[io-1]){var id=[];var ig=this.getFactorByZooms(e,ib);var i=h7*ig;var ie=h9*ig;for(var ik=0;ik<ig;ik++){var h8=i+ik;for(var ij=0;ij<ig;ij++){var ia=ie+ij;id.push({col:h8,row:ia,zoom:ib,useZoom:ic[io-1]})}}return id}il+=ic.length;if(io===ic.length){ii=ib}}}return null}var id=[];if(e+io>ih){return null}var ig=Math.pow(2,io);var i=h7*ig;var ie=h9*ig;var ib=e+io;var id=[];for(var ik=0;ik<2;ik++){var h8=i+ik;for(var ij=0;ij<2;ij++){var ia=ie+ij;id.push({col:h8,row:ia,zoom:ib,useZoom:ib})}}return id},getFactorByZooms:function(i,h6){var T=dn.mapZoomBaseIndex[i];var h7=dn.mapZoomBaseIndex[h6];var e=dn.baseScaleZoomMercatorSize[T];var h8=dn.baseScaleZoomMercatorSize[h7];return e/h8}};var bb={};var ai=["swiftshader","microsoft basic render driver"];var co=["intel","nvidia","amd","apple","geforce"];function dA(e){e=e.toLowerCase();if(ai.indexOf(e)>=0){return true}if(e.indexOf("mobile")>=0){return true}return false}function fP(T){T=T.toLowerCase();for(var e=0;e<co.length;e++){if(T.indexOf(co[e])>=0){return true}}return false}function d6(e){if(!e){return false}if(dA(e)){return false}if(fP(e)){return true}return false}bb.ifEnableEarth=function(i){var e=bb.ifEnableEarth;if(!i&&typeof e._enable==="boolean"){return e._enable}if(bb.ifSupportWebGL()){e._enable=true;return true}e._enable=false;return false};bb.ifEnableWebGLMap=function(i){var e=bb.ifEnableWebGLMap;if(!i&&typeof e._enable==="boolean"){return e._enable}if(bb.ifSupportWebGL()){if(dB.inMapHost){e._enable=true;return true}else{if(window.Blob||window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder){e._enable=true;return true}else{e._enable=false;return false}}}e._enable=false;return false};bb.params={};bb.ifSupportWebGL=function(){var i=bb.ifSupportWebGL;if(typeof i._supportWebGL==="boolean"){return i._supportWebGL}if(!window.WebGLRenderingContext){i._supportWebGL=false;return false}var T=document.createElement("canvas");T.width=300;T.height=150;var h7=null;var id={alpha:true,antialias:false,failIfMajorPerformanceCaveat:true,preserveDrawingBuffer:false,stencil:false};try{h7=T.getContext("webgl",id)||T.getContext("experimental-webgl",id)}catch(h9){i._supportWebGL=false}if(h7===null){i._supportWebGL=false}else{i._supportWebGL=true;var ib=h7.getExtension("WEBGL_debug_renderer_info");var ia="";if(ib){ia=h7.getParameter(ib.UNMASKED_RENDERER_WEBGL);if(d6(ia)===true){i._supportWebGL=true}var ic=h7.getParameter(ib.UNMASKED_VENDOR_WEBGL);i._renderer=ia;i._vendor=ic}if(!ib&&D.Browser.firefox){i._supportWebGL=true}if(!ib&&D.Platform.macintosh){i._supportWebGL=true}if(h7.drawingBufferWidth!==T.width||h7.drawingBufferHeight!==T.height){i._supportWebGL=false}if(h7.getParameter(h7.MAX_VERTEX_TEXTURE_IMAGE_UNITS)<4){i._supportWebGL=false}var h6=h7.getParameter(h7.MAX_TEXTURE_SIZE);bb.params.maxTextureSize=h6;if(h6<4096){i._supportWebGL=false}var h8=h7.getParameter(h7.MAX_TEXTURE_IMAGE_UNITS);if(h8<8){i._supportWebGL=false}if(!h7.getShaderPrecisionFormat||h7.getShaderPrecisionFormat(h7.FRAGMENT_SHADER,h7.HIGH_FLOAT).precision<23){i._supportWebGL=false}}return i._supportWebGL};bb.ifSupportCanvas2d=function(){var h7=bb.ifSupportCanvas2d;if(typeof h7.supportCanvas2d==="boolean"){return h7.supportCanvas2d}var T=document.createElement("canvas");var i=null;try{i=T.getContext("2d")}catch(h6){h7.supportCanvas2d=false}if(i===null){h7.supportCanvas2d=false}else{h7.supportCanvas2d=true}return h7.supportCanvas2d};bb.ifCanvas2dInBlackList=function(){return true};bb.ifEnableCanvas2dMap=function(){return false;var i=navigator.userAgent;var e=0;var h6=0;var h7=0;if(/macintosh/ig.test(i)){var T=0;if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(i)&&!/chrome/i.test(i)){T=parseInt((RegExp["\x241"]||RegExp["\x242"]),10)}if(T>0){return false}return true}if(/windows nt (\d+\.\d)/ig.test(i)){h6=parseFloat(RegExp.$1);if(h6>=6.1){if(/chrome\/(\d+\.\d)/i.test(i)){e=parseFloat(RegExp.$1);if(e>=31){return true}}if(/MSIE (\d+(\.\d+)?)/.test(i)){h7=parseFloat(RegExp.$1);if(h7>=10){return true}}if(/Firefox/.test(i)){return true}if(/rv:11.0/ig.test(i)){return true}if(/edge/ig.test(i)){return true}}}return false};bb.ifSupportCSS3=function(ia,i){var h9=document.createElement("div");var h8="Webkit Moz O ms".split(" ");var e=h8.length;var T="";var h6=h9.style;if(ia in h6){T=ia}ia=ia.replace(/^[a-z]/,function(ib){return ib.toUpperCase()});while(e--){var h7=h8[e]+ia;if(h7 in h6){T=h7;break}}if(i){return T}else{return T.length>0?true:false}};bb.isModernBrowser=bb.ifSupportCanvas2d()&&bb.ifSupportCSS3("transform");function fa(i,e){this._size=i;this._curSize=0;this._cache={};this._least=null;this._most=null;this._options={clearCallback:null,removeOldCallback:null};e=e||{};for(var T in e){this._options[T]=e[T]}this._getDataTimes=0;this._hitTimes=0}fa.prototype.setData=function(h6,h8){var i=this._cache;var T=this._size;if(T===0){return}var e=this._curSize;if(e===T){this._removeOld()}var h7;if(!i[h6]){h7={key:h6,data:h8,older:null,newwer:null};i[h6]=h7;if(this._least===null){this._least=h7}if(this._most===null){this._most=h7}this._curSize++}else{h7=i[h6];h7.data=h8;if(this._most===h7){return}h7.older&&(h7.older.newer=h7.newer);h7.newer&&(h7.newer.older=h7.older);if(this._least===h7){this._least=h7.newer}}if(this._most&&this._most!==h7){this._most.newer=h7;h7.older=this._most;this._most=h7;h7.newer=null}};fa.prototype.getData=function(e){var i=this._cache[e];this._getDataTimes++;if(i){this._hitTimes++;var T=i.data;if(this._most===i){return T}i.older&&(i.older.newer=i.newer);i.newer&&(i.newer.older=i.older);if(this._least===i){this._least=i.newer}this._most.newer=i;i.older=this._most;i.newer=null;this._most=i;return T}return null};fa.prototype.getAllData=function(){return this._cache};fa.prototype.getHitRate=function(){return this._hitTimes/this._getDataTimes};fa.prototype.removeData=function(i){var e=this._cache;var T=e[i];if(!T){return}if(this._options.clearCallback){this._options.clearCallback(T.data,T.key)}T.older&&(T.older.newer=T.newer);T.newer&&(T.newer.older=T.older);if(this._least===T){this._least=T.newer}if(this._most===T){this._most=T.older}delete e[i];this._curSize--};fa.prototype._removeOld=function(){var e=this._cache;var h6=Math.round(this._size*0.6);var T=0;while(this._least&&T<h6){var i=this._least;this._least=i.newer;i.newer&&(i.newer.older=null);if(this._options.clearCallback){this._options.clearCallback(i.data,i.key)}delete e[i.key];T++}this._curSize-=T;if(this._options.removeOldCallback){this._options.removeOldCallback()}};fa.prototype.clear=function(){var e=this._cache;var i=this._least;if(this._options.clearCallback){while(i){this._options.clearCallback(i.data,i.key);i=i.newer}}this._least=this._most=null;this._cache={};this._curSize=0};fa.prototype.forEach=function(e){var i=this._least;while(i){e(i.data);i=i.newer}};fa.prototype.clearExcept=function(i){var e=this._cache;var T=this._least;while(T){if(!i[T.key]){if(this._options.clearCallback){this._options.clearCallback(T.data,T.key)}T.older&&(T.older.newer=T.newer);T.newer&&(T.newer.older=T.older);if(this._least===T){this._least=T.newer}if(this._most===T){this._most=T.older}delete e[T.key];this._curSize--}T=T.newer}};!function(T,i){"object"==typeof br&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(T="undefined"!=typeof globalThis?globalThis:T||self).gcoord=i()}(this,(function(){
/* *****************************************************************************
        Copyright (c) Microsoft Corporation.

        Permission to use, copy, modify, and/or distribute this software for any
        purpose with or without fee is hereby granted.

        THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
        REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
        AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
        INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
        LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
        OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
        PERFORMANCE OF THIS SOFTWARE.
        ***************************************************************************** */
var iN=function(){return(iN=Object.assign||function(iS){for(var i,T=1,iU=arguments.length;T<iU;T++){for(var iT in i=arguments[T]){Object.prototype.hasOwnProperty.call(i,iT)&&(iS[iT]=i[iT])}}return iS}).apply(this,arguments)},iy=Math.sin,iA=Math.cos,iE=Math.sqrt,iD=Math.abs,iR=Math.PI,iJ=6378245,ix=0.006693421622965823;function iM(T,i){return T>=72.004&&T<=137.8347&&i>=0.8293&&i<=55.8271}function iP(iU,iT){var iX,i,iZ,T=(iZ=300+(iX=iU-105)+2*(i=iT-35)+0.1*iX*iX+0.1*iX*i+0.1*iE(iD(iX)),iZ+=2*(20*iy(6*iX*iR)+20*iy(2*iX*iR))/3,(iZ+=2*(20*iy(iX*iR)+40*iy(iX/3*iR))/3)+2*(150*iy(iX/12*iR)+300*iy(iX/30*iR))/3),iS=function(i2,i1){var i0=2*i2-100+3*i1+0.2*i1*i1+0.1*i2*i1+0.2*iE(iD(i2));return i0+=2*(20*iy(6*i2*iR)+20*iy(2*i2*iR))/3,i0+=2*(20*iy(i1*iR)+40*iy(i1/3*iR))/3,i0+2*(160*iy(i1/12*iR)+320*iy(i1*iR/30))/3}(iU-105,iT-35),iW=iT/180*iR,iV=iy(iW),iY=iE(iV=1-ix*iV*iV);return[T=180*T/(iJ/iY*iA(iW)*iR),iS=180*iS/(iJ*(1-ix)/(iV*iY)*iR)]}function iG(iS){var i=iS[0],T=iS[1];if(!iM(i,T)){return[i,T]}var iT=iP(i,T);return[i+iT[0],T+iT[1]]}function iz(iU){var iY=iU[0],T=iU[1];if(!iM(iY,T)){return[iY,T]}for(var iS=[iY,T],iW=iS[0],iT=iS[1],iX=iG([iW,iT]),iV=iX[0]-iY,iZ=iX[1]-T;iD(iV)>0.000001||iD(iZ)>0.000001;){iV=(iX=iG([iW-=iV,iT-=iZ]))[0]-iY,iZ=iX[1]-T}return[iW,iT]}var iK=Math.sin,iL=Math.cos,ie=Math.atan2,iO=Math.sqrt,iw=3000*Math.PI/180;function iC(iS){var i=iS[0]-0.0065,T=iS[1]-0.006,iU=iO(i*i+T*T)-0.00002*iK(T*iw),iT=ie(T,i)-0.000003*iL(i*iw);return[iU*iL(iT),iU*iK(iT)]}function ij(iS){var i=iS[0],T=iS[1],iU=iO(i*i+T*T)+0.00002*iK(T*iw),iT=ie(T,i)+0.000003*iL(i*iw);return[iU*iL(iT)+0.0065,iU*iK(iT)+0.006]}var it=180/Math.PI,h9=Math.PI/180,ib=6378137,iQ=20037508.342789244;function ip(i){return[i[0]*it/ib,(0.5*Math.PI-2*Math.atan(Math.exp(-i[1]/ib)))*it]}function iF(iS){var i=Math.abs(iS[0])<=180?iS[0]:iS[0]-360*(iS[0]<0?-1:1),T=[ib*i*h9,ib*Math.log(Math.tan(0.25*Math.PI+0.5*iS[1]*h9))];return T[0]>iQ&&(T[0]=iQ),T[0]<-iQ&&(T[0]=-iQ),T[1]>iQ&&(T[1]=iQ),T[1]<-iQ&&(T[1]=-iQ),T}var io,im,il,iv,ii,h6,iu=Math.abs,iH=[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],ih=[75,60,45,30,15,0],h8=[[1.410526172116255e-8,0.00000898305509648872,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-0.03801003308653,17337981.2],[-7.435856389565537e-9,0.000008983055097726239,-0.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,0.00000898305509983578,0.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,0.32710905363475,6856817.37],[-1.981981304930552e-8,0.000008983055099779535,0.03278182852591,40.31678527705744,0.65659298677277,-4.44255534477492,0.85341911805263,0.12923347998204,-0.04625736007561,4482777.06],[3.09191371068437e-9,0.000008983055096812155,0.00006995724062,23.10934304144901,-0.00023663490511,-0.6321817810242,-0.00663494467273,0.03430082397953,-0.00466043876332,2555164.4],[2.890871144776878e-9,0.000008983055095805407,-3.068298e-8,7.47137025468032,-0.00000353937994,-0.02145144861037,-0.00001234426596,0.00010322952773,-0.00000323890364,826088.5]],iI=[[-0.0015702102444,111320.7020616939,1704480524535203,-10338987376042340,26112667856603880,-35149669176653700,26595700718403920,-10725012454188240,1800819912950474,82.5],[0.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[0.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[0.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-0.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-0.0003218135878613132,111320.7020701615,0.00369383431289,823725.6402795718,0.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,0.37238884252424,7.45]];function ig(iT,T,iS){var iV=iu(T)/iS[9],iU=iS[0]+iS[1]*iu(iT),i=iS[2]+iS[3]*iV+iS[4]*Math.pow(iV,2)+iS[5]*Math.pow(iV,3)+iS[6]*Math.pow(iV,4)+iS[7]*Math.pow(iV,5)+iS[8]*Math.pow(iV,6);return[iU*=iT<0?-1:1,i*=T<0?-1:1]}function iB(iS){for(var i=iS[0],T=iS[1],iU=[],iT=0;iT<ih.length;iT++){if(iu(T)>ih[iT]){iU=iI[iT];break}}return ig(i,T,iU)}function id(iS){for(var i=iS[0],T=iS[1],iU=[],iT=0;iT<iH.length;iT++){if(T>=iH[iT]){iU=h8[iT];break}}return ig(i,T,iU)}function ic(T,i){if(!T){throw new Error(i)}}function iq(i){return !!i&&"[object Array]"===Object.prototype.toString.call(i)}function ik(i){return !isNaN(Number(i))&&null!==i&&!iq(i)}function ia(){for(var iS=[],i=0;i<arguments.length;i++){iS[i]=arguments[i]}var T=iS.length-1;return function(){for(var iT=[],iV=0;iV<arguments.length;iV++){iT[iV]=arguments[iV]}for(var iU=T,e=iS[T].apply(null,iT);iU--;){e=iS[iU].call(null,e)}return e}}function h7(i9,iY,i0){if(void 0===i0&&(i0=!1),null!==i9){for(var i3,i2,jc,i5,iX,i8,jb,i4,iZ=0,i6=0,i7=i9.type,iT="FeatureCollection"===i7,ja="Feature"===i7,iW=iT?i9.features.length:1,i1=0;i1<iW;i1++){iX=(i4=!!(jb=iT?i9.features[i1].geometry:ja?i9.geometry:i9)&&"GeometryCollection"===jb.type)?jb.geometries.length:1;for(var iV=0;iV<iX;iV++){var iU=0,T=0;if(null!==(i5=i4?jb.geometries[iV]:jb)){var iS=i5.type;switch(iZ=!i0||"Polygon"!==iS&&"MultiPolygon"!==iS?0:1,iS){case null:break;case"Point":if(!1===iY(i8=i5.coordinates,i6,i1,iU,T)){return !1}i6++,iU++;break;case"LineString":case"MultiPoint":for(i8=i5.coordinates,i3=0;i3<i8.length;i3++){if(!1===iY(i8[i3],i6,i1,iU,T)){return !1}i6++,"MultiPoint"===iS&&iU++}"LineString"===iS&&iU++;break;case"Polygon":case"MultiLineString":for(i8=i5.coordinates,i3=0;i3<i8.length;i3++){for(i2=0;i2<i8[i3].length-iZ;i2++){if(!1===iY(i8[i3][i2],i6,i1,iU,T)){return !1}i6++}"MultiLineString"===iS&&iU++,"Polygon"===iS&&T++}"Polygon"===iS&&iU++;break;case"MultiPolygon":for(i8=i5.coordinates,i3=0;i3<i8.length;i3++){for(T=0,i2=0;i2<i8[i3].length;i2++){for(jc=0;jc<i8[i3][i2].length-iZ;jc++){if(!1===iY(i8[i3][i2][jc],i6,i1,iU,T)){return !1}i6++}T++}iU++}break;case"GeometryCollection":for(i3=0;i3<i5.geometries.length;i3++){if(!1===h7(i5.geometries[i3],iY,i0)){return !1}}break;default:throw new Error("Unknown Geometry Type")}}}}}}!function(i){i.WGS84="WGS84",i.WGS1984="WGS84",i.EPSG4326="WGS84",i.GCJ02="GCJ02",i.AMap="GCJ02",i.BD09="BD09",i.BD09LL="BD09",i.Baidu="BD09",i.BMap="BD09",i.BD09MC="BD09MC",i.BD09Meter="BD09MC",i.EPSG3857="EPSG3857",i.EPSG900913="EPSG3857",i.EPSG102100="EPSG3857",i.WebMercator="EPSG3857",i.WM="EPSG3857"}(h6||(h6={}));var ir={WGS84:{to:(io={},io[h6.GCJ02]=iG,io[h6.BD09]=ia(ij,iG),io[h6.BD09MC]=ia(iB,ij,iG),io[h6.EPSG3857]=iF,io)},GCJ02:{to:(im={},im[h6.WGS84]=iz,im[h6.BD09]=ij,im[h6.BD09MC]=ia(iB,ij),im[h6.EPSG3857]=ia(iF,iz),im)},BD09:{to:(il={},il[h6.WGS84]=ia(iz,iC),il[h6.GCJ02]=iC,il[h6.EPSG3857]=ia(iF,iz,iC),il[h6.BD09MC]=iB,il)},EPSG3857:{to:(iv={},iv[h6.WGS84]=ip,iv[h6.GCJ02]=ia(iG,ip),iv[h6.BD09]=ia(ij,iG,ip),iv[h6.BD09MC]=ia(iB,ij,iG,ip),iv)},BD09MC:{to:(ii={},ii[h6.WGS84]=ia(iz,iC,id),ii[h6.GCJ02]=ia(iC,id),ii[h6.EPSG3857]=ia(iF,iz,iC,id),ii[h6.BD09]=id,ii)}};return iN(iN({},h6),{CRSTypes:h6,transform:function(iW,iU,iV){if(ic(!!iW,"The args[0] input coordinate is required"),ic(!!iU,"The args[1] original coordinate system is required"),ic(!!iV,"The args[2] target coordinate system is required"),iU===iV){return iW}var iY=ir[iU];ic(!!iY,"Invalid original coordinate system: "+iU);var iX=iY.to[iV];ic(!!iX,"Invalid target coordinate system: "+iV);var T=typeof iW;if(ic("string"===T||"object"===T,"Invalid input coordinate type: "+T),"string"===T){try{iW=JSON.parse(iW)}catch(iU){throw new Error("Invalid input coordinate: "+iW)}}var iT=!1;iq(iW)&&(ic(iW.length>=2,"Invalid input coordinate: "+iW),ic(ik(iW[0])&&ik(iW[1]),"Invalid input coordinate: "+iW),iW=iW.map(Number),iT=!0);var iS=iX;return iT?iS(iW):(h7(iW,(function(iZ){var i;i=iS(iZ),iZ[0]=i[0],iZ[1]=i[1]})),iW)}})}));var he={ColorRefTable:{aliceblue:["#f0f8ff","rgb(240,248,255)"],antiquewhite:["#faebd7","rgb(250,235,215)"],aqua:["#00ffff","rgb(0,255,255)"],aquamarine:["#7fffd4","rgb(127,255,212)"],azure:["#f0ffff","rgb(240,255,255)"],beige:["#f5f5dc","rgb(245,245,220)"],bisque:["#ffe4c4","rgb(255,228,196)"],black:["#000000","rgb(0,0,0)"],blanchedalmond:["#ffebcd","rgb(255,235,205)"],blue:["#0000ff","rgb(0,0,255)"],blueviolet:["#8a2be2","rgb(138,43,226)"],brown:["#a52a2a","rgb(165,42,42)"],burlywood:["#deb887","rgb(222,184,135)"],cadetblue:["#5f9ea0","rgb(95,158,160)"],chartreuse:["#7fff00","rgb(127,255,0)"],chocolate:["#d2691e","rgb(210,105,30)"],coral:["#ff7f50","rgb(255,127,80)"],cornflowerblue:["#6495ed","rgb(100,149,237)"],cornsilk:["#fff8dc","rgb(255,248,220)"],crimson:["#dc143c","rgb(220,20,60)"],cyan:["#00ffff","rgb(0,255,255)"],darkblue:["#00008b","rgb(0,0,139)"],darkcyan:["#008b8b","rgb(0,139,139)"],darkgoldenrod:["#b8860b","rgb(184,134,11)"],darkgray:["#a9a9a9","rgb(169,169,169)"],darkgreen:["#006400","rgb(0,100,0)"],darkgrey:["#a9a9a9","rgb(169,169,169)"],darkkhaki:["#bdb76b","rgb(189,183,107)"],darkmagenta:["#8b008b","rgb(139,0,139)"],darkolivegreen:["#556b2f","rgb(85,107,47)"],darkorange:["#ff8c00","rgb(255,140,0)"],darkorchid:["#9932cc","rgb(153,50,204)"],darkred:["#8b0000","rgb(139,0,0)"],darksalmon:["#e9967a","rgb(233,150,122)"],darkseagreen:["#8fbc8f","rgb(143,188,143)"],darkslateblue:["#483d8b","rgb(72,61,139)"],darkslategray:["#2f4f4f","rgb(47,79,79)"],darkslategrey:["#2f4f4f","rgb(47,79,79)"],darkturquoise:["#00ced1","rgb(0,206,209)"],darkviolet:["#9400d3","rgb(148,0,211)"],deeppink:["#ff1493","rgb(255,20,147)"],deepskyblue:["#00bfff","rgb(0,191,255)"],dimgray:["#696969","rgb(105,105,105)"],dimgrey:["#696969","rgb(105,105,105)"],dodgerblue:["#1e90ff","rgb(30,144,255)"],firebrick:["#b22222","rgb(178,34,34)"],floralwhite:["#fffaf0","rgb(255,250,240)"],forestgreen:["#228b22","rgb(34,139,34)"],fuchsia:["#ff00ff","rgb(255,0,255)"],gainsboro:["#dcdcdc","rgb(220,220,220)"],ghostwhite:["#f8f8ff","rgb(248,248,255)"],gold:["#ffd700","rgb(255,215,0)"],goldenrod:["#daa520","rgb(218,165,32)"],gray:["#808080","rgb(128,128,128)"],green:["#008000","rgb(0,128,0)"],greenyellow:["#adff2f","rgb(173,255,47)"],grey:["#808080","rgb(128,128,128)"],honeydew:["#f0fff0","rgb(240,255,240)"],hotpink:["#ff69b4","rgb(255,105,180)"],indianred:["#cd5c5c","rgb(205,92,92)"],indigo:["#4b0082","rgb(75,0,130)"],ivory:["#fffff0","rgb(255,255,240)"],khaki:["#f0e68c","rgb(240,230,140)"],lavender:["#e6e6fa","rgb(230,230,250)"],lavenderblush:["#fff0f5","rgb(255,240,245)"],lawngreen:["#7cfc00","rgb(124,252,0)"],lemonchiffon:["#fffacd","rgb(255,250,205)"],lightblue:["#add8e6","rgb(173,216,230)"],lightcoral:["#f08080","rgb(240,128,128)"],lightcyan:["#e0ffff","rgb(224,255,255)"],lightgoldenrodyellow:["#fafad2","rgb(250,250,210)"],lightgray:["#d3d3d3","rgb(211,211,211)"],lightgreen:["#90ee90","rgb(144,238,144)"],lightgrey:["#d3d3d3","rgb(211,211,211)"],lightpink:["#ffb6c1","rgb(255,182,193)"],lightsalmon:["#ffa07a","rgb(255,160,122)"],lightseagreen:["#20b2aa","rgb(32,178,170)"],lightskyblue:["#87cefa","rgb(135,206,250)"],lightslategray:["#778899","rgb(119,136,153)"],lightslategrey:["#778899","rgb(119,136,153)"],lightsteelblue:["#b0c4de","rgb(176,196,222)"],lightyellow:["#ffffe0","rgb(255,255,224)"],lime:["#00ff00","rgb(0,255,0)"],limegreen:["#32cd32","rgb(50,205,50)"],linen:["#faf0e6","rgb(250,240,230)"],magenta:["#ff00ff","rgb(255,0,255)"],maroon:["#800000","rgb(128,0,0)"],mediumaquamarine:["#66cdaa","rgb(102,205,170)"],mediumblue:["#0000cd","rgb(0,0,205)"],mediumorchid:["#ba55d3","rgb(186,85,211)"],mediumpurple:["#9370db","rgb(147,112,219)"],mediumseagreen:["#3cb371","rgb(60,179,113)"],mediumslateblue:["#7b68ee","rgb(123,104,238)"],mediumspringgreen:["#00fa9a","rgb(0,250,154)"],mediumturquoise:["#48d1cc","rgb(72,209,204)"],mediumvioletred:["#c71585","rgb(199,21,133)"],midnightblue:["#191970","rgb(25,25,112)"],mintcream:["#f5fffa","rgb(245,255,250)"],mistyrose:["#ffe4e1","rgb(255,228,225)"],moccasin:["#ffe4b5","rgb(255,228,181)"],navajowhite:["#ffdead","rgb(255,222,173)"],navy:["#000080","rgb(0,0,128)"],oldlace:["#fdf5e6","rgb(253,245,230)"],olive:["#808000","rgb(128,128,0)"],olivedrab:["#6b8e23","rgb(107,142,35)"],orange:["#ffa500","rgb(255,165,0)"],orangered:["#ff4500","rgb(255,69,0)"],orchid:["#da70d6","rgb(218,112,214)"],palegoldenrod:["#eee8aa","rgb(238,232,170)"],palegreen:["#98fb98","rgb(152,251,152)"],paleturquoise:["#afeeee","rgb(175,238,238)"],palevioletred:["#db7093","rgb(219,112,147)"],papayawhip:["#ffefd5","rgb(255,239,213)"],peachpuff:["#ffdab9","rgb(255,218,185)"],peru:["#cd853f","rgb(205,133,63)"],pink:["#ffc0cb","rgb(255,192,203)"],plum:["#dda0dd","rgb(221,160,221)"],powderblue:["#b0e0e6","rgb(176,224,230)"],purple:["#800080","rgb(128,0,128)"],red:["#ff0000","rgb(255,0,0)"],rosybrown:["#bc8f8f","rgb(188,143,143)"],royalblue:["#4169e1","rgb(65,105,225)"],saddlebrown:["#8b4513","rgb(139,69,19)"],salmon:["#fa8072","rgb(250,128,114)"],sandybrown:["#f4a460","rgb(244,164,96)"],seagreen:["#2e8b57","rgb(46,139,87)"],seashell:["#fff5ee","rgb(255,245,238)"],sienna:["#a0522d","rgb(160,82,45)"],silver:["#c0c0c0","rgb(192,192,192)"],skyblue:["#87ceeb","rgb(135,206,235)"],slateblue:["#6a5acd","rgb(106,90,205)"],slategray:["#708090","rgb(112,128,144)"],slategrey:["#708090","rgb(112,128,144)"],snow:["#fffafa","rgb(255,250,250)"],springgreen:["#00ff7f","rgb(0,255,127)"],steelblue:["#4682b4","rgb(70,130,180)"],tan:["#d2b48c","rgb(210,180,140)"],teal:["#008080","rgb(0,128,128)"],thistle:["#d8bfd8","rgb(216,191,216)"],tomato:["#ff6347","rgb(255,99,71)"],turquoise:["#40e0d0","rgb(64,224,208)"],violet:["#ee82ee","rgb(238,130,238)"],wheat:["#f5deb3","rgb(245,222,179)"],white:["#ffffff","rgb(255,255,255)"],whitesmoke:["#f5f5f5","rgb(245,245,245)"],yellow:["#ffff00","rgb(255,255,0)"],yellowgreen:["#9acd32","rgb(154,205,50)"]},parseHexToRgbaArray:function(h8){var h9=h8.replace("#","");if(h9.length===3){h9+="f"}else{if(h9.length===6){h9+="ff"}}var e=[];var h7=h9.length;var h6=h7===8?2:1;for(var T=0;T<h7;T=T+h6){if(h6===2){e.push(parseInt(h9.slice(T,T+2),16))}else{e.push(parseInt(h9.slice(T,T+1)+h9.slice(T,T+1),16))}}return e},parseRgbaStrToArray:function(i){var e=[0,0,0,255];if(i.indexOf("rgba(")===0){var h6=i.replace("rgba(","").replace(")","");var T=h6.split(",");e[0]=parseInt(T[0],10);e[1]=parseInt(T[1],10);e[2]=parseInt(T[2],10);e[3]=Math.round(parseFloat(T[3])*255)}else{if(i.indexOf("rgb(")===0){var h6=i.replace("rgb(","").replace(")","");var h7=h6.split(",");e[0]=parseInt(h7[0],10);e[1]=parseInt(h7[1],10);e[2]=parseInt(h7[2],10);e[3]=255}}return e},parseHexAndOpacityToRgbaArray:function(h7,h8){var T=[];var ib=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;var ia=h7.toLowerCase();if(ib.test(ia)){if(ia.length===4){var e="#";for(var h9=1;h9<4;h9++){e+=ia.slice(h9,h9+1).concat(ia.slice(h9,h9+1))}ia=e}for(var h6=1;h6<7;h6+=2){T.push(parseInt(ia.slice(h6,h6+2),16))}T.push(h8)}return T},parseCSSColor:function(e){if(e.indexOf("#")===0){return he.parseHexToRgbaArray(e)}return he.parseRgbaStrToArray(e)},rgbToHSV:function(h7){var e=h7[0]/255;var T=h7[1]/255;var h8=h7[2]/255;var ib=Math.max(e,T,h8);var h6=Math.min(e,T,h8);var ia=ib-h6;var i;if(ia===0){i=0}else{if(ib===e){i=60*(((T-h8)/ia)%6)}else{if(ib===T){i=60*((h8-e)/ia+2)}else{if(ib===h8){i=60*((e-T)/ia+4)}}}}var ic=ib===0?0:(ia/ib);var h9=ib;while(i<0){i+=360}return[i,ic,h9]},hsvToRGB:function(h6){var ia=h6[2]*h6[1];var T=ia*(1-Math.abs((h6[0]/60)%2-1));var i=h6[2]-ia;var h7=h6[0];var h9;var h8;var e;if(h7>=0&&h7<60){h9=ia;h8=T;e=0}else{if(h7>=60&&h7<120){h9=T;h8=ia;e=0}else{if(h7>=120&&h7<180){h9=0;h8=ia;e=T}else{if(h7>=180&&h7<240){h9=0;h8=T;e=ia}else{if(h7>=240&&h7<300){h9=T;h8=0;e=ia}else{if(h7>=300&&h7<360){h9=ia;h8=0;e=T}}}}}}h9=(h9+i)*255>255?255:(h9+i)*255;h8=(h8+i)*255>255?255:(h8+i)*255;e=(e+i)*255>255?255:(e+i)*255;return[Math.round(h9),Math.round(h8),Math.round(e)]},formatColorCssToRgbaArray:function(h8,T,h6){h6=(typeof h6!=="boolean")?true:h6;if(typeof h8!=="string"){return h6?[0,0,0,1]:[0,0,0,255]}var i=(h8||"Black").trim().toLowerCase();var e=[];var h7=he.ColorRefTable[i];if(h7!==undefined){i=h7[0]}e=he.parseCSSColor(i);if(T!==undefined&&!isNaN(Number(T))){T=Number(T);e[3]=he.fitTo(T,0,1)}else{e[3]=Number((e[3]/255).toFixed(2))}if(!h6){e[3]=Math.floor(e[3]*255)}return e},fitTo:function(T,i,e){if(T<i){T=i}else{if(T>e){T=e}}return T}};(function(h8){function ij(ip,it){var ir=(ip&65535)+(it&65535);var iq=(ip>>16)+(it>>16)+(ir>>16);return(iq<<16)|(ir&65535)}function ii(ip,iq){return(ip<<iq)|(ip>>>(32-iq))}function ic(iv,ir,iq,ip,iu,it){return ij(ii(ij(ij(ir,iv),ij(ip,it)),iu),iq)}function e(ir,iq,iw,iv,ip,iu,it){return ic((iq&iw)|(~iq&iv),ir,iq,ip,iu,it)}function h9(ir,iq,iw,iv,ip,iu,it){return ic((iq&iv)|(iw&~iv),ir,iq,ip,iu,it)}function ig(ir,iq,iw,iv,ip,iu,it){return ic(iq^iw^iv,ir,iq,ip,iu,it)}function im(ir,iq,iw,iv,ip,iu,it){return ic(iw^(iq|~iv),ir,iq,ip,iu,it)}function T(iA,iv){iA[iv>>5]|=128<<(iv%32);iA[((iv+64)>>>9<<4)+14]=iv;var ir;var iu;var it;var iq;var ip;var iz=1732584193;var iy=-271733879;var ix=-1732584194;var iw=271733878;for(ir=0;ir<iA.length;ir+=16){iu=iz;it=iy;iq=ix;ip=iw;iz=e(iz,iy,ix,iw,iA[ir],7,-680876936);iw=e(iw,iz,iy,ix,iA[ir+1],12,-389564586);ix=e(ix,iw,iz,iy,iA[ir+2],17,606105819);iy=e(iy,ix,iw,iz,iA[ir+3],22,-1044525330);iz=e(iz,iy,ix,iw,iA[ir+4],7,-176418897);iw=e(iw,iz,iy,ix,iA[ir+5],12,1200080426);ix=e(ix,iw,iz,iy,iA[ir+6],17,-1473231341);iy=e(iy,ix,iw,iz,iA[ir+7],22,-45705983);iz=e(iz,iy,ix,iw,iA[ir+8],7,1770035416);iw=e(iw,iz,iy,ix,iA[ir+9],12,-1958414417);ix=e(ix,iw,iz,iy,iA[ir+10],17,-42063);iy=e(iy,ix,iw,iz,iA[ir+11],22,-1990404162);iz=e(iz,iy,ix,iw,iA[ir+12],7,1804603682);iw=e(iw,iz,iy,ix,iA[ir+13],12,-40341101);ix=e(ix,iw,iz,iy,iA[ir+14],17,-1502002290);iy=e(iy,ix,iw,iz,iA[ir+15],22,1236535329);iz=h9(iz,iy,ix,iw,iA[ir+1],5,-165796510);iw=h9(iw,iz,iy,ix,iA[ir+6],9,-1069501632);ix=h9(ix,iw,iz,iy,iA[ir+11],14,643717713);iy=h9(iy,ix,iw,iz,iA[ir],20,-373897302);iz=h9(iz,iy,ix,iw,iA[ir+5],5,-701558691);iw=h9(iw,iz,iy,ix,iA[ir+10],9,38016083);ix=h9(ix,iw,iz,iy,iA[ir+15],14,-660478335);iy=h9(iy,ix,iw,iz,iA[ir+4],20,-405537848);iz=h9(iz,iy,ix,iw,iA[ir+9],5,568446438);iw=h9(iw,iz,iy,ix,iA[ir+14],9,-1019803690);ix=h9(ix,iw,iz,iy,iA[ir+3],14,-187363961);iy=h9(iy,ix,iw,iz,iA[ir+8],20,1163531501);iz=h9(iz,iy,ix,iw,iA[ir+13],5,-1444681467);iw=h9(iw,iz,iy,ix,iA[ir+2],9,-51403784);ix=h9(ix,iw,iz,iy,iA[ir+7],14,1735328473);iy=h9(iy,ix,iw,iz,iA[ir+12],20,-1926607734);iz=ig(iz,iy,ix,iw,iA[ir+5],4,-378558);iw=ig(iw,iz,iy,ix,iA[ir+8],11,-2022574463);ix=ig(ix,iw,iz,iy,iA[ir+11],16,1839030562);iy=ig(iy,ix,iw,iz,iA[ir+14],23,-35309556);iz=ig(iz,iy,ix,iw,iA[ir+1],4,-1530992060);iw=ig(iw,iz,iy,ix,iA[ir+4],11,1272893353);ix=ig(ix,iw,iz,iy,iA[ir+7],16,-155497632);iy=ig(iy,ix,iw,iz,iA[ir+10],23,-1094730640);iz=ig(iz,iy,ix,iw,iA[ir+13],4,681279174);iw=ig(iw,iz,iy,ix,iA[ir],11,-358537222);ix=ig(ix,iw,iz,iy,iA[ir+3],16,-722521979);iy=ig(iy,ix,iw,iz,iA[ir+6],23,76029189);iz=ig(iz,iy,ix,iw,iA[ir+9],4,-640364487);iw=ig(iw,iz,iy,ix,iA[ir+12],11,-421815835);ix=ig(ix,iw,iz,iy,iA[ir+15],16,530742520);iy=ig(iy,ix,iw,iz,iA[ir+2],23,-995338651);iz=im(iz,iy,ix,iw,iA[ir],6,-198630844);iw=im(iw,iz,iy,ix,iA[ir+7],10,1126891415);ix=im(ix,iw,iz,iy,iA[ir+14],15,-1416354905);iy=im(iy,ix,iw,iz,iA[ir+5],21,-57434055);iz=im(iz,iy,ix,iw,iA[ir+12],6,1700485571);iw=im(iw,iz,iy,ix,iA[ir+3],10,-1894986606);ix=im(ix,iw,iz,iy,iA[ir+10],15,-1051523);iy=im(iy,ix,iw,iz,iA[ir+1],21,-2054922799);iz=im(iz,iy,ix,iw,iA[ir+8],6,1873313359);iw=im(iw,iz,iy,ix,iA[ir+15],10,-30611744);ix=im(ix,iw,iz,iy,iA[ir+6],15,-1560198380);iy=im(iy,ix,iw,iz,iA[ir+13],21,1309151649);iz=im(iz,iy,ix,iw,iA[ir+4],6,-145523070);iw=im(iw,iz,iy,ix,iA[ir+11],10,-1120210379);ix=im(ix,iw,iz,iy,iA[ir+2],15,718787259);iy=im(iy,ix,iw,iz,iA[ir+9],21,-343485551);iz=ij(iz,iu);iy=ij(iy,it);ix=ij(ix,iq);iw=ij(iw,ip)}return[iz,iy,ix,iw]}function ih(iq){var ir;var ip="";var it=iq.length*32;for(ir=0;ir<it;ir+=8){ip+=String.fromCharCode((iq[ir>>5]>>>(ir%32))&255)}return ip}function ib(iq){var it;var ip=[];ip[(iq.length>>2)-1]=undefined;for(it=0;it<ip.length;it+=1){ip[it]=0}var ir=iq.length*8;for(it=0;it<ir;it+=8){ip[it>>5]|=(iq.charCodeAt(it/8)&255)<<(it%32)}return ip}function ia(ip){return ih(T(ib(ip),ip.length*8))}function io(ir,iv){var iq;var iu=ib(ir);var ip=[];var it=[];var iw;ip[15]=it[15]=undefined;if(iu.length>16){iu=T(iu,ir.length*8)}for(iq=0;iq<16;iq+=1){ip[iq]=iu[iq]^909522486;it[iq]=iu[iq]^1549556828}iw=T(ip.concat(ib(iv)),512+iv.length*8);return ih(T(it.concat(iw),512+128))}function il(it){var ir="0123456789abcdef";var iq="";var ip;var iu;for(iu=0;iu<it.length;iu+=1){ip=it.charCodeAt(iu);iq+=ir.charAt((ip>>>4)&15)+ir.charAt(ip&15)}return iq}function id(ip){return unescape(encodeURIComponent(ip))}function h6(ip){return ia(id(ip))}function ie(ip){return il(h6(ip))}function i(ip,iq){return io(id(ip),id(iq))}function ik(ip,iq){return il(i(ip,iq))}function h7(iq,ir,ip){if(!ir){if(!ip){return ie(iq)}return h6(iq)}if(!ip){return ik(ir,iq)}return i(ir,iq)}if(typeof define==="function"&&define.amd){define(function(){return h7})}else{if(typeof module==="object"&&module.exports){module.exports=h7}else{h8.md5=h7}}})(this);var aD={levels:{INFO:"info",WARNING:"warning",ERROR:"error"},category:{JS:"js",RESOURCE:"resource",AJAX:"ajax"},config:{jsError:true,resourceError:true,ajaxError:true},hosts:"api.map.baidu.com|webmap0.bdimg.com|maponline0.bdimg.com|",ignoreUrl:"api.map.baidu.com/images/blank.gif",sender:true,collections:[],sendError:function(){},init:function(i,e,T){this.hosts+=i?i:"";dc&&dc(this.config,e);this.sender=true;if(T){this.sender=false}this.hosts=this.urlScope(this.hosts);this.sendError=this.notifyError();var h6=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};this.config.jsError&&this.handleJavaScriptError(h6);this.config.resourceError&&this.handleResourceError(h6);this.config.ajaxError&&this.handleAjaxError(h6)},handleJavaScriptError:function(T){var e=this;var i=T.onerror;T.onerror=function(ia,h9,h6,h8,h7){if(e.isFetch(e.category.JS)&&e.hostExit(h9)){if(h7&&h7.stack){e.sendError({title:ia,msg:h7.stack,category:e.category.JS,level:e.levels.ERROR})}else{if(typeof ia==="string"){e.sendError({title:ia,msg:JSON.stringify({resourceUrl:h9,rowNum:h6,colNum:h8}),category:"js",level:e.levels.ERROR})}}}if(i&&bY(i)){i&&i.apply(T,arguments)}}},handleResourceError:function(i){var e=this;i.addEventListener("error",function(h8){if(h8){var h9=h8.target||h8.srcElement;var h7=h9 instanceof HTMLScriptElement||h9 instanceof HTMLLinkElement||h9 instanceof HTMLImageElement;if(!h7){if(!i.onerror){var T=h8.filename||null;if(!e.isFetch(e.category.JS)||!e.hostExit(T)){return}if(h8.error&&h8.error.stack){e.sendError({title:h8.message,msg:h8.error.stack,category:e.category.JS,level:e.levels.ERROR})}else{if(typeof h8.message==="string"){e.sendError({title:h8.message,msg:JSON.stringify({resourceUrl:T,rowNum:h8.lineno,colNum:h8.cowno}),category:e.category.JS,level:e.levels.ERROR})}}}return}var h6=h9.src||h9.href;if(e.isFetch(e.category.RESOURCE)&&e.hostExit(h6)){e.sendError({title:h9.nodeName,msg:h6,category:e.category.RESOURCE,level:e.levels.ERROR})}}},true)},handleAjaxError:function(h8){var e=this;var h7=h8.location.protocol;if(h7==="file:"){return}if(!h8.XMLHttpRequest){return}var i=h8.XMLHttpRequest;var T=i.prototype.send;var h6=function(ia){if(ia&&ia.currentTarget&&ia.currentTarget.status!==200){var h9=ia.target.responseURL;if(e.isFetch(e.category.AJAX)&&e.hostExit(h9)){e.sendError({title:h9,msg:JSON.stringify({response:ia.target.response,responseURL:h9,status:ia.target.status,statusText:ia.target.statusText}),category:e.category.AJAX,level:e.levels.ERROR})}}};i.prototype.send=function(){if(this["addEventListener"]){this["addEventListener"]("error",h6);this["addEventListener"]("load",h6);this["addEventListener"]("abort",h6)}else{var h9=this["onreadystatechange"];this["onreadystatechange"]=function(ia){if(this.readyState===4){h6(ia)}h9&&h9.apply(this,arguments)}}return T.apply(this,arguments)}},notifyError:function(T){var i=T||1000;this._idleWorkerTicker=(function(h6){return function(){h6.runJob()}})(this);var e=this;return function(h7){if(h7.url){if(!e.isFetch(h7.category)){return}var h6=h7.url||"";if(!e.hostExit(h6)){return}delete h7.url}if(!navigator.onLine){return}e.collections.push(h7);e.checkJob(i)}},runJob:function(){if(this.collections.length===0){clearInterval(this.idleWork);this.idleWork=null;return}var h7=this.collections.slice(0,2);var T=l(JSON.stringify({dataset:h7}));var h6=new Date().getTime();var i=e6.apiIMG+"/blank.gif?product=jsapi&v=gl&l="+T+"&ak="+gr+"&t="+h6;if(this.sender){try{var h9=document.createElement("div");h9.style="width:0;height:0;visibility: hidden;opacity: 0;z-index:-999;background-image: url("+i+");";document.querySelector("BODY").appendChild(h9);setTimeout(function(){document.querySelector("BODY").removeChild(h9)})}catch(h8){}}this.collections.splice(0,2);if(this.collections.length===0){clearInterval(this.idleWork);this.idleWork=null}},checkJob:function(e){if(!this.idleWork&&this._idleWorkerTicker){this.idleWork=setInterval(this._idleWorkerTicker,e)}},urlScope:function(h6){var T={};var h8=Object.keys(fe);if(fe&&h8.length>0){for(var h7 in fe){if(fe[h7]&&(typeof fe[h7]!=="function")){T[h7]=fe[h7]}}}try{var ia=JSON.stringify(T);if(ia.length>2){return h6+"|"+ia}else{return h6}}catch(h9){return h6}},hostExit:function(i){try{if(i&&i.indexOf("//")===0){i=window.location.protocol+i}var T=new URL(i);if(!T||!T.host){return false}var h7=T.host+T.pathname;if(this.ignoreUrl.indexOf(h7)===-1&&this.hosts.indexOf(T.host)>-1){return true}return false}catch(h6){return false}},isFetch:function(e){return this.config[e+"Error"]||false}};br.fetchDebug=aD;var cF={request:function(ig,ij,ib,ic,ih){var ia=new Date().getTime();var h7=(Math.random()*100000).toFixed(0);br._rd["_cbk"+h7]=function(ip){if(ip.result&&ip.result["error"]&&ip.result["error"]===202){alert("该AK因为恶意行为已经被管理员封禁！");return}ib=ib||{};ig&&ig(ip,ib);delete br._rd["_cbk"+h7]};ic=ic||"";var ii;var id;if(ib&&ib.useEncodeURI){ii=hy(ij,encodeURI);id=hy(ij)}else{ii=hy(ij,encodeURIComponent);id=hy(ij)}var io=this;var T=fe.apiHost+"/"+ic+"?"+ii+"&ie=utf-8&oue=1&fromproduct=jsapi";var e=fe.apiHost+"/"+ic+"?"+id+"&ie=utf-8&oue=1&fromproduct=jsapi";if(!ih){T+="&res=api";e+="&res=api"}T+="&callback="+eL+"._rd._cbk"+h7;e+="&callback="+eL+"._rd._cbk"+h7;var i=window.___abvk?window.___abvk:this.getSeckeyCidItem("SECKEY_ABVK");var h9=this.getSeckeyCidItem("BMAP_SECKEY");var ik=encodeURIComponent(i+","+h9);var h8=i+","+h9;T+="&ak="+gr+"&v=gl&seckey="+ik+"&timeStamp="+ia;e+="&ak="+gr+"&v=gl&seckey="+h8+"&timeStamp="+ia;var im="F5L2O6R6AD8990O";var il="H0A9P8P7Y6ABQO0";var h6=e.substr(e.indexOf("?")+1);var ie=md5(md5(h6+im)+il);T+="&sign="+ie.substring(ie.length-12);hB.load(T)},getSeckeyCidItem:function(i){if(navigator.cookieEnabled){var T=new RegExp("(^| )"+i+"=([^;]*)(;|$)");var e=document.cookie.match(T);if(e){return unescape(e[2])}return -1}if(localStorage){return localStorage.getItem(i)?localStorage.getItem(i):-1}if(sessionStorage){return sessionStorage.getItem(i)?localStorage.getItem(i):-1}}};window.srqtimer=null;window.firstTime=true;window.srqcount=0;br._rd={};var E={request:function(h9,e){if(e){var h8=(Math.random()*100000).toFixed(0);BMapGL._rd["_cbk"+h8]=function(ib){e&&e(ib);delete BMapGL._rd["_cbk"+h8]};h9+="&callback=BMapGL._rd._cbk"+h8}function h7(ic){var ib;var id=new RegExp("(^| )"+ic+"=([^;]*)(;|$)");if(ib=document.cookie.match(id)){return unescape(ib[2])}else{return -1}}var T=window.___abvk?window.___abvk:this.getSeckeyCidItem("SECKEY_ABVK");var ia=this.getSeckeyCidItem("BMAP_SECKEY");var i=encodeURIComponent(T+","+ia);h9+="&seckey="+i;var h6=U("script",{src:h9,type:"text/javascript",charset:"utf-8"});if(h6.addEventListener){h6.addEventListener("load",function(ic){var ib=ic.target;ib.parentNode.removeChild(ib)},false);h6.addEventListener("error",function(ib){e&&e([,,,,,])},false)}else{if(h6.attachEvent){h6.attachEvent("onreadystatechange",function(ic){var ib=window.event.srcElement;if(ib&&(ib.readyState=="loaded"||ib.readyState=="complete")){ib.parentNode.removeChild(ib)}})}}document.getElementsByTagName("head")[0].appendChild(h6);h6=null},getSeckeyCidItem:function(i){if(navigator.cookieEnabled){var T=new RegExp("(^| )"+i+"=([^;]*)(;|$)");var e=document.cookie.match(T);if(e){return unescape(e[2])}return -1}if(localStorage){return localStorage.getItem(i)?localStorage.getItem(i):-1}if(sessionStorage){return sessionStorage.getItem(i)?localStorage.getItem(i):-1}}};function ba(){this._map=null;this._container;this._type="control";this.blockInfoWindow=true;this._visible=true}ba.inherits(em,"Control");D.extend(ba.prototype,{initialize:function(e){this._map=e;if(this._container){if(this._opts&&this._opts.container){this._opts.container.appendChild(this._container)}else{e.container.appendChild(this._container)}return this._container}return},_i:function(e){if(!this._container&&this.initialize&&bY(this.initialize)){this._container=this.initialize(e)}this._opts=this._opts||{printable:false};this._setStyle();this._setPosition();if(this._container){this._container._jsobj=this}},_setStyle:function(){var i=this._container;if(i){var e=i.style;e.position="absolute";e.zIndex=this._cZIndex||"10";e.MozUserSelect="none";if(!this._opts.printable){D.ac(i,"BMap_noprint")}D.on(i,"contextmenu",dg)}},remove:function(){this._map=null;if(!this._container){return}this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container._jsobj=null;this._container=null},_render:function(e){if(this._opts&&this._opts.container){this._container=dO(this._opts.container,\'<div unselectable="on"></div>\')}else{var i=\'<div unselectable="on"></div>\';if(e&&e.config.autoSafeArea&&by()){this._safeAreaContainer=dO(this._map.container,i);this._safeAreaContainer.style.position="absolute";this._safeAreaContainer.style.bottom="env(safe-area-inset-bottom)";this._container=dO(this._safeAreaContainer,i)}else{this._container=dO(this._map.container,i)}}if(this._visible===false){this._container.style.display="none"}return this._container},_setPosition:function(){this.setAnchor(this._opts.anchor)},setAnchor:function(h6){if(this.anchorFixed||typeof h6!=="number"||isNaN(h6)||h6<BMAP_ANCHOR_TOP_LEFT||h6>BMAP_ANCHOR_BOTTOM_RIGHT){h6=this.defaultAnchor}this._opts.offset=this._opts.offset||this.defaultOffset;var T=this._opts.anchor;this._opts.anchor=h6;if(!this._container){return}var h8=this._container;var e=this._opts.offset.width;var h7=this._opts.offset.height;h8.style.left=h8.style.top=h8.style.right=h8.style.bottom="auto";switch(h6){case BMAP_ANCHOR_TOP_LEFT:h8.style.top=h7+"px";h8.style.left=e+"px";break;case BMAP_ANCHOR_TOP_RIGHT:h8.style.top=h7+"px";h8.style.right=e+"px";break;case BMAP_ANCHOR_BOTTOM_LEFT:h8.style.bottom=h7+"px";h8.style.left=e+"px";break;case BMAP_ANCHOR_BOTTOM_RIGHT:h8.style.bottom=h7+"px";h8.style.right=e+"px";break;default:break}var i=["TL","TR","BL","BR"];D.rc(this._container,"anchor"+i[T]);D.ac(this._container,"anchor"+i[h6])},getAnchor:function(){return this._opts.anchor},setOffset:function(e){if(!e){return}this._opts=this._opts||{};this._opts.offset=new ei(e.width,e.height);if(!this._container){return}this.setAnchor(this._opts.anchor)},getOffset:function(){return this._opts.offset},getDom:function(){return this._container},show:function(){if(this._visible===true){return}this._visible=true;if(this._container){this._container.style.display=""}this.dispatchEvent(new be("onshow"))},hide:function(){if(this._visible===false){return}this._visible=false;if(this._container){this._container.style.display="none"}this.dispatchEvent(new be("onhide"))},isPrintable:function(){return !!this._opts.printable},isVisible:function(){if(!this._container&&!this._map){return false}return !!this._visible},_asyncLoadCode:function(){var e=this;ej.load("control",function(){if(e._asyncDraw){e._asyncDraw()}})}});var hS={TOP_LEFT:0,TOP_RIGHT:1,BOTTOM_LEFT:2,BOTTOM_RIGHT:3};br.ControlAnchor=hS;window.BMAP_ANCHOR_TOP_LEFT=0;window.BMAP_ANCHOR_TOP_RIGHT=1;window.BMAP_ANCHOR_BOTTOM_LEFT=2;window.BMAP_ANCHOR_BOTTOM_RIGHT=3;function dN(e){ba.call(this);e=e||{};this._opts={printable:false};D.extend(this._opts,e);this._copyrightCollection=[];this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT;this.defaultOffset=new ei(5,2);this.setAnchor(e.anchor);this._canShow=true;this.sateMapStyle=false;this.blockInfoWindow=false;this._asyncLoadCode()}dN.inherits(ba,"CopyrightControl");D.extend(dN.prototype,{initialize:function(e){this._map=e;return this._container},addCopyright:function(h6){var e={minZoom:0,bounds:null,content:"",mapType:""};for(var T in h6){e[T]=h6[T]}if(this._map){var h9=e.minZoom;if(h9===-1||h9<this._map.getMinZoom()||h9>this._map.getMaxZoom()){e.minZoom=this._map.getMinZoom()}if(e.mapType!==""&&!b9[e.mapType]){e.mapType=BMAPGL_NORMAL_MAP}}var h7=this.getCopyright(h6.id);if(h7){for(var h8 in e){h7[h8]=e[h8]}}else{this._copyrightCollection.push(e)}},getCopyright:function(h6){for(var T=0,e=this._copyrightCollection.length;T<e;T++){if(this._copyrightCollection[T].id===h6){return this._copyrightCollection[T]}}},addSateMapStyle:function(){this.sateMapStyle=true;if(this._container){D.ac(this._container,"BMap_cpyCtrl_w")}},removeSateMapStyle:function(){this.sateMapStyle=false;if(this._container){D.rc(this._container,"BMap_cpyCtrl_w")}}});function ek(e){ba.call(this);e=e||{};this.canCheckSize=e.canCheckSize===false?false:true;this.curCityName="";this.curCityCode="";this.defaultOffset=new ei(10,10);this.defaultAnchor=hS.TOP_LEFT;this.onChangeBefore=[];this.onChangeAfter=[];this.onChangeSuccess=[];this._opts={printable:false,offset:e.offset||this.defaultOffset,anchor:e.anchor||this.defaultAnchor,expand:!!(e.expand)};if(e.onChangeBefore&&bY(e.onChangeBefore)){this.onChangeBefore.push(e.onChangeBefore)}if(e.onChangeAfter&&bY(e.onChangeAfter)){this.onChangeAfter.push(e.onChangeAfter)}if(e.onChangeSuccess&&bY(e.onChangeSuccess)){this.onChangeSuccess.push(e.onChangeSuccess)}this.setAnchor(e.anchor);this._asyncLoadCode()}ek.inherits(ba,"CityListControl");D.extend(ek.prototype,{initialize:function(e){this._map=e;return this._container}});function hw(e){ba.call(this);e=e||{};this._opts={printable:false};this._opts=D.extend(D.extend(this._opts,{unit:"metric"}),e);this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT;this.defaultOffset=new ei(81,18);if(gi()){this.defaultOffset=new ei(75,10)}this.setAnchor(e.anchor);this._units={metric:{name:"metric",conv:1,incon:1000,u1:"米",u2:"公里"},us:{name:"us",conv:3.2808,incon:5280,u1:"英尺",u2:"英里"}};this.sateMapStyle=false;if(!this._units[this._opts.unit]){this._opts.unit="metric"}this._scaleText=null;this._numberArray={};this._asyncLoadCode()}window.BMAP_UNIT_METRIC="metric";window.BMAP_UNIT_IMPERIAL="us";hw.inherits(ba,"ScaleControl");D.extend(hw.prototype,{initialize:function(e){this._map=e;return this._container},setUnit:function(e){this._opts.unit=this._units[e]&&this._units[e].name||this._opts.unit},getUnit:function(){return this._opts.unit},addSateMapStyle:function(){this.sateMapStyle=true;var e=this._container;if(e){D.ac(e.children[0],"dark")}},removeSateMapStyle:function(){this.sateMapStyle=false;var e=this._container;if(e){D.rc(e.children[0],"dark")}}});window.BMAP_NAVIGATION_CONTROL_LARGE=0;window.BMAP_NAVIGATION_CONTROL_SMALL=1;window.BMAP_NAVIGATION_CONTROL_PAN=2;window.BMAP_NAVIGATION_CONTROL_ZOOM=3;window.BMAP_NAVIGATION_CONTROL_ANIM=4;function dy(e){ba.call(this);e=e||{};this._opts={printable:false};D.extend(this._opts,e);this.controlHeight=[{width:65,height:227,zoomHeight:227,zoomWidth:37,sliderHeight:180},{width:65,height:47,zoomHeight:(this._opts.forceNew===true)?56:47,zoomWidth:37,sliderHeight:0},{width:37,height:57,zoomHeight:0,zoomWidth:0,sliderHeight:0},{width:26,height:56,zoomHeight:56,zoomWidth:6,sliderHeight:0},{width:56,height:47,zoomHeight:47,zoomWidth:37,sliderHeight:180}];this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT;this.defaultOffset=new ei(10,10);this.setAnchor(e.anchor);this.setType(e.type);this._maxTotalZoomLv=19;this._minZoomLevel=-1;this._maxZoomLevel=-1;this._totalZoomLv=-1;this._sliderInterval=10;this._sliderHeight=180;this._minBarY=1;this._maxBarY=-1;this._curBarY=-1;this._zoomDom=null;this._zoomBtnDom=null;this._sliderDom=null;this._sliderBaseDom=null;this._cZIndex="1100";this._asyncLoadCode()}dy.inherits(ba,"NavigationControl");D.extend(dy.prototype,{initialize:function(e){this._map=e;return this._container},setType:function(e){if(typeof e=="number"&&e>=BMAP_NAVIGATION_CONTROL_LARGE&&e<=BMAP_NAVIGATION_CONTROL_ANIM){this._opts.type=e}else{this._opts.type=BMAP_NAVIGATION_CONTROL_LARGE}},getType:function(){return this._opts.type}});function bF(i){ba.call(this);i=i||{};this._opts={printable:false};this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT;this.defaultOffset=new ei(10,10);this.setAnchor(i.anchor);this._opts=D.extend(D.extend(this._opts,{offset:this.defaultOffset,enableSwitch:true}),i);var e=this;ej.load("control",function(){e._asyncDraw()})}bF.inherits(ba,"MapTypeControl");D.extend(bF.prototype,{initialize:function(e){this._map=e;return this._container},showStreetLayer:function(e){this._map.showStreetLayer(e)}});function cB(e){ba.call(this);e=e||{};this._opts={};this._opts=D.extend(this._opts,e);this._zoomInDisabled=false;this._zoomOutDisabled=false;this._zoomInTapped=false;this._zoomOutTapped=false;this.defaultAnchor=hS.BOTTOM_RIGHT;this.defaultOffset=new ei(15,20);this.setAnchor(e.anchor);this._asyncLoadCode()}cB.inherits(ba,"ZoomControl");D.extend(cB.prototype,{initialize:function(e){this._map=e;return this._container}});function bD(e){ba.call(this);e=e||{};this._opts={autoZoom:true,autoViewport:true};this._opts=D.extend(this._opts,e);this.defaultAnchor=hS.BOTTOM_LEFT;this.defaultOffset=new ei(10,50);this.watchPosition=this._opts.watchPosition||false;this.useCompass=this._opts.useCompass||false;this.locMarker=null;this.locLevel=16;this.setAnchor(this._opts.anchor);this.onLocationStart=e.onLocationStart||null;this._asyncLoadCode()}bD.inherits(ba,"LocationControl");D.extend(bD.prototype,{initialize:function(e){this._map=e;return this._container},startLocation:function(){this._startLocationCalled=true},stopLocationTrace:function(){},setOptions:function(e){e=e||{};D.extend(this._opts,e)}});function ah(e){ba.call(this);e=e||{};this._opts={};this._opts=D.extend(this._opts,e);this.defaultAnchor=hS.BOTTOM_LEFT;this.defaultOffset=new ei(5,15);if(gi()){this.defaultOffset=new ei(10,10)}this.setAnchor(e.anchor)}ah.inherits(ba,"LogoControl");D.extend(ah.prototype,{initialize:function(i){this._map=i;var e=this._container=document.createElement("div");e.innerHTML=\'<img src="\'+fe.apiHost+\'/images/logo_hd.png"  style="height:21px;width:62px;"/>\';i.getContainer().appendChild(e);return e}});function gO(e,i){this._map=e;this._indoorInfo=i;this._visible=true;this._adjustVisible=true;this._isMobile=gi();this._sizeConfig={FLOOR_BTN_HEIGHT:this._isMobile?35:26,SWITCH_ARROW_HEIGHT:this._isMobile?20:15};this._init()}gO.prototype._init=function(){this._render();this._bindDom();this._bind();this._adjustDisplayHeight();var e=new be("onindoor_bar_show");e.uid=this._indoorInfo.uid;this._map.dispatchEvent(e)};gO.prototype._render=function(){if(!this._indoorInfo){return}var ia=this._isMobile;var e=this._div=U("div");D.ac(e,"floor-select-container");ia&&D.ac(e,"mobile");ia&&D.ac(e,"all-border-radius");var i=this._btnTop=U("button");D.ac(i,"floor-switch-top");D.ac(i,"top-border-radius");var h8=U("div");D.ac(h8,"floor-switch-top-icon");i.appendChild(h8);var h7=this._btnBottom=U("button");var T=U("div");D.ac(T,"floor-switch-bottom-icon");h7.appendChild(T);D.ac(h7,"floor-switch-bottom");D.ac(h7,"bottom-border-radius");var h6=this._floorsContainer=U("div");D.ac(h6,"floors-container");h6.appendChild(this._createFloorsDom());this._div.appendChild(i);this._div.appendChild(h6);this._div.appendChild(h7);var ib=0;if(this._btnTop.style.display===""){ib=2*this._sizeConfig.SWITCH_ARROW_HEIGHT}this._div.style.height=parseInt(this._floorsContainer.style.height,10)+ib+"px";this._map.getContainer().appendChild(this._div);if(!ia){var h9=this;setTimeout(function(){h9._div.style.right="20px"},20)}};gO.prototype._createFloorsDom=function(){if(!this._indoorInfo){return}var T=this._ol=U("ol");var h8=this._indoorInfo.currentFloor;for(var h7=this._indoorInfo.floors.length-1;h7>=0;h7--){var h9=this._indoorInfo.floors[h7].floorName;var e=U("li");var h6=U("button");D.ac(h6,"btn-select-floor");if(h7===h8){D.ac(h6,"selected")}h6.setAttribute("data-floor",h7);h6.innerHTML=h9;e.appendChild(h6);T.appendChild(e)}return T};gO.prototype._updateUI=function(){if(!this._ol){this._render();this._bind();this._adjustDisplayHeight();return}this._ol=null;this._ol=this._createFloorsDom();this._floorsContainer.innerHTML="";this._floorsContainer.appendChild(this._ol);this._adjustDisplayHeight()};gO.prototype._bindDom=function(){var e=this;D.on(this._floorsContainer,"click",function(h6){var T=h6.target||h6.srcElement;if(T.tagName.toLowerCase()==="button"){e._map.showIndoor(e._indoorInfo.uid,parseInt(T.getAttribute("data-floor"),10));var i=new be("onindoor_bar_click");i.uid=e._indoorInfo.uid;e._map.dispatchEvent(i)}});D.on(this._floorsContainer,"mouseover",function(T){var i=T.target;if(i.tagName.toLowerCase()==="button"){D.ac(i,"hover")}});D.on(this._floorsContainer,"mouseout",function(T){var i=T.target;if(i.tagName.toLowerCase()==="button"){D.rc(i,"hover")}});D.on(this._floorsContainer,"touchstart",function(T){var i=T.target;if(i.tagName.toLowerCase()==="button"){D.ac(i,"onmousedown")}});D.on(this._floorsContainer,"touchend",function(T){var i=T.target;if(i.tagName.toLowerCase()==="button"){D.rc(i,"onmousedown")}});D.on(this._btnTop,"mouseover",function(i){if(this._disable){return}D.ac(this,"hover")});D.on(this._btnTop,"mouseout",function(i){D.rc(this,"hover")});D.on(this._btnBottom,"mouseover",function(i){if(this._disable){return}D.ac(this,"hover")});D.on(this._btnBottom,"mouseout",function(i){D.rc(this,"hover")});D.on(this._btnTop,"touchstart",function(i){if(this.className.indexOf("disable")>-1){return}D.ac(this,"onmousedown")});D.on(this._btnTop,"touchend",function(i){D.rc(this,"onmousedown")});D.on(this._btnBottom,"touchstart",function(i){if(this.className.indexOf("disable")>-1){return}D.ac(this,"onmousedown")});D.on(this._btnBottom,"touchend",function(i){D.rc(this,"onmousedown")});D.on(this._btnTop,"click",function(i){e._setBarSliderTop(parseInt(e._ol.style.top,10)+26)});D.on(this._btnBottom,"click",function(i){e._setBarSliderTop(parseInt(e._ol.style.top,10)-26)});D.on(this._div,"mousemove",h);D.on(this._div,"wheel",dg);D.on(this._div,"mousewheel",dg);this._map.addEventListener("resize",function(){e._adjustDisplayHeight()})};gO.prototype._adjustDisplayHeight=function(){if(!this._indoorInfo){return}var h8=this._map.getSize().height;var h9=this._sizeConfig.FLOOR_BTN_HEIGHT;var ia=h8-291-100;if(this._isMobile){ia=h8-12-108-this._map.config.bottomOffset}var e=this._indoorInfo.floors.length;var T=e*h9;var h6=e;var ic=0;var id=this._floorsContainer.children[0];if(T>ia){this._showArrow=true;D.rc(id.children[0].children[0],"top-border-radius");D.rc(id.children[e-1].children[0],"bottom-border-radius")}else{this._showArrow=false;D.ac(id.children[0].children[0],"top-border-radius");D.ac(id.children[e-1].children[0],"bottom-border-radius")}while(T>ia){if(h6===0){break}h6--;ic=2*this._sizeConfig.SWITCH_ARROW_HEIGHT;T=h6*h9+ic}this._currentDisplayHeight=T;if(h6<3){this._setAdjustVisbile(false)}else{this._setAdjustVisbile(true)}this._floorsContainer.style.height=h6*h9+"px";var h7=this._indoorInfo.currentFloor;var i=e-h7;var ib=h7-1;this._div.style.height=parseInt(this._floorsContainer.style.height,10)+ic+"px";var ie=-(e-(h7+Math.round(h6/2)))*h9;this._setBarSliderTop(ie);if(h6<e){D.show(this._btnTop);D.show(this._btnBottom)}else{D.hide(this._btnTop);D.hide(this._btnBottom);this._setBarSliderTop(0)}if(this._isMobile){this._div.style.bottom=108+this._map.config.bottomOffset+"px"}};gO.prototype._setBarSliderTop=function(h6){var T=26;var i=this._indoorInfo.floors.length;var e=i*T;if(this._currentDisplayHeight){if(this._showArrow){e=this._currentDisplayHeight-30}else{e=this._currentDisplayHeight}}if(e-h6>=i*T){h6=e-i*T;D.ac(this._btnBottom,"disable");D.rc(this._btnBottom,"hover");this._btnBottom._disable=true}else{D.rc(this._btnBottom,"disable");this._btnBottom._disable=false}if(h6>=0){h6=0;D.ac(this._btnTop,"disable");D.rc(this._btnTop,"hover");this._btnTop._disable=true}else{D.rc(this._btnTop,"disable");this._btnTop._disable=false}this._ol.style.top=h6+"px"};gO.prototype._setAdjustVisbile=function(e){if(this._adjustVisible===e){return}this._adjustVisible=e;if(e&&this._visible){this._div.style.right="20px"}else{this._div.style.right="-30px"}};gO.prototype._bind=function(){var i=this._map;var e=this;i.on("indoor_status_changed",function(ia){if(e._visible===false){return}var T=e._ol;var h8=ia.uid;if(!h8){return}var h9=ia.floor;for(var h7=0;h7<T.children.length;h7++){var h6=T.children[h7].children[0];if(parseInt(h6.getAttribute("data-floor"),10)===h9){D.ac(h6,"selected")}else{D.rc(h6,"selected")}}});i.on("zoomend",function(T){if(this.getZoom()<17){e._setAdjustVisbile(false)}else{e._setAdjustVisbile(true)}})};gO.prototype.setInfo=function(e){if(this._indoorInfo&&this._indoorInfo.uid===e.uid){return}this._indoorInfo=e;this._updateUI()};gO.prototype.show=function(){if(this._visible===true){return}this._visible=true;if(!this._isMobile){this._div.style.right="20px"}else{this._div.style.display=""}var e=new be("onindoor_bar_show");e.uid=this._indoorInfo.uid;this._map.dispatchEvent(e)};gO.prototype.hide=function(){if(this._visible===false){return}this._visible=false;if(!this._isMobile){this._div.style.right="-30px"}else{this._div.style.display="none"}};function e5(e){this._opts=e||{};this.defaultOffset=new ei(2,80);this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT;if(this._opts.anchor===undefined){this.setAnchor(this.defaultAnchor)}else{this.setAnchor(this._opts.anchor)}this._firstAnimation=true}e5.inherits(ba,"NavigationControl3D");D.extend(e5.prototype,{initialize:function(T){this._map=T;this._createDom();this._bindDom();this._bind();if(!gi()){this._headingControl=new hV(this._map,this._div)}this._tiltControl=new eB(this._map,this._div);this._render();var i=this._map.getMapType();var e=this;if(i==="B_EARTH_MAP"||this._map._renderType==="webgl"){e._div.style.opacity="1";e._div.style.visibility="visible"}else{e._div.style.opacity="0";e._div.style.visibility="hidden"}return this._container},_createDom:function(){var i=this._div=document.createElement("div");this._container=i;var e=i.style;e.position="absolute";e.zIndex=5;e.width="52px";e.height="82px";e.right="-3px";e.bottom="79px";e.opacity="0";e.visibility="hidden";e.WebkitTransition=e.transition="opacity .3s ease-out,visibility .3s ease-out"},_render:function(){var e=document.getElementById("map-operate");if(e){e.appendChild(this._div)}else{this._map.getContainer().appendChild(this._div)}},_bindDom:function(){this._div.addEventListener("mousemove",h)},_bind:function(){if(this._map._renderType==="webgl"){return}var e=this;this._map.on("maptypechange",function(){if(this.mapType==="B_EARTH_MAP"){if(e._firstAnimation){e._firstAnimation=false;setTimeout(function(){e._div.style.opacity="1";e._div.style.visibility="visible"},300)}else{e._div.style.opacity="1";e._div.style.visibility="visible"}}else{e._div.style.opacity="0";e._div.style.visibility="hidden"}})}});function hV(T,i){this._map=T;this._target=T;var h6=T.temp.originMapType||T.mapType;if(h6==="B_EARTH_MAP"&&T._earth){this._target=T._earth}this._outContainer=i||T.getContainer();this._imgRatio=a9()>=dd.HIGH_RES_MIN_RATIO?2:1;this._imgPath=fe.imgPath+"earth-navi-control-pc4"+(this._imgRatio===2?"-2x.png":".png");this._enabled=true;var e=this;this._setHeadingOptions={callback:function(){e._target.setLock(false)}};this._init()}D.extend(hV.prototype,{_init:function(){this._createDom();this._render();this._bindDom();this._bind();this._updateUI();this._checkEnable()},_checkEnable:function(){if(this._target.getZoom()>=this._target._enableHeadingZoom){this.enable()}else{this.disable()}},_createDom:function(){var i=this._div=U("div");var e=i.style;e.position="absolute";e.zIndex=5;e.top="0";e.left="0";e.width="52px";e.height="54px";e.background="url("+this._imgPath+") no-repeat";e.backgroundSize="266px auto";this._rotateCCW=this._createButton();this._rotateCCW.title="逆时针转动";e=this._rotateCCW.style;e.left="2px";e.top="5px";e.zIndex="1";e.width="15px";e.height="42px";e.backgroundPosition="-75px -5px";this._rotateCW=this._createButton();this._rotateCW.title="顺时针转动";e=this._rotateCW.style;e.right="2px";e.top="5px";e.zIndex="1";e.width="15px";e.height="42px";e.backgroundPosition="-75px -5px";e.WebkitTransform=e.transform="scaleX(-1)";this._compass=this._createButton();this._compass.title="恢复正北方向";e=this._compass.style;e.left="19px";e.top="4px";e.width="14px";e.height="44px";e.backgroundPosition="-56px -4px";e.WebkitTransform=e.transform="rotate(0deg)";this._div.appendChild(this._rotateCCW);this._div.appendChild(this._compass);this._div.appendChild(this._rotateCW);this._domRendered=true},_createButton:function(){var e=U("button");var i=e.style;i.position="absolute";i.outline="none";i.border="none";i.background="url("+this._imgPath+") no-repeat";i.backgroundSize="266px auto";i.cursor="pointer";return e},_render:function(){this._outContainer.appendChild(this._div)},enable:function(){this._enabled=true;if(this._domRendered){this._rotateCCW.style.cursor="pointer";this._rotateCCW.style.opacity=1;this._rotateCW.style.cursor="pointer";this._rotateCW.style.opacity=1;this._compass.style.cursor="pointer";this._compass.style.opacity=1}},disable:function(){this._enabled=false;if(this._domRendered){this._rotateCCW.style.cursor="";this._rotateCCW.style.opacity=0.4;this._rotateCW.style.cursor="";this._rotateCW.style.opacity=0.4;this._compass.style.cursor="";this._compass.style.opacity=0.4}},_bindDom:function(){eV(this._div,["mousedown","click","dblclick"]);var i=this._map;var e=this;this._rotateCW.addEventListener("click",function(){if(e._isOperating||e._enabled===false){return}if(e._target.getLock()){return}if(e._target.getHeading()===360){e._target.setHeading(0)}e._target.setLock(true);e._target.setHeading(e._target.getHeading()+90,e._setHeadingOptions);i.fire(new be("onrotatecwclick"))},false);this._rotateCCW.addEventListener("click",function(){if(e._isOperating||e._enabled===false){return}if(e._target.getLock()){return}if(e._target.getHeading()===-360){e._target.setHeading(0)}e._target.setLock(true);e._target.setHeading(e._target.getHeading()-90,e._setHeadingOptions);i.fire(new be("onrotateccwclick"))},false);this._rotateCW.addEventListener("mouseover",function(){if(e._enabled===false){return}this.style.backgroundPosition="-89px -5px"},false);this._rotateCW.addEventListener("mouseout",function(){if(e._enabled===false){return}this.style.backgroundPosition="-75px -5px"},false);this._rotateCCW.addEventListener("mouseover",function(){if(e._enabled===false){return}this.style.backgroundPosition="-89px -5px"},false);this._rotateCCW.addEventListener("mouseout",function(){if(e._enabled===false){return}this.style.backgroundPosition="-75px -5px"},false);this._compass.addEventListener("click",function(){if(e._isOperating||e._enabled===false){return}if(e._target.getLock()){return}e._target.setLock(true);var T=false;if(e._target.getTilt()!==0){T=true;e._target.setTilt(0,e._setHeadingOptions)}if(e._target.getHeading()%360!==0){T=true;e._target.resetHeading(e._setHeadingOptions)}if(!T){e._target.setLock(false)}i.fire(new be("oncompassclick"))},false)},_bind:function(){var e=this;this._bindTarget(this._target);if(this._map._renderType==="webgl"){this._map.addEventListener("maptypechange",function(i){if(this.mapType==="B_EARTH_MAP"){e._target=e._map._earth}else{e._target=e._map}e._bindTarget(e._target);e._checkEnable()})}},_bindTarget:function(i){if(i===this._map&&this._mapBinded){return}if(i===this._map._earth&&this._earthBinded){return}var e=this;i.addEventListener("heading_changed",function(T){e._updateUI()});i.addEventListener("animation_start",function(T){e._isOperating=true});i.addEventListener("animation_end",function(T){e._isOperating=false});i.on("load",function(){e._checkEnable()});i.on("zoom_changed",function(){e._checkEnable()});if(i===this._map){this._mapBinded=true}else{this._earthBinded=true}},_updateUI:function(){var e=this._target.getHeading();var i=this._compass.style;i.WebkitTransform=i.transform="rotate("+e+"deg)"},hide:function(){this._div.style.display="none"},show:function(){this._div.style.display="block"}});function eB(T,i){this._map=T;this._target=T;var h6=T.temp.originMapType||T.mapType;if(h6==="B_EARTH_MAP"&&T._earth){this._target=T._earth}this._outContainer=i||T.getContainer();this._imgRatio=a9()>=dd.HIGH_RES_MIN_RATIO?2:1;this._imgPath=fe.imgPath+"gl-navi-control-pc4"+(this._imgRatio===2?"-2x.png":".png");this._enabled=true;var e=this;this._setTiltOptions={callback:function(){e._target.setLock(false)}};this._init()}D.extend(eB.prototype,{_init:function(){this._createDom();this._render();this._bindDom();this._bind();this._checkEnable()},_checkEnable:function(){if(this._target.getZoom()>=this._target._enableTiltZoom){this.enable()}else{this.disable()}},_createDom:function(){var e=this._div=U("button");e.title="倾斜";var i=e.style;i.position="absolute";i.zIndex=5;i.outline="none";i.border="none";i.cursor="pointer";i.width="26px";i.height="26px";i.top="56px";i.right="13px";i.background="url("+this._imgPath+") no-repeat #fff";i.backgroundSize="266px auto";i.backgroundPosition="-110px 1px";i.boxShadow="1px 2px 1px rgba(0, 0, 0, 0.15)"},enable:function(){this._enabled=true;if(this._div){this._div.style.cursor="pointer"}this._updateUI()},disable:function(){this._enabled=false;if(this._div){this._div.style.cursor=""}this._updateUI()},_render:function(){this._outContainer.appendChild(this._div)},_bindDom:function(){var e=this;this._div.addEventListener("mousedown",function(h6){if(!e._enabled){return}if(e._target.getLock()){return}var i=e._target.getTilt();var T;if(i===e._map.getCurrentMaxTilt()){T="out"}else{if(i===0){T="in"}else{T=e._preTrend?e._preTrend:"in"}}e._curTrend=T;e._clickTimer=setTimeout(function(){e._map.fire(new be("ontiltmsdown"));e._tiltAni=new p({duration:9999999,render:function(h7){i=e._target.getTilt();if(T==="in"&&i<e._map.getCurrentMaxTilt()){e._target.setTilt(i+1,{noAnimation:true})}else{if(T==="out"&&i>0){e._target.setTilt(i-1,{noAnimation:true})}}},finish:function(){e._tiltAni=null}});e._clickTimer=null},200);h6.stopPropagation()},false);this._div.addEventListener("mouseup",function(i){if(!e._enabled){return}if(e._tiltAni){e._tiltAni.stop()}e._preTrend=e._curTrend},false);this._div.addEventListener("click",function(h6){if(!e._enabled){return}if(!e._clickTimer){return}if(e._target.getLock()){return}clearTimeout(e._clickTimer);e._map.fire(new be("ontiltclick"));var i=e._target.getTilt();e._target.setLock(true);h6.stopPropagation();var T=e._map.getCurrentMaxTilt();if(e._curTrend==="in"){e._target.setTilt(T,e._setTiltOptions)}else{if(e._curTrend==="out"){e._target.setTilt(0,e._setTiltOptions)}else{if(i<T){e._target.setTilt(T,e._setTiltOptions)}else{e._target.setTilt(0,e._setTiltOptions)}}}},false);this._div.addEventListener("mouseover",function(i){if(!e._enabled){return}e._mouseOver=true;e._updateUI()},false);this._div.addEventListener("mouseout",function(i){if(!e._enabled){return}e._mouseOver=false;e._updateUI()},false);eV(this._div,["mousedown","click","dblclick"])},_bind:function(){var e=this;var i=this._map;this._bindTarget(this._target);if(this._map._renderType==="webgl"){this._map.addEventListener("maptypechange",function(T){if(this.mapType==="B_EARTH_MAP"){e._target=e._map._earth}else{e._target=e._map}e._bindTarget(e._target);e._checkEnable()})}},_bindTarget:function(i){if(i===this._map&&this._mapBinded){return}if(i===this._map._earth&&this._earthBinded){return}var e=this;i.on("load",function(){e._checkEnable()});i.on("zoom_changed",function(){e._checkEnable()});i.on("tilt_changed",function(){e._updateUI()});if(i===this._map){this._mapBinded=true}else{this._earthBinded=true}},_updateUI:function(){var T=this._target.getTilt();var i=0;var h6=0;var e=0;if(T>0){i=78}if(this._mouseOver){e=52}if(this._enabled===false){h6=26;e=0;i=0}var h7="-"+(110+i+h6+e)+"px 1px";this._div&&(this._div.style.backgroundPosition=h7);if(this._enabled){if(T>0){this._div&&(this._div.title="恢复")}else{this._div&&(this._div.title="倾斜")}}else{this._div&&(this._div.title="请放大地图后操作")}},hide:function(){this._div.style.display="none"},show:function(){this._div.style.display="block"}});function ci(i){em.call(this);this._opts={container:null,cursor:"default"};this._opts=D.extend(this._opts,i);this._type="contextmenu";this._map=null;this._container;this._left=0;this._top=0;this._items=[];this._rItems=[];this._dividers=[];this._enable=true;this.curPixel=null;this.curPoint=null;this._isOpen=false;var e=this;ej.load("menu",function(){e._draw()})}ci.inherits(em,"ContextMenu");D.extend(ci.prototype,{initialize:function(e){this._map=e},remove:function(){this._map=null},addItem:function(h7,e){if(!h7||h7._type!="menuitem"||h7._text==""||h7._width<=0){return}for(var h6=0,T=this._items.length;h6<T;h6++){if(this._items[h6]===h7){return}}if(e===undefined||e>this._items.length-1){e=-1}h7._insertIndex=e;if(e===-1){this._items.push(h7);this._rItems.push(h7)}else{this._items.splice(e,0,h7);this._rItems.splice(e,0,h7)}},removeItem:function(h6){if(!h6||h6._type!="menuitem"){return}for(var T=0,e=this._items.length;T<e;T++){if(this._items[T]===h6){this._items[T].remove();this._items.splice(T,1);delete h6._insertIndex;e--}}for(var T=0,e=this._rItems.length;T<e;T++){if(this._rItems[T]===h6){this._rItems[T].remove();this._rItems.splice(T,1);delete h6._insertIndex;e--}}},addSeparator:function(e){if(e===undefined||e>this._items.length-1){e=-1}var i={_type:"divider",_dIndex:this._dividers.length,_insertIndex:e};this._dividers.push({dom:null});if(e===-1){this._items.push(i)}else{this._items.splice(e,0,i)}},removeSeparator:function(T){if(!this._dividers[T]){return}for(var h6=0,e=this._items.length;h6<e;h6++){if(this._items[h6]&&this._items[h6]._type=="divider"&&this._items[h6]._dIndex==T){this._items.splice(h6,1);e--}if(this._items[h6]&&this._items[h6]._type=="divider"&&this._items[h6]._dIndex>T){this._items[h6]._dIndex--}}this._dividers.splice(T,1)},getDom:function(){return this._container},show:function(){if(this._isOpen==true){return}this._isOpen=true},hide:function(){if(this._isOpen==false){return}this._isOpen=false},setCursor:function(e){if(!e){return}this._opts.cursor=e},getItem:function(e){return this._rItems[e]},enable:function(){this._enable=true},disable:function(){this._enable=false}});function fK(T,h6,i){if(!T||!h6||typeof h6!="function"){return}em.call(this);this._opts={width:100,id:""};i=i||{};this._opts.width=(i.width*1)?i.width:100;this._opts.id=i.id?i.id:"";this._text=T+"";this._callback=h6;this._map=null;this._type="menuitem";this._contextmenu=null;this._container=null;this._enabled=true;var e=this;ej.load("menu",function(){e._draw()})}fK.inherits(em,"MenuItem");D.extend(fK.prototype,{initialize:function(e,i){this._map=e;this._contextmenu=i},remove:function(){this._contextmenu=null;this._map=null},setText:function(e){if(!e){return}this._text=e+""},getDom:function(){return this._container},enable:function(){this._enabled=true},disable:function(){this._enabled=false}});function dZ(e,i){this.setSouthWest(e);this.setNorthEast(i)}D.extend(dZ.prototype,{isEmpty:function(){return this.sw===null&&this.ne===null},equals:function(e){if(!e||e.isEmpty()||this.isEmpty()){return false}return this.sw.equals(e.sw)&&this.ne.equals(e.ne)},containsBounds:function(e){if(!e||e.isEmpty()||this.isEmpty()){return false}return(e.sw.lng>this.sw.lng&&e.ne.lng<this.ne.lng&&e.sw.lat>this.sw.lat&&e.ne.lat<this.ne.lat)},getCenter:function(){if(this.isEmpty()){return null}return new hH((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)},intersects:function(T){if(!T||T.isEmpty()||this.isEmpty()){return null}if(Math.max(T.sw.lng,T.ne.lng)<Math.min(this.sw.lng,this.ne.lng)||Math.min(T.sw.lng,T.ne.lng)>Math.max(this.sw.lng,this.ne.lng)||Math.max(T.sw.lat,T.ne.lat)<Math.min(this.sw.lat,this.ne.lat)||Math.min(T.sw.lat,T.ne.lat)>Math.max(this.sw.lat,this.ne.lat)){return null}var h7=Math.max(this.sw.lng,T.sw.lng);var i=Math.min(this.ne.lng,T.ne.lng);var h6=Math.max(this.sw.lat,T.sw.lat);var e=Math.min(this.ne.lat,T.ne.lat);return new dZ(new hH(h7,h6),new hH(i,e))},setMinMax:function(){this.minX=this.sw?this.sw.lng:null;this.minY=this.sw?this.sw.lat:null;this.maxX=this.ne?this.ne.lng:null;this.maxY=this.ne?this.ne.lat:null},containsPoint:function(e){if(!e){return}return(e.lng>=this.sw.lng&&e.lng<=this.ne.lng&&e.lat>=this.sw.lat&&e.lat<=this.ne.lat)},extend:function(e){if(!e){return}var i=e.lng;var T=e.lat;if(!this.sw){this.sw=e.clone()}if(!this.ne){this.ne=e.clone()}if(this.sw.lng>i){this.sw.lng=i}if(this.ne.lng<i){this.ne.lng=i}if(this.sw.lat>T){this.sw.lat=T}if(this.ne.lat<T){this.ne.lat=T}},getMin:function(){return this.sw},getMax:function(){return this.ne},getSouthWest:function(){return this.sw},getNorthEast:function(){return this.ne},setSouthWest:function(e){this.sw=e?e.clone():null},setNorthEast:function(e){this.ne=e?e.clone():null},clone:function(){return new dZ(this.sw,this.ne)},toSpan:function(){if(this.isEmpty()){return new ei(0,0)}return new ei(Math.abs(this.ne.lng-this.sw.lng),Math.abs(this.ne.lat-this.sw.lat))},div:function(e){if(!e||e.isEmpty()||this.isEmpty()){return 0}return((this.ne.lng-this.sw.lng)*(this.ne.lat-this.sw.lat))/((e.ne.lng-e.sw.lng)*(e.ne.lat-e.sw.lat))},makeNormalizedPoint:function(e){this.normalizedTopLeft=this.pointTopLeft.clone();this.normalizedTopRight=this.pointTopRight.clone();this.normalizedBottomRight=this.pointBottomRight.clone();this.normalizedBottomLeft=this.pointBottomLeft.clone();while(e<0){e+=360}e=e%360;if(e>=0&&e<90||e>=270&&e<360){if(this.normalizedTopRight.lng<this.normalizedTopLeft.lng){this.normalizedTopRight.lng+=dd.WORLD_SIZE_MC}if(this.normalizedBottomRight.lng<this.normalizedBottomLeft.lng){this.normalizedBottomRight.lng+=dd.WORLD_SIZE_MC}}else{if(this.normalizedTopLeft.lng<this.normalizedTopRight.lng){this.normalizedTopLeft.lng+=dd.WORLD_SIZE_MC}if(this.normalizedBottomLeft.lng<this.normalizedBottomRight.lng){this.normalizedBottomLeft.lng+=dd.WORLD_SIZE_MC}}},toString:function(){return"Bounds"}});function hH(e,i){if(isNaN(e)){e=hf(e);e=isNaN(e)?0:e}if(typeof e==="string"){e=parseFloat(e)}if(isNaN(i)){i=hf(i);i=isNaN(i)?0:i}if(typeof i==="string"){i=parseFloat(i)}this.lng=e;this.lat=i}hH.prototype.equals=function(i){if(!i){return false}var h6=Math.abs(this.lat-i.lat);var T=Math.abs(this.lng-i.lng);var e=1e-8;if(h6<e&&T<e){return true}return false};hH.prototype.clone=function(){return new hH(this.lng,this.lat)};hH.prototype.add=function(e){return new hH(this.lng+e.lng,this.lat+e.lat)};hH.prototype.sub=function(e){return new hH(this.lng-e.lng,this.lat-e.lat)};hH.prototype.mult=function(e){return new hH(this.lng*e,this.lat*e)};hH.prototype.div=function(e){return new hH(this.lng/e,this.lat/e)};hH.prototype.mag=function(){return Math.sqrt(this.lng*this.lng+this.lat*this.lat)};hH.prototype.toString=function(){return"Point"};function ew(){}D.extend(ew,{EARTHRADIUS:6370996.81,MCBAND:[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],LLBAND:[86,60,45,30,15,0],MC2LL:[[1.410526172116255e-8,0.00000898305509648872,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-0.03801003308653,17337981.2],[-7.435856389565537e-9,0.000008983055097726239,-0.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,0.00000898305509983578,0.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,0.32710905363475,6856817.37],[-1.981981304930552e-8,0.000008983055099779535,0.03278182852591,40.31678527705744,0.65659298677277,-4.44255534477492,0.85341911805263,0.12923347998204,-0.04625736007561,4482777.06],[3.09191371068437e-9,0.000008983055096812155,0.00006995724062,23.10934304144901,-0.00023663490511,-0.6321817810242,-0.00663494467273,0.03430082397953,-0.00466043876332,2555164.4],[2.890871144776878e-9,0.000008983055095805407,-3.068298e-8,7.47137025468032,-0.00000353937994,-0.02145144861037,-0.00001234426596,0.00010322952773,-0.00000323890364,826088.5]],LL2MC:[[-0.0015702102444,111320.7020616939,1704480524535203,-10338987376042340,26112667856603880,-35149669176653700,26595700718403920,-10725012454188240,1800819912950474,82.5],[0.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[0.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[0.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-0.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-0.0003218135878613132,111320.7020701615,0.00369383431289,823725.6402795718,0.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,0.37238884252424,7.45]],getDistanceByMC:function(h8,h6){if(!h8||!h6){return 0}var i;var h7;var e;var T;h8=this.convertMC2LL(h8);if(!h8){return 0}i=dQ(h8.lng);h7=dQ(h8.lat);h6=this.convertMC2LL(h6);if(!h6){return 0}e=dQ(h6.lng);T=dQ(h6.lat);return this.getDistance(i,e,h7,T)},getDistanceByLL:function(h8,h6){if(!h8||!h6){return 0}h8.lng=this.getLoop(h8.lng,-180,180);h8.lat=this.getRange(h8.lat,-80,84);h6.lng=this.getLoop(h6.lng,-180,180);h6.lat=this.getRange(h6.lat,-80,84);var i;var e;var h7;var T;i=dQ(h8.lng);h7=dQ(h8.lat);e=dQ(h6.lng);T=dQ(h6.lat);return this.getDistance(i,e,h7,T)},proximityCovertMC2LL:function(e){if(e===null){return e}if(e.lng<180&&e.lng>-180&&e.lat<90&&e.lat>-90){return e}return this.convertMC2LL(e)},convertMC2LL:function(e){if(e===null){return e}if(!e){return new hH(0,0)}var T;var h7;T=new hH(Math.abs(e.lng),Math.abs(e.lat));for(var h6=0;h6<this.MCBAND.length;h6++){if(T.lat>=this.MCBAND[h6]){h7=this.MC2LL[h6];break}}var h8=this.convertor(e,h7);return new c8(h8.lat,h8.lng)},convertLL2MC:function(h9){if(!h9){return new hH(0,0)}var ib=h9.lat;var h6=h9.lng;h6=this.getLoop(h9.lng,-180,180);ib=fR(ib,-85,85);var h8;for(var h7=0;h7<this.LLBAND.length;h7++){if(ib>=this.LLBAND[h7]){h8=this.LL2MC[h7];break}}if(!h8){for(h7=0;h7<this.LLBAND.length;h7++){if(ib<=-this.LLBAND[h7]){h8=this.LL2MC[h7];break}}}var T=new hH(h6,ib);var ia=this.convertor(T,h8);var e=new hH(ia.lng,ia.lat);e.latLng=new c8(h9.lat,h9.lng);return e},convertor:function(T,h6){if(!T||!h6){return}var e=h6[0]+h6[1]*Math.abs(T.lng);var i=Math.abs(T.lat)/h6[9];var h7=h6[2]+h6[3]*i+h6[4]*i*i+h6[5]*i*i*i+h6[6]*i*i*i*i+h6[7]*i*i*i*i*i+h6[8]*i*i*i*i*i*i;e*=(T.lng<0?-1:1);h7*=(T.lat<0?-1:1);return new hH(e,h7)},getDistance:function(i,e,h6,T){return this.EARTHRADIUS*Math.acos((Math.sin(h6)*Math.sin(T)+Math.cos(h6)*Math.cos(T)*Math.cos(e-i)))},getRange:function(T,i,e){if(i!=null){T=Math.max(T,i)}if(e!=null){T=Math.min(T,e)}return T},getLoop:function(T,i,e){while(T>e){T-=e-i}while(T<i){T+=e-i}return T}});D.extend(ew.prototype,{lnglatToMercator:function(e){return ew.convertLL2MC(e)},lngLatToPoint:function(e){var i=ew.convertLL2MC(e);return new es(i.lng,i.lat)},mercatorToLnglat:function(e){return ew.convertMC2LL(e)},pointToLngLat:function(i){var e=new hH(i.x,i.y);var T=ew.convertMC2LL(e);return new c8(T.lat,T.lng)},pointToPixel:function(i,h8,h7,h6){if(!i){return}i=this.lnglatToMercator(i);var T=this.getZoomUnits(h8);var e=Math.round((i.lng-h7.lng)/T+h6.width/2);var h9=Math.round((h7.lat-i.lat)/T+h6.height/2);return new es(e,h9)},mercatorToPixel:function(h8,h7,h6,T){if(!h8){return}var i=this.getZoomUnits(h7);var e=Math.round((h8.lng-h6.lng)/i+T.width/2);var h9=Math.round((h6.lat-h8.lat)/i+T.height/2);return new es(e,h9)},pixelToPoint:function(h6,h9,h8,h7){if(!h6){return}var i=this.getZoomUnits(h9);var T=h8.lng+i*(h6.x-h7.width/2);var ia=h8.lat-i*(h6.y-h7.height/2);var e=new hH(T,ia);return this.mercatorToLnglat(e)},tileToBound:function(h6,ia){var i=h6.col;var id=h6.row;var ic=h6.baseTileSize;var ib=this.getZoomUnits(h6.zoom);var T={x:Math.round(ia.lng/ib),y:Math.round(ia.lat/ib)};var h8={lbx:i*ic,lby:id*ic,rtx:(i+1)*ic,rty:(id+1)*ic};var e={lbx:ia.lng+(h8.lbx-T.x)*ib,lby:ia.lat+(h8.lby-T.y)*ib,rtx:ia.lng+(h8.rtx-T.x)*ib,rty:ia.lat+(h8.rty-T.y)*ib};var h7=ew.convertMC2LL(new hH(e.lbx,e.lby));var h9=ew.convertMC2LL(new hH(e.rtx,e.rty));return{MC:new dZ(new hH(e.lbx,e.lby),new hH(e.rtx,e.rty)),LL:new dZ(h7,h9)}},getZoomUnits:function(e){return Math.pow(2,(18-e))},setCoordType:function(e){this.coordsType=e}});function eE(){}D.extend(eE,{RADIUS:6378137,EXTENT4326:[-180,-90,180,90],WORLD_EXTENT:[-180,-85,180,85],HALF_SIZE:20037508.342789244,METERS_PER_UNIT:111319.49079327358,EXTENT3857:[-20037508.342789244,-20037508.342789244,20037508.342789244,20037508.342789244],MAX_SAFE_Y:238107693.26496765,origin:[-20037508.342789244,20037508.342789244],size:156543.03392804097,gridSize:[256,256],resolutions:[156543.03392804097,78271.51696402048,39135.75848201024,19567.87924100512,9783.93962050256,4891.96981025128,2445.98490512564,1222.99245256282,611.49622628141,305.748113140705,152.8740565703525,76.43702828517625,38.21851414258813,19.109257071294063,9.554628535647032,4.777314267823516,2.388657133911758,1.194328566955879,0.5971642834779395,0.29858214173896974,0.14929107086948487,0.07464553543474244,0.03732276771737122],calcResolutions:function(i){this.resolutions=[];for(var e=0;e<i;++e){this.resolutions.push(this.size/Math.pow(2,e))}return this.resolutions},forEachTileCoord:function(ic,ib,T,h9){var e=this.getTileRangeForExtentFactory(ic,ib,T);for(var h7=e.minX,ia=e.maxX;h7<=ia;++h7){for(var h6=e.minY,h8=e.maxY;h6<=h8;++h6){h9([ib,h7,h6])}}},getTileRangeForExtentFactory:function(T,h7,i,h6){var e;switch(i.source){case"BD09MC":e=this.getBDTileRangeForExtentAndZ(T,h7,h6);break;case"EPSG3857":e=this.getTileRangeForExtentAndZ(T,h7,h6);break;default:e=this.getTileRangeForExtentAndZ(T,h7,h6);break}return e},getBDTileRangeForExtentAndZ:function(T,h7,h6){var i=[0,0,0];this.getBDTileCoordForXYAndZ_(T[0],T[1],h7,false,i);var e=i[1];var h8=i[2];this.getBDTileCoordForXYAndZ_(T[2],T[3],h7,true,i);return this.createOrUpdateTileRange(e,i[1],h8,i[2],h6)},getTileRangeForExtentAndZ:function(T,h7,h6){var i=[0,0,0];this.getTileCoordForXYAndZ_(T[0],T[3],h7,false,i);var e=i[1];var h8=i[2];this.getTileCoordForXYAndZ_(T[2],T[1],h7,true,i);return this.createOrUpdateTileRange(e,i[1],h8,i[2],h6)},getBDTileCoordForXYAndZ_:function(e,ia,h8,h7,h6){var h9=256*Math.pow(2,(18-h8));var T=e/h9;var i=ia/h9;if(h7){T=Math.ceil(T)-1;i=Math.ceil(i)-1}else{T=Math.floor(T);i=Math.floor(i)}return this.createOrUpdateTileCoord(h8,T,i,h6)},getTileCoordForXYAndZ_:function(id,ic,ia,ib,e){var ie=this.origin;var i=(this.resolutions.length===0?this.calcResolutions(21)[ia]:this.resolutions[ia]);var ih=this.gridSize;var h6=ib?0.5:0;var T=ib?0.5:0;var ig=Math.floor((id-ie[0])/i+h6);var h8=Math.floor((ie[1]-ic)/i+T);var h9=ig/ih[0];var h7=h8/ih[1];if(ib){h9=Math.ceil(h9)-1;h7=Math.ceil(h7)-1}else{h9=Math.floor(h9);h7=Math.floor(h7)}return this.createOrUpdateTileCoord(ia,h9,h7,e)},getTileCoordForCoordAndZ:function(T,i,e){return this.getTileCoordForXYAndZ_(T[0],T[1],i,false,e)},getTileRangeExtent:function(T,h9){var ia=this.origin;if(this.resolutions.length===0){this.calcResolutions(23)}var h7=this.resolutions[T[0]];var ib=this.gridSize;var h8=ia[0]+T[1]*ib[0]*h7;var h6=ia[1]-(T[2]+1)*ib[1]*h7;var i=h8+ib[0]*h7;var e=h6+ib[1]*h7;return this.createOrUpdateTileRange(h8,i,h6,e,h9)},getRangeExtent:function(i,ie,ia,ih,h6){var ib=this.calPiexlResolution(ih,h6);var h9=ie/2*ib;var ic=ia/2*ib;var h8=i[0]-h9;var T=i[0]+h9;var h7=i[1]-ic;var e=i[1]+ic;var id=gcoord.transform([h8,h7],gcoord[h6.target],gcoord[h6.source]);var ig=gcoord.transform([T,e],gcoord[h6.target],gcoord[h6.source]);return this.createOrUpdateTileRange(id[0],ig[0],id[1],ig[1])},getMousePoint:function(h9,h8,i,h7,T){var h6=aK(h9,h8);return this.calLngLatByMapViewPixelInverse(h6.clientPos,i,h8.width,h8.height,h7,T)},calLngLatByMapViewPixelInverse:function(h6,e,i,id,ie,T){var h9=this.calPiexlResolution(ie,T);var h8=h6.x-i/2;var h7=h6.y-id/2;var ib=e[0]+h8*h9;var ia=e[1]-h7*h9;var ic=gcoord.transform([ib,ia],gcoord[T.target],gcoord[T.source]);return ic},calPiexlResolution:function(T,i){var e;switch(i.target){case"BD09MC":e=Math.pow(2,(18-T));break;case"EPSG3857":e=this.resolutions[Math.floor(T)];break;default:e=Math.pow(2,(18-T));break}return e},getXYZCellPixelCoor:function(h9,h7,h6,i){var ib=this.gridSize;var ia;var h8;switch(i.source){case"EPSG3857":var T=Math.pow(2,h6-1)-(h7+1);var e=h9-Math.pow(2,h6-1);ia=e*ib[0];h8=T*ib[1];break;case"BD09MC":ia=h9*ib[0];h8=h7*ib[1];default:break}return{x:ia,y:h8}},getBaiduCellPixelCoor:function(e,h6,T){var i=256;return{x:e*i,y:h6*i}},getPointPixelCoor:function(e,ib,i){var h9;var h8;var T=Math.pow(2,(18-ib));var h6=this.resolutions[Math.floor(ib)];var h7=ew.convertMC2LL(e);switch(i.source){case"EPSG3857":var ia=gcoord.transform([h7.lng,h7.lat],gcoord.BD09LL,gcoord.EPSG3857);h9=ia[0]/h6;h8=ia[1]/h6;break;case"BD09MC":h9=e.lng/T;h8=e.lat/T;default:break}return[h9,h8]},getResolutionScale:function(h6,T){var h7;var i=this.resolutions[Math.floor(h6)];var e=Math.pow(2,(18-h6));switch(T.target){case"BD09MC":h7=i/e;break;case"EPSG3857":h7=e/i;break;default:h7=i/e;break}return h7},getBaiduResolutionScale:function(T){var i=this.resolutions[Math.floor(T)];var e=Math.pow(2,(18-T));var h6=e/i;return h6},getTileCoordCenter:function(T){var e=this.origin;if(this.resolutions.length===0){this.calcResolutions(23)}var i=this.resolutions[T[0]];var h6=this.gridSize;return[e[0]+(T[1]+0.5)*h6[0]*i,e[1]-(T[2]+0.5)*h6[1]*i,]},transformBDmcPoint:function(h6,e){e=e||"EPSG3857";var i=ew.convertMC2LL(new hH(h6.lng,h6.lat));var T=gcoord.transform([i.lng,i.lat],gcoord.BD09LL,gcoord[e]);return T},getTilesLoop:function(T,e){var i=Math.pow(2,T);while(e>i-1){e=e-i}while(e<0){e=e+i}return e},getLoopBox:function(e,h6){var i=this.HALF_SIZE*2;if(e[0]>0&&h6[2]<0){h6[2]=h6[2]+i}else{if(e[0]<0&&h6[0]>0){h6[0]=h6[0]-i}}return h6},createOrUpdateTileCoord:function(T,e,h6,i){if(i!==undefined){i[0]=T;i[1]=e;i[2]=h6;return i}else{return[T,e,h6]}},createOrUpdateTileRange:function(e,h6,h7,T,i){if(i!==undefined){i.minX=e;i.maxX=h6;i.minY=h7;i.maxY=T;return i}else{return{minX:e,maxX:h6,minY:h7,maxY:T}}},fromEPSG4326:function(T,ib,h9){var h7=T.length;var h8=h9>1?h9:2;var e=ib;if(e===undefined){if(h8>2){e=T.slice()}else{e=new Array(h7)}}for(var h6=0;h6<h7;h6+=h8){e[h6]=(this.HALF_SIZE*T[h6])/180;var ia=this.RADIUS*Math.log(Math.tan((Math.PI*(+T[h6+1]+90))/360));if(ia>this.MAX_SAFE_Y){ia=this.MAX_SAFE_Y}else{if(ia<-this.MAX_SAFE_Y){ia=-this.MAX_SAFE_Y}}e[h6+1]=ia}return e},toEPSG4326:function(T,ia,h9){var h7=T.length;var h8=h9>1?h9:2;var e=ia;if(e===undefined){if(h8>2){e=T.slice()}else{e=new Array(h7)}}for(var h6=0;h6<h7;h6+=h8){e[h6]=(180*T[h6])/this.HALF_SIZE;e[h6+1]=(360*Math.atan(Math.exp(T[h6+1]/this.RADIUS)))/Math.PI-90}return e},findParentGridAndPosition:function(h6,ih,ig,ia,ib,id,h9){if(ig-1<0){return false}var ii=h6;var ic=ih;var T=ig;for(var h8=1;h8<=h9;h8++){var e=this.findParent(ii,ic,T,h8);if(!e){return false}var ie=this.getTileKey(e);var h7=ia.getData(ie);if(h7&&h7.status==="ready"){if(ib[ie]){continue}id.setData(h7,this.drawIndex,0);ib[ie]=true;return true}ii=e.col;ic=e.row;T=e.zoom}},findParent:function(i,h7,T,h6){if(T-1<0){return null}var e=i%2;var h8=h7%2;return{col:Math.floor(i/2),row:Math.floor(h7/2),sonX:e,sonY:h8,thumbLB:[e*0.5,1-h8*0.5-0.5],thumbRT:[e*0.5+0.5,1-h8*0.5],radio:Math.pow(2,h6),zoom:T-1,useZoom:T-1}},getTileKey:function(e,h6){h6=h6||{};var i=typeof h6.useZoom==="number"?h6.useZoom:e.useZoom;var T=e.style||this.mapStyleId||"default";return this.mapType+"_"+T+"_"+e.col+"_"+e.row+"_"+e.zoom+"_"+i},lon2tile:function(i,e){return(Math.floor((i+180)/360*Math.pow(2,e)))},lat2tile:function(T,i){var e=Math.tan(T*Math.PI/180)+1/Math.cos(T*Math.PI/180);return(Math.floor((1-Math.log(e)/Math.PI)/2*Math.pow(2,i)))},tile2long:function(e,i){return(e/Math.pow(2,i)*360-180)},tile2lat:function(T,e){var i=Math.PI-2*Math.PI*T/Math.pow(2,e);return(180/Math.PI*Math.atan(0.5*(Math.exp(i)-Math.exp(-i))))}});function c8(i,e){if(i<-90){i=-90}else{if(i>90){i=90}}while(e<-180){e+=360}while(e>180){e-=360}e=e||0;i=i||0;hH.call(this,e,i)}c8.inherits(hH,"LatLng");D.extend(c8.prototype,{equals:function(e){return(this.lat===e.lat&&this.lng===e.lng)},clone:function(){return new c8(this.lat,this.lng)},add:function(e){return new c8(this.lng+e.lng,this.lat+e.lat)},sub:function(e){return new c8(this.lat-e.lat,this.lng-e.lng)},mult:function(e){return new c8(this.lng*e,this.lat*e)},div:function(e){return new c8(this.lng/e,this.lat/e)},mag:function(){return Math.sqrt(this.lng*this.lng+this.lat*this.lat)},getLngSpan:function(e){var i=this.lng;var T=Math.abs(e-i);if(T>180){T=360-T}return T},toString:function(){return"LatLng"}});function eR(e,i){if(e&&!i){i=e}this._sw=this._ne=null;this._swLng=this._swLat=null;this._neLng=this._neLat=null;if(e){this._sw=new c8(e.lat,e.lng);this._ne=new c8(i.lat,i.lng);this._swLng=e.lng;this._swLat=e.lat;this._neLng=i.lng;this._neLat=i.lat}}D.extend(eR.prototype,{isEmpty:function(){return !this._sw||!this._ne},equals:function(e){if(this.isEmpty()){return false}return this.getSouthWest().equals(e.getSouthWest())&&this.getNorthEast().equals(e.getNorthEast())},getSouthWest:function(){return this._sw},getNorthEast:function(){return this._ne},containsBounds:function(e){if(this.isEmpty()||e.isEmpty()){return false}return(e._swLng>this._swLng&&e._neLng<this._neLng&&e._swLat>this._swLat&&e._neLat<this._neLat)},getCenter:function(){if(this.isEmpty()){return null}return new c8((this._swLat+this._neLat)/2,(this._swLng+this._neLng)/2)},intersects:function(T){if(Math.max(T._swLng,T._neLng)<Math.min(this._swLng,this._neLng)||Math.min(T._swLng,T._neLng)>Math.max(this._swLng,this._neLng)||Math.max(T._swLat,T._neLat)<Math.min(this._swLat,this._neLat)||Math.min(T._swLat,T._neLat)>Math.max(this._swLat,this._neLat)){return false}var h7=Math.max(this._swLng,T._swLng);var i=Math.min(this._neLng,T._neLng);var h6=Math.max(this._swLat,T._swLat);var e=Math.min(this._neLat,T._neLat);this._sw=new c8(h6,h7);this._ne=new c8(e,i);this._swLng=h7;this._swLat=h6;this._neLng=i;this._neLat=e;return true},containsPoint:function(e){if(this.isEmpty()){return false}return(e.lng>=this._swLng&&e.lng<=this._neLng&&e.lat>=this._swLat&&e.lat<=this._neLat)},extend:function(e){var i=e.lng;var T=e.lat;if(!this._sw){this._sw=new c8(0,0)}if(!this._ne){this._ne=new c8(0,0)}if(!this._swLng||this._swLng>i){this._sw.lng=this._swLng=i}if(!this._neLng||this._neLng<i){this._ne.lng=this._neLng=i}if(!this._swLat||this._swLat>T){this._sw.lat=this._swLat=T}if(!this._neLat||this._neLat<T){this._ne.lat=this._neLat=T}},toSpan:function(){if(this.isEmpty()){return new c8(0,0)}return new c8(Math.abs(this._neLat-this._swLat),Math.abs(this._neLng-this._swLng))},union:function(i){if(i.isEmpty()){return false}var e=i.getSouthWest();var T=i.getNorthEast();if(this._swLat>e.lat){this._swLat=e.lat}if(this._swLng>e.lng){this._swLng=e.lng}if(this._neLat<T.lat){this._neLat=T.lat}if(this._neLng<T.lng){this._neLng=T.lng}this._sw=new c8(this._swLat,this._swLng);this._ne=new c8(this._neLat,this._neLng);return true},toString:function(){return this._swLat+", "+this._swLng+", "+this._neLat+", "+this._neLng}});window.COORDINATES_WGS84=1;window.COORDINATES_WGS84_MC=2;window.COORDINATES_GCJ02=3;window.COORDINATES_GCJ02_MC=4;window.COORDINATES_BD09=5;window.COORDINATES_BD09_MC=6;window.COORDINATES_MAPBAR=7;window.COORDINATES_51=8;function aB(){}aB.inherits(em,"Convertor");D.extend(aB.prototype,{translate:function(i,h7,h6,T){h7=h7||1;h6=h6||5;if(i.length>10){T&&T({status:25});return}var e=fe.apiHost+"/geoconv/v1/?coords=";D.each(i,function(h8){e+=h8.lng+","+h8.lat+";"});e=e.replace(/;$/gi,"");e=e+"&from="+h7+"&to="+h6+"&v=gl&type=webgl&ak="+gr;E.request(e,function(h9){if(h9.status===0){var h8=[];D.each(h9.result,function(ia){h8.push(new hH(ia.x,ia.y))});delete h9.result;h9.points=h8}T&&T(h9)})}});var d1={idle:0,freeze:1,zooming:2,dragging:3,moving:4,readyToDrag:5,readyToPinch:6,pinching:7,stdMapCtrlDrag:8,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,arrowOpCodes:{37:1,38:2,39:4,40:8}};var eq={_map:null,_html:"<div class=\'BMap_opMask\' unselectable=\'on\'></div>",_maskElement:null,_cursor:"default",inUse:false,show:function(e){if(!this._map){this._map=e}this.inUse=true;if(!this._maskElement){this._createMask(e)}this._maskElement.style.display="block"},_createMask:function(i){if(!this._map){this._map=i}if(!this._map){return}var e=this._maskElement=dO(this._map.container,this._html);D.on(e,"mouseup",function(T){if(T.button==2){dg(T)}});D.on(e,"contextmenu",dg);e.style.display="none"},getDrawPoint:function(h6,h9,h7){h6=window.event||h6;var i=h6.offsetX||h6.layerX||0;var h8=parseInt(h6.offsetY)||parseInt(h6.layerY)||0;var T=h6.target||h6.srcElement;if(T!=eq.getDom(this._map)&&h9==true){while(T&&T!=this._map.container){if(!(T.clientWidth==0&&T.clientHeight==0&&T.offsetParent&&T.offsetParent.nodeName.toLowerCase()=="td")){i+=T.offsetLeft;h8+=T.offsetTop}T=T.offsetParent}}if(T!=eq.getDom(this._map)&&T!=this._map.container){return}if(typeof i==="undefined"||typeof h8==="undefined"){return}if(isNaN(i)||isNaN(h8)){return}if(h7){i=i+h7.x;h8=h8+h7.y}return this._map.pixelToPointIn(new es(i,h8))},hide:function(){if(!this._map){return}this.inUse=false;if(this._maskElement){this._maskElement.style.display="none"}},getDom:function(e){if(!this._maskElement){this._createMask(e)}return this._maskElement},setCursor:function(e){this._cursor=e||"default";if(this._maskElement){this._maskElement.style.cursor=this._cursor}}};function bo(){this._type="overlay"}bo.inherits(D.BaseClass,"Overlay");bo.getZIndex=function(i,e){i=i*1;if(!i){return 0}if(e){i=ew.convertMC2LL(new hH(0,i)).lat}return(i*-100000)<<1};D.extend(bo.prototype,{_i:function(e){this._map=e;if(!this.domElement&&bY(this.initialize)){this.domElement=this.initialize(e);if(this.domElement){this.domElement.style.WebkitUserSelect="none"}}this.draw()},initialize:function(e){throw"initialize方法未实现"},draw:function(){throw"draw方法未实现"},remove:function(){if(this.domElement&&this.domElement.parentNode){this.domElement.parentNode.removeChild(this.domElement)}this.domElement=null;this.dispatchEvent(new be("onremove"))},hide:function(){this._visible=false;D.hide(this.domElement)},show:function(){this._visible=true;D.show(this.domElement)},getMap:function(){return this._map},dispose:function(){D.BaseClass.prototype.decontrol.call(this)}});function cZ(){D.BaseClass.call(this);bo.call(this);this._visible=true;this._visibleInternal=true;this.infoWindow=null;this._dblclickTime=0}cZ.inherits(bo,"OverlayInternal");D.extend(cZ.prototype,{initialize:function(e){this.map=e;D.BaseClass.call(this,this.hashCode);return null},draw:function(){},remove:function(){this.decontrol();bo.prototype.remove.call(this)},hide:function(){this._visible=false},show:function(){this._visible=true},getDom:function(){return this.domElement},getContainer:function(){return this.domElement},setClassName:function(){},setConfig:function(i){if(!i){return}for(var e in i){if(i.hasOwnProperty(e)){this._config[e]=i[e]}}},getPoint:function(T,h6){if(!T){return this.point}else{var e=h6?h6.width:0;var h7=h6?h6.height:0;if(this.map){var i=this.map.pointToPixelIn(this.point);if(this._config&&this._config.offset){i.x=i.x+this._config.offset.width+e;i.y=i.y+this._config.offset.height+h7}else{i.x=i.x+e;i.y=i.y+h7}return this.map.pixelToPointIn(i)}}},setZIndex:function(e){this.zIndex=e},isVisible:function(){if(!this.domElement){return false}return !!this._visible},enableMassClear:function(){this._config.enableMassClear=true},disableMassClear:function(){this._config.enableMassClear=false},showInternal:function(){this._visibleInternal=true},hideInternal:function(e){this._visibleInternal=false;this._hideInternalReason=e}});function e8(e){this.map=e;this._overlays={};this._overlayArray=[];this._customOverlays=[];e._overlays=this._overlays;e._overlayArray=this._overlayArray;e._customOverlays=this._customOverlays;this._zoomingOrMoving=false;this._init()}e8.prototype._init=function(){if(this.map._renderType!=="webgl"){this._createOverlayContainers()}else{this._createWebGLOverlayContainers()}this._bind()};e8.prototype._createOverlayContainers=function(){var e=this.map;e.temp.overlayDiv=e.overlayDiv=this._createOverlayDiv(e.platform,200);e.temp.overlayDivEx=e.overlayDivEx=this._createOverlayDiv(e.platform,50);e._panes.floatPane=this._createOverlayDiv(e.temp.overlayDiv,800);e._panes.markerMouseTarget=this._createOverlayDiv(e.temp.overlayDiv,700);e._panes.floatShadow=this._createOverlayDiv(e.temp.overlayDiv,600);e._panes.labelPane=this._createOverlayDiv(e.temp.overlayDiv,500);e._panes.markerPane=this._createOverlayDiv(e.temp.overlayDiv,400);if(e.isCanvasMap()){e._panes.mapPane=this._createOverlayDiv(e.temp.overlayDivEx,50)}else{e._panes.mapPane=this._createOverlayDiv(e.temp.overlayDiv,200)}};e8.prototype._createWebGLOverlayContainers=function(){var e=this.map;e.temp.overlayDiv=e.overlayDiv=this._createOverlayDiv(e.platform,200);e._panes.floatPane=this._createOverlayDiv(e.temp.overlayDiv,800);e._panes.markerMouseTarget=this._createOverlayDiv(e.temp.overlayDiv,700);e._panes.floatShadow=this._createOverlayDiv(e.temp.overlayDiv,600);e._panes.labelPane=this._createOverlayDiv(e.temp.overlayDiv,500);e._panes.markerPane=this._createOverlayDiv(e.temp.overlayDiv,400)};e8.prototype._createOverlayDiv=function(e,h6){var T=U("div");var i=T.style;i.position="absolute";i.top=i.left=i.width=i.height="0";i.zIndex=h6;e.appendChild(T);return T};e8.prototype._bind=function(){var h7=this.map;var h6=this;function i(h9){h6.draw(h9)}if(h7._renderType!=="webgl"){h7.addEventListener("load",i);h7.addEventListener("moveend",i);h7.addEventListener("resize",i);h7.addEventListener("zoomend",i);h7.addEventListener("zooming_inner",i)}else{h7.on("update",i)}h7.addEventListener("zoomend",function(h9){if(this.mapType==="B_EARTH_MAP"){if(this._earth.getZoom()<this._earth.zoomForNight+1){this.temp.overlayDiv.style.display="none";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display="none"}}else{if(this.temp.overlayDiv.style.display==="none"){this.temp.overlayDiv.style.display="";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display=""}if(this.temp.infoWin&&this.temp.infoWin.isOpen()){this.temp.infoWin.redraw()}}}}});h7.addEventListener("oncenterandzoom",function(h9){h6.draw(h9);if(this.mapType==="B_EARTH_MAP"){if(this._earth.getZoom()<this._earth.zoomForNight+1){this.temp.overlayDiv.style.display="none";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display="none"}}else{if(this.temp.overlayDiv.style.display==="none"){this.temp.overlayDiv.style.display="";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display=""}if(this.temp.infoWin&&this.temp.infoWin.isOpen()){this.temp.infoWin.redraw()}}}}});h7.addEventListener("maptypechange",function(h9){if(this.mapType==="B_EARTH_MAP"){if(this._panes.mapPane){this._panes.mapPane.style.display="none"}if(this._earth.getZoom()<this._earth.zoomForNight+1){this.temp.overlayDiv.style.display="none";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display="none"}}else{if(this.temp.overlayDiv.style.display==="none"){this.temp.overlayDiv.style.display="";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display=""}if(this.temp.infoWin&&this.temp.infoWin.isOpen()){this.temp.infoWin.redraw()}}}if(this._panes.markerPane){this._panes.markerPane.style.display="none"}}else{if(this._panes.mapPane){this._panes.mapPane.style.display=""}if(this._panes.markerPane){this._panes.markerPane.style.display=""}if(this.temp.overlayDiv.style.display==="none"){this.temp.overlayDiv.style.display="";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display=""}if(this.temp.infoWin&&this.temp.infoWin.isOpen()){this.temp.infoWin.redraw()}}}h6.draw(h9)});h7.on("earthstatuschange",function h8(h9){h6.draw(h9)});h7.addEventListener("addoverlay",function(id){var ia=id.target;if(ia instanceof cZ){if(!h6._overlays[ia.hashCode]){h6._overlays[ia.hashCode]=ia;h6._overlayArray.push(ia)}}else{var ic=false;for(var ib=0,h9=h6._customOverlays.length;ib<h9;ib++){if(h6._customOverlays[ib]===ia){ic=true;break}}if(!ic){h6._customOverlays.push(ia)}}});h7.addEventListener("removeoverlay",function(ic){var ia=ic.target;if(ia instanceof cZ){delete h6._overlays[ia.hashCode];for(var ib=0;ib<h6._overlayArray.length;ib++){if(h6._overlayArray[ib]===ia){h6._overlayArray.splice(ib,1);break}}}else{for(var ib=0,h9=h6._customOverlays.length;ib<h9;ib++){if(h6._customOverlays[ib]===ia){h6._customOverlays.splice(ib,1);break}}}});h7.addEventListener("clearoverlays",function(ib){this.closeInfoWindow();this.closeSimpleInfoWindow();for(var ia in h6._overlays){if(h6._overlays[ia]._config.enableMassClear){this.removeOverlay(h6._overlays[ia])}}for(var h9=h6._customOverlays.length-1;h9>0;h9--){if(h6._customOverlays[h9].enableMassClear!==false){this.removeOverlay(h6._customOverlays[h9]);h6._customOverlays.splice(h9,1)}}});h7.addEventListener("infowindowopen",function(ia){var h9=this.infoWindow;if(h9){D.hide(h9.popDom);D.hide(h9.shadowDom)}});function T(){if(this.getMapType()==="B_EARTH_MAP"||this._renderType==="webgl"){if(h6._zoomingOrMoving===false){this._panes.markerMouseTarget.style.display="none";h6._zoomingOrMoving=true}}}function e(ib){if(this.getMapType()==="B_EARTH_MAP"||this._renderType==="webgl"){if(h6._zoomingOrMoving===true){this._panes.markerMouseTarget.style.display="";h6._zoomingOrMoving=false;for(var ia=0;ia<h6._overlayArray.length;ia++){var h9=h6._overlayArray[ia];if(h9 instanceof dw===true){h9.draw(ib)}}}}}h7.addEventListener("movestart",T);h7.addEventListener("moveend",e);h7.addEventListener("zoomstart",T);h7.addEventListener("zoomend",e);h7.addEventListener("animation_start",T);h7.addEventListener("animation_end",e);h7.addEventListener("displayoptions_changed",function(h9){if(this._displayOptions.overlay===false){this.temp.overlayDiv.style.display="none"}else{this.temp.overlayDiv.style.display=""}})};e8.prototype.draw=function(h9){h9=h9||{};if(this.map.getMapType()==="B_EARTH_MAP"){for(var h7=0;h7<this._overlayArray.length;h7++){var T=this._overlayArray[h7];if(T instanceof x===true){continue}if(this._zoomingOrMoving){if(T instanceof dw===true){continue}}T.draw(h9)}}else{for(var h7=0,h6=this._overlayArray.length;h7<h6;h7++){var T=this._overlayArray[h7];if(this._zoomingOrMoving&&T instanceof dw===true){continue}T.draw(h9)}}D.each(this._customOverlays,function(e){e.draw(h9)});if(this.map.temp.infoWin){this.map.temp.infoWin.setPosition(h9.center,h9.zoom)}if(this.map.getMapType()!=="B_EARTH_MAP"&&this.map._renderType!=="webgl"){if(br.DrawerSelector){var h8=br.DrawerSelector.getDrawer(this.map);h8.setPalette()}}};br.register(function(e){e._overlayMgr=new e8(e)});function x(e){cZ.call(this);this._config={strokeColor:"#000",strokeWeight:2,strokeOpacity:1,strokeStyle:"solid",dashArray:null,strokeLineCap:"round",strokeLineJoin:"round",enableMassClear:true,getParseTolerance:null,getParseCacheIndex:null,enableParse:true,enableEditing:false,mouseOverTolerance:5,geodesic:false,clip:true,texture:null,textureSize:null,textureZoomWithMap:false,textureRepeat:true};this.setConfig(e);if(this._config.strokeOpacity<0||this._config.strokeOpacity>1){this._config.strokeOpacity=1}if(this._config.fillOpacity<0||this._config.fillOpacity>1){this._config.fillOpacity=1}if(this._config.strokeStyle!=="solid"&&this._config.strokeStyle!=="dashed"&&this._config.strokeStyle!=="dotted"){this._config.strokeStyle="solid"}this.domElement=null;this._bounds=new dZ();this.points=[];this.greatCirclePoints=[];this._parseCache=[];this._holesCache=[];this._parseCacheGL=[];this._parseCacheGLRaw=[];this._areaCacheGL=[];this._strokeStyleInfoForGL=[[]];this._fillStyleInfoForGL="";this.vertexMarkers=[];this._temp={}}x.JOININDEX={miter:0,round:1,bevel:2};x.CAPINDEX={round:0,butt:1,square:2};x.inherits(cZ,"Graph");x.getGraphPoints=function(i){var e=[];if(!i||i.length===0){return e}if(typeof i==="string"){var T=i.split(";");D.each(T,function(h7){var h6=h7.split(",");e.push(new hH(h6[0],h6[1]))})}if(i.constructor===Array&&i.length>0){e=i}return e};x.parseTolerance={0:[0.09,0.005,0.0001,0.00001],1:[9000,500,20,1]};D.extend(x.prototype,{initialize:function(e){this.map=e;return null},draw:function(){},setPoints:function(e){this._clearCache();this.points=x.getGraphPoints(e).slice(0);this._calcBounds()},setPathIn:function(e){this.setPoints(e)},_calcBounds:function(){if(!this.points){return}var e=this;e._bounds=new dZ();if(!this.hasMultipleParts){D.each(this.points,function(i){e._bounds.extend(i)})}else{D.each(this.points,function(i){D.each(i,function(T){e._bounds.extend(T)})})}},getPoints:function(){return this.points},getPathIn:function(){return this.points},setPointAt:function(i,e){if(!e||!this.points[i]){return}this._clearCache();this.points[i]=new hH(e.lng,e.lat);this._calcBounds()},setPositionAt:function(i,e){if(!e||!this.points[i]){return}var T=ew.convertLL2MC(e);this.setPointAt(i,T)},setOptions:function(i){i=i||{};for(var e in i){if(i.hasOwnProperty(e)){this._config[e]=i[e]}}},setStrokeColor:function(e){this._config.strokeColor=e},getStrokeColor:function(){return this._config.strokeColor},setStrokeLineCap:function(e){this._config.strokeLineCap=e},getStrokeLineCap:function(){return this._config.strokeLineCap},setStrokeLineJoin:function(e){this._config.strokeLineJoin=e},getStrokeLineJoin:function(){return this._config.strokeLineJoin},setStrokeWeight:function(e){if(e>0){this._config.strokeWeight=e}},getStrokeWeight:function(){return this._config.strokeWeight},setStrokeOpacity:function(e){if(!e||e>1||e<0){return}this._config.strokeOpacity=e},getStrokeOpacity:function(){return this._config.strokeOpacity},setFillOpacity:function(e){if(e>1||e<0){return}this._config.fillOpacity=e},getFillOpacity:function(){return this._config.fillOpacity},setStrokeStyle:function(e){if(e!=="solid"&&e!=="dashed"&&e!=="dotted"){return}this._config.strokeStyle=e},getStrokeStyle:function(){return this._config.strokeStyle},setFillColor:function(e){this._config.fillColor=e||""},getFillColor:function(){return this._config.fillColor},getBoundsIn:function(){this._bounds.setMinMax();return this._bounds},getBounds:function(){var e=this.getBoundsIn();var i=new dZ(ew.convertMC2LL(e.getSouthWest()),ew.convertMC2LL(e.getNorthEast()));i.setMinMax();return i},remove:function(){if(this.map){this.map.removeEventListener("onmousemove",this._graphMouseEvent);this.map.removeEventListener("onclick",this._graphClickEvent)}cZ.prototype.remove.call(this);this._clearCache();var e=new be("onlineupdate");e.action="remove";e.overlay=this;this.fire(e)},enableEditing:function(){if(this.points.length<2){return}this._config.enableEditing=true;var e=this;ej.load("poly",function(){e.addVertexs()},true)},disableEditing:function(){this._config.enableEditing=false;var e=this;ej.load("poly",function(){e.clearVertexs()},true)},getLength:function(){if(typeof this._length==="number"){return this._length}if(typeof this._config.totalLength==="number"){this._length=this._config.totalLength;return this._length}var T=0;if(this.points.length<=1){this._length=0;return T}for(var e=0;e<this.points.length-1;e++){T+=bS(this.points[e],this.points[e+1])}this._length=T;return T},getParsedPoints:function(){var e=this._simplification(this.points);if(this.hasMultipleParts){return e}return[e]},_simplification:function(ia){var e=this.map;var h9=this.getParseCacheIndex(e.getZoom());var ic;if(this._parseCache[h9]){ic=this._parseCache[h9]}else{var h7=ia;if(this.greatCirclePoints.length>0){h7=this.greatCirclePoints}var h8=this.getParseTolerance(e.getZoom(),e.config.coordType);if(!this.hasMultipleParts){var ib=hU(h7,h8)}else{var ib=[];for(var T=0;T<h7.length;T++){var h6=hU(h7[T],h8);ib.push(h6)}}ic=this._parseCache[h9]=ib}return ic},_clearCache:function(){this._length=null;this._parseCache.length=0;this._parseCacheGL.length=0;this._parseCacheGLRaw.length=0;this._areaCacheGL.length=0},canRenderDataBeMerged:function(){var e=this._config;if(e.texture){return false}return true}});if(D.Browser.ie&&document.namespaces&&!document.namespaces.olv){document.namespaces.add("olv","urn:schemas-microsoft-com:vml")}function hq(h8,h6,T){if(!h8||!h6){return}this.imageUrl=null;this.imageDom=null;if(typeof h8==="string"){this.imageUrl=h8}else{this.imageDom=h8;if(!this.imageDom.id){this.imageDom.id=br.getGUID("icon_dom_")}}this.size=h6;var h7=new ei(Math.floor(h6.width/2),Math.floor(h6.height/2));var i={offset:h7,imageOffset:new ei(0,0)};T=T||{};for(var e in T){i[e]=T[e]}if(T.anchor){i.offset=T.anchor}this.anchor=this.offset=i.offset;this.imageOffset=i.imageOffset;this.infoWindowOffset=T.infoWindowOffset||this.offset;this.printImageUrl=T.printImageUrl||"";this.imageSize=T.imageSize||this.size;this.srcSetObject={};this.setImageSrcset(T.srcset||T.srcSet)}hq.prototype.setImageUrl=function(e){if(!e){return}this.imageUrl=e;this._renderData=null};hq.prototype.getCurrentImageUrl=function(){if(window.devicePixelRatio>1&&this.srcSetObject["2x"]){return this.srcSetObject["2x"]}return this.imageUrl};hq.prototype.setPrintImageUrl=function(e){if(!e){return}this.printImageUrl=e};hq.prototype.setSize=function(e){if(!e){return}this.size=new ei(e.width,e.height);this._renderData=null};hq.prototype.setOffset=function(e){if(!e){return}this.anchor=this.offset=new ei(e.width,e.height);this._renderData=null};hq.prototype.setAnchor=function(e){this.setOffset(e)};hq.prototype.setImageOffset=function(e){if(!e){return}this.imageOffset=new ei(e.width,e.height);this._renderData=null};hq.prototype.setInfoWindowOffset=function(e){if(!e){return}this.infoWindowOffset=new ei(e.width,e.height)};hq.prototype.setImageSize=function(e){if(!e){return}this.imageSize=new ei(e.width,e.height)};hq.prototype.setImageSrcset=function(T){var e="";if(!T){return}for(var i in T){if(T.hasOwnProperty(i)){this.srcSetObject[i]=T[i];e=T[i]+" "+i+","}}this.srcSet=e};hq.prototype.toString=function(){return"Icon"};hq.prototype.generateRenderData=function(h8){var T=this.offset;var e=this.size;var ia=this.imageOffset;var h9=[];h9.push(-T.width,T.height-e.height,0);h9.push(e.width-T.width,T.height-e.height,0);h9.push(e.width-T.width,T.height,0);h9.push(-T.width,T.height-e.height,0);h9.push(e.width-T.width,T.height,0);h9.push(-T.width,T.height,0);if(h8!==0){for(var h7=0;h7<h9.length;h7+=3){var h6=vec2.fromValues(h9[h7],h9[h7+1]);vec2.rotate(h6,h6,[0,0],dQ(-h8));h9[h7]=h6[0];h9[h7+1]=h6[1]}}return{vertex:h9}};hq.prototype.getRenderData=function(e){this._renderData=this.generateRenderData(e);return this._renderData};function ar(T,i){D.BaseClass.call(this);this.content=T;this.map=null;this._config={width:0,height:0,maxWidth:600,offset:new ei(0,0),title:"",maxContent:"",enableMaximize:false,enableAutoPan:true,enableCloseOnClick:true,margin:[10,10,40,10],collisions:[[10,10],[10,10],[10,10],[10,10]],ifMaxScene:false,onClosing:function(){return true}};this.setConfig(i);if(this._config.width!==0){if(this._config.width<220){this._config.width=220}if(this._config.width>730){this._config.width=730}}if(this._config.height!==0){if(this._config.height<60){this._config.height=60}if(this._config.height>650){this._config.height=650}}if(this._config.maxWidth!==0){if(this._config.maxWidth<220){this._config.maxWidth=220}if(this._config.maxWidth>730){this._config.maxWidth=730}}this.isWinMax=false;this.IMG_PATH=fe.imgPath;this.overlay=null;var e=this;ej.load("infowindow",function(){e._draw()})}ar.inherits(D.BaseClass,"InfoWindow");D.extend(ar.prototype,{setWidth:function(e){e=e*1;if(!e&&e!==0||isNaN(e)||e<0){return}if(e!==0){if(e<220){e=220}if(e>730){e=730}}this._config.width=e},setHeight:function(e){e=e*1;if(!e&&e!==0||isNaN(e)||e<0){return}if(e!==0){if(e<60){e=60}if(e>650){e=650}}this._config.height=e},setMaxWidth:function(e){e=e*1;if(!e&&e!==0||isNaN(e)||e<0){return}if(e!==0){if(e<220){e=220}if(e>730){e=730}}this._config.maxWidth=e},setTitle:function(e){this._config.title=e||""},setContent:function(e){this.content=e||""},getContent:function(){return this.content},setMaxContent:function(e){this._config.maxContent=e||""},redraw:function(){},enableAutoPan:function(){this._config.enableAutoPan=true},disableAutoPan:function(){this._config.enableAutoPan=false},enableCloseOnClick:function(){this._config.enableCloseOnClick=true},disableCloseOnClick:function(){this._config.enableCloseOnClick=false},enableMaximize:function(){this._config.enableMaximize=true},disableMaximize:function(){this._config.enableMaximize=false},show:function(){this._visible=true},hide:function(){this._visible=false},close:function(){this.hide()},dispose:function(){D.BaseClass.prototype.decontrol.call(this)},maximize:function(){this.isWinMax=true},restore:function(){this.isWinMax=false},setConfig:function(i){if(!i){return}for(var e in i){if(typeof(this._config[e])===typeof(i[e])){this._config[e]=i[e]}}},isVisible:function(){return this.isOpen()},isOpen:function(){return false},getPointIn:function(){if(this.overlay&&this.overlay.getPoint){return this.overlay.getPoint()}},getTitle:function(){return this._config.title||""},getPosition:function(){return this.latLng;var e=this.getPointIn();return ew.convertMC2LL(e)},getPoint:function(){var e=this.getPointIn();return ew.convertMC2LL(e)},getOffset:function(){return this._config.offset},dispose:function(){D.BaseClass.prototype.decontrol.call(this)},toString:function(){return"InfoWindow"}});dd.prototype.openInfoWindow=function(T,e){T.latLng=new c8(e.lat,e.lng);var i=ew.convertLL2MC(e);this.openInfoWindowIn(T,i)};dd.prototype.closeInfoWindow=function(){var e=this.temp.infoWin||this.temp._infoWin;if(e&&e.overlay){e.overlay.closeInfoWindow()}};dd.prototype.openInfoWindowIn=function(h6,e){if(!h6||h6.toString()!=="InfoWindow"||!e||e.toString()!=="Point"){return}var i=this.temp;if(!i.marker){var T=new hq(fe.imgPath+"blank.gif",{width:1,height:1});i.marker=new dw(e,{icon:T,width:1,height:1,offset:new ei(0,0),infoWindowOffset:new ei(0,0),clickable:false});i.marker._fromMap=1}else{i.marker.setPoint(e)}this.addOverlay(i.marker);i.marker.show();i.marker.openInfoWindow(h6)};cZ.prototype.openInfoWindow=function(e){if(this.map){this.map.closeInfoWindow();e._visible=true;this.map.temp._infoWin=e;e.overlay=this;D.BaseClass.call(e,e.hashCode)}};cZ.prototype.closeInfoWindow=function(){if(this.map&&this.map.temp._infoWin){this.map.temp._infoWin._visible=false;this.map.temp._infoWin.decontrol();this.map.temp._infoWin=null}};function aP(T,i){cZ.call(this);this.content=T;this.map=null;this.domElement=null;this._config={width:0,offset:new ei(0,0),styles:{backgroundColor:"#fff",border:"1px solid #f00",padding:"1px",whiteSpace:"nowrap",fontSize:"12px",zIndex:"80",MozUserSelect:"none"},point:null,enableMassClear:true};i=i||{};this.setConfig(i);if(this._config.width<0){this._config.width=0}this.point=this._config.point;var e=this;ej.load("marker",function(){e._draw()})}aP.inherits(cZ,"Label");D.extend(aP.prototype,{setPoint:function(e){if(e&&e.toString()==="Point"&&!this.getMarker()){this.point=this._config.point=new hH(e.lng,e.lat)}},setContent:function(e){this.content=e},getContent:function(e){return this.content},setOpacity:function(e){if(e>=0&&e<=1){this._config.opacity=e}},setOffset:function(e){if(!e||e.toString()!=="Size"){return}this._config.offset=new ei(e.width,e.height)},getOffset:function(){return this._config.offset},setStyle:function(e){e=e||{};this._config.styles=D.extend(this._config.styles,e)},setStyles:function(e){this.setStyle(e)},setTitle:function(e){this._config.title=e||""},getTitle:function(){return this._config.title},setMarker:function(e){if(this._marker&&this._marker!==e){this._marker._config.label=null}this._marker=e;if(e){this.point=this._config.point=e.getPoint()}else{this.point=this._config.point=null}},getMarker:function(){return this._marker||null},getPositionIn:function(){return this.getPoint()},});function f2(T,i){var h6={};for(var e in i){if(i.hasOwnProperty(e)){if(e==="position"){h6.point=ew.convertLL2MC(i[e]);this.latLng=new c8(i[e]["lat"],i[e]["lng"])}else{h6[e]=i[e]}}}aP.call(this,T,h6)}f2.inherits(aP,"LabelOut");D.extend(f2.prototype,{toString:function(){return"Label"},setPosition:function(e){this.latLng=new c8(e.lat,e.lng);var i=ew.convertLL2MC(e);this.setPoint(i)},getPosition:function(){return this.latLng;var e=this.getPositionIn();return ew.convertMC2LL(e)}});window.BMAP_ANIMATION_DROP=1;window.BMAP_ANIMATION_BOUNCE=2;function dw(e,i){cZ.call(this);i=i||{};this.point=e;this._rotation=0;this.map=null;this._animation=null;this.domElement=null;this.iconDom=null;this.infoWindowDom=null;this.siblingElement=null;this.textureCoord=null;this.textureCoordGLMap=null;this.collisionDetectionFailed=false;this._config={offset:new ei(0,0),opacity:1,icon:null,title:"",infoWindow:null,label:null,baseZIndex:0,clickable:true,zIndexFixed:false,isTop:false,enableMassClear:true,enableDragging:false,raiseOnDrag:false,restrictDraggingArea:false,startAnimation:"",enableCollisionDetection:false,rank:0,enableDraggingMap:false};this.setConfig(i);if(!i.icon){this._config.icon=new hq(fe.imgPath+"marker_red.png",new ei(23,25),{offset:new ei(10,25),infoWindowOffset:new ei(10,0)})}this._isDragging=false;var T=this;ej.load("marker",function(){T._draw()})}dw.TOP_ZINDEX=bo.getZIndex(-90)+1000000;dw.DRAG_ZINDEX=dw.TOP_ZINDEX+1000000;dw._injectMethond=function(e){D.extend(dw.prototype,e)};dw.inherits(cZ,"Marker");D.extend(dw.prototype,{toString:function(){return"Marker"},setIcon:function(e){if(e){this._config.icon=e;this.textureCoord=this.textureCoordGLMap=null}},getIcon:function(){return this._config.icon},setLabel:function(e){if(!(e instanceof aP)){return}this._config.label=e;e._config.enableMassClear=this._config.enableMassClear;e.setPoint(this.point)},getLabel:function(){return this._config.label},enableDragging:function(){this._config.enableDragging=true},disableDragging:function(){this._config.enableDragging=false},setPoint:function(e){if(e){this.point=this._config.point=new hH(e.lng,e.lat);this.latLng=ew.convertMC2LL(e)}},setPositionIn:function(e){this.setPoint(e)},getPositionIn:function(){return this.getPoint()},setTop:function(i,e){this._config.isTop=!!i;if(i){this._addi=e||0}},setTitle:function(e){this._config.title=e||""},getTitle:function(){return this._config.title},setOffset:function(e){if(e){this._config.offset=e}},getOffset:function(){return this._config.offset},setAnimation:function(e){this._animation=e},setRank:function(e){this._config.rank=e},getRank:function(){return this._config.rank},setRotation:function(e){while(e<0){e+=360}this._rotation=e%360},getRotation:function(){return this._rotation}});function aF(e,T){this.latLng=new c8(e.lat,e.lng);var i=ew.convertLL2MC(e);dw.call(this,i,T)}aF.inherits(dw,"MarkerOut");D.extend(aF.prototype,{toString:function(){return"Marker"},setPosition:function(e){this.latLng=new c8(e.lat,e.lng);var i=ew.convertLL2MC(e);this.setPositionIn(i)},getPosition:function(){return this.latLng;var e=this.getPositionIn();return ew.convertMC2LL(e)},});window.BMAP_SHAPE_CIRCLE=1;window.BMAP_SHAPE_RECT=2;function bh(i,e,T){cZ.call(this,e,T);this.domElement=null;this.point=i;T=T||{};this._config={};this._config.height=e||0;this._config.size=typeof T.size==="number"?T.size:50;this._config.fillOpacity=typeof T.fillOpacity==="number"?T.fillOpacity:0.8;this._config.shape=typeof T.shape==="number"?T.shape:1;fR(this._config.fillOpacity,0,1);if(T.fillColor===""){this._config.fillColor=""}else{this._config.fillColor=T.fillColor?T.fillColor:"#f00"}this._config.icon=T.icon instanceof hq?T.icon:"";this._config.enableMassClear=T.enableMassClear||true;var h6=this;ej.load("marker",function(){h6._draw()})}bh.inherits(cZ,"Marker3D");D.extend(bh.prototype,{setPoint:function(e){this.point=this._config.point=new hH(e.lng,e.lat);this.latLng=ew.convertMC2LL(e);var i=new be("onstatus_change");i.overlay=this;i.action="setPoint";this.fire(i)},setPositionIn:function(e){this.setPoint(e)},getPositionIn:function(){return this.getPoint()},setDomAttribute:function(i,T){var e=new be("onlineupdate");e.overlay=this;this.dispatchEvent(e)}});function cy(i,e,h6){this.latLng=new c8(i.lat,i.lng);var T=ew.convertLL2MC(i);bh.call(this,T,e,h6)}cy.inherits(bh,"Marker3d");D.extend(cy.prototype,{toString:function(){return"Marker3D"},setHeight:function(e){this._config.height=Number(e);this.draw();var i=new be("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getHeight:function(){return this._config.height},setFillOpacity:function(e){if(e>1||e<0){return}this._config.fillOpacity=e;this.setDomAttribute("fillopacity",e)},getFillOpacity:function(){return this._config.fillOpacity},setFillColor:function(e){this._config.fillColor=e||"";this.setDomAttribute("fillcolor",e)},getFillColor:function(){return this._config.fillColor},setIcon:function(i){if(!i||!this.map){return}this._config.icon=i;if(this._config.icon){var e=this._config.icon.getCurrentImageUrl();var h6=i.getCurrentImageUrl()!==e;this._config.icon=i;this.textureCoord=this.textureCoordGLMap=null;this.draw();var T=new be("onstatus_change");T.overlay=this;T.action="setIcon";T.imageUrlChanged=h6;this.fire(T)}},getIcon:function(){return this._config.icon},setPosition:function(e){this.latLng=new c8(e.lat,e.lng);var i=ew.convertLL2MC(e);this.setPositionIn(i)},getPosition:function(){var e=this.getPositionIn();return ew.convertMC2LL(e)}});function a(T,e){x.call(this,e);this._normalizedBounds=new dZ();this.setPoints(T);var i=this;ej.load("poly",function(){i._draw()})}a.inherits(x,"Polyline");D.extend(a.prototype,{getBoundsIn:function(e){if(!e){this._bounds.setMinMax();return this._bounds}this._normalizedBounds.setMinMax();return this._normalizedBounds},setPoints:function(T){this._clearCache();this.points=x.getGraphPoints(T).slice(0);if(this._config.geodesic===true){this.greatCirclePoints.length=0;for(var e=0;e<this.points.length-1;e++){this.calcGreatCirclePoints(this.points[e],this.points[e+1])}}this._calcBounds()},_calcBounds:function(){if(!this.points){return}var e=this;e._bounds.setNorthEast(null);e._bounds.setSouthWest(null);if(e.greatCirclePoints&&e.greatCirclePoints.length>0){D.each(e.greatCirclePoints,function(i){e._bounds.extend(i)})}else{D.each(e.points,function(i){e._bounds.extend(i)})}e._normalizedBounds.setSouthWest(e._bounds.getSouthWest());e._normalizedBounds.setNorthEast(e._bounds.getNorthEast());if(e._normalizedBounds.sw.lng<-dd.WORLD_SIZE_MC_HALF||e._normalizedBounds.ne.lng>dd.WORLD_SIZE_MC_HALF){e._normalizedBounds.sw.lng=-dd.WORLD_SIZE_MC_HALF;e._normalizedBounds.ne.lng=dd.WORLD_SIZE_MC_HALF}},calcGreatCirclePoints:function(h6,T){var h8=h6.latLng;var h7=T.latLng;if(h8.equals(h7)){return}var e=ew.getDistance(dQ(h8.lng),dQ(h8.lat),dQ(h7.lng),dQ(h7.lat));if(e<250000){return}var ic=Math.round(e/150000);var ih=this.calcAngularDistance(h8,h7);this.greatCirclePoints.push(h6);var ig=h8.lng;var ie=h6;for(var h9=0;h9<ic;h9++){var ib=this.calcMiddlePoint(h8,h7,h9/ic,ih);var id=ew.convertLL2MC(ib);var ia=id.lng;var ii=bS(id,ie);if(ii>30037726){if(id.lng<ie.lng){id.lng+=dd.WORLD_SIZE_MC}else{id.lng-=dd.WORLD_SIZE_MC}}this.greatCirclePoints.push(id);ie=id}var ii=bS(T,ie);if(ii>30037726){if(T.lng<ie.lng){T.lng+=dd.WORLD_SIZE_MC}else{T.lng-=dd.WORLD_SIZE_MC}}this.greatCirclePoints.push(T)},calcMiddlePoint:function(id,ic,ie,ij){var h7=id.lat;var h6=ic.lat;var ii=id.lng;var ig=ic.lng;var ik=dQ(h7);var ih=dQ(h6);var i=dQ(ii);var e=dQ(ig);var im=Math.sin((1-ie)*ij)/Math.sin(ij);var il=Math.sin(ie*ij)/Math.sin(ij);var ia=im*Math.cos(ik)*Math.cos(i)+il*Math.cos(ih)*Math.cos(e);var h9=im*Math.cos(ik)*Math.sin(i)+il*Math.cos(ih)*Math.sin(e);var h8=im*Math.sin(ik)+il*Math.sin(ih);var T=Math.atan2(h8,Math.sqrt(Math.pow(ia,2)+Math.pow(h9,2)));var ib=Math.atan2(h9,ia);return new hH(dj(ib),dj(T))},calcAngularDistance:function(h7,i){var h8=dQ(h7.lat);var h6=dQ(i.lat);var T=dQ(h7.lng);var e=dQ(i.lng);return Math.acos(Math.sin(h8)*Math.sin(h6)+Math.cos(h8)*Math.cos(h6)*Math.cos(Math.abs(e-T)))}});function am(h7,e){if(!h7||h7.length===0){return}var h6=[];for(var T=0;T<h7.length;T++){h6[T]=ew.convertLL2MC(h7[T])}a.call(this,h6,e)}am.inherits(a,"PolylineOut");D.extend(am.prototype,{toString:function(){return"Polyline"},setPath:function(h6){if(!h6||h6.length===0){return}var T=[];for(var e=0;e<h6.length;e++){T[e]=ew.convertLL2MC(h6[e])}this.setPathIn(T)},getPath:function(){var e=this.getPathIn();if(!e||e.length===0){return[]}var h6=[];for(var T=0;T<e.length;T++){h6[T]=ew.convertMC2LL(e[T])}return h6},getBounds:function(i){var e=this.getBoundsIn(i);var T=new dZ(ew.convertMC2LL(e.getSouthWest()),ew.convertMC2LL(e.getNorthEast()));return T}});function ey(T,h6,e){x.call(this,e);this._normalizedBounds=new dZ();this._cps=h6;this._path=T;this.setPoints(T);var i=this;ej.load("poly",function(){i._draw()})}ey.inherits(a,"BezierCurve");D.extend(ey.prototype,{getBoundsIn:function(e){if(!e){this._bounds.setMinMax();return this._bounds}this._normalizedBounds.setMinMax();return this._normalizedBounds},setPoints:function(e){this._clearCache();this.points=x.getGraphPoints(e).slice(0);this.points=this.calcBezierPoints(this.points,this._cps);this._calcBounds()},_calcBounds:function(){if(!this.points){return}var e=this;e._bounds.setNorthEast(null);e._bounds.setSouthWest(null);if(e.greatCirclePoints&&e.greatCirclePoints.length>0){D.each(e.greatCirclePoints,function(i){e._bounds.extend(i)})}else{D.each(e.points,function(i){e._bounds.extend(i)})}e._normalizedBounds.setSouthWest(e._bounds.getSouthWest());e._normalizedBounds.setNorthEast(e._bounds.getNorthEast());if(e._normalizedBounds.sw.lng<-dd.WORLD_SIZE_MC_HALF||e._normalizedBounds.ne.lng>dd.WORLD_SIZE_MC_HALF){e._normalizedBounds.sw.lng=-dd.WORLD_SIZE_MC_HALF;e._normalizedBounds.ne.lng=dd.WORLD_SIZE_MC_HALF}},getPathIn:function(){return this._path},setPathIn:function(e){this._path=e;this.setPoints(e)},getCpsIn:function(){return this._cps},setCpsIn:function(e){this._cps=e;this.setPoints(this._path)},calcBezierPoints:function(h6,h8){var T=[];for(var e=0;e<h6.length-1;e++){var h7=[h6[e],h8[e][0],h8[e][1],h6[e+1]];T=T.concat((this.bezierbetweenTwoP(h7)))}return T},bezierbetweenTwoP:function(h8){var T=100;var h7=1/T;var e=[];for(var h6=0;h6<T;h6++){e.push(this.getPointOnCubicBezier(h8,h6*h7))}return e},getPointOnCubicBezier:function(h9,id){var i;var h8;var h6;var ie;var h7;var T;var ic;var e;var ib;var ia;h6=3*(h9[1].lng-h9[0].lng);h8=3*(h9[2].lng-h9[1].lng)-h6;i=h9[3].lng-h9[0].lng-h6-h8;T=3*(h9[1].lat-h9[0].lat);h7=3*(h9[2].lat-h9[1].lat)-T;ie=h9[3].lat-h9[0].lat-T-h7;ic=id*id;e=ic*id;ib=(i*e)+(h8*ic)+(h6*id)+h9[0].lng;ia=(ie*e)+(h7*ic)+(T*id)+h9[0].lat;return new hH(ib,ia)}});function fz(h7,h9,e){if(!h7||h7.length===0){return}this.userPath=h7;this.userCps=h9;var h6=[];for(var T=0;T<h7.length;T++){h6[T]=ew.convertLL2MC(h7[T])}if(!h9||h9.length===0){return}var h8=[];for(var T=0;T<h9.length;T++){h8[T]=[];h8[T][0]=ew.convertLL2MC(h9[T][0]);if(h9[T][1]){h8[T][1]=ew.convertLL2MC(h9[T][1])}else{h8[T][1]=ew.convertLL2MC(h9[T][0])}}ey.call(this,h6,h8,e)}fz.inherits(ey,"BezierCurveOut");D.extend(fz.prototype,{toString:function(){return"BezierCurve"},setPath:function(h6){if(!h6||h6.length===0){return}this.userPath=h6;var T=[];for(var e=0;e<h6.length;e++){T[e]=ew.convertLL2MC(h6[e])}this.setPathIn(T)},getPath:function(){return this.userPath;var e=this.getPathIn();if(!e||e.length===0){return[]}var h6=[];for(var T=0;T<e.length;T++){h6[T]=ew.convertMC2LL(e[T])}return h6},getControlPoints:function(){return this.userCps;var e=this.getCpsIn();if(!e||e.length===0){return[]}var h6=[];for(var T=0;T<e.length;T++){h6[T]=[];h6[T][0]=ew.convertMC2LL(e[T][0]);h6[T][1]=ew.convertMC2LL(e[T][1])}return h6},setControlPoints:function(h6){if(!h6||h6.length===0){return}this.userCps=h6;var T=[];for(var e=0;e<h6.length;e++){T[e]=[];T[e][0]=ew.convertLL2MC(h6[e][0]);if(h6[e][1]){T[e][1]=ew.convertLL2MC(h6[e][1])}else{T[e][1]=ew.convertLL2MC(h6[e][0])}}this.setCpsIn(T)},getBounds:function(i){var e=this.getBoundsIn(i);var T=new dZ(ew.convertMC2LL(e.getSouthWest()),ew.convertMC2LL(e.getNorthEast()));return T}});function fx(e,T){x.call(this,T);this._normalizedBounds=new dZ();this.setPoints(e);var i=this;ej.load("poly",function(){i._draw()})}fx.inherits(a,"PolylineMultipart");D.extend(fx.prototype,{setPoints:function(e){if(!e){return}this._clearCache();this.points=this._unifyArgs(e);this._calcBounds()},_unifyArgs:function(T){var e=[];var i=[];if(T.constructor===Array){if(T[0].constructor===hH){i.push(T)}else{i=T}}else{if(typeof T==="string"){i.push(T)}}D.each(i,function(h6){e.push(x.getGraphPoints(h6))});return e},setPointAt:function(i,e,T){T=T||0;if(!e||!this.points[T]||!this.points[T][i]){return}this._clearCache();this.points[T][i]=new hH(e.lng,e.lat);this._calcBounds()},getBoundsIn:function(e){if(!e){this._bounds.setMinMax();return this._bounds}this._normalizedBounds.setMinMax();return this._normalizedBounds},_calcBounds:function(){if(!this.points){return}var e=this;e._bounds.setNorthEast(null);e._bounds.setSouthWest(null);if(e.greatCirclePoints&&e.greatCirclePoints.length>0){D.each(e.greatCirclePoints,function(i){e._bounds.extend(i)})}else{D.each(e.points,function(i){D.each(i,function(T){e._bounds.extend(T)})})}e._normalizedBounds.setSouthWest(e._bounds.getSouthWest());e._normalizedBounds.setNorthEast(e._bounds.getNorthEast());if(e._normalizedBounds.sw.lng<-dd.WORLD_SIZE_MC_HALF||e._normalizedBounds.ne.lng>dd.WORLD_SIZE_MC_HALF){e._normalizedBounds.sw.lng=-dd.WORLD_SIZE_MC_HALF;e._normalizedBounds.ne.lng=dd.WORLD_SIZE_MC_HALF}}});function aT(T,e){x.call(this,e);e=e||{};if(typeof e.fillOpacity==="number"){this._config.fillOpacity=e.fillOpacity}else{this._config.fillOpacity=0.6}fR(this._config.fillOpacity,0,1);if(e.fillColor===""){this._config.fillColor=""}else{this._config.fillColor=e.fillColor?e.fillColor:"#fff"}this._parseFillCacheWebGL=[];this.setPoints(T,e);var i=this;ej.load("poly",function(){i._draw()})}aT.inherits(x,"Polygon");D.extend(aT.prototype,{setPoints:function(h8){var h6=[];if(typeof h8==="string"||h8.length===1||h8[0] instanceof hH||h8[0] instanceof c8||this instanceof gl||h8.length===0){if(h8.length===1){h8=h8[0]}var e=this._processSinglePointArray(h8);this._userPoints=e.userPoints;h6=e.innerPoints;this.hasMultipleParts=false}else{this._userPoints=[];for(var h7=0;h7<h8.length;h7++){var T=this._processSinglePointArray(h8[h7]);this._userPoints.push(T.userPoints);h6.push(T.innerPoints)}this.hasMultipleParts=true}x.prototype.setPoints.call(this,h6)},setPathIn:function(e){this.setPoints(e)},_processSinglePointArray:function(e){var i=x.getGraphPoints(e).slice(0);innerPoints=i.slice(0);if(innerPoints.length>1&&!innerPoints[0].equals(innerPoints[innerPoints.length-1])){innerPoints.push(new hH(innerPoints[0].lng,innerPoints[0].lat))}return{userPoints:i,innerPoints:innerPoints}},setPointAt:function(i,e){if(!this._userPoints[i]){return}this._clearCache();this._userPoints[i]=new hH(e.lng,e.lat);this.points[i]=new hH(e.lng,e.lat);if(i===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new hH(e.lng,e.lat)}this._calcBounds()},setPositionAt:function(i,e){if(!this._userPoints[i]){return}var T=ew.convertLL2MC(e);this.setPointAt(i,T)},getPoints:function(){var e=this._userPoints;if(e.length===0){e=this.points}return e},getPathIn:function(){return this.getPoints()}});function hj(ib,h8){if(!ib||ib.length===0){return}var ia=[];if(typeof ib==="string"||ib[0] instanceof hH||ib[0] instanceof c8){var e=this._processSinglePointArray(ib);for(var h9=0;h9<e.innerPoints.length;h9++){ia[h9]=ew.convertLL2MC(e.innerPoints[h9])}}else{for(var h9=0;h9<ib.length;h9++){var T=this._processSinglePointArray(ib[h9]);var h7=[];for(var h6=0;h6<T.innerPoints.length;h6++){h7[h6]=ew.convertLL2MC(T.innerPoints[h6])}ia.push(h7)}}aT.call(this,ia,h8)}hj.inherits(aT,"PolygonOut");D.extend(hj.prototype,{toString:function(){return"Polygon"},setPath:function(h6){if(!h6||h6.length===0){return}h6=x.getGraphPoints(h6);var T=[];for(var e=0;e<h6.length;e++){T[e]=ew.convertLL2MC(h6[e])}this.setPathIn(T)},getPath:function(){var e=this.getPathIn();if(!e||e.length===0){return[]}var h6=[];for(var T=0;T<e.length;T++){h6[T]=ew.convertMC2LL(e[T])}return h6}});function gl(i,e,T){this.point=i;this.radius=Math.abs(e);aT.call(this,[],T)}gl.parseTolerance={0:[0.01,0.0001,0.00001,0.000004],1:[1000,10,1,0.4]};gl.inherits(aT,"Circle");D.extend(gl.prototype,{initialize:function(e){this.map=e;this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();return null},getPoint:function(){return this.point},setPoint:function(e){if(!e){return}this.point=e;this.latLng=ew.convertMC2LL(e)},setCenterIn:function(e){var i=arguments[1];this.setPoint(e,i)},setRadius:function(e){this.radius=Math.abs(e)},getCenterIn:function(){return this.point},getRadius:function(){return this.radius},_getPerimeterPoints:function(e,id){if(!e||!id||!this.map){return[]}var T=this.map;var ia=e.lng;var h8=e.lat;var ik=ew.convertMC2LL(e);ia=ik.lng;h8=ik.lat;var il=[];var ig=id/ew.EARTHRADIUS;var ic=(Math.PI/180)*h8;var ij=(Math.PI/180)*ia;for(var ib=0;ib<360;ib+=9){var h9=(Math.PI/180)*ib;var ih=Math.asin(Math.sin(ic)*Math.cos(ig)+Math.cos(ic)*Math.sin(ig)*Math.cos(h9));var ie=Math.atan2(Math.sin(h9)*Math.sin(ig)*Math.cos(ic),Math.cos(ig)-Math.sin(ic)*Math.sin(ih));var ii=((ij-ie+Math.PI)%(2*Math.PI))-Math.PI;var h7=new c8(ih*(180/Math.PI),ii*(180/Math.PI));il.push(ew.convertLL2MC(h7))}var h6=il[0];il.push(new hH(h6.lng,h6.lat));if(h6){this._radiusMercator=Math.sqrt(Math.pow(h6.lng-this.point.lng,2)+Math.pow(h6.lat-this.point.lat,2))}else{this._radiusMercator=this.radius}return il}});function dL(i,e,h6){this.latLng=new c8(i.lat,i.lng);var T=ew.convertLL2MC(i);gl.call(this,T,e,h6)}dL.inherits(gl,"CircleOut");D.extend(dL.prototype,{toString:function(){return"Circle"},setCenter:function(e){this.latLng=new c8(e.lat,e.lng);var i=ew.convertLL2MC(e);this.setCenterIn(i)},getCenter:function(){return this.latLng},getPath:function(){var e=this.getPathIn();if(!e||e.length===0){return[]}var h6=[];for(var T=0;T<e.length;T++){h6[T]=ew.convertMC2LL(e[T])}return h6}});function bv(h6,e,i){x.call(this,i);i=i||{};if(typeof i.topFillOpacity==="number"){this._config.topFillOpacity=i.topFillOpacity}else{this._config.topFillOpacity=0.6}if(typeof i.sideFillOpacity==="number"){this._config.sideFillOpacity=i.sideFillOpacity}else{this._config.sideFillOpacity=0.8}fR(this._config.sideFillOpacity,0,1);if(i.topFillColor===""){this._config.topFillColor=""}else{this._config.topFillColor=i.topFillColor?i.topFillColor:"#fff"}if(i.sideFillColor===""){this._config.sideFillColor=""}else{this._config.sideFillColor=i.sideFillColor?i.sideFillColor:"#fff"}this._parseFillCacheWebGL=[];this.setPoints(h6,i);this._config.altitude=e||0;var T=this;ej.load("poly",function(){T._draw()})}bv.inherits(x,"Prism");D.extend(bv.prototype,{setPoints:function(h8){var h6=[];if(typeof h8==="string"||h8[0] instanceof hH||h8[0] instanceof c8||this instanceof gl||h8.length===0){var e=this._processSinglePointArray(h8);this._userPoints=e.userPoints;h6=e.innerPoints;this.hasMultipleParts=false}else{this._userPoints=[];for(var h7=0;h7<h8.length;h7++){var T=this._processSinglePointArray(h8[h7]);this._userPoints.push(T.userPoints);h6.push(T.innerPoints)}this.hasMultipleParts=true}x.prototype.setPoints.call(this,h6)},setPathIn:function(e){this.setPoints(e)},_processSinglePointArray:function(e){var i=x.getGraphPoints(e).slice(0);innerPoints=i.slice(0);if(innerPoints.length>1&&!innerPoints[0].equals(innerPoints[innerPoints.length-1])){innerPoints.push(new hH(innerPoints[0].lng,innerPoints[0].lat))}return{userPoints:i,innerPoints:innerPoints}},setPointAt:function(i,e){if(!this._userPoints[i]){return}this._clearCache();this._userPoints[i]=new hH(e.lng,e.lat);this.points[i]=new hH(e.lng,e.lat);if(i===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new hH(e.lng,e.lat)}this._calcBounds()},getPoints:function(){var e=this._userPoints;if(e.length===0){e=this.points}return e},getPathIn:function(){return this.getPoints()},setTopFillOpacity:function(e){if(e>1||e<0){return}this._config.topFillOpacity=e;this._setDomAttribute("topfillopacity",e)},getTopFillOpacity:function(){return this._config.topFillOpacity},setSideFillOpacity:function(e){if(e>1||e<0){return}this._config.sideFillOpacity=e;this._setDomAttribute("sidefillopacity",e)},getSideFillOpacity:function(){return this._config.sideFillOpacity},setTopFillColor:function(e){this._config.topFillColor=e||"";this._setDomAttribute("topfillcolor",e)},getTopFillColor:function(){return this._config.topFillColor},setSideFillColor:function(e){this._config.sideFillColor=e||"";this._setDomAttribute("sidefillcolor",e)},getSideFillColor:function(){return this._config.sideFillColor},setAltitude:function(e){this._config.altitude=Number(e);this.draw();var i=new be("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getAltitude:function(){return this._config.altitude}});function cj(ia,h8,ib){if(!ia||ia.length===0){return}this.userPath=ia;var e=[];if(typeof ia==="string"||ia[0] instanceof hH||ia[0] instanceof c8){var ic=this._processSinglePointArray(ia);for(var h7=0;h7<ic.innerPoints.length;h7++){e[h7]=ew.convertLL2MC(ic.innerPoints[h7])}}else{for(var h7=0;h7<ia.length;h7++){var h9=this._processSinglePointArray(ia[h7]);var T=[];for(var h6=0;h6<h9.innerPoints.length;h6++){T[h6]=ew.convertLL2MC(h9.innerPoints[h6])}e.push(T)}}bv.call(this,e,h8,ib)}cj.inherits(bv,"PrismOut");D.extend(cj.prototype,{toString:function(){return"Prism"},setPath:function(h6){if(!h6||h6.length===0){return}this.userPath=h6;var T=[];for(var e=0;e<h6.length;e++){T[e]=ew.convertLL2MC(h6[e])}this.setPathIn(T)},getPath:function(){return this.userPath;var e=this.getPathIn();if(!e||e.length===0){return[]}var h6=[];for(var T=0;T<e.length;T++){h6[T]=ew.convertMC2LL(e[T])}return h6}});function d4(T,e){x.call(this,e);e=e||{};this._config.type=e.type||"image";this._config.url=e.url||"";this._config.opacity=typeof e.opacity==="number"?e.opacity:1;fR(this._config.opacity,0,1);this._parseFillCacheWebGL=[];this.setPoints(T,e);var i=this;ej.load("poly",function(){i._draw()})}d4.inherits(x,"GroundOverlay");D.extend(d4.prototype,{setPoints:function(i){var e=x.getGraphPoints(i).slice(0);this.hasMultipleParts=false;x.prototype.setPoints.call(this,e)},setPathIn:function(e){this.setPoints(e)},getPoints:function(){return this.points},getPathIn:function(){return this.getPoints()}});function cs(h7,T){if(!h7){return}var h9=[new hH(h7.sw.lng,h7.ne.lat),new hH(h7.ne.lng,h7.ne.lat),new hH(h7.ne.lng,h7.sw.lat),new hH(h7.sw.lng,h7.sw.lat)];var e=x.getGraphPoints(h9).slice(0);var h8=[];for(var h6=0;h6<e.length;h6++){h8[h6]=ew.convertLL2MC(e[h6])}d4.call(this,h8,T)}cs.inherits(d4,"GroundOverlayOut");D.extend(cs.prototype,{toString:function(){return"GroundOverlay"}});var bE={};function hW(T,i){D.BaseClass.call(this);this.content=T;this.map=null;this._config={width:0,height:0,maxWidth:600,offset:new ei(0,0),title:"",maxContent:"",enableMaximize:false,enableAutoPan:true,enableCloseOnClick:true,margin:[10,10,40,10],collisions:[[10,10],[10,10],[10,10],[10,10]],ifMaxScene:false,onClosing:function(){return true}};this.setConfig(i);if(this._config.width<50){this._config.width=50}if(this._config.width>730){this._config.width=730}if(this._config.height!=0){if(this._config.height<50){this._config.height=50}if(this._config.height>650){this._config.height=650}}if(this._config.maxWidth!==0){if(this._config.maxWidth<50){this._config.maxWidth=50}if(this._config.maxWidth>730){this._config.maxWidth=730}}this.isWinMax=false;this.IMG_PATH=fe.imgPath;this.overlay=null;var e=this;ej.load("simpleInfowindow",function(){e._draw()})}hW.inherits(D.BaseClass,"SimpleInfoWindow");D.extend(hW.prototype,{setWidth:function(e){e=e*1;if(!e&&e!=0||isNaN(e)||e<0){return}if(e!=0){if(e<50){e=50}if(e>730){e=730}}this._config.width=e},setHeight:function(e){e=e*1;e-=10;if(!e&&e!=0||isNaN(e)||e<0){return}if(e!=0){if(e<50){e=50}if(e>650){e=650}}this._config.height=e},setMaxWidth:function(e){e=e*1;if(!e&&e!=0||isNaN(e)||e<0){return}if(e!=0){if(e<50){e=50}if(e>730){e=730}}this._config.maxWidth=e},setTitle:function(e){this._config.title=e||""},setContent:function(e){this.content=e||""},setMaxContent:function(e){this._config.maxContent=e||""},redraw:function(){},enableAutoPan:function(){this._config.enableAutoPan=true},disableAutoPan:function(){this._config.enableAutoPan=false},enableCloseOnClick:function(){this._config.enableCloseOnClick=true},disableCloseOnClick:function(){this._config.enableCloseOnClick=false},enableMaximize:function(){this._config.enableMaximize=true},disableMaximize:function(){this._config.enableMaximize=false},show:function(){this._visible=true},hide:function(){this._visible=false},close:function(){this.hide()},dispose:function(){D.BaseClass.prototype.decontrol.call(this)},maximize:function(){this.isWinMax=true},restore:function(){this.isWinMax=false},setConfig:function(i){if(!i){return}for(var e in i){if(typeof(this._config[e])==typeof(i[e])){this._config[e]=i[e]}}},isVisible:function(){return this.isOpen()},isOpen:function(){return false},getPoint:function(){if(this.overlay&&this.overlay.getPoint){return this.overlay.getPoint()}},getOffset:function(){return this._config.offset},dispose:function(){D.BaseClass.prototype.decontrol.call(this)},toString:function(){return"SimpleInfoWindow"}});dd.prototype.openSimpleInfoWindow=function(h6,e){if(!h6||h6.toString()!="SimpleInfoWindow"||!e||e.toString()!="Point"){return}var i=this.temp;if(!i.marker){var T=new hq(fe.imgPath+"blank.gif",{width:1,height:1});i.marker=new dw(e,{icon:T,width:1,height:1,offset:new ei(0,0),infoWindowOffset:new ei(0,0),clickable:false});i.marker._fromMap=1}else{i.marker.setPoint(e)}this.addOverlay(i.marker);i.marker.show();i.marker.openSimpleInfoWindow(h6)};dd.prototype.closeSimpleInfoWindow=function(){var e=this.temp.infoWin||this.temp._infoWin;if(e&&e.overlay){e.overlay.closeSimpleInfoWindow()}};cZ.prototype.openSimpleInfoWindow=function(e){if(this.map){this.map.closeSimpleInfoWindow();e._visible=true;this.map.temp._infoWin=e;e.overlay=this;D.BaseClass.call(e,e.hashCode)}};cZ.prototype.closeSimpleInfoWindow=function(){if(this.map&&this.map.temp._infoWin){this.map.temp._infoWin._visible=false;this.map.temp._infoWin.decontrol();this.map.temp._infoWin=null}};function es(e,i){e=isNaN(e)?0:e;i=isNaN(i)?0:i;this.x=e;this.y=i}es.prototype.equals=function(e){if(!e){return false}return e.x===this.x&&e.y===this.y};es.prototype.clone=function(){return new es(this.x,this.y)};es.prototype.toString=function(){return"Pixel"};function ei(i,e){if(typeof i!=="number"){this.width=parseFloat(i)}else{this.width=i}if(typeof e!=="number"){this.height=parseFloat(e)}else{this.height=e}}ei.prototype.equals=function(e){return !!(e&&this.width===e.width&&this.height===e.height)};ei.prototype.toString=function(){return"Size"};var bK={B_NORMAL_MAP:{tileUrls:eA(fe.tileDomain,fe.rasterTilePath),vectorTileUrls:eA(fe.tileDomain,fe.vectorTilePath),tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,webgl:{minZoom:3,maxZoom:25},zoomLevelBase:18,errorUrl:fe.imgPath+"bg.png",bounds:new dZ(new hH(-21364736,-11708041.66),new hH(23855104,12474104.17)),imgExtend:"png"},B_SATELLITE_MAP:{tileUrls:["//maponline0.bdimg.com/starpic/?qt=satepc&","//maponline1.bdimg.com/starpic/?qt=satepc&","//maponline2.bdimg.com/starpic/?qt=satepc&","//maponline3.bdimg.com/starpic/?qt=satepc&"],tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,zoomLevelBase:18,errorUrl:fe.imgPath+"bg.png",bounds:new dZ(new hH(-21364736,-10616832),new hH(23855104,15859712)),imgExtend:"png"},B_STREET_MAP:{tileUrls:eA(fe.tileDomain,fe.rasterTilePath),tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,zoomLevelBase:18,errorUrl:fe.imgPath+"bg.png",bounds:new dZ(new hH(-21364736,-10616832),new hH(23855104,15859712)),imgExtend:"png"},BMAP_CUSTOM_LAYER:{tileUrls:[""],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,zoomLevelBase:18,errorUrl:fe.imgPath+"blank.gif",bounds:new dZ(new hH(-21364736,-10616832),new hH(23855104,15859712)),imgExtend:"png"},B_EARTH_MAP:{tileUrls:[""],tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,webgl:{minZoom:3,maxZoom:21},zoomLevelBase:18,errorUrl:fe.imgPath+"blank.gif",bounds:new dZ(new hH(-21364736,-10616832),new hH(23855104,15859712)),imgExtend:"png"},B_NONE_MAP:{tileUrls:"",tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,zoomLevelBase:18,errorUrl:fe.imgPath+"bg.png",bounds:new dZ(new hH(-21364736,-11708041.66),new hH(23855104,12474104.17)),imgExtend:"png"}};var b9=bK;function dH(h9,ia,T,e,h8){if(h8&&b9[h8]){this.mapTypeName=h8}else{this.mapTypeName=BMAP_NORMAL_MAP}if(h9&&h9 instanceof Array){var h7=true;for(var h6=0;h6<h9.length;h6++){if(h9[h6] instanceof dZ){continue}else{h7=false;break}}h7&&(this.bounds=h9)}if(typeof ia==="number"&&ia>=b9[this.mapTypeName].webgl.minZoom){if(b9[this.mapTypeName].webgl){if(ia>=b9[this.mapTypeName].webgl.minZoom){this.minZoom=ia}else{this.minZoom=b9[this.mapTypeName].webgl.minZoom}}else{if(ia>=b9[this.mapTypeName].minZoom){this.minZoom=ia}else{this.minZoom=b9[this.mapTypeName].minZoom}}}if(typeof T==="number"){if(b9[this.mapTypeName].webgl){if(T<=b9[this.mapTypeName].webgl.maxZoom){this.maxZoom=T}else{this.maxZoom=b9[this.mapTypeName].webgl.maxZoom}}else{if(T<=b9[this.mapTypeName].maxZoom){this.maxZoom=T}else{this.maxZoom=b9[this.mapTypeName].maxZoom}}}if(this.maxZoom<this.minZoom){this.maxZoom=null}if(e&&typeof e==="function"){this.tileUrlFunction=e}}D.extend(dH.prototype,{addBoundary:function(e){if(e instanceof dZ){if(this.bounds){this.bounds.push(e)}else{this.bounds=[e]}}},setTileUrlFunction:function(e){if(e&&typeof e==="function"){this.tileUrlFunction=e}},crossPoint:function(e,h6,h7){if(h7<this.minZoom||h7>this.maxZoom){return false}var h8=this.containsPoint(e,h7);if(h8){return h8}for(var T=0;T<this.bounds.length;T++){if(this.bounds[T].intersects(h6)){h8=true;break}}return h8},containsPoint:function(e,h6){if(!e||!(e instanceof hH)||!this.isValid()){return false}var h7=false;if(h6<this.minZoom||h6>this.maxZoom){return h7}for(var T=0;T<this.bounds.length;T++){if(this.bounds[T].containsPoint(e)){h7=true;break}}return h7},isValid:function(){return this.bounds&&this.minZoom&&this.maxZoom&&this.tileUrlFunction},toString:function(){return"PrivateRegionDataModel"}});function bW(ib,i,h7,T,h6){this.mgr=ib;this.position=h7;this._cbks=[];this.name=ib.getTileName(T,h6,ib.map.config.style);this.info=T;this._transparentPng=h6.isTransparentPng();var ic=U("img");ds(ic);ic.galleryImg=false;var ia=ic.style;ia.position="absolute";ia.width=ib.tileSize+"px";ia.height=ib.tileSize+"px";ia.left=h7[0]+"px";ia.top=h7[1]+"px";this.img=ic;this.src=i;if(ad&&h7._offsetX===0){ia.opacity=0;ia.willChange="opacity"}var h9=this;this.img.onload=function(il){if(!h9.mgr){return}var ig=h9.mgr;var id=ig.bufferTiles;if(ig.bufferNumber>0){id[h9.name]=h9;id.push(h9.name)}var ii=id.length-ig.bufferNumber;for(var ij=0;ii>0&&ij<id.length;ij++){var ik=id[ij];if(!ig.mapTiles[ik]){if(id[ik]){id[ik].mgr=null;var ih=id[ik].img;if(ih.parentNode){fC(ih);ih.parentNode.removeChild(ih)}ih=null;id[ik].img=null;id[ik]=null;delete id[ik]}id.splice(ij,1);ij--;ii--}}h9.loaded=true;ig.imgNumber++;if(!hs(h9.img)){if(h6.tilesDiv){h6.tilesDiv.appendChild(h9.img)}}var il=new be("onimagechange");il.action="show";il.tile=h9.name;ig.map.dispatchEvent(il);if(ad&&h7._offsetX===0){var ie=new p({fps:10,duration:300,render:function(e){if(h9.img&&h9.img.style){h9.img.style.opacity=e*1}},finish:function(){if(h9.img&&h9.img.style){delete h9.img.style.opacity;h9.img.style.willChange="auto"}}})}h9._callCbks()};this.img.onerror=function(ig){h9.error=true;h9._callCbks();if(!h9.mgr){return}var id=h9.mgr;var ie=b9[h6.mapType];if(ie.errorUrl){h9.img.src=ie.errorUrl}if(!hs(h9.img)){if(h6.tilesDiv){h6.tilesDiv.appendChild(h9.img)}}};ic=null;var h8=new be("onimagebefore");h8.tile=h9.name;ib.map.dispatchEvent(h8)}bW.prototype._addLoadCbk=function(e){this._cbks.push(e)};bW.prototype._load=function(){if(FeBrowser.ie<=6&&FeBrowser.ie>0&&this._transparentPng){this.img.src=fe.imgPath+"blank.gif"}else{this.img.src=this.src}};bW.prototype._callCbks=function(){var T=this;for(var e=0;e<T._cbks.length;e++){T._cbks[e]()}T._cbks.length=0};var ad=(!D.Browser.ie||D.Browser.ie>8);function fp(e){this.tileLayers=[];this.map=e;this.bufferNumber=300;this.mapTiles=[];this.bufferTiles=[];this.config=b9[this.map.mapType];this.errorUrl=this.config.errorUrl;this.tileSize=this.config.tileSize;this.baseUnits=this.config.baseUnits;this.baseZoomLevel=this.config.zoomLevelBase;this.tileURLs=this.config.tileUrls;this.imgNumber=0;this.numLoading=0;this.temp={}}br.register(function(i){if(i._renderType==="webgl"){return}var e=i.tileMgr=new fp(i);i.addEventListener("mousewheel",function(T){e.mouseWheel(T)});i.addEventListener("dblclick",function(T){e.dblClick(T)});i.addEventListener("rightdblclick",function(T){e.dblClick(T)});i.addEventListener("minuspress",function(T){e.keypress(T)});i.addEventListener("pluspress",function(T){e.keypress(T)});i.addEventListener("load",function(T){if(this.mapType===BMAP_EARTH_MAP){return}e.loadTiles()});i.addEventListener("zoomstartcode",function(T){if(this.mapType===BMAP_EARTH_MAP){return}e._zoom(T)});i.addEventListener("moving",function(T){if(this.mapType===BMAP_EARTH_MAP){return}e.moveGridTiles()});i.addEventListener("resize",function(T){if(this.mapType===BMAP_EARTH_MAP){return}e.resizeMap(T)});i.addEventListener("addtilelayer",function(T){e.addTileLayer(T)});i.addEventListener("removetilelayer",function(T){e.removeTileLayer(T)})});D.extend(fp.prototype,{addTileLayer:function(h6){var T=this;var i=h6.target;T.tileLayers.push(i);if(T.map.loaded){T.moveGridTiles()}},removeTileLayer:function(id){var ie=this;var ib=id.target;var h9=ib.mapType;var h8=ie.mapTiles;var ih=ie.bufferTiles;for(var T in ih){var h6=T.split("-")[1];if(h6==h9){delete ih[T]}}for(var T in h8){var h6=T.split("-")[1];if(h6==h9){delete h8[T]}}if(ie.zoomsDiv&&ie.zoomsDiv.parentNode){ie.zoomsDiv.parentNode.removeChild(ie.zoomsDiv);ie.zoomsDiv.innerHTML=""}var h7=ie.map;if(h7.deepZoom){var ig=h7.deepZoom.preDeepZoomDiv;if(ig&&ig.parentNode){ig.parentNode.removeChild(ig)}}for(var ic=0,ia=ie.tileLayers.length;ic<ia;ic++){if(ib==ie.tileLayers[ic]){ie.tileLayers.splice(ic,1)}}ie.moveGridTiles()},hideDeepZoomDiv:function(){var i=this,T=i.map;if(T.deepZoom){var e=T.deepZoom.preDeepZoomDiv;if(e&&e.style.display!="none"){e.style.display="none"}}},getTileLayer:function(h7){var h6=this;for(var T=0,e=h6.tileLayers.length;T<e;T++){tilelayer=h6.tileLayers[T];if(tilelayer.mapType==h7){return tilelayer}}return null},_zoom:function(T){var i=this;if(i.zoomsDiv&&i.zoomsDiv.style.display!="none"){i.zoomsDiv.style.display="none"}i.hideDeepZoomDiv();i.moveGridTiles()},resizeMap:function(i){this.loaded=false;this.moveGridTiles()},_checkTilesLoaded:function(){this.numLoading--;var e=this;if(this.numLoading==0){if(this._checkLoadedTimer){clearTimeout(this._checkLoadedTimer);this._checkLoadedTimer=null}this._checkLoadedTimer=setTimeout(function(){if(e.numLoading==0){e.map.dispatchEvent(new be("ontilesloaded"))}e._checkLoadedTimer=null},80)}},getTileName:function(e,T,i){var h7=T.mapType;var h6="TILE-"+h7+"-"+i+"-"+e[0]+"-"+e[1]+"-"+e[2];return h6},hideTile:function(h6,T){var i=h6.img;if(hs(i)){if(h6.loaded){this.imgNumber--}if(i.parentNode){fC(i);i.parentNode.removeChild(i)}}var h7=new be("onimagechange");h7.tile=this.getTileName(h6.info,T,this.map.config.style);h7.action="hide";delete this.mapTiles[h6.name];if(!h6.loaded){fC(i);h6._callCbks();i=null;h6.img=null;h6.mgr=null}this.map.dispatchEvent(h7)},loadTiles:function(){var i=this;if(D.Browser.ie){try{document.execCommand("BackgroundImageCache",false,true)}catch(T){}}if(this.zoomsDiv&&this.zoomsDiv.style.display!="none"){this.zoomsDiv.style.display="none"}i.hideDeepZoomDiv();i.moveGridTiles()},getCell:function(h7,h6){var e=this.baseUnits*Math.pow(2,(this.baseZoomLevel-h6));var T=parseInt(h7.lng/e);var i=parseInt(h7.lat/e);return[T,i,e*(T+0.5),e*(i+0.5)]},moveGridTiles:function(){var im=this.map,ix=im.getMapType(),iv=this.tileLayers.length;var it=im.centerPoint;if(ix!==BMAP_SATELLITE_MAP){it=ed.calcLoopCenterPoint(it)}var ib=im.width;var iJ=im.getZoomUnits();var iu=iJ*ib;var iz=it.lng-iu/2;var ii=it.lng+iu/2;var il=ed.isAddWidth(iz,ii);for(var iB=0;iB<iv;iB++){var h7=this.tileLayers[iB];if(h7.baseLayer||iv==1){this.tilesDiv=h7.tilesDiv}var io=b9[h7.mapType];var h6=im.zoomLevel;var iE=im.getZoomUnits(im.zoomLevel);var ih=io.baseUnits*Math.pow(2,(io.zoomLevelBase-h6));var ie=Math.floor(it.lng/ih);var iA=Math.floor(it.lat/ih);var ik=io.tileSize;var ip=[ie,iA,(it.lng-ie*ih)/ih*ik,(it.lat-iA*ih)/ih*ik];var ig=il?im.width/2*1.5:im.width/2;var ij=ip[0]-Math.ceil((ig-ip[2])/ik);var iI=ip[1]-Math.ceil((im.height/2-ip[3])/ik);var iC=ip[0]+Math.ceil((ig+ip[2])/ik);var iq=ip[1]+Math.ceil((im.height/2+ip[3])/ik);var ic=[];for(var iG=ij;iG<iC;iG++){for(var iF=iI;iF<iq;iF++){ic.push([iG,iF]);var iw="id_"+iG+"_"+iF+"_"+h6;ic[iw]=true}}if(h7.mapType!==BMAP_SATELLITE_MAP){ic=ed.calcLoopTiles(ic,h6)}ic.sort((function(i){return function(id,iL){return((0.4*Math.abs(id[0]-i[0])+0.6*Math.abs(id[1]-i[1]))-(0.4*Math.abs(iL[0]-i[0])+0.6*Math.abs(iL[1]-i[1])))}})([ip[0],ip[1]]));var T=this.mapTiles;var e=-it.lng/iE;var iK=it.lat/iE;var iy=[e,iK];for(var ir in T){var h9=T[ir];var iH=h9.info;if(!iH){continue}var iw="id_"+iH[0]+"_"+iH[1]+"_"+iH[2];if(!ic[iw]){this.hideTile(h9,h7)}}var h8=-im.offsetX+im.width/2;var ia=-im.offsetY+im.height/2;h7.tilesDiv.style.left=Math.round(e+h8)-iy[0]+"px";h7.tilesDiv.style.top=Math.round(iK+ia)-iy[1]+"px";this.numLoading+=ic.length;for(var iG=0,iD=ic.length;iG<iD;iG++){this.showTile([ic[iG][0],ic[iG][1],im.zoomLevel],iy,h7,iG,im.config.style)}}},showTile:function(h9,h8,ic,ii){this.centerPos=h8;var ia=b9[ic.mapType];var id=this.map.config.style;var h6=this.getTileName(h9,ic,id);var h7=(h9[0]*ia.tileSize)+h8[0];var T=(-1-h9[1])*ia.tileSize+h8[1];var ih=[h7,T];var ib=null;if(ic.mapType!==BMAP_SATELLITE_MAP){ib=ed.calcLoopParam(h9[0],h9[2]);var ig=ib.offsetX;ih[0]+=ig;ih._offsetX=ig}var il=this;var ik=this.mapTiles[h6];if(ik){ik.img.style.left=ih[0]+"px";ik.img.style.top=ih[1]+"px";if(ik.loaded){this._checkTilesLoaded()}else{ik._addLoadCbk(function(){il._checkTilesLoaded()})}return}ik=this.bufferTiles[h6];if(ik){this.imgNumber++;ic.tilesDiv.insertBefore(ik.img,ic.tilesDiv.lastChild);this.mapTiles[h6]=ik;ik.img.style.left=ih[0]+"px";ik.img.style.top=ih[1]+"px";if(ik.loaded){this._checkTilesLoaded()}else{ik._addLoadCbk(function(){il._checkTilesLoaded()})}var ij=new be("onimagechange");ij.action="cache";ij.tile=this.getTileName(h9,ic,id);this.map.dispatchEvent(ij)}else{var ie=new es(h9[0],h9[1]);if(ib){ie.x=ib.col}var i=ic.getTilesUrl(ie,h9[2]);ik=new bW(this,i,ih,h9,ic);ik._addLoadCbk(function(){il._checkTilesLoaded()});ik._load();this.mapTiles[h6]=ik;bB(this.map)}},mouseWheel:function(ia){var h9=this.map;if(!h9.config.enableWheelZoom){return}var ib=h9.zoomLevel+(ia.trend===true?1:-1);var h7=h9._getProperZoom(ib);if(h7.exceeded){var T=new be("onzoomexceeded");T.targetZoom=ib;h9.dispatchEvent(T);return}h9.dispatchEvent(new be("onzoomstart"));h9.lastLevel=h9.zoomLevel;h9.zoomLevel=h7.zoom;var i=ia.pixel;var h6=h9.pixelToPointIn(i,{zoom:h9.lastLevel});var h8=h9.getZoomUnits(h9.zoomLevel);h9.centerPoint=new hH(h6.lng+h8*(h9.width/2-i.x),h6.lat-h8*(h9.height/2-i.y));this.zoom(i)},dblClick:function(T){var i=this.map;if(!i.config.enableDblclickZoom){return}if(i.mapType==="B_EARTH_MAP"){return}if(i.currentOperation===d1.dragging){return}if(T.type=="onrightdblclick"){i.zoomOut(T.point)}else{i.zoomIn(T.point)}},keypress:function(T){var i=this.map;if(i.getMapType()===BMAP_EARTH_MAP){return}T.type=="onpluspress"?i.zoomIn():i.zoomOut()}});function cV(h6){this.opts=h6||{};this.copyright=this.opts.copyright||{};this.transparentPng=this.opts.transparentPng||false;this.png8=this.opts.png8||false;this.baseLayer=this.opts.baseLayer||false;this.dataType=this.opts.dataType||1;this.transform=this.opts.transform||0;this.isFlat=!this.opts.isFlat?false:true;this.showLabel=this.opts.showLabel===false?false:true;var e=this.opts.tileTypeName||"web";this.tileType=cP.getInstance(e);this.clipTile=this.opts.clipTile||false;this._type="tilelayer";var i=gi()?128:256;this.cacheSize=this.opts.cacheSize||i;var T=this;this.tileCache=new fa(this.cacheSize,{clearCallback:function(h7){if(h7.label){if(h7.label.textImageBitmap){h7.label.textImageBitmap.close()}if(h7.label.indoorTextImageBitmap){h7.label.indoorTextImageBitmap.close()}}T._removeIndoorData(h7)}});this.scaler=a9()>=1.5?2:1;this.normalUdt=aG("ditu","normal").udt;this.numLoading=0;this.useThumbData=false;this.useThumbData=this.opts.useThumbData||false;if(this.baseLayer){this.useThumbData=true}if(typeof this.opts.customLayer==="boolean"){this.customLayer=this.opts.customLayer}else{this.customLayer=true}}cV.inherits(em,"TileLayer");D.extend(cV.prototype,{isTransparentPng:function(){return this.transparentPng},getTilesUrl:function(id,e){var T=b9[this.mapType];if(typeof T!=="object"){return null}var h6=id.x;var ie=id.y;if(this.mapType!==BMAP_SATELLITE_MAP){var ie=ed.calcLoopParam(ie,e).col}var i="";if(this.opts.tileUrlTemplate){i=this.opts.tileUrlTemplate;i=i.replace(/\{X\}/,ie);i=i.replace(/\{Y\}/,h6);i=i.replace(/\{Z\}/,e)}else{if(this.mapType===BMAPGL_NORMAL_MAP){var ic=this.isCanvasMap?0:1;var h8=T.tileUrls[Math.abs(ie+h6)%T.tileUrls.length];if(window.offLineIPAddress){h8=window.offLineIPAddress+"tile5/"}var h7=this.map.config.style;i=h8+"?qt=vtile&x="+h6+"&y="+ie+"&z="+e+(h7==="default"?"":("&styleId=1"))+"&styles=pl&udt="+this.normalUdt+"&scaler="+this.scaler+"&showtext="+ic;i=i.replace(/-(\d+)/gi,"M$1")}if(this.mapType===BMAP_SATELLITE_MAP){var h9=aG("ditu","satellite");var ib=h9.ver;var ia=h9.udt;i=T.tileUrls[Math.abs(ie+h6)%T.tileUrls.length]+"u=x="+h6+";y="+ie+";z="+e+";v="+ib+";type=sate&fm=46&udt="+ia;i=i.replace(/-(\d+)/gi,"M$1")}}return i},initialize:function(h8){this.map=h8;if(h8._renderType==="webgl"){var h7=null;if(this.customLayer!==false){h7=this.getTilesUrl}D.extend(this,f5);this.labelProcessor=new dp(this);this.callbackDataQueue=[];if(h7){this.getTilesUrl=h7}var i=this;h8.on("indoor_data_refresh",function(h9){if(!i.baseLayer){return}i._refreshIndoorData(h9.uid,h9.floor)});h8.on("custom_labels_ready",function(h9){if(!i.baseLayer){return}i._doWorkAfterLabelImageLoad(h9.virtualTile,h9.labelCanvas,null,h9.imgKey)});h8.on("glmoduleloaded",function(){if(!i.baseLayer){return}i.updateAllIconsTextureCoords()});h8.on("layer_update",function(ia){if(ia.name===i.tileType.getName()&&h8.customLoaded){i.tileCache.clear();h8._featureMgr.clearData(i.drawIndex);h8._featureMgr.setLabelData([]);h8._featureMgr.clearLabelOverlayData();i.labelProcessor.iconCache={};var h9=new be("onlayer_clear");h8.fire(h9)}})}if(!h8.temp.layerZIndex){h8.temp.layerZIndex=0}this.zIndex=this.zIndex||0;if(this.baseLayer){this.zIndex=0}this.adjustZIndex();if(!h8.temp.layid){h8.temp.layid=0}if(!this.opts.mapType){this.mapType="BMAP_CUSTOM_LAYER_"+h8.temp.layid;h8.temp.layid++}else{this.mapType=this.opts.mapType}var T=b9[this.mapType];if(!T){b9[this.mapType]={tileUrls:[],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:19,minZoom:3,maxZoom:19,minDataZoom:3,maxDataZoom:19,zoomLevelBase:18,errorUrl:fe.imgPath+"/blank.gif",bounds:new dZ(new hH(-21364736,-10616832),new hH(23855104,15859712)),imgExtend:"png"}}if(h8._renderType!=="webgl"){var h6=dO(h8.platform,\'<div style="position:absolute;z-index:\'+this.zIndex+\'"></div>\');h6.style.display="";h6.style.left=Math.ceil(-h8.offsetX+h8.width/2)+"px";h6.style.top=Math.ceil(-h8.offsetY+h8.height/2)+"px";this.tilesDiv=h6}this.isCanvasMap=h8.isCanvasMap();this.lastZoom=h8.getZoom();var e=this;this.addEventListener("initDrawData",function(h9){if(e.opts.boundary){e.addBoundary(e.opts.boundary)}})},remove:function(){if(this.tilesDiv&&this.tilesDiv.parentNode){this.tilesDiv.innerHTML="";this.tilesDiv.parentNode.removeChild(this.tilesDiv)}delete this.tilesDiv},getCopyright:function(){return this.copyright},getMapType:function(){return this.mapType},adjustZIndex:function(){if(this.map&&this.map._featureMgr){var e=this.map._featureMgr.result.bkData;while(e[this.zIndex]){this.zIndex+=1}}},setZIndex:function(e){this.setTargetZIndex(e)},setTargetZIndex:function(e){this.zIndex=e;this.drawIndex=e;if(this.tilesDiv){this.tilesDiv.style.zIndex=e}},calcLoopParam:function(e,i){return ed.calcLoopParam(e,i)},addBoundary:function(h8){if(!h8||!this.map){return}if(typeof h8==="string"){h8=[h8]}for(var h6=0;h6<h8.length;h6++){var T=new BMapGL.Polygon(h8[h6]);if(T&&bY(T._i)){var h7=new be("onbeforeaddoverlay",T);h7.overlay=T;h7.isLayerMask=true;this.map.dispatchEvent(h7);T._i(this.map);if(this.boundary){this.boundary.push(T)}else{this.boundary=[T]}}}this.updateBoundary()},clearBoundary:function(){this.boundary=false;this.updateBoundary()},updateBoundary:function(){if(this.boundary===undefined||!this.map){return}var i=this.map._featureMgr.result.bkData;if(i[this.zIndex]){i[this.zIndex].boundary=this.boundary;this.map.dispatchEvent(new be("onrefresh"));if(this.boundary===false){var T=new be("onremoveLayerMask");T.hasLayerBoundary=this.map._featureMgr.hasLayerBoundary();this.map.dispatchEvent(T)}}}});function c9(i,e,T){this.bounds=i;this.content=e;this.mapType=T}c9.inherits(em,"Copyright");var gB={get:function(e){if(!gB.singleton){gB.singleton=new ak(e)}return gB.singleton}};function ak(i){this._map=i;this._tileMgr=i.tileMgr;this._animationDiv=null;this._preAnimationDiv=null;this._animation=null;this._baseLayerDiv=null;this._transformStyleName=bb.ifSupportCSS3("transform",true);this._transformOriginStyleName=bb.ifSupportCSS3("transformOrigin",true);this._preZoomTimes=1;this._preRenderTick=1;this._enableCanvas2dMap=!!(i.getRenderType()==="canvas");this._isIE9=!!(D.Browser.ie===9);var e=this;i.addEventListener("maptypechange",function(){e.hide()});i.addEventListener("load",function(){e.hide()})}D.extend(ak.prototype,{prepareLayer:function(){var h6=this._map;var e=this._tileMgr;this._canvas2dMapMgr=h6.canvas2dMapMgr;var T=this._baseLayerDiv=e.tilesDiv;if(!this._animationDiv){var i=this._preAnimationDiv;if(i){i.parentNode&&i.parentNode.removeChild(i);this._preAnimationDiv=null}this._preAnimationDiv=this._animationDiv=T.cloneNode(true);h6.platform.insertBefore(this._animationDiv,h6.platform.firstChild)}this.show()},prepareAniParam:function(){var h6=this._animationDiv;if(!h6){return}var e=h6.children.length;var T;this._zoomAniInfo=[];for(var h7=e-1;h7>-1;h7--){var h8={};T=h6.children[h7].style;h8.top=parseInt(T.top,10);h8.left=parseInt(T.left,10);this._zoomAniInfo[h7]=h8}},prepareLabelLayer:function(){var h7=this._map;if(this._enableCanvas2dMap&&h7.canvas2dMapMgr){if(this.touchZoomLabelCanvas){this.touchZoomLabelCanvas.parentNode.removeChild(this.touchZoomLabelCanvas)}var i=h7.canvas2dMapMgr._labelCanvas;this.touchZoomLabelCanvas=i.cloneNode(false);var e=this.touchZoomLabelCanvas.getContext("2d");e.drawImage(i,0,0);h7.platform.insertBefore(this.touchZoomLabelCanvas,h7.platform.firstChild);var h6=parseInt(i.style.left,10);var T=parseInt(i.style.top,10);this.touchZoomLabelCanvas.style.zIndex=9;this.touchZoomLabelCanvas.style[this._transformOriginStyleName]=(this._fixPosition.x-(h7.offsetX+h6))+"px "+(this._fixPosition.y-(h7.offsetY+T))+"px";i.style.visibility="hidden"}},show:function(){if(this._animationDiv){this._animationDiv.style.visibility=""}},showLabel:function(){var i=this._map;if(this._enableCanvas2dMap&&i.canvas2dMapMgr){var e=i.canvas2dMapMgr._labelCanvas;if(e){e.style.visibility=""}if(this.touchZoomLabelCanvas){this.touchZoomLabelCanvas.style.zIndex=-2;this.touchZoomLabelCanvas.style.visibility="hidden"}}},hide:function(){if(this._animationDiv){this._animationDiv.style.visibility="hidden"}if(this._preAnimationDiv){this._preAnimationDiv.style.visibility="hidden"}},hideNonAnimationLayers:function(){var h6=this._map;if(h6.getRenderType()==="dom"){if(h6.overlayDiv){h6.overlayDiv.style.visibility="hidden"}if(h6.overlayDivEx){h6.overlayDivEx.style.visibility="hidden"}}var h8=h6.tileMgr.tileLayers;var h7;for(var T=0,e=h8.length;T<e;T++){h7=h8[T];h7.tilesDiv.style.visibility="hidden"}},showNonAnimationLayers:function(){var h6=this._map;if(h6.getRenderType()==="dom"){if(h6.overlayDiv){h6.overlayDiv.style.visibility=""}if(h6.overlayDivEx){h6.overlayDivEx.style.visibility=""}}var h8=h6.tileMgr.tileLayers;var h7;for(var T=0,e=h8.length;T<e;T++){h7=h8[T];h7.tilesDiv.style.visibility=""}},setFixPosition:function(e){this._fixPosition=e},setZoom:function(e,ic){var h9=this._fixPosition;var ij=this._map;var ik=this._baseLayerDiv;var ia={x:h9.x-parseInt(ik.style.left,10)-ij.offsetX,y:h9.y-parseInt(ik.style.top,10)-ij.offsetY};var h6=this._animationDiv;if(!h6){return}var ih=h6.children.length;var ie;var ii=this._transformStyleName;var h8=this._transformOriginStyleName;var il=this;var io;var ib;for(var ig=ih-1;ig>-1;ig--){var id=this._zoomAniInfo[ig];ie=h6.children[ig].style;var h7=id.left-ia.x;var T=id.top-ia.y;id.dx=h7*e-h7;id.dy=T*e-T;id.preDx=h7-h7;id.preDy=T-T;io=id.preDx+(id.dx-id.preDx);ib=id.preDy+(id.dy-id.preDy)+ic;ie.left=id.left+io+"px";ie.top=id.top+ib+"px";ie.width=ie.height=256*e+"px"}if(this._enableCanvas2dMap){var im=!il._isIE9?"translate3d(0px, "+ic+"px, 0) scale("+e+")":"translate(0px, "+ic+"px) scale("+e+")";this.touchZoomLabelCanvas.style[ii]=im}},setZoomFinish:function(){this._animationDiv=null},startAnimation:function(h9){this.prepareLayer();this.hideNonAnimationLayers();var iv=this._map;if(this.touchZoomLabelCanvas){this.touchZoomLabelCanvas.style.display="none"}h9=h9||{};var it=h9.zoomCount||0;var ie=h9.fixPosition;var iq=h9.fixMCPosition;var ic=h9.pixOffset;this._zoomCount=it;var h6=iv.getZoom();var iu=h6+it;var e=iv.config.enableContinuousZoom;var ij=0.5;var id=5;var T=Math.pow(2,it);var ix=this._baseLayerDiv;var ig={x:ie.x-parseInt(ix.style.left,10)-iv.offsetX,y:ie.y-parseInt(ix.style.top,10)-iv.offsetY};var ia=this._animationDiv;var io=ia.children.length;var iz=this._preZoomTimes;var ir=[];var ip=this._transformStyleName;var ib=this._transformOriginStyleName;for(var im=io-1;im>-1;im--){var ik={};var il=ia.children[im].style;ik.top=parseInt(il.top,10);ik.left=parseInt(il.left,10);var h8=ik.left-ig.x;var h7=ik.top-ig.y;ik.dx=h8*T-h8;ik.dy=h7*T-h7;ik.preDx=h8*iz-h8;ik.preDy=h7*iz-h7;ir[im]=ik}var iw=this;var ii;var iy;var ih;this._zoomAni=new p({fps:60,duration:e?500:1,transition:function(i){i=i*id/(2*ij);return id*i-ij*i*i},render:function(iI){iI=iI*(4*ij)/(id*id);ii=iz+iI*(T-iz);var iB=h6+eN(ii);var iG=null;var iF=0;var iJ=0;if(h9.onAnimationBeforeLooping){var iK=h9.onAnimationBeforeLooping(iI,iB);iG=iK.loopingCenter;iF=iK.yDiff;iJ=iK.totalYDiff}for(var iC=ir.length-1;iC>-1;iC--){var iD=ir[iC];if(ia.children[iC]){var iH=ia.children[iC].style;iy=iD.preDx+(iD.dx-iD.preDx)*iI-ic.width*iI;ih=iD.preDy+(iD.dy-iD.preDy)*iI-ic.height*iI+iF;iH.left=iD.left+iy+"px";iH.top=iD.top+ih+"px";iH.height=iH.width=256*ii+"px"}}var iA=ic.width*iI;var iE=ic.height*iI;if(iv.isRestrict){iw._enableCanvas2dMap&&iw._canvas2dMapMgr.clearLabel()}else{iw._enableCanvas2dMap&&iw._canvas2dMapMgr.drawLabel(ii,ie,h6,iu,it,iI,iA,iE,iJ,iF)}iw._preZoomTimes=ii;iw._preRenderTick=iI;h9.onAnimationLooping&&h9.onAnimationLooping(iI,iB,iG)},finish:function(){iw._preZoomTimes=1;iw._zoomAni=null;iw._animationDiv=null;h9.onAnimationFinish&&h9.onAnimationFinish();iw.showNonAnimationLayers()}});return this._zoomAni},stopAnimation:function(){if(this._zoomAni){this._zoomAni.stop();this._zoomAni=null}}});function c(e){this._initVars(e);this._initColorCanvas();this._bindEvent(e)}D.extend(c.prototype,{_initVars:function(e){this._map=e._map;this._canvas2dMapMgr=e;this._labelCtx=e._labelCtx;this.ratio=this._map.config.ratio;this.sizeRatio=this.ratio>1?2:1;this.RANK1=1000000;this.RANK2=2000000;this.RANK3=3000000;this.RANK4=4000000;this.RANK5=5000000},_initColorCanvas:function(){var i=256,T=U("canvas"),e=T.style;e.width=i+"px";e.height=i+"px";T.width=i;T.height=i;this._colorCvsSize=i;this._colorCvs=T;this._colorCtx=T.getContext("2d")},getLabelImageData:function(ik){var ij=ik.textImg;var T=ik.textPos;var ih=this.ratio;var ie=this.sizeRatio/ih;var h7=this._colorCtx;var ib=this._colorCvsSize;h7.clearRect(0,0,ib,ib);var id=0;var e=0;var ia=0;for(var ic=0;ic<T.length;ic++){if(T[ic].width>id){id=T[ic].width;e=ic;ia=T[ic].drawX}}id/=ie;var ig=0;for(var ic=0,h9=T.length;ic<h9;ic++){var ii=T[ic];var il;if(ic===e){il=0}else{il=ii.drawX-ia}h7.drawImage(ij,ii.srcX,ii.srcY,ii.width,ii.height,il,ig,ii.width/ie,ii.height/ie);if(ii.width/ie>id){id=ii.width/ie}ig+=ii.height/ie+2*ih}var h6=h7.getImageData(0,0,id,ig);var h8=h7.getImageData(0,0,id,ig);return[h6,h8]},_bindEvent:function(i){var e=this,T=i._map;T.addEventListener("onspotmouseover",function(h9){if(!this.isCanvasMap()||!this.temp.isPermitSpotOver){return}if(h9.spots.length>0){var h8=h9.spots[0].userdata.uid;var h7=h9.spots[0].userdata.name;var h6=e.findLabelByUid(h8,h7);h6&&e._toHighLightColor(h6)}});T.addEventListener("onspotmouseout",function(h9){if(!this.isCanvasMap()||!this.temp.isPermitSpotOver){return}if(h9.spots.length>0){var h8=h9.spots[0].userdata.uid;var h7=h9.spots[0].userdata.name;var h6=e.findLabelByUid(h8,h7);h6&&e._toDefaultColor(h6)}});T.addEventListener("onspotclick",function(h9){if(!this.isCanvasMap()||!this.temp.isPermitSpotOver){return}if(h9.spots&&h9.spots.length>0){var h8=h9.spots[0].userdata.uid;var h7=h9.spots[0].userdata.name;var h6=e.findLabelByUid(h8,h7);h6&&e._changeBaseMapState(h6)}else{e._recoverNormalState()}});T.on("spot_status_reset",function(){e._recoverNormalState()});T.on("spot_highlight",function(h7){var h6=e.findLabelByUid(h7.uid);h6&&e._changeBaseMapState(h6)})},_getTextBound:function(ii){if(!ii.textPos){return null}var ig=this.ratio;var id=this.sizeRatio/ig;var T=ii.textPos;var ih=ii.baseDrawX;var ie=ii.baseDrawY;var ib=ih*ig+(T[0].drawX-ih)/id;var h9=ie*ig+(T[0].drawY-ie)/id;var h7=ib+T[0].width/id;var e=h9+T[0].height/id;for(var ic=0,ia=T.length;ic<ia;ic++){var ij=T[ic];var h8=ih*ig+(ij.drawX-ih)/id;if(h8<ib){ib=h8}var h6=ie*ig+(ij.drawY-ie)/id;if(h6<h9){h9=h6}if(h8+ij.width>h7){h7=h8+ij.width}if(h6+ij.height>e){e=h6+ij.height}}return[ib,h9,h7,e]},_toHighLightColor:function(T){if(T._tempRank&&T._tempRank==this.RANK5){return}var ia=this._getTextBound(T);if(!ia){return}var h6=Math.round(ia[0]);var i=Math.round(ia[1]);var e=this.getLabelImageData(T);var h8=e[0];var h7=e[1];var h9=this._canvas2dMapMgr.getFilterImageData(h8,this.RANK5);T._oldImgData=h7;this._labelCtx.putImageData(h9,h6,i)},_toDefaultColor:function(e){if(e._tempRank&&e._tempRank==this.RANK5){return}if(e._oldImgData){var i=this.sizeRatio;var T=this._getTextBound(e);if(!T){return}this._labelCtx.putImageData(e._oldImgData,Math.round(T[0]),Math.round(T[1]));e._oldImgData=null}},_changeBaseMapState:function(h6){var T=this._canvas2dMapMgr;var i=h6.guid;var e=h6.guidExt;var h7={guid:i,name:h6.name,guidExt:e};T._labelStrategy.setStrategyInfo(h7);T._loadData()},_recoverNormalState:function(){var e=this._canvas2dMapMgr;e._labelStrategy.setStrategyInfo(null);e._loadData()},findLabelByUid:function(h8,h6){var ia=this._canvas2dMapMgr,e=ia._computedLabel;for(var h7=0,T=e.length;h7<T;h7++){var h9=e[h7];if(!ia.isClickableLabel(h9)){continue}if(h8&&h9.guid===h8){return h9}if(h6&&h9.name===h6){return h9}}return null}});function el(e){this._initVars(e)}D.extend(el.prototype,{_initVars:function(e){this._map=e._map;this._canvas2dMapMgr=e;this.ratio=this._map.config.ratio;this._strategyInfo=null;this.RANK1=1000000;this.RANK2=2000000;this.RANK3=3000000;this.RANK4=4000000;this.RANK5=5000000},setStrategyInfo:function(e){this._strategyInfo=e},preComputeLabel:function(ic,i6,iP,iq,i0,jk){var iJ=[],il=ic._centerX,ij=ic._centerY,jl=iq*i0;var iV=this.ratio;var ib=this._map.getZoom();var iE=0;if(ib===5){iE=4}if(ib===8){iE=-6}ic.sort(function(jm,i){if(jm.x*jm.y<i.x*i.y){return -1}else{return 1}});for(var iG=0,iC=ic.length;iG<iC;iG++){var jb=ic[iG],ix=jb.x,iu=jb.y,ir=jb.z;var iz=ed.calcLoopParam(ix,ir).offsetX;var iT=ix*jl,iS=(iu+1)*jl,h6=(iT-il)/iq+i6/2+iz,T=(ij-iS)/iq+iP/2;for(var iD=0,jf=jb.length;iD<jf;iD++){var ie=jb[iD],im=undefined,ik=undefined,jd=undefined,jc=undefined;var i2=ie.baseDrawX=h6+ie.baseX;var i1=ie.baseDrawY=T+ie.baseY;if(ie.type=="fixed"){var iN=ie.iconPos,ip=ie.textPos,jh=ie.textImg;if(iN){iN.drawX=h6+iN.destX;iN.drawY=T+iN.destY;im=iN.drawX;ik=iN.drawY;jd=iN.drawX+iN.width;jc=iN.drawY+iN.height}if(ip&&jh){for(var i3=0;i3<ip.length;i3++){var jg=ip[i3];jg.drawX=h6+jg.destX;jg.drawY=T+jg.destY;if(!im){im=jg.drawX;ik=jg.drawY;jd=jg.drawX+jg.width;jc=jg.drawY+jg.height}else{if(jg.drawX<im){im=jg.drawX}if(jg.drawY<ik){ik=jg.drawY}if(jg.drawX+jg.width>jd){jd=jg.drawX+jg.width}if(jg.drawY+jg.height>jc){jc=jg.drawY+jg.height}}}}}else{ie.tileX=h6;ie.tileY=T;im=h6+ie.minXOriginal;ik=T+ie.minYOriginal;jd=h6+ie.maxXOriginal;jc=T+ie.maxYOriginal}if(im!=undefined){var i5=i2+(im-i2)/iV;var i4=i1+(ik-i1)/iV;var iH=i2+(jd-i2)/iV;var iF=i1+(jc-i1)/iV;ie.minX=i5;ie.minY=i4;ie.maxX=iH;ie.maxY=iF;var i9=(i5+iH)/2,i8=(i4+iF)/2,iQ=il+(i9-i6/2)*iq,iO=ij+(iP/2-i8)*iq;ie.geoX=iQ;ie.geoY=iO;iJ.push(ie)}}}if(jk){for(var iG=0,iC=jk.length;iG<iC;iG++){var iB=jk[iG];var iY=iB[0];var ig=iB[1];var iN=iY.iconPos;var h9=iN.geoX;var h7=iN.geoY;var i2=(h9-il)/iq+i6/2;var i1=(ij-h7)/iq+iP/2;var im=i2+iN.destX;var ik=i1+iN.destY;var jd=im+iN.width;var jc=ik+iN.height;iY.textPos=iY.textPos||iY._textPos;var ip=iY.textPos;var i7=ip[0];var iw=i2+i7.destX;var ii=i1+i7.destY;if(ii<ik){ik=ii}if(iw+i7.width>jd){jd=iw+i7.width}if(ii+i7.height>jc){jc=ii+i7.height}if(ip.length===2){var iv=ip[1];var it=i2+iv.destX;var ih=i1+iv.destY;if(ih<ik){ik=ih}if(it+iv.width>jd){jd=it+iv.width}if(ih+iv.height>jc){jc=ih+iv.height}}iY._tempBounds=[im,ik,jd,jc];var iN=ig.iconPos;var h9=iN.geoX;var h7=iN.geoY;var i2=(h9-il)/iq+i6/2;var i1=(ij-h7)/iq+iP/2;var im=i2+iN.destX;var ik=i1+iN.destY;var jd=im+iN.width;var jc=ik+iN.height;ig.textPos=ig.textPos||ig._textPos;var ip=ig.textPos;var i7=ip[0];var iw=i2+i7.destX;var ii=i1+i7.destY;if(iw<im){im=iw}if(ii<ik){ik=ii}if(ii+i7.height>jc){jc=ii+i7.height}if(ip.length===2){var iv=ip[1];var it=i2+iv.destX;var ih=i1+iv.destY;if(it<im){im=it}if(ih<ik){ik=ih}if(ih+iv.height>jc){jc=ih+iv.height}}ig._tempBounds=[im,ik,jd,jc]}for(var iG=0,iC=jk.length;iG<iC;iG++){var iB=jk[iG];var iY=iB[0];var ig=iB[1];if(iG===0&&ig.textPos){ig._textPos=ig.textPos;delete ig.textPos}var ja=iY;if(!iY.textPos&&ig.textPos){ja=ig}var je=ja._tempBounds;for(iD=iG+1;iD<iC;iD++){var iA=jk[iD];var iK=iA[0];var jj=iA[1];var io=0;var ji=iK._tempBounds;if(!(je[2]<ji[0]||je[0]>ji[2]||je[3]<ji[1]||je[1]>ji[3])){io++;if(iK.textPos){iK._textPos=iK.textPos;delete iK.textPos}}var ji=jj._tempBounds;if(!(je[2]<ji[0]||je[0]>ji[2]||je[3]<ji[1]||je[1]>ji[3])){io++;if(jj.textPos){jj._textPos=jj.textPos;delete jj.textPos}}if(io>=2){if(ja.textPos){ja._textPos=ja.textPos;delete ja.textPos}}}}for(var iG=0,iC=jk.length;iG<iC;iG++){var iB=jk[iG];var iY=iB[0];var ig=iB[1];var iL=iY;if(!iY.textPos&&ig.textPos){iL=ig}var iN=iL.iconPos;var h9=iN.geoX;var h7=iN.geoY;var i2=iL.baseDrawX=(h9-il)/iq+i6/2;var i1=iL.baseDrawY=(ij-h7)/iq+iP/2;iN.drawX=i2+iN.destX;iN.drawY=i1+iN.destY;var im=iN.drawX;var ik=iN.drawY;var jd=iN.drawX+iN.width;var jc=iN.drawY+iN.height;var ip=iL.textPos;if(ip){var i7=ip[0];i7.drawX=i2+i7.destX;i7.drawY=i1+i7.destY;if(i7.drawX<im){im=i7.drawX}if(i7.drawY<ik){ik=i7.drawY}if(i7.drawX+i7.width>jd){jd=i7.drawX+i7.width}if(i7.drawY+i7.height>jc){jc=i7.drawY+i7.height}if(ip.length===2){var iv=ip[1];iv.drawX=i2+iv.destX;iv.drawY=i1+iv.destY;if(iv.drawX<im){im=iv.drawX}if(iv.drawY<ik){ik=iv.drawY}if(iv.drawX+iv.width>jd){jd=iv.drawX+iv.width}if(iv.drawY+iv.height>jc){jc=iv.drawY+iv.height}}}var i5=i2+(im-i2)/iV;var i4=i1+(ik-i1)/iV;var iH=i2+(jd-i2)/iV;var iF=i1+(jc-i1)/iV;iL.minX=i5;iL.minY=i4;iL.maxX=iH;iL.maxY=iF;var iX=(i5+iH)/2;var iW=(i4+iF)/2;var ia=il+(iX-i6/2)*iq;var h8=ij+(iP/2-iW)*iq;iL.geoX=ia;iL.geoY=h8;iJ.push(iL)}}var iZ=this._strategyInfo;if(iZ){var iI=iZ.guid;var iR=iZ.name;var iy=iZ.guidExt;for(var iG=0,iC=iJ.length;iG<iC;iG++){var id=iJ[iG];delete id._tempRank;if(!this._canvas2dMapMgr.isClickableLabel(id)||(iy===1&&!id.guidExt)){continue}if((iI&&iI===id.guid)||(iR&&iR===id.name)){id._tempRank=this.RANK5}}}else{for(var iG=0,iC=iJ.length;iG<iC;iG++){var id=iJ[iG];if(id.type=="line"||!id.iconPos){continue}delete id._tempRank}}iJ.sort(function(jn,jm){var jo=jn._tempRank?jn._tempRank:jn.rank,i=jm._tempRank?jm._tempRank:jm.rank;if(jo===i){return jn.baseX-jm.baseX}return i-jo});for(var iG=0,iC=iJ.length;iG<iC;iG++){var ja=iJ[iG];ja.isDel=false;ja.isFadeout=false;ja._schedule=0;ja._isIgnore=false;ja.arrIntersectIndex=[];for(iD=iG+1;iD<iC;iD++){var iM=iJ[iD];if(!(ja.maxX-iE<iM.minX||ja.minX>iM.maxX-iE||ja.maxY-iE<iM.minY||ja.minY>iM.maxY-iE)){ja.arrIntersectIndex.push(iD)}}}for(var iG=0,iC=iJ.length;iG<iC;iG++){var id=iJ[iG];if(id.isDel==false){var e=id.arrIntersectIndex;for(var iD=0,jf=e.length;iD<jf;iD++){var iU=iJ[e[iD]];iU.isDel=true;if(iU.guidExt===1){iU.isDel=false}}}}return iJ}});function aj(e){this._map=e;this._initCanvas();this._initVars();this._bindEvent();this._tileType=cP.getInstance("na")}br.register(function(i){if(i.getRenderType()==="canvas"){var e=i.config.style;if(br["FeatureStyle"+e]){i.canvas2dMapMgr=new aj(i)}else{i.loadMapStyleFiles(function(){i.canvas2dMapMgr=new aj(i);i.canvas2dMapMgr._loadData()})}}});D.extend(aj.prototype,{_initCanvas:function(){var h9=this._map,h7=h9.getSize(),h6=h7.width,i=h7.height,e=h9.platform,ia=U("canvas"),h8=ia.style;var T=this.ratio=h9.config.ratio;this._width=h6;this._height=i;h8.cssText="position: absolute;left:0;top:0;width:"+h6+"px;height:"+i+"px;z-index:100;";ia.width=h6*T;ia.height=i*T;this._labelCanvas=ia;this._labelCtx=ia.getContext("2d");e.appendChild(ia)},_initVars:function(){var e=aG("ditu","normal");this._udt=e.udt;this._version=e.ver;this._labelDataUrls=b9.B_NORMAL_MAP.vectorTileUrls;this._style=br["FeatureStyle"+this._map.config.style];this._labelCount=0;this._vectorDrawLib=new a3(this);this._cache={maxNum:500,delNum:50,arrCache:[]};this._computedLabel=null;this._spotData=null;this._labelStrategy=new el(this);this._labelClick=new c(this);this._biz=new g1(this);this._map.temp.isPermitSpotOver=true;this.labelStyleParam="pl";if(this._map.getMapType()===BMAP_SATELLITE_MAP){this.labelStyleParam="sl"}this.statRequestCount=0;this.statResponseCount=0},_resizeHandler:function(h8){var ia=this,i=ia._map,h7=i.getSize(),T=h7.width,ic=h7.height;var h9=this.ratio;var id=this._labelCanvas,h6=id.style;h6.width=T+"px";h6.height=ic+"px";id.width=T*h9;id.height=ic*h9;ia._width=T;ia._height=ic;var ib=true;ia._loadData(ib)},_bindEvent:function(){var e=this,i=e._map;i.addEventListener("load",function(T){e.clearLabel();e._loadData()});i.addEventListener("zoomend",function(T){if(!T.notClearLabel){e.clearLabel()}e._loadData()});i.addEventListener("moveend",function(T){e._loadData()});i.addEventListener("resize",function(T){e._resizeHandler(T)});i.addEventListener("maptypechange",function(T){if(T.mapType===BMAP_EARTH_MAP){e.hideLabelCanvas()}else{e.showLabelCanvas();if(T.mapType===BMAPGL_NORMAL_MAP){e.labelStyleParam="pl"}else{if(T.mapType===BMAP_SATELLITE_MAP){e.labelStyleParam="sl"}}e._loadData()}});i.addEventListener("streetlayer_show",function(T){if(this.isCanvasMap()){e.showLabelCanvas()}});i.addEventListener("streetlayer_hide",function(T){if(this.isCanvasMap()){e.hideLabelCanvas()}});i.addEventListener("loadbizdata",function(h6){var T=h6.data;e._biz.proecessBizData(T,function(){e.updateLabel()})});i.addEventListener("unloadbizdata",function(T){e._biz.clearBizData();e.updateLabel()});e.isDrawText=false;setTimeout(function(){if(!e.isDrawText){i.dispatchEvent(new be("onmapwhitescreen"))}},10000)},getStyle:function(){return this._style},_getZoomUnits:function(e){return Math.pow(2,18-e)},_createCacheForm:function(T,ia,h9,i){var h8=this;var e=h8._cache;var h6=e.arrCache;var ib=this._getLabelId(T,ia,h9,i);var h7={id:ib,updateLabelCounter:0};h6.push(h7);h6[ib]=h7;return h7},_getLabelId:function(i,h6,T,e){return"_"+i+"_"+h6+"_"+T+"_"+e+"_"+this.labelStyleParam},_getCache:function(i,h6,T,e){return this._cache.arrCache[this._getLabelId(i,h6,T,e)]},_setCacheValue:function(h7,il,ij,h6,id){var ig=this;var e=ig._cache;var h9=e.arrCache;var ib=e.maxNum;var h8=e.delNum;var ik=this._getLabelId(h7,il,ij,h6);var ie=h9[ik];if(id){ie.lb=id}if(h9.length>ib){var T=h9.splice(0,h8);for(var ic=0,ia=T.length;ic<ia;ic++){var ih=T[ic],ii=ih.id;if(h9[ii].lb){h9[ii].lb=null}h9[ii]=null;delete h9[ii]}T=null}},_loadData:function(ik){var iF=this._map;if(!iF.isCanvasMap()){return}var ib=iF.getCenterIn();var iE=ed.calcLoopCenterPoint(ib);var ia=this._tileType;var ie=this._width/2;var it=this._height;var iu=iF.getZoom();var ip=ia.getDataZoom(iu);var ih=iF.getZoomUnits(iu);var io=ih*ie;var iD=iE.lng-io;var iC=iE.lng+io;var il=ed.isAddWidth(iD,iC);ie=il?ie*1.5:ie;var im=ia.getTileSize(iu);var h7=ia.getMercatorSize(iu,ip);var ig=Math.floor(iE.lng/h7);var ii=Math.floor(iE.lat/h7);var h8=[ig,ii,(iE.lng-ig*h7)/h7*im,(iE.lat-ii*h7)/h7*im];var iw=h8[0]-Math.ceil((ie-h8[2])/im);var iA=h8[1]-Math.ceil((it/2-h8[3])/im);var ir=h8[0]+Math.ceil((ie+h8[2])/im);var ix=h8[1]+Math.ceil((it/2+h8[3])/im);iF.temp.isPermitSpotOver=false;var e=[];for(var iz=iw;iz<ir;iz++){for(var iy=iA;iy<ix;iy++){e.push([iz,iy,ip]);var iq="id_"+iz+"_"+iy+"_"+iu;e[iq]=true}}e._zoom=ip;e=ed.calcLoopTiles(e,iu);e.sort((function(i){return function(id,iH){return((0.4*Math.abs(id[0]-i[0])+0.6*Math.abs(id[1]-i[1]))-(0.4*Math.abs(iH[0]-i[0])+0.6*Math.abs(iH[1]-i[1])))}})([h8[0],h8[1]]));var ij=this._cache.arrCache;this._curViewLabels=[];var h6="viewKey_"+Math.floor(ib.lng)+"_"+Math.floor(ib.lat)+"_"+iu;this.statRequestCount=0;this.statResponseCount=0;this._labelCount+=e.length;var ic=iu;for(var iz=0,iv=e.length;iz<iv;iz++){var ig=e[iz][0];var ii=e[iz][1];var T=e[iz][2];var h9=this._getLabelId(ig,ii,T,ic);var iB=ij[h9];if(!iB){iB=this._createCacheForm(ig,ii,T,ic)}if(typeof iB.lb==="undefined"){iB.lb=null;this._loadLabelData(ig,ii,T,ic,im,h6);this.statRequestCount++}else{if(iB.lb){this._curViewLabels.push(iB.lb);this._labelCount--}else{if(ik){this._loadLabelData(ig,ii,T,ic,im,h6)}iB.updateLabelCounter++}}}if(this._labelCount===0){this.updateLabel()}var iG=this;if(iG.errorTimer){clearTimeout(iG.errorTimer)}iG.errorTimer=setTimeout(function(){if(iG._labelCount!==0){iG._labelCount=0;iG.updateLabel()}var iH=new be("onloaddatatimeout");var iI=0;var id=0;var iJ=0;var i=0;if(iG.statRequestCount===iG.statResponseCount){iI=1}else{id=1}if(id===1){i=iG.statRequestCount-iG.statResponseCount;iJ=iG.statResponseCount}iH.noTimeoutCount=iI;iH.timeoutCount=id;iH.timeoutNoLoaded=i;iH.timeoutLoaded=iJ;iG._map.dispatchEvent(iH)},500)},clearLabel:function(){var e=this._width;var T=this._height;var i=this.ratio;this._labelCtx.clearRect(0,0,e*i,T*i)},updateLabel:function(){var i=this._map;var e=i.getCenterIn();var h6=this._width;var h9=this._height;var ic=i.getZoom();var ib=this._tileType.getTileSize(ic);var ia=this._getZoomUnits(ic);var T=this._labelCtx;this._labelCanvas.style.left=-i.offsetX+"px";this._labelCanvas.style.top=-i.offsetY+"px";var h8=this._curViewLabels;h8._centerX=e.lng;h8._centerY=e.lat;var h7=this._biz.bizLabels;this._computedLabel=this._labelStrategy.preComputeLabel(h8,h6,h9,ia,ib,h7);this._computedLabel._zoom=ic;this.clearLabel();this._vectorDrawLib.drawIconAndText(T,this._computedLabel,ic);this._addSpotData();i.temp.isPermitSpotOver=true;if(h8.length>0){this.isDrawText=true}},_loadLabelData:function(ig,ie,id,T,ih,e){var h8=ig.toString();var h6=ie.toString();var ia="cbk_"+h8.replace("-","_")+"_"+h6.replace("-","__")+"_"+Math.floor(id);var il=eL+"."+ia;var ik=this._labelDataUrls;var ic=Math.abs(ig+ie)%ik.length;var ir=ik[ic];if(window.offLineIPAddress){ir=window.offLineIPAddress+"pvd/"}var i=this.labelStyleParam;var ij="?qt=vtile";var im="";if(this._map.config.style!=="default"){im="&styleId=1"}var ii="x={x}&y={y}&z={z}&udt={udt}&v={v}&styles={styles}"+im+"&textonly=1&textimg=1&scaler={scaler}&fn="+encodeURIComponent(il);var io=ed.calcLoopParam(ig,id).col;var ib=this.ratio>1?2:1;var h9=ii.replace(/{x}/,io).replace(/{y}/,ie).replace(/{z}/,Math.floor(id)).replace(/{styles}/,i).replace(/{udt}/,this._udt).replace(/{v}/,this._version).replace(/{scaler}/,ib);var h7=ir+ij+"&param="+window.encodeURIComponent(gy(h9));var iq=this;var ip=iq._map;br[ia]=function(it){iq._vectorDrawLib.parseLabelData(it,ig,ie,id,T,ih,function(iy){var iv=ip.getCenterIn();var iz=ip.getZoom();var iB="viewKey_"+Math.floor(iv.lng)+"_"+Math.floor(iv.lat)+"_"+iz;iq._labelCount--;var iC=iq._getCache(ig,ie,id,T).updateLabelCounter;iq._labelCount-=iC;var iw=iq._curViewLabels;if(iB===e||(iq._labelCount<0&&iz===id)){iw.push(iy)}if(iB===e){iq.statResponseCount++}if(iq._labelCount<=0){var iu=(new Date()).getTime();iq.updateLabel();var ix=(new Date()).getTime();var iA=new be("oncanvasmaploaded");iA.drawTime=ix-iu;if(iq.statResponseCount===iq.statRequestCount){iA.isAllLoadedDrawing=true}ip.dispatchEvent(iA)}iq._setCacheValue(ig,ie,id,T,iy);delete br[ia]})};hB.load(h7)},drawLabel:function(T,h6,id,i,ib,h7,e,h8,ic,h9){var ia=this;if(!ia._computedLabel){return}if(ia._computedLabel._zoom!==id){ia.clearLabel();return}ia._map.temp.isPermitSpotOver=false;ia.clearLabel();ia._vectorDrawLib.zoomingIconAndText(this._labelCtx,ia._computedLabel,T,h6,i,ib,h7,e,h8,ic,h9)},_addSpotData:function(){this._spotData=[];var id=this._map.getZoom();for(var h8=0,h7=this._computedLabel.length;h8<h7;h8++){var ia=this._computedLabel[h8];if(!this.isClickableLabel(ia)||(ia.guidExt===1&&ia.startScale>id)){continue}var h9=[];h9[0]=(ia.minX-ia.maxX)/2;h9[1]=(ia.minY-ia.maxY)/2;h9[2]=(ia.maxX-ia.minX)/2;h9[3]=(ia.maxY-ia.minY)/2;var h6=null;if(ia.iconPos){h6=new hH(ia.iconPos.geoX,ia.iconPos.geoY)}var T=ia.name?ia.name.replace("\\\\","<br>"):"";if(ia.iconPos&&ia.iconPos.iconType.indexOf("ditie")>-1&&this._map.getZoom()>14){T=""}var ic={n:T,pt:new hH(ia.geoX,ia.geoY),userdata:{iconPoint:h6,uid:ia.guid,name:T,type:ia.iconPos?ia.iconPos.iconType:"",iconImg:ia.iconImg,mapPoi:true,adver_log:ia.adver_log||""},bd:h9,tag:"MAP_SPOT_INFO"};this._spotData.push(ic)}var ib=new be("onspotsdataready");ib.spots=this._spotData;this._map._spotDataOnCanvas=this._spotData;this._map.dispatchEvent(ib)},isClickableLabel:function(e){if(e.isDel||(!e.guid&&!e.name)){return false}return true},getFilterImageData:function(T,h9){var ia=T.data,h8=this._labelStrategy,h9=parseInt(h9);for(var ib=0,h7=ia.length;ib<h7;ib+=4){var e=ia[ib],ic=ia[ib+1],id=ia[ib+2],ie=ia[ib+3];if(ie===0){continue}var h6=Math.round((e+ic+id)/3);var ig=h6-90;ig=ig<0?0:ig;if(h9===h8.RANK5){ia[ib]=51+ig*1.3;ia[ib+1]=133+ig*0.8;ia[ib+2]=255}}return T},showLabelCanvas:function(){this._labelCanvas.style.visibility=""},hideLabelCanvas:function(){this._labelCanvas.style.visibility="hidden"}});var cc=5;var d5=4;var hF=3;var fr=2;var hZ=1;var d8=0;var h2=3;var hv=5;var J={3:{start:3,base:3},4:{start:4,base:5},5:{start:4,base:5},6:{start:6,base:7},7:{start:6,base:7},8:{start:8,base:9},9:{start:8,base:9},10:{start:10,base:10},11:{start:11,base:12},12:{start:11,base:12},13:{start:11,base:12},14:{start:14,base:15},15:{start:14,base:15},16:{start:16,base:17},17:{start:16,base:17},18:{start:18,base:19},19:{start:18,base:19},20:{start:18,base:19},21:{start:18,base:19}};function a3(h6){this._canvas2dMapMgr=h6;var i=this.ratio=h6._map.config.ratio;this._featureStyle=null;this._map=h6._map;var T=fL();var e="udt="+T.udt+"&v="+T.ver;this.sizeRatio=this.ratio>1?2:1;this._binaryCache={};this._iconCache={};this._initColorCanvas()}D.extend(a3.prototype,{_initColorCanvas:function(){var i=256,T=U("canvas"),e=T.style;e.width=i+"px";e.height=i+"px";T.width=i;T.height=i;this._colorCvs=T;this._colorCtx=T.getContext("2d")},parseLabelData:function(i,h8,h7,h6,e,ib,ia){if(!this._featureStyle){this._featureStyle=this._canvas2dMapMgr.getStyle()}if(!i||!i[0]){ia([]);return}var h9=this._map.getZoomUnits();var T=this;this.loadTextPng(i,ib,h8,h7,h6,e,h9,ia)},loadTextPng:function(ip,ie,ic,ib,h9,i,h7,h6){var io=this;var e=ip[5];var im=this._map;var ij=im.getZoom();var T=im.getSize();var ik=T.width;var ii=T.height;var il=im.getCenterIn();var ia=il.lng;var h8=il.lat;var ih=ic*ie*h7;var ig=(ib+1)*ie*h7;if(e){var id=new Image();id.onload=function(){io.calcIconAndTextInfo(ip,id,ie,ic,ib,h9,i,h7,ih,ig,h6);delete this.onload};id.src=e}else{setTimeout(function(){io.calcIconAndTextInfo(ip,null,ie,ic,ib,h9,i,h7,ih,ig,h6)},1)}},calcIconAndTextInfo:function(ir,ih,ii,ig,ic,ia,h6,h8,ik,ij,h7){var iq=this;var ip=iq._featureStyle;var id=[];id.x=ig;id.y=ic;id.z=ia;var ie=iq._canvas2dMapMgr,T=ig*h8*ii,io=(ic+1)*h8*ii,h9={tileLeft:T,tileTop:io,zoomUnits:h8};var e=[];if(ir[0]){for(var il=0;il<ir[0].length;il++){if(ir[0][il][0]===h2){e.push(ir[0][il])}}}var ib=ir[2]||[];for(var il=0;il<e.length;il++){this._getFixedLabelInfo(e[il],ih,h6,h8,ii,ik,ij,id)}var im=Math.pow(2,h6-ia);for(il=0;il<ib.length;il++){this._getLineLabelInfo(ib[il],ih,ia,h6,h8,ii,ik,ij,im,id)}h7(id)},_getFixedLabelInfo:function(ih,il,h7,ib,im,iq,ip,it){var ig=ih[1];if(!ig){return}var iv=this._map.getZoom();var iD=this._map.config.style;var iE=this._featureStyle;var ic=h7;if(ic===9){ic=8}for(var iA=0;iA<ig.length;iA++){var iF=ig[iA];var e=iF[0];var h6=eu.getStyleFromCache(iD,e,"point",ic,iE);var iz=eu.getStyleFromCache(iD,e,"pointText",ic,iE);if((!iz||iz.length===0)&&(!h6||h6.length===0)){if(ic===5){var ia=iF[1];if(!ia){continue}for(var iw=0;iw<ia.length;iw++){var iu=ia[iw][4];if(iu&&iu[7]==="北京"){h6=eu.getStyleFromCache(iD,e,"point",6,iE);iz=eu.getStyleFromCache(iD,e,"pointText",6,iE);break}else{continue}}}else{continue}}var ia=iF[1];if(!ia){continue}var iB=null;var id=1;var T=0;var ik=0;if(h6&&h6[0]){h6=h6[0];iB=h6.icon;id=h6.zoom?h6.zoom/100:1}else{h6=null}for(var iw=0;iw<ia.length;iw++){var iu=ia[iw][4];if(!iu){continue}var iy=iu[2];if(!this._isVisible(iy,iv)){continue}var ie=iu[12];if(iz&&iz.length>0&&!ie){continue}var ij=Math.round(iu[0]/100);var ii=Math.round(iu[1]/100);var ix={lng:iq+ij,lat:ip-(im*ib-ii)};var h9=ij/ib;var h8=im-ii/ib;var io=iu[7]||"";var iC=iu[5];var ir={type:"fixed",name:io,textImg:il,rank:iu[4],baseX:h9,baseY:h8,iconPos:null,textPos:null,guid:iu[3]||"",tracer:iy,direction:iC,startScale:3};if((iC!==d5&&ie||!ie)&&iB!==null){ir.iconPos=this._getIconPosition(iB,id,h9,h8,ix);if(ir.iconPos){T=ir.iconPos.width;ik=ir.iconPos.height}}if(T===0){ir.direction=d5}if(ie){ir.textPos=this._getTextDrawData(iu,h9,h8,T,ik)}if(ir.textPos||ir.iconPos){it.push(ir)}}}},_isVisible:function(e,i){var h6;if(!this._binaryCache[e]){h6=e.toString(2);if(h6.length<8){h6=new Array(8-h6.length+1).join("0")+h6}this._binaryCache[e]=h6}h6=this._binaryCache[e];var T=J[i].start;return h6[i-T]==="1"},_getIconPosition:function(ia,h8,T,i,e){var h6=this._map.config.style;var ib=br["iconSetInfo"+h6][ia];if(!ib){if(ia.charCodeAt(0)>=48&&ia.charCodeAt(0)<=57){ib=br["iconSetInfo"+h6]["_"+ia]}}if(!ib){return null}var h7=ib[0];var h9=ib[1];h7=h7*h8;h9=h9*h8;return{srcX:0,srcY:0,destX:T-h7/2,destY:i-h9/2,width:h7,height:h9,geoX:e.lng,geoY:e.lat,mcPt:e,iconType:ia}},_getTextDrawData:function(ii,ih,ig,h6,id){var io=ii[5];if(typeof io!=="number"){io=0}var ib=this.ratio;var ia=ib/2;h6*=ia;id*=ia;var ic=ii[12];var h7=ic.length;var ir=0;var iq=0;var im=[];var il=0;var ip=0;for(var ik=0;ik<h7;ik++){ip+=Math.round(ic[ik][3])}for(var ik=0;ik<h7;ik++){var h9=ic[ik];var h8=h9[0];var i=h9[1];var T=h9[2];var e=h9[3];var it=2*ib;var ij=0;if(h6!==0){ij=2*ib}if(h6===0){io=d5}switch(io){case hF:var ie=ig-ip/2-it*(h7-1)/2;ir=ih-T-h6/2-ij;iq=ie+il+it*ik;break;case hZ:var ie=ig-ip/2-it*(h7-1)/2;ir=ih+h6/2+ij;iq=ie+il+it*ik;break;case fr:var ie=ig-id/2-ip-it*(h7-1)-it;ir=ih-T/2;iq=ie+il+it*ik;break;case d8:var ie=ig+id/2+it/2;ir=ih-T/2;iq=ie+il+it*ik;break;case d5:var ie=ig-e/2-it*(h7-1)/2;ir=ih-T/2;iq=ie+il+it*ik;break}il+=e;if(T>0&&e>0){im.push({srcX:h8,srcY:i,destX:ir,destY:iq,width:T,height:e})}}if(im.length>0){return im}return null},_getLineLabelInfo:function(ie,h6,h7,iw,iJ,im,iu,it,iv,il){if(ie.length!==10){return}var iy=this.ratio;var T=this.ratio;var iF=ie[7].length;var io=ie[1];var iH=ie[3];var iN=ie[8];var ia=ie[4];var e=2;var h8=ia.slice(0,e);for(var iK=e;iK<ia.length;iK+=e){h8[iK]=h8[iK-e]+ia[iK];h8[iK+1]=h8[iK-(e-1)]+ia[iK+1]}for(var iK=e;iK<ia.length;iK+=e){if(iK%(iH*e)===0||iK%(iH*e)===1){continue}h8[iK]=h8[iK-e]+ia[iK]/iv;h8[iK+1]=h8[iK-(e-1)]+ia[iK+1]/iv}for(var iM=0;iM<iF;iM++){var iI=ie[7][iM];if(!this._isVisible(iI,iw)){continue}var iA=ie[6][iM];var ik=iM*iH*e;ia=h8.slice(ik,ik+iH*e);var ip=[];var iz=undefined;var ix=undefined;var ij=undefined;var ii=undefined;var iN=ie[9].slice(0);if(iA){iN.reverse()}var iD;var iB;for(var iL=0;iL<iH;iL++){var ih=ie[5][iH*iM+iL];var iE=ia[iL*e]/100;var iC=ia[iL*e+1]/100;var ig=iN[iL];var ib=ig[0];var id=ig[1];var h9=ig[2];var ic=ig[3];var ir;var iq;var iP;var iO;if(iL===0){iD=iP=iE/iJ;iB=im-iC/iJ;iO=iC/iJ}else{iP=iE/iJ;iO=iC/iJ}var iR=iD+(iP-iD)*T-h9/2;var iQ=iB+(im-iO-iB)*T-ic/2;if(iz===undefined){iz=iD-h9/2;ix=iB-ic/2;ij=iz+h9;ii=ix+ic}else{if(iR<iz){iz=iR}if(iQ<ix){ix=iQ}if(iR+h9>ij){ij=iR+h9}if(iQ+ic>ii){ii=iQ+ic}}ip.push({angle:ih,srcX:ib,srcY:id,destX:iR,destY:iQ,width:h9,height:ic})}var iG={type:"line",textImg:h6,rank:io,baseX:iD,baseY:iB,arrWordPos:ip,minXOriginal:iz,minYOriginal:ix,maxXOriginal:ij,maxYOriginal:ii,text:""};il.push(iG)}},alterColor:function(h9,e,h8){var T=this._colorCtx,i=this._canvas2dMapMgr;T.clearRect(0,0,h9.width,h9.height);T.drawImage(e,h9.srcX,h9.srcY,h9.width,h9.height,0,0,h9.width,h9.height);var h7=T.getImageData(0,0,h9.width,h9.height),h6=i.getFilterImageData(h7,h8);T.putImageData(h6,0,0)},drawIconAndText:function(im,il,e){var ic=this.ratio;var ia=this.sizeRatio/ic;var ie=2/ic;var iz=this;for(var iq=0,io=il.length;iq<io;iq++){var id=il[iq];if(id.isDel==false){var h7=id.baseDrawX;var h6=id.baseDrawY;if(id.type=="fixed"){var h9=id.iconPos,ir=id.textPos,ij=id.textImg,iv=id.startScale;if(h9&&iv<=e){var T=this._iconCache[h9.iconType];if(T){if(T.img){im.drawImage(T.img,0,0,T.img.width,T.img.height,Math.round(h7*ic+(h9.drawX-h7)/ie),Math.round(h6*ic+(h9.drawY-h6)/ie),h9.width/ie,h9.height/ie)}else{T.drawLabels.push(id)}}else{if(!T){this._iconCache[h9.iconType]={img:null,drawLabels:[id]};var iB=new Image();iB._iconName=h9.iconType;iB.onload=function(){var iH=iz._iconCache[this._iconName];iH.img=this;this.onload=null;for(var iD=0;iD<iH.drawLabels.length;iD++){var iF=iH.drawLabels[iD];var iE=iF.baseDrawX;var iC=iF.baseDrawY;var iG=iF.iconPos;im.drawImage(this,0,0,this.width,this.height,Math.round(iE*ic+(iG.drawX-iE)/ie),Math.round(iC*ic+(iG.drawY-iC)/ie),iG.width/ie,iG.height/ie)}iH.drawPos=[]};iB.src=fe.getIconSetPath(iz._map.config.style)+h9.iconType+".png"}}}if(ir&&ij&&iv<=e){for(var ib=0;ib<ir.length;ib++){var ik=ir[ib];if(!id._tempRank){im.drawImage(ij,ik.srcX,ik.srcY,ik.width,ik.height,Math.round(h7*ic+(ik.drawX-h7)/ia),Math.round(h6*ic+(ik.drawY-h6)/ia),ik.width/ia,ik.height/ia)}else{this.alterColor(ik,ij,id._tempRank);im.drawImage(this._colorCvs,0,0,ik.width,ik.height,Math.round(h7*ic+(ik.drawX-h7)/ia),Math.round(h6*ic+(ik.drawY-h6)/ia),ik.width/ia,ik.height/ia)}}}}else{var h8=id.arrWordPos,ij=id.textImg,ii=id.tileX,ig=id.tileY;for(var ip=0,ih=h8.length;ip<ih;ip++){var it=h8[ip];var iA=Math.round(ii+it.destX);var iy=Math.round(ig+it.destY);var iu=it.angle;iA=h7*ic+iA-h7;iy=h6*ic+iy-h6;if(iu>10&&iu<350){im.save();var ix=Math.round(iA+it.width/2);var iw=Math.round(iy+it.height/2);im.translate(ix,iw);im.rotate(-iu/180*Math.PI);im.drawImage(ij,it.srcX,it.srcY,it.width,it.height,-Math.round(it.width/2),-Math.round(it.height/2),it.width/ia,it.height/ia);im.restore()}else{im.drawImage(ij,it.srcX,it.srcY,it.width,it.height,iA,iy,it.width/ia,it.height/ia)}}}}}},isCollide:function(h8,ii,ih,e,ia,T,ic){for(var h7=0,h6=T.length;h7<h6;h7++){var ib=T[h7],h9=1/Math.pow(2,ic+1),ig=h9*ib[3]/2,ie=h9*ib[4]/2,id=ib[0];if(id!=h8){if(!(ii+e<ib[1]-ig||ii>ib[1]+ib[3]+ig||ih+ia<ib[2]-ie||ih>ib[2]+ib[4]+ie)){return true}}}return false},zoomingIconAndText:function(iz,it,h6,ix,iy,i0,iG,ie,iM,iF,ip){var i1=this.ratio;var ig=this.sizeRatio/i1;var i2=2/i1;var jc=i1/2;var iW=ix.x;var iV=ix.y;var iA=2*i1;if(ip!==0){iV+=iF}var ij=undefined,ib=undefined,h8=undefined,id=undefined,io=undefined;var iL=i0>0?true:false;if(!iL){ij=[];var iP=1-iG}for(var i8=0,i6=it.length;i8<i6;i8++){var i3=it[i8];if(i3.isDel==false){var jd=i3.baseDrawX;var ja=i3.baseDrawY;iz.save();iz.translate(-ie*i1,-iM*i1);if(i3.isFadeout){if(!iL&&i3._schedule<=iG&&!i3._isIgnore){iz.globalAlpha=iP;i3._schedule=iG}else{i3._isIgnore=true;continue}}if(i3.type=="fixed"){var iB=i3.iconPos,iI=i3.textPos,h9=i3.textImg,iC=i3.startScale;var T;var iT=0;if(iB){iT=iA}if(iB&&!i3.iconImg&&this._iconCache[iB.iconType]){T=this._iconCache[iB.iconType].img}if(iB&&iC<=iy&&T){id=iB.width;io=iB.height;ib=(iW+(jd-iW)*h6)*i1-id/2/i2;h8=(iV+(ja-iV)*h6)*i1-io/2/i2+ip;if(!iL&&this.isCollide(i8,ib,h8,id,io,ij,i0)){i3.isFadeout=true}iz.drawImage(T,iB.srcX,iB.srcY,T.width,T.height,Math.round(ib),Math.round(h8),id/i2,io/i2);!iL&&ij.push([i8,ib,h8,id,io])}if(iI&&h9&&iC<=iy){var iH;var iJ;var ir=0;var iE=0;if(iB){ir=iB.width;iE=iB.height}var iU=iI.length;var ii=0;var iK=0;for(var iu=0;iu<iU;iu++){var i5=iI[iu];iK+=i5.height;if(ii<i5.width){ii=i5.width}}iK+=(iu-1)*iA;if(!iL&&this.isCollide(i8,ib,h8,ii,iK,ij,i0)){i3.isFadeout=true}var i4=0;for(var iu=0;iu<iU;iu++){var i5=iI[iu];switch(i3.direction){case hF:iH=-(ir/2/i2+i5.width+iT);iJ=-iK/2+i4+iA*iu;break;case hZ:iH=ir/2/i2+iT;iJ=-iK/2+i4+iA*iu;break;case fr:iH=-i5.width/2;iJ=-iE/2/i2-iK+i4-iA*(iu+1);break;case d8:iH=-i5.width/2;iJ=iE/2/i2+i4+iA*(iu+1);break;case d5:iH=-i5.width/2;iJ=-iK/2+i4+iA*iu;break}i4+=i5.height;ib=(iW+(jd-iW)*h6)*i1+iH/ig;h8=(iV+(ja-iV)*h6)*i1+iJ/ig;+ip;id=i5.width;io=i5.height;if(!i3._tempRank){iz.drawImage(h9,i5.srcX,i5.srcY,id,io,Math.round(ib),Math.round(h8),id/ig,io/ig)}else{this.alterColor(i5,h9,i3._tempRank);iz.drawImage(this._colorCvs,0,0,id,io,Math.round(ib),Math.round(h8),id/ig,io/ig)}!iL&&ij.push([i8,ib,h8,id,io])}}}else{var iq=i3.arrWordPos,h9=i3.textImg,jb=i3.tileX,i9=i3.tileY;var ih=iq[0];var ic=Math.round(jb+ih.destX);var ia=Math.round(i9+ih.destY);for(var i7=0,iS=iq.length;i7<iS;i7++){var iZ=iq[i7];var jf=Math.round(jb+iZ.destX);var je=Math.round(i9+iZ.destY);var iw=iZ.angle;var iR=Math.round((iW+(jd-iW)*h6)*i1-ih.width/2+jf-ic);var iQ=Math.round((iV+(ja-iV)*h6)*i1-ih.height/2+je-ia);ib=iR;h8=iQ;id=iZ.width;io=iZ.height;if(!iL&&this.isCollide(i8,ib,h8,id,io,ij,i0)){i3.isFadeout=true}if(iw>10&&iw<350){var iY=iR+iZ.width/2;var iX=iQ+iZ.height/2;var h7=iw/180*Math.PI;var iD=Math.cos(h7);var ik=Math.sin(h7);var iO=iD;var il=iD;var iN=ik;var im=-ik;var iv=iY-iY*iD-iX*ik;var e=iX+iY*ik-iX*iD;iz.save();iz.transform(iO,im,iN,il,iv,e);iz.drawImage(h9,iZ.srcX,iZ.srcY,id,io,ib,h8,id/ig,io/ig);iz.restore()}else{iz.drawImage(h9,iZ.srcX,iZ.srcY,id,io,ib,h8,id/ig,io/ig)}!iL&&ij.push([i8,ib,h8,id,io])}}iz.restore()}}}});function g1(e){this.initVars(e)}D.extend(g1.prototype,{initVars:function(e){this._map=e._map;this._canvas2dMapMgr=e;this.base64Prefix="data:image/png;base64,";this.bizData=null;this.objTextsPng=null;this.arrIconsPng=null;this.bizLabels=null},proecessBizData:function(h8,ic){var ia=this;this.bizData=h8;this.objTextsPng=null;this.arrIconsPng=null;var T=h8.textsPng;var ie=h8.iconsPng;if(!T||!ie){return}var ib=new Image();ib.onload=function(){ia.objTextsPng=this;ia.calcIconAndTextInfo(ic);this.onload=null};ib.src=this.base64Prefix+T;var id=ie.length;var e=[];for(var h7=0;h7<id;h7++){var h9=ie[h7];var h6=new Image();(function(i){h6.onload=function(){id--;e[i]=this;if(id===0){ia.arrIconsPng=e;ia.calcIconAndTextInfo(ic)}this.onload=null}})(h7);h6.src=this.base64Prefix+h9}},calcIconAndTextInfo:function(ig){if(this.objTextsPng&&this.arrIconsPng){var ib=this.bizData;var h9=ib.pois;var e=[];for(var ic=0,h8=h9.length;ic<h8;ic++){var h6=h9[ic];var ia=this.arrIconsPng[h6.iconPng];var h7=ia.height/2;var ie={type:"fixed",name:"",textImg:this.objTextsPng,iconImg:ia,rank:h6.rank,iconPos:{srcX:0,srcY:0,destX:-ia.width/2,destY:-h7/2,width:ia.width,height:h7,geoX:h6.x,geoY:h6.y,iconType:"vectorCustom"},textPos:this.calcTextPos(h6.pos,ia),startScale:h6.from<12?12:h6.from,guid:h6.guid,guidExt:1,adver_log:h6.adver_log||""};var T={type:"fixed",textDirLeft:"left",name:"",textImg:this.objTextsPng,iconImg:ia,rank:h6.rank,iconPos:{srcX:0,srcY:0,destX:-ia.width/2,destY:-h7/2,width:ia.width,height:h7,geoX:h6.x,geoY:h6.y,iconType:"vectorCustom"},textPos:this.calcTextPosLeft(h6.pos,ia),startScale:h6.from<12?12:h6.from,guid:h6.guid,guidExt:1,adver_log:h6.adver_log||""};var id=[ie,T];e.push(id)}this.bizLabels=e;ig&&ig()}},calcTextPos:function(h9,T){var i=[];var h8=h9.length/4;var h7=T.width/2;if(h8===1){var h6={srcX:h9[0],srcY:h9[1],destX:h7,destY:-h9[3]/2,width:h9[2],height:h9[3]};i.push(h6)}else{var h6={srcX:h9[0],srcY:h9[1],destX:h7,destY:-h9[3],width:h9[2],height:h9[3]};var e={srcX:h9[4],srcY:h9[5],destX:h7,destY:0,width:h9[6],height:h9[7]};i.push(h6);i.push(e)}return i},calcTextPosLeft:function(h9,T){var i=[];var h8=h9.length/4;var h7=T.width/2;if(h8===1){var h6={srcX:h9[0],srcY:h9[1],destX:-h7-h9[2],destY:-h9[3]/2,width:h9[2],height:h9[3]};i.push(h6)}else{var h6={srcX:h9[0],srcY:h9[1],destX:-h7-h9[2],destY:-h9[3],width:h9[2],height:h9[3]};var e={srcX:h9[4],srcY:h9[5],destX:-h7-h9[2],destY:0,width:h9[6],height:h9[7]};i.push(h6);i.push(e)}return i},clearBizData:function(){this.bizData=null;this.bizLabels=null}});function db(){}D.extend(db.prototype,{centerAndZoomIn:function(T,ic,id){id=id||{};if(!this.loaded){this.firstTileLoad=false}ic=this._getProperZoom(ic).zoom;if(id.noAnimation!==true&&this.loaded){var h8=this._ifUseAnimation(T,ic);if(h8){this.flyToIn(T,ic,id);return}}var ia=this;if(!T&&!ic){return}this._stopAllAnimations();if(T&&!T.equals(this.centerPoint)){this.fire(new be("oncenter_changed"))}if(ic&&ic!==this.zoomLevel){this.fire(new be("onzoom_changed"))}T=T||this.centerPoint;ic=ic||this.zoomLevel;ic=this._getProperZoom(ic).zoom;if(this.mapType===BMAP_EARTH_MAP){if(!this._earth){this.mapType=BMAPGL_NORMAL_MAP;this.temp.originMapType=BMAP_EARTH_MAP;function ib(){ia._earth=new br.Earth(ia,{showRealSunlight:ia.config.showRealSunlight,showMilkyway:ia.config.showMilkyway,earthBackground:ia.config.earthBackground});ia._proxyEarthEvents();ia._changeEarthMapType(BMAP_EARTH_MAP);D.extend(ia,br.EarthView.prototype);delete ia.temp.originMapType}ej.load("earth",function(){if(br["FeatureStyle"+ia.config.style]){ib()}else{ia.loadMapStyleFiles(function(){ib()})}})}}this.lastLevel=this.zoomLevel||ic;this.zoomLevel=ic;var h9=new be("onload");h9.point=T;h9.zoom=ic;this.centerPoint=new hH(T.lng,T.lat);this.defaultZoomLevel=this.defaultZoomLevel||this.zoomLevel;this.defaultCenter=this.defaultCenter||this.centerPoint;if(this.mapType!==BMAP_EARTH_MAP){this.centerPoint=this.restrictCenter(this.centerPoint)}if(!this.loaded&&!(this.temp.originMapType===BMAP_EARTH_MAP)){var i=this.config.defaultMaxBounds;var h7=new c9(i,"baidu",this.mapType);if(this.mapType!==BMAP_NONE_MAP){var h6=new cV({mapType:this.mapType,copyright:h7,dataType:this.mapType===BMAP_SATELLITE_MAP?eS:gG,customLayer:this.mapType===BMAP_SATELLITE_MAP,baseLayer:true,transparentPng:true,tileTypeName:this.mapType===BMAP_SATELLITE_MAP?"web":"na"});h6._isInnerLayer=true;this.addTileLayer(h6);this.baseLayerAdded=true}if(this.mapType===BMAP_SATELLITE_MAP&&this._isHybridShow===true){this._addHybirdMap()}this.on("zoom_changed",function(){if(this._heading===0){return}if(this.getZoom()<7&&this.config.restrictCenter===true){ia.resetHeading()}})}this.loaded=true;this.dispatchEvent(h9);id.callback&&id.callback()},_ifUseAnimation:function(h6,ib){var ia=this.getSize();var T={zoom:this.zoomLevel};var id={zoom:ib};var ic=this.pointToPixelIn(this.centerPoint);var h7=this.pointToPixelIn(h6,T);var h9=this.pointToPixelIn(this.centerPoint,id);var ig=this.pointToPixelIn(h6,id);var h8=Math.abs(ic.x-h7.x);var i=Math.abs(ic.y-h7.y);var e=Math.abs(h9.x-ig.x);var ie=Math.abs(h9.y-ig.y);if((h8>ia.width||i>ia.height)&&(e>ia.width||ie>ia.height)){return false}return true},_setPlatformPosition:function(id,ic,ig){ig=ig||{};if(id===0&&ic===0&&!ig.point){return}if(isNaN(ig.initMapOffsetX)){ig.initMapOffsetX=this.offsetX}if(isNaN(ig.initMapOffsetY)){ig.initMapOffsetY=this.offsetY}var h9=dQ(this._heading);if(this._tilt>0){ic=ic/Math.cos(dQ(this._tilt))}var ie=id*Math.cos(h9)+ic*Math.sin(h9);var ib=-id*Math.sin(h9)+ic*Math.cos(h9);ie=ie+ig.initMapOffsetX;ib=ib+ig.initMapOffsetY;if(ig.point){var i=this.restrictCenter(ig.point);if(!i.equals(this.centerPoint)){this.centerPoint=i.clone();this.fire(new be("oncenter_changed"))}}else{var h6=this.offsetX-ie;var e=this.offsetY-ib;var ia=this.centerPoint.lng;var h8=this.centerPoint.lat;var h7=new hH(ia,h8);var T=this.getZoomUnits();this.centerPoint=this.restrictCenter(new hH(h7.lng+h6*T,h7.lat-e*T),T);this.fire(new be("oncenter_changed"))}this.offsetX=ie;this.offsetY=ib;this.dispatchEvent(new be("onmoving"))},restrictCenter:function(ie,e){if(this.config.restrictCenter===false){return ie}e=e||this.getZoomUnits();var ic=this.pixelToPointIn(new es(this.width,0),{center:ie});var h9=this.pixelToPointIn(new es(0,this.height),{center:ie});var ig=ie.lng;var il=ie.lat;if(this.config.restrictBounds!==null&&!this.config.restrictBounds.isEmpty()){var ik=this.config.restrictBounds;var T=ik.getSouthWest();var ii=ik.getNorthEast();var id=ew.convertLL2MC(T);var h7=ew.convertLL2MC(ii);var ia=this.calcNewZoomByRestriction(ig,il,h9,ic,id.lng,h7.lng,id.lat,h7.lat);if(ia>this.zoomLevel){this.zoomLevel=ia;return ie}ie.lng=this.calcNewLngByBounds(ig,h9,ic,id.lng,h7.lng,e);ie.lat=this.calcNewLatByBounds(il,h9,ic,id.lat,h7.lat,e);return ie}var ib=this.pixelToPointIn(new es(0,0),{center:ie});var h6=this.pixelToPointIn(new es(0,this.height),{center:ie});if(this.zoomLevel<5){if(ib.lat>dd.MAX_LAT&&h6.lat<dd.MIN_LAT){var i=dd.MAX_LAT-ie.lat;var h8=ie.lat-dd.MIN_LAT;var ij;if(i<h8){ij=i/(this.height/2)}else{ij=h8/(this.height/2)}var ih=18-eN(ij);this.zoomLevel=ih;return ie}}if(ib.lat>dd.MAX_LAT){ie.lat=dd.MAX_LAT-this.height/2*e}else{if(h6.lat<dd.MIN_LAT){ie.lat=dd.MIN_LAT+this.height/2*e}}return ie},calcNewZoomByRestriction:function(id,ic,e,ib,h7,h9,h6,h8){var ih=0;var ii=0;if(typeof h6==="number"&&typeof h8==="number"&&ib.lat>h8&&e.lat<h6){var T=h8-ic;var i=ic-h6;var ia;if(T<i){ia=T/(this.height/2)}else{ia=i/(this.height/2)}ih=18-eN(ia)}if(typeof h7==="number"&&typeof h9==="number"&&ib.lng>h9&&e.lng<h7){var ig=h9-id;var ie=id-h7;var ia;if(ig<ie){ia=ig/(this.width/2)}else{ia=ie/(this.width/2)}ii=18-eN(ia)}return Math.max(ih,ii)||this.zoomLevel},calcNewLatByBounds:function(i,h6,T,h9,h8,e){var h7=i;if(T.lat>h8){h7=h8-this.height/2*e}else{if(h6.lat<h9){h7=h9+this.height/2*e}}return h7},calcNewLngByBounds:function(h9,h8,h6,h7,T,e){var i=h9;if(h6.lng>T){i=T-this.width/2*e}else{if(h8.lng<h7){i=h7+this.width/2*e}}return i},zoomTo:function(e,ii,ij){var id=b9[this.mapType];if(!id){return}var ic=this._getProperZoom(e);e=ic.zoom;if(this.zoomLevel===e){ij&&ij.callback&&ij.callback();return}var h8=e;this.lastLevel=this.zoomLevel;ij=ij||{};if(this.zoomEventStatus==="idle"){this.fire(new be("onzoomstart"));this.zoomEventStatus="zooming"}if(!ii&&(this.getInfoWindow()&&this.temp.infoWin&&this.temp.infoWin.isOpen())){ii=ew.convertLL2MC(this.getInfoWindow().getPoint())}var T=null;if(ij.fixPixel){T=ij.fixPixel}else{if(ii){T=this.pointToPixelIn(ii,{useRound:false})}}var h9=this.pixelToPointIn(T);var ia=this.centerPoint.clone();this.fixPoint=ii;this.fixPixel=T;this.fixCenter=ia;this.mousePosMCPoint=h9;if(ij.noAnimation){e=ic.zoom;this.zoomLevel=e;this.fire(new be("onzoom_changed"));var h7=this.getCurrentMaxTilt();if(this._tilt>h7){this._tilt=h7}if(ii){if(this._heading%360!==0||this._tilt>0){var i=this._webglMapCamera.fromScreenPixelToMC(T.x,T.y,{center:ia,zoom:this.zoomLevel});if(i){var ie=i.sub(h9);var h6=ia.sub(ie);this.centerPoint=this.restrictCenter(h6)}}else{var ib=this.getZoomUnits();var h6=new hH(ii.lng-ib*(T.x-this.width/2),ii.lat+ib*(T.y-this.height/2));this.centerPoint=this.restrictCenter(h6,ib)}this.fire(new be("oncenter_changed"))}this._checkFireZoomend();ij.callback&&ij.callback();return}this._animationInfo.zoom={current:this.zoomLevel,diff:e-this.zoomLevel,target:e};var ig=this;ig._checkFireZoomend();var ih=this._tilt;if(this.fixPoint||ih>dd.MAX_DRAG_TILT_L2){ij.renderCallback=function(){var io=ig.getCurrentMaxTilt();if(ig._tilt>io){ig._tilt=io}var ip=ig.fixPixel;if(!ig.fixPixel||!ig.fixPoint){return}var ik=ig.fixPixel;var iw=ig.fixPoint;var it=ig.fixCenter;var iq=ig.mousePosMCPoint;if(ig._heading%360!==0||ig._tilt>0){var il=ig._webglMapCamera.fromScreenPixelToMC(ik.x,ik.y,{center:it,zoom:ig.zoomLevel,tilt:ig._tilt});if(il){var iv=il.sub(iq);var im=it.sub(iv);ig.centerPoint=ig.restrictCenter(im)}}else{var ir=ik;var iu=ig.getZoomUnits();var im=new hH(iw.lng-iu*(ir.x-ig.width/2),iw.lat+iu*(ir.y-ig.height/2));ig.centerPoint=ig.restrictCenter(im,iu)}ig.fire(new be("oncenter_changed"))}}if(ij.fromMouseWheel===true){this._startInfiniteZoomAnimation(ij);ij.callback&&ij.callback();return}this._startAnimation(ij)},_checkFireZoomend:function(){var e=this;if(e.fireZoomendTimer){clearTimeout(e.fireZoomendTimer)}e.fireZoomendTimer=setTimeout(function(){if(e.zoomEventStatus==="zooming"){e.fire(new be("onzoomend"));e.zoomEventStatus="idle"}e.fireZoomendTimer=null},150)},deepZoomMedia:function(e){var i=this;if(!i.temp.isStdCtrlBusy){i.temp.isStdCtrlBusy=true;i.deepZoomTo(i.zoomLevel+e);setTimeout(function(){i.temp.isStdCtrlBusy=false},400)}},deepZoomTo:function(e){this.zoomTo(e)},flyToIn:function(T,iD,im){im=im||{};var h7=this._getProperZoom(iD);iD=h7.zoom;if(this.centerPoint.equals(T)&&this.zoomLevel===iD&&typeof im.heading!=="number"&&typeof im.tilt!=="number"){return}var e=this.getHeading()%360;var id=this.getTilt();var ik=0;var ip=0;var ih=this.getBounds().containsPoint(T);if(typeof im.heading==="number"){ik=im.heading}else{if(ih){ik=e}}if(typeof im.tilt==="number"){ip=im.tilt}else{if(ih){ip=id}}this._heading=e;var iA=ik-e;var iw=ip-id;var ii=this;var h9=this.zoomLevel;var ia=1.42;var ir=this.zoomScale(iD-h9);var iF=this.getZoomUnits();var ig=this.centerPoint.div(iF);var iG=T.div(iF);var iz=this.worldSize();var iv=ia;var iu=Math.max(this.width,this.height);var it=iu/ir;var ie=iG.sub(ig).mag();var i=iv*iv;function iC(iI){var iH=(it*it-iu*iu+(iI?-1:1)*i*i*ie*ie)/(2*(iI?it:iu)*i*ie);return Math.log(Math.sqrt(iH*iH+1)-iH)}function h6(iH){return(Math.exp(iH)-Math.exp(-iH))/2}function ib(iH){return(Math.exp(iH)+Math.exp(-iH))/2}function il(iH){return h6(iH)/ib(iH)}var ic=iC(0);var ix=function(iH){return(ib(ic)/ib(ic+iv*iH))};var iy=function(iH){return iu*((ib(ic)*il(ic+iv*iH)-h6(ic))/i)/ie};var h8=(iC(1)-ic)/iv;if(Math.abs(ie)<0.000001||h8===Infinity||isNaN(h8)){if(Math.abs(iu-it)<0.000001){this._animationInfo.zoom={current:this.zoomLevel,diff:iD-this.zoomLevel};this._animationInfo.center={current:this.centerPoint,diff:T.sub(this.centerPoint)};this._animationInfo.heading={current:e,diff:ik-e};this._animationInfo.tilt={current:id,diff:ip-id};this.setLock(true);this._startAnimation({callback:function(iH){ii.setLock(false);if(im.callback){im.callback(iH)}},duration:im.duration});return}var iE=it<iu?-1:1;h8=Math.abs(Math.log(it/iu))/iv;iy=function(){return 0};ix=function(iH){return Math.exp(iE*iv*iH)}}var iB=1.7;if(h8<0.3){iB=0.8}else{if(h8>5){iB=(h8-5)/2+iB}}var io=im.duration||1000*h8/iB;if(isNaN(io)){var iq={};for(var ij in im){iq[ij]=im[ij];iq.noAnimation=true}this.centerAndZoomIn(T,iD,iq);return}this.fire(new be("onmovestart"));this.fire(new be("onzoomstart"));this.setLock(true);this._startAnimation({duration:io,renderCallback:function(iH,iI){var iJ=iH*h8;var iM=iy(iJ);var iL=h9+ii.scaleZoom(1/ix(iJ));if(iL<ii.getMinZoom()){iL=ii.getMinZoom()}if(iL>ii.getMaxZoom()){iL=ii.getMaxZoom()}if(iL!==ii.zoomLevel){ii.zoomLevel=iL;ii.fire(new be("onzoom_changed"))}ii.centerPoint=ig.add(iG.sub(ig).mult(iM)).mult(iF);ii.fire(new be("oncenter_changed"));if(typeof ik==="number"){var iK=iH/0.7;if(iK>1){iK=1}ii.setHeading(e+iA*iH,{noAnimation:true})}if(typeof ip==="number"){ii.setTilt(id+iw*iH,{noAnimation:true})}},callback:function(iH,iI){ii.setLock(false);if(iI&&iI.stop===true){ii.fire(new be("onmoveend"));ii.fire(new be("onzoomend"));im.callback&&im.callback(iH);return}if(iD!==ii.zoomLevel){ii.zoomLevel=iD;ii.fire(new be("onzoom_changed"))}ii.fire(new be("onmoveend"));ii.fire(new be("onzoomend"));im.callback&&im.callback(iH)}})},zoomScale:function(e){return Math.pow(2,e)},scaleZoom:function(e){return Math.log(e)/Math.LN2},panToIn:function(i,T){T=T||{};if(!i||i.equals(this.centerPoint)){T.callback&&T.callback();return}var h6=this.pointToPixelIn(i);var e=Math.round(this.width/2);var h8=Math.round(this.height/2);var h7=this._ifUseAnimation(i,this.zoomLevel);if(T.noAnimation===true||h7===false){this._stopAllAnimations();this._panToIn(e-h6.x,h8-h6.y,i);T.callback&&T.callback();return}this.flyToIn(i,this.zoomLevel,T)},_panToIn:function(i,e,h6){var T=this.temp;if(T.operating===true){return}if(T.dragAni){T.dragAni.stop(false,{readyToMove:true});T.dragAni=null}this.dispatchEvent(new be("onmovestart"));this._setPlatformPosition(i,e,{point:h6});this.dispatchEvent(new be("onmoveend"))},_stopAllAnimations:function(e){e=e||{};if(this._ani){this._ani.stop(!!e.goToEnd,{stopCurrentAnimation:e.stopCurrentAnimation});this._ani=null}if(this._infiniteAni){this._infiniteAni.stop();this._infiniteAni=null}},panBy:function(i,e,T){i=Math.round(i)||0;e=Math.round(e)||0;T=T||{};if(Math.abs(i)<=this.width&&Math.abs(e)<=this.height&&T.noAnimation!==true){this._panBy(i,e,T)}else{this._panToIn(i,e,T.point);T.callback&&T.callback()}},_panBy:function(i,e,h7){if(this.temp.operating===true){return}h7=h7||{};this.dispatchEvent(new be("onmovestart"));var h6=this;var T=h6.temp;T.pl=h6.offsetX;T.pt=h6.offsetY;if(T.tlPan){T.tlPan.cancel()}if(T.dragAni){T.dragAni.stop(false,{readyToMove:true});T.dragAni=null}T.tlPan=new p({fps:h7.fps||h6.config.fps,duration:h7.duration||h6.config.actionDuration,transition:h7.transition||cq.easeInOutQuad,render:function(h8){this.terminative=h6.temp.operating;if(h6.temp.operating){return}h6._setPlatformPosition(i*h8,e*h8,{initMapOffsetX:T.pl,initMapOffsetY:T.pt})},finish:function(h8){h6.dispatchEvent(new be("onmoveend"));h6.temp.tlPan=false;if(h6.temp.stopArrow===true){h6.temp.stopArrow=false;if(h6.temp.arrow!==0){h6._arrow()}}}})},_startAnimation:function(i){var h7=this._animationInfo;var T=this;i=i||{};if(T._ani){T._ani.stop(!!i.goToEnd,{stopCurrentAnimation:i.stopCurrentAnimation})}if(T._infiniteAni){T._infiniteAni.stop();T._infiniteAni=null}var h8=i.duration||500;var h9=i.transition||cq.ease;var e=new be("onanimation_start");this.fire(e);if(i.unstopable){h7=this._animationInfoUnstopable}var h6=new p({duration:h8,transition:h9,render:function(ic,ib){for(var ia in h7){if(!h7.hasOwnProperty(ia)){continue}var ie=h7[ia].current;var id=h7[ia].diff;T._setValueTick(ia,ie,id,ic)}if(i.renderCallback){i.renderCallback(ic,ib)}},finish:function(ia){T.fire(new be("onanimation_end"));if(i.unstopable){T._animationInfoUnstopable={};T._unstopableAni=null}else{T._ani=null;T._animationInfo={}}if(i.mapNeedCbk){i.mapNeedCbk()}if(i.callback){i.callback(ia)}},onStop:function(ia){ia=ia||{};T.fire(new be("onanimation_end"));if(ia.stopCurrentAnimation){T._animationInfo={}}T._ani=null;if(i.mapNeedCbk){i.mapNeedCbk()}if(i.callback){i.callback(null,{stop:true})}}});if(i.unstopable){T._unstopableAni=h6}else{T._ani=h6}},_startInfiniteZoomAnimation:function(e){var i=this;if(i._ani){i._ani.stop(!!e.goToEnd,{stopCurrentAnimation:e.stopCurrentAnimation})}if(i._infiniteAni){return}this.fire(new be("onanimation_start"));i._infiniteAni=new p({duration:10000,transition:cq.linear,render:function(){var T=i._animationInfo.zoom;if(Math.abs(T.current-T.target)<0.001){i._setValue("zoom",T.target);i._infiniteAni.stop();return}T.current+=(T.target-T.current)*0.35;i._setValue("zoom",T.current);if(e.renderCallback){e.renderCallback()}},finish:function(){i._infiniteAni=null;i._animationInfo={};i.fire(new be("onanimation_end"));if(e.callback){e.callback()}},onStop:function(){i._infiniteAni=null;i._animationInfo={};i.fire(new be("onanimation_end"));if(e.callback){e.callback()}}})},_setValue:function(e,T){if(e==="zoom"){this._preZoomLevel=this.zoomLevel;var i=this._getProperZoom(T);T=i.zoom;if(T!==this.zoomLevel){this.zoomLevel=T;if(T<5){this.restrictCenter(this.centerPoint)}this.fire(new be("on"+e+"_changed"))}return}else{if(e==="center"){this.centerPoint=T}}this["_"+e]=T;this.fire(new be("on"+e+"_changed"))},_setValueTick:function(e,h7,h6,i){if(e==="center"){var T=new hH(h7.lng+h6.lng*i,h7.lat+h6.lat*i);this._setValue(e,T);return}if(e==="zoom"){this._setValue(e,Math.pow(h7,1-i)*Math.pow(h7+h6,i));return}this._setValue(e,h7+h6*i)},setHeading:function(h6,i){i=i||{};if(h6===this._heading){i.callback&&i.callback();return}var T=gc(this._heading,360);var e=gc(h6,360);if(e===T){this._heading=h6;i.callback&&i.callback();return}if(i.noAnimation){this._setValue("heading",h6);i.callback&&i.callback();return}if(i.unstopable){this._animationInfoUnstopable.heading={current:this._heading,diff:h6-this._heading}}else{this._animationInfo.heading={current:this._heading,diff:h6-this._heading}}this._startAnimation(i)},resetHeading:function(e){var i=this._heading;while(i<0){i+=360}i=i%360;if(i>180){i-=360}this._heading=i;e=e||{};e.unstopable=true;this.setHeading(0,e)},getHeading:function(){return this._heading},setTilt:function(e,i){i=i||{};if(e===this._tilt){i.callback&&i.callback();return}if(e>dd.MAX_TILT){e=dd.MAX_TILT}if(e<dd.MIN_TILT){e=dd.MIN_TILT}if(i&&i.noAnimation){this._setValue("tilt",e);i.callback&&i.callback();return}this._animationInfo.tilt={current:this._tilt,diff:e-this._tilt};this._startAnimation(i)},getTilt:function(){return this._tilt},getCenterIn:function(){return this.centerPoint},getZoom:function(){return this.zoomLevel},getCameraPosition:function(T){T=T||{};var e=T.center||this.centerPoint;var h6=T.zoom||this.zoomLevel;var h9=typeof T.heading==="number"?T.heading:this._heading;var i=typeof T.tilt==="number"?T.tilt:this._tilt;var h8=this._webglMapCamera.generateMVMatrix(e,h6,h9,i);var h7=mat4.create(Float32Array);mat4.invert(h7,h8);return this._webglMapCamera.getPosition(h7)}});function f1(i){this._jobQueue=[];this._idleOnlyJobQueue=[];var e=this;this.isIdle=true;i.on("updateframe",function(h6){var T=12-h6.frameTime;T=T<1?1:T;e.isIdle=false;if(e.idleWorkTimer){clearInterval(e.idleWorkTimer);e.idleWorkTimer=null}e.runJobs(T)});this._idleWorkerTicker=(function(T){return function(){if(T.isIdle){T.runJobs();T.runIdleOnlyJobs()}}})(this);i.on("mapglidle",function(){e.isIdle=true;e.runJobs();e.runIdleOnlyJobs();e.idleWorkTimer=setInterval(e._idleWorkerTicker,f1.MAX_IDLE_TIME)})}f1.MAX_IDLE_TIME=50;f1.MAX_FRAME_TIME=6;f1.prototype.runJobs=function(i){if(this._jobQueue.length===0){return}var h6=fN();var e=0;i=i||f1.MAX_FRAME_TIME;while(this._jobQueue.length&&e<i){var T=this._jobQueue.shift();if(T.state!=="invalid"){T.call()}e=fN()-h6}};f1.prototype.runIdleOnlyJobs=function(){if(this._idleOnlyJobQueue.length===0){return}var T=fN();var e=0;while(this._idleOnlyJobQueue.length&&e<f1.MAX_IDLE_TIME){var i=this._idleOnlyJobQueue.shift();if(i.state!=="invalid"){i.call()}e=fN()-T}};f1.prototype.checkIdleRunning=function(){if(this.isIdle&&!this.idleWorkTimer){this.runJobs();this.runIdleOnlyJobs();this.idleWorkTimer=setInterval(this._idleWorkerTicker,50)}};f1.prototype.addJob=function(e){this._jobQueue.push(e);this.checkIdleRunning()};f1.prototype.clearJobs=function(){this._jobQueue.length=0;this._idleOnlyJobQueue.length=0};f1.prototype.addIdleOnlyJob=function(e){this._idleOnlyJobQueue.push(e);this.checkIdleRunning()};var ce={};(function(h9){if(!id){var id=0.000001}if(!i){var i=(typeof Float32Array!=="undefined")?Float32Array:Array}if(!h7){var h7=Math.random}var T={};var h8=Math.PI/180;T.toRadian=function(ie){return ie*h8};var ic={};ic.create=function(ig){ig=ig||i;var ie=new ig(2);ie[0]=0;ie[1]=0;return ie};ic.clone=function(ie,ih){ih=ih||i;var ig=new ih(2);ig[0]=ie[0];ig[1]=ie[1];return ig};ic.fromValues=function(ie,ii,ih){ih=ih||i;var ig=new ih(2);ig[0]=ie;ig[1]=ii;return ig};ic.copy=function(ig,ie){ig[0]=ie[0];ig[1]=ie[1];return ig};ic.set=function(ig,ie,ih){ig[0]=ie;ig[1]=ih;return ig};ic.add=function(ih,ig,ie){ih[0]=ig[0]+ie[0];ih[1]=ig[1]+ie[1];return ih};ic.subtract=function(ih,ig,ie){ih[0]=ig[0]-ie[0];ih[1]=ig[1]-ie[1];return ih};ic.sub=ic.subtract;ic.multiply=function(ih,ig,ie){ih[0]=ig[0]*ie[0];ih[1]=ig[1]*ie[1];return ih};ic.mul=ic.multiply;ic.divide=function(ih,ig,ie){ih[0]=ig[0]/ie[0];ih[1]=ig[1]/ie[1];return ih};ic.div=ic.divide;ic.min=function(ih,ig,ie){ih[0]=Math.min(ig[0],ie[0]);ih[1]=Math.min(ig[1],ie[1]);return ih};ic.max=function(ih,ig,ie){ih[0]=Math.max(ig[0],ie[0]);ih[1]=Math.max(ig[1],ie[1]);return ih};ic.scale=function(ih,ig,ie){ih[0]=ig[0]*ie;ih[1]=ig[1]*ie;return ih};ic.scaleAndAdd=function(ih,ig,ie,ii){ih[0]=ig[0]+(ie[0]*ii);ih[1]=ig[1]+(ie[1]*ii);return ih};ic.distance=function(ih,ig){var ie=ig[0]-ih[0],ii=ig[1]-ih[1];return Math.sqrt(ie*ie+ii*ii)};ic.dist=ic.distance;ic.squaredDistance=function(ih,ig){var ie=ig[0]-ih[0],ii=ig[1]-ih[1];return ie*ie+ii*ii};ic.sqrDist=ic.squaredDistance;ic.length=function(ig){var ie=ig[0],ih=ig[1];return Math.sqrt(ie*ie+ih*ih)};ic.len=ic.length;ic.squaredLength=function(ig){var ie=ig[0],ih=ig[1];return ie*ie+ih*ih};ic.sqrLen=ic.squaredLength;ic.negate=function(ig,ie){ig[0]=-ie[0];ig[1]=-ie[1];return ig};ic.normalize=function(ii,ih){var ig=ih[0],ij=ih[1];var ie=ig*ig+ij*ij;if(ie>0){ie=1/Math.sqrt(ie);ii[0]=ih[0]*ie;ii[1]=ih[1]*ie}return ii};ic.dot=function(ig,ie){return ig[0]*ie[0]+ig[1]*ie[1]};ic.cross=function(ih,ig,ie){var ii=ig[0]*ie[1]-ig[1]*ie[0];ih[0]=ih[1]=0;ih[2]=ii;return ih};ic.lerp=function(ih,ig,ie,ii){var ik=ig[0],ij=ig[1];ih[0]=ik+ii*(ie[0]-ik);ih[1]=ij+ii*(ie[1]-ij);return ih};ic.random=function(ie,ih){ih=ih||1;var ig=h7()*2*Math.PI;ie[0]=Math.cos(ig)*ih;ie[1]=Math.sin(ig)*ih;return ie};ic.transformMat2=function(ii,ih,ig){var ie=ih[0],ij=ih[1];ii[0]=ig[0]*ie+ig[2]*ij;ii[1]=ig[1]*ie+ig[3]*ij;return ii};ic.transformMat2d=function(ii,ih,ig){var ie=ih[0],ij=ih[1];ii[0]=ig[0]*ie+ig[2]*ij+ig[4];ii[1]=ig[1]*ie+ig[3]*ij+ig[5];return ii};ic.transformMat3=function(ii,ih,ig){var ie=ih[0],ij=ih[1];ii[0]=ig[0]*ie+ig[3]*ij+ig[6];ii[1]=ig[1]*ie+ig[4]*ij+ig[7];return ii};ic.transformMat4=function(ii,ih,ig){var ie=ih[0],ij=ih[1];ii[0]=ig[0]*ie+ig[4]*ij+ig[12];ii[1]=ig[1]*ie+ig[5]*ij+ig[13];return ii};ic.rotate=function(ii,ig,ie,im){var il=ig[0]-ie[0];var ik=ig[1]-ie[1];var ih=Math.sin(im);var ij=Math.cos(im);ii[0]=il*ij-ik*ih+ie[0];ii[1]=il*ih+ik*ij+ie[1];return ii};ic.forEach=(function(){var ie=ic.create();return function(ii,im,io,il,ik,ig){var ij,ih;if(!im){im=2}if(!io){io=0}if(il){ih=Math.min((il*im)+io,ii.length)}else{ih=ii.length}for(ij=io;ij<ih;ij+=im){ie[0]=ii[ij];ie[1]=ii[ij+1];ik(ie,ie,ig);ii[ij]=ie[0];ii[ij+1]=ie[1]}return ii}})();ic.str=function(ie){return"vec2("+ie[0]+", "+ie[1]+")"};h9.vec2=ic;var ib={};ib.create=function(ig){ig=ig||i;var ie=new ig(3);ie[0]=0;ie[1]=0;ie[2]=0;return ie};ib.clone=function(ie,ih){ih=ih||i;var ig=new ih(3);ig[0]=ie[0];ig[1]=ie[1];ig[2]=ie[2];return ig};ib.fromValues=function(ie,ij,ih,ii){ii=ii||i;var ig=new ii(3);ig[0]=ie;ig[1]=ij;ig[2]=ih;return ig};ib.copy=function(ig,ie){ig[0]=ie[0];ig[1]=ie[1];ig[2]=ie[2];return ig};ib.set=function(ig,ie,ii,ih){ig[0]=ie;ig[1]=ii;ig[2]=ih;return ig};ib.add=function(ih,ig,ie){ih[0]=ig[0]+ie[0];ih[1]=ig[1]+ie[1];ih[2]=ig[2]+ie[2];return ih};ib.subtract=function(ih,ig,ie){ih[0]=ig[0]-ie[0];ih[1]=ig[1]-ie[1];ih[2]=ig[2]-ie[2];return ih};ib.sub=ib.subtract;ib.multiply=function(ih,ig,ie){ih[0]=ig[0]*ie[0];ih[1]=ig[1]*ie[1];ih[2]=ig[2]*ie[2];return ih};ib.mul=ib.multiply;ib.divide=function(ih,ig,ie){ih[0]=ig[0]/ie[0];ih[1]=ig[1]/ie[1];ih[2]=ig[2]/ie[2];return ih};ib.div=ib.divide;ib.min=function(ih,ig,ie){ih[0]=Math.min(ig[0],ie[0]);ih[1]=Math.min(ig[1],ie[1]);ih[2]=Math.min(ig[2],ie[2]);return ih};ib.max=function(ih,ig,ie){ih[0]=Math.max(ig[0],ie[0]);ih[1]=Math.max(ig[1],ie[1]);ih[2]=Math.max(ig[2],ie[2]);return ih};ib.scale=function(ih,ig,ie){ih[0]=ig[0]*ie;ih[1]=ig[1]*ie;ih[2]=ig[2]*ie;return ih};ib.scaleAndAdd=function(ih,ig,ie,ii){ih[0]=ig[0]+(ie[0]*ii);ih[1]=ig[1]+(ie[1]*ii);ih[2]=ig[2]+(ie[2]*ii);return ih};ib.distance=function(ih,ig){var ie=ig[0]-ih[0],ij=ig[1]-ih[1],ii=ig[2]-ih[2];return Math.sqrt(ie*ie+ij*ij+ii*ii)};ib.dist=ib.distance;ib.squaredDistance=function(ih,ig){var ie=ig[0]-ih[0],ij=ig[1]-ih[1],ii=ig[2]-ih[2];return ie*ie+ij*ij+ii*ii};ib.sqrDist=ib.squaredDistance;ib.length=function(ig){var ie=ig[0],ii=ig[1],ih=ig[2];return Math.sqrt(ie*ie+ii*ii+ih*ih)};ib.len=ib.length;ib.squaredLength=function(ig){var ie=ig[0],ii=ig[1],ih=ig[2];return ie*ie+ii*ii+ih*ih};ib.sqrLen=ib.squaredLength;ib.negate=function(ig,ie){ig[0]=-ie[0];ig[1]=-ie[1];ig[2]=-ie[2];return ig};ib.normalize=function(ii,ih){var ig=ih[0],ik=ih[1],ij=ih[2];var ie=ig*ig+ik*ik+ij*ij;if(ie>0){ie=1/Math.sqrt(ie);ii[0]=ih[0]*ie;ii[1]=ih[1]*ie;ii[2]=ih[2]*ie}return ii};ib.dot=function(ig,ie){return ig[0]*ie[0]+ig[1]*ie[1]+ig[2]*ie[2]};ib.cross=function(ig,il,ik){var ie=il[0],io=il[1],im=il[2],ij=ik[0],ii=ik[1],ih=ik[2];ig[0]=io*ih-im*ii;ig[1]=im*ij-ie*ih;ig[2]=ie*ii-io*ij;return ig};ib.lerp=function(ih,ig,ie,ii){var il=ig[0],ik=ig[1],ij=ig[2];ih[0]=il+ii*(ie[0]-il);ih[1]=ik+ii*(ie[1]-ik);ih[2]=ij+ii*(ie[2]-ij);return ih};ib.random=function(ie,ij){ij=ij||1;var ih=h7()*2*Math.PI;var ii=(h7()*2)-1;var ig=Math.sqrt(1-ii*ii)*ij;ie[0]=Math.cos(ih)*ig;ie[1]=Math.sin(ih)*ig;ie[2]=ii*ij;return ie};ib.transformMat4=function(ii,ih,ig){var ie=ih[0],ik=ih[1],ij=ih[2];ii[0]=ig[0]*ie+ig[4]*ik+ig[8]*ij+ig[12];ii[1]=ig[1]*ie+ig[5]*ik+ig[9]*ij+ig[13];ii[2]=ig[2]*ie+ig[6]*ik+ig[10]*ij+ig[14];return ii};ib.transformMat3=function(ii,ih,ig){var ie=ih[0],ik=ih[1],ij=ih[2];ii[0]=ie*ig[0]+ik*ig[3]+ij*ig[6];ii[1]=ie*ig[1]+ik*ig[4]+ij*ig[7];ii[2]=ie*ig[2]+ik*ig[5]+ij*ig[8];return ii};ib.transformQuat=function(il,it,ie){var iu=it[0],ir=it[1],iq=it[2],io=ie[0],im=ie[1],ik=ie[2],ip=ie[3],ii=ip*iu+im*iq-ik*ir,ih=ip*ir+ik*iu-io*iq,ig=ip*iq+io*ir-im*iu,ij=-io*iu-im*ir-ik*iq;il[0]=ii*ip+ij*-io+ih*-ik-ig*-im;il[1]=ih*ip+ij*-im+ig*-io-ii*-ik;il[2]=ig*ip+ij*-ik+ii*-im-ih*-io;return il};ib.rotateX=function(ih,ig,ie,ik){var ij=[],ii=[];ij[0]=ig[0]-ie[0];ij[1]=ig[1]-ie[1];ij[2]=ig[2]-ie[2];ii[0]=ij[0];ii[1]=ij[1]*Math.cos(ik)-ij[2]*Math.sin(ik);ii[2]=ij[1]*Math.sin(ik)+ij[2]*Math.cos(ik);ih[0]=ii[0]+ie[0];ih[1]=ii[1]+ie[1];ih[2]=ii[2]+ie[2];return ih};ib.rotateY=function(ih,ig,ie,ik){var ij=[],ii=[];ij[0]=ig[0]-ie[0];ij[1]=ig[1]-ie[1];ij[2]=ig[2]-ie[2];ii[0]=ij[2]*Math.sin(ik)+ij[0]*Math.cos(ik);ii[1]=ij[1];ii[2]=ij[2]*Math.cos(ik)-ij[0]*Math.sin(ik);ih[0]=ii[0]+ie[0];ih[1]=ii[1]+ie[1];ih[2]=ii[2]+ie[2];return ih};ib.rotateZ=function(ih,ig,ie,ik){var ij=[],ii=[];ij[0]=ig[0]-ie[0];ij[1]=ig[1]-ie[1];ij[2]=ig[2]-ie[2];ii[0]=ij[0]*Math.cos(ik)-ij[1]*Math.sin(ik);ii[1]=ij[0]*Math.sin(ik)+ij[1]*Math.cos(ik);ii[2]=ij[2];ih[0]=ii[0]+ie[0];ih[1]=ii[1]+ie[1];ih[2]=ii[2]+ie[2];return ih};ib.forEach=(function(){var ie=ib.create();return function(ii,im,io,il,ik,ig){var ij,ih;if(!im){im=3}if(!io){io=0}if(il){ih=Math.min((il*im)+io,ii.length)}else{ih=ii.length}for(ij=io;ij<ih;ij+=im){ie[0]=ii[ij];ie[1]=ii[ij+1];ie[2]=ii[ij+2];ik(ie,ie,ig);ii[ij]=ie[0];ii[ij+1]=ie[1];ii[ij+2]=ie[2]}return ii}})();ib.str=function(ie){return"vec3("+ie[0]+", "+ie[1]+", "+ie[2]+")"};h9.vec3=ib;var ia={};ia.create=function(ig){ig=ig||i;var ie=new ig(4);ie[0]=0;ie[1]=0;ie[2]=0;ie[3]=0;return ie};ia.clone=function(ie,ih){ih=ih||i;var ig=new ih(4);ig[0]=ie[0];ig[1]=ie[1];ig[2]=ie[2];ig[3]=ie[3];return ig};ia.fromValues=function(ie,ik,ii,ig,ij){ij=ij||i;var ih=new ij(4);ih[0]=ie;ih[1]=ik;ih[2]=ii;ih[3]=ig;return ih};ia.copy=function(ig,ie){ig[0]=ie[0];ig[1]=ie[1];ig[2]=ie[2];ig[3]=ie[3];return ig};ia.set=function(ih,ie,ij,ii,ig){ih[0]=ie;ih[1]=ij;ih[2]=ii;ih[3]=ig;return ih};ia.add=function(ih,ig,ie){ih[0]=ig[0]+ie[0];ih[1]=ig[1]+ie[1];ih[2]=ig[2]+ie[2];ih[3]=ig[3]+ie[3];return ih};ia.subtract=function(ih,ig,ie){ih[0]=ig[0]-ie[0];ih[1]=ig[1]-ie[1];ih[2]=ig[2]-ie[2];ih[3]=ig[3]-ie[3];return ih};ia.sub=ia.subtract;ia.multiply=function(ih,ig,ie){ih[0]=ig[0]*ie[0];ih[1]=ig[1]*ie[1];ih[2]=ig[2]*ie[2];ih[3]=ig[3]*ie[3];return ih};ia.mul=ia.multiply;ia.divide=function(ih,ig,ie){ih[0]=ig[0]/ie[0];ih[1]=ig[1]/ie[1];ih[2]=ig[2]/ie[2];ih[3]=ig[3]/ie[3];return ih};ia.div=ia.divide;ia.min=function(ih,ig,ie){ih[0]=Math.min(ig[0],ie[0]);ih[1]=Math.min(ig[1],ie[1]);ih[2]=Math.min(ig[2],ie[2]);ih[3]=Math.min(ig[3],ie[3]);return ih};ia.max=function(ih,ig,ie){ih[0]=Math.max(ig[0],ie[0]);ih[1]=Math.max(ig[1],ie[1]);ih[2]=Math.max(ig[2],ie[2]);ih[3]=Math.max(ig[3],ie[3]);return ih};ia.scale=function(ih,ig,ie){ih[0]=ig[0]*ie;ih[1]=ig[1]*ie;ih[2]=ig[2]*ie;ih[3]=ig[3]*ie;return ih};ia.scaleAndAdd=function(ih,ig,ie,ii){ih[0]=ig[0]+(ie[0]*ii);ih[1]=ig[1]+(ie[1]*ii);ih[2]=ig[2]+(ie[2]*ii);ih[3]=ig[3]+(ie[3]*ii);return ih};ia.distance=function(ii,ig){var ie=ig[0]-ii[0],ik=ig[1]-ii[1],ij=ig[2]-ii[2],ih=ig[3]-ii[3];return Math.sqrt(ie*ie+ik*ik+ij*ij+ih*ih)};ia.dist=ia.distance;ia.squaredDistance=function(ii,ig){var ie=ig[0]-ii[0],ik=ig[1]-ii[1],ij=ig[2]-ii[2],ih=ig[3]-ii[3];return ie*ie+ik*ik+ij*ij+ih*ih};ia.sqrDist=ia.squaredDistance;ia.length=function(ih){var ie=ih[0],ij=ih[1],ii=ih[2],ig=ih[3];return Math.sqrt(ie*ie+ij*ij+ii*ii+ig*ig)};ia.len=ia.length;ia.squaredLength=function(ih){var ie=ih[0],ij=ih[1],ii=ih[2],ig=ih[3];return ie*ie+ij*ij+ii*ii+ig*ig};ia.sqrLen=ia.squaredLength;ia.negate=function(ig,ie){ig[0]=-ie[0];ig[1]=-ie[1];ig[2]=-ie[2];ig[3]=-ie[3];return ig};ia.normalize=function(ij,ii){var ig=ii[0],il=ii[1],ik=ii[2],ih=ii[3];var ie=ig*ig+il*il+ik*ik+ih*ih;if(ie>0){ie=1/Math.sqrt(ie);ij[0]=ii[0]*ie;ij[1]=ii[1]*ie;ij[2]=ii[2]*ie;ij[3]=ii[3]*ie}return ij};ia.dot=function(ig,ie){return ig[0]*ie[0]+ig[1]*ie[1]+ig[2]*ie[2]+ig[3]*ie[3]};ia.lerp=function(ih,ig,ie,ii){var il=ig[0],ik=ig[1],ij=ig[2],im=ig[3];ih[0]=il+ii*(ie[0]-il);ih[1]=ik+ii*(ie[1]-ik);ih[2]=ij+ii*(ie[2]-ij);ih[3]=im+ii*(ie[3]-im);return ih};ia.random=function(ie,ig){ig=ig||1;ie[0]=h7();ie[1]=h7();ie[2]=h7();ie[3]=h7();ia.normalize(ie,ie);ia.scale(ie,ie,ig);return ie};ia.transformMat4=function(ij,ii,ig){var ie=ii[0],il=ii[1],ik=ii[2],ih=ii[3];ij[0]=ig[0]*ie+ig[4]*il+ig[8]*ik+ig[12]*ih;ij[1]=ig[1]*ie+ig[5]*il+ig[9]*ik+ig[13]*ih;ij[2]=ig[2]*ie+ig[6]*il+ig[10]*ik+ig[14]*ih;ij[3]=ig[3]*ie+ig[7]*il+ig[11]*ik+ig[15]*ih;return ij};ia.transformQuat=function(il,it,ie){var iu=it[0],ir=it[1],iq=it[2],io=ie[0],im=ie[1],ik=ie[2],ip=ie[3],ii=ip*iu+im*iq-ik*ir,ih=ip*ir+ik*iu-io*iq,ig=ip*iq+io*ir-im*iu,ij=-io*iu-im*ir-ik*iq;il[0]=ii*ip+ij*-io+ih*-ik-ig*-im;il[1]=ih*ip+ij*-im+ig*-io-ii*-ik;il[2]=ig*ip+ij*-ik+ii*-im-ih*-io;return il};ia.forEach=(function(){var ie=ia.create();return function(ii,im,io,il,ik,ig){var ij,ih;if(!im){im=4}if(!io){io=0}if(il){ih=Math.min((il*im)+io,ii.length)}else{ih=ii.length}for(ij=io;ij<ih;ij+=im){ie[0]=ii[ij];ie[1]=ii[ij+1];ie[2]=ii[ij+2];ie[3]=ii[ij+3];ik(ie,ie,ig);ii[ij]=ie[0];ii[ij+1]=ie[1];ii[ij+2]=ie[2];ii[ij+3]=ie[3]}return ii}})();ia.str=function(ie){return"vec4("+ie[0]+", "+ie[1]+", "+ie[2]+", "+ie[3]+")"};h9.vec4=ia;var h6={};h6.create=function(ig){ig=ig||i;var ie=new ig(4);ie[0]=1;ie[1]=0;ie[2]=0;ie[3]=1;return ie};h6.clone=function(ie,ih){ih=ih||i;var ig=new ih(4);ig[0]=ie[0];ig[1]=ie[1];ig[2]=ie[2];ig[3]=ie[3];return ig};h6.copy=function(ig,ie){ig[0]=ie[0];ig[1]=ie[1];ig[2]=ie[2];ig[3]=ie[3];return ig};h6.identity=function(ie){ie[0]=1;ie[1]=0;ie[2]=0;ie[3]=1;return ie};h6.transpose=function(ih,ig){if(ih===ig){var ie=ig[1];ih[1]=ig[2];ih[2]=ie}else{ih[0]=ig[0];ih[1]=ig[2];ih[2]=ig[1];ih[3]=ig[3]}return ih};h6.invert=function(ij,ih){var ii=ih[0],ig=ih[1],ie=ih[2],il=ih[3],ik=ii*il-ie*ig;if(!ik){return null}ik=1/ik;ij[0]=il*ik;ij[1]=-ig*ik;ij[2]=-ie*ik;ij[3]=ii*ik;return ij};h6.adjoint=function(ih,ie){var ig=ie[0];ih[0]=ie[3];ih[1]=-ie[1];ih[2]=-ie[2];ih[3]=ig;return ih};h6.determinant=function(ie){return ie[0]*ie[3]-ie[2]*ie[1]};h6.multiply=function(ij,ip,im){var ii=ip[0],ih=ip[1],ig=ip[2],ie=ip[3];var iq=im[0],io=im[1],il=im[2],ik=im[3];ij[0]=ii*iq+ig*io;ij[1]=ih*iq+ie*io;ij[2]=ii*il+ig*ik;ij[3]=ih*il+ie*ik;return ij};h6.mul=h6.multiply;h6.rotate=function(ij,im,il){var ii=im[0],ih=im[1],ig=im[2],ie=im[3],io=Math.sin(il),ik=Math.cos(il);ij[0]=ii*ik+ig*io;ij[1]=ih*ik+ie*io;ij[2]=ii*-io+ig*ik;ij[3]=ih*-io+ie*ik;return ij};h6.scale=function(ij,ik,im){var ii=ik[0],ih=ik[1],ig=ik[2],ie=ik[3],io=im[0],il=im[1];ij[0]=ii*io;ij[1]=ih*io;ij[2]=ig*il;ij[3]=ie*il;return ij};h6.str=function(ie){return"mat2("+ie[0]+", "+ie[1]+", "+ie[2]+", "+ie[3]+")"};h6.frob=function(ie){return(Math.sqrt(Math.pow(ie[0],2)+Math.pow(ie[1],2)+Math.pow(ie[2],2)+Math.pow(ie[3],2)))};h6.LDU=function(ie,ii,ih,ig){ie[2]=ig[2]/ig[0];ih[0]=ig[0];ih[1]=ig[1];ih[3]=ig[3]-ie[2]*ih[1];return[ie,ii,ih]};h9.mat2=h6;var e={};e.create=function(ig){ig=ig||i;var ie=new ig(16);ie[0]=1;ie[1]=0;ie[2]=0;ie[3]=0;ie[4]=0;ie[5]=1;ie[6]=0;ie[7]=0;ie[8]=0;ie[9]=0;ie[10]=1;ie[11]=0;ie[12]=0;ie[13]=0;ie[14]=0;ie[15]=1;return ie};e.clone=function(ie){var ig=new i(16);ig[0]=ie[0];ig[1]=ie[1];ig[2]=ie[2];ig[3]=ie[3];ig[4]=ie[4];ig[5]=ie[5];ig[6]=ie[6];ig[7]=ie[7];ig[8]=ie[8];ig[9]=ie[9];ig[10]=ie[10];ig[11]=ie[11];ig[12]=ie[12];ig[13]=ie[13];ig[14]=ie[14];ig[15]=ie[15];return ig};e.copy=function(ig,ie){ig[0]=ie[0];ig[1]=ie[1];ig[2]=ie[2];ig[3]=ie[3];ig[4]=ie[4];ig[5]=ie[5];ig[6]=ie[6];ig[7]=ie[7];ig[8]=ie[8];ig[9]=ie[9];ig[10]=ie[10];ig[11]=ie[11];ig[12]=ie[12];ig[13]=ie[13];ig[14]=ie[14];ig[15]=ie[15];return ig};e.identity=function(ie){ie[0]=1;ie[1]=0;ie[2]=0;ie[3]=0;ie[4]=0;ie[5]=1;ie[6]=0;ie[7]=0;ie[8]=0;ie[9]=0;ie[10]=1;ie[11]=0;ie[12]=0;ie[13]=0;ie[14]=0;ie[15]=1;return ie};e.transpose=function(ii,ih){if(ii===ih){var im=ih[1],ik=ih[2],ij=ih[3],ie=ih[6],il=ih[7],ig=ih[11];ii[1]=ih[4];ii[2]=ih[8];ii[3]=ih[12];ii[4]=im;ii[6]=ih[9];ii[7]=ih[13];ii[8]=ik;ii[9]=ie;ii[11]=ih[14];ii[12]=ij;ii[13]=il;ii[14]=ig}else{ii[0]=ih[0];ii[1]=ih[4];ii[2]=ih[8];ii[3]=ih[12];ii[4]=ih[1];ii[5]=ih[5];ii[6]=ih[9];ii[7]=ih[13];ii[8]=ih[2];ii[9]=ih[6];ii[10]=ih[10];ii[11]=ih[14];ii[12]=ih[3];ii[13]=ih[7];ii[14]=ih[11];ii[15]=ih[15]}return ii};e.invert=function(iA,iF){var iJ=iF[0],iH=iF[1],iG=iF[2],iD=iF[3],ij=iF[4],ii=iF[5],ih=iF[6],ig=iF[7],iz=iF[8],iy=iF[9],ix=iF[10],iw=iF[11],iL=iF[12],iK=iF[13],iI=iF[14],iE=iF[15],iv=iJ*ii-iH*ij,iu=iJ*ih-iG*ij,it=iJ*ig-iD*ij,ir=iH*ih-iG*ii,iq=iH*ig-iD*ii,ip=iG*ig-iD*ih,io=iz*iK-iy*iL,im=iz*iI-ix*iL,il=iz*iE-iw*iL,ik=iy*iI-ix*iK,iC=iy*iE-iw*iK,iB=ix*iE-iw*iI,ie=iv*iB-iu*iC+it*ik+ir*il-iq*im+ip*io;if(!ie){return null}ie=1/ie;iA[0]=(ii*iB-ih*iC+ig*ik)*ie;iA[1]=(iG*iC-iH*iB-iD*ik)*ie;iA[2]=(iK*ip-iI*iq+iE*ir)*ie;iA[3]=(ix*iq-iy*ip-iw*ir)*ie;iA[4]=(ih*il-ij*iB-ig*im)*ie;iA[5]=(iJ*iB-iG*il+iD*im)*ie;iA[6]=(iI*it-iL*ip-iE*iu)*ie;iA[7]=(iz*ip-ix*it+iw*iu)*ie;iA[8]=(ij*iC-ii*il+ig*io)*ie;iA[9]=(iH*il-iJ*iC-iD*io)*ie;iA[10]=(iL*iq-iK*it+iE*iv)*ie;iA[11]=(iy*it-iz*iq-iw*iv)*ie;iA[12]=(ii*im-ij*ik-ih*io)*ie;iA[13]=(iJ*ik-iH*im+iG*io)*ie;iA[14]=(iK*iu-iL*ir-iI*iv)*ie;iA[15]=(iz*ir-iy*iu+ix*iv)*ie;return iA};e.adjoint=function(io,ir){var iw=ir[0],iu=ir[1],it=ir[2],ip=ir[3],ii=ir[4],ih=ir[5],ig=ir[6],ie=ir[7],im=ir[8],il=ir[9],ik=ir[10],ij=ir[11],iy=ir[12],ix=ir[13],iv=ir[14],iq=ir[15];io[0]=(ih*(ik*iq-ij*iv)-il*(ig*iq-ie*iv)+ix*(ig*ij-ie*ik));io[1]=-(iu*(ik*iq-ij*iv)-il*(it*iq-ip*iv)+ix*(it*ij-ip*ik));io[2]=(iu*(ig*iq-ie*iv)-ih*(it*iq-ip*iv)+ix*(it*ie-ip*ig));io[3]=-(iu*(ig*ij-ie*ik)-ih*(it*ij-ip*ik)+il*(it*ie-ip*ig));io[4]=-(ii*(ik*iq-ij*iv)-im*(ig*iq-ie*iv)+iy*(ig*ij-ie*ik));io[5]=(iw*(ik*iq-ij*iv)-im*(it*iq-ip*iv)+iy*(it*ij-ip*ik));io[6]=-(iw*(ig*iq-ie*iv)-ii*(it*iq-ip*iv)+iy*(it*ie-ip*ig));io[7]=(iw*(ig*ij-ie*ik)-ii*(it*ij-ip*ik)+im*(it*ie-ip*ig));io[8]=(ii*(il*iq-ij*ix)-im*(ih*iq-ie*ix)+iy*(ih*ij-ie*il));io[9]=-(iw*(il*iq-ij*ix)-im*(iu*iq-ip*ix)+iy*(iu*ij-ip*il));io[10]=(iw*(ih*iq-ie*ix)-ii*(iu*iq-ip*ix)+iy*(iu*ie-ip*ih));io[11]=-(iw*(ih*ij-ie*il)-ii*(iu*ij-ip*il)+im*(iu*ie-ip*ih));io[12]=-(ii*(il*iv-ik*ix)-im*(ih*iv-ig*ix)+iy*(ih*ik-ig*il));io[13]=(iw*(il*iv-ik*ix)-im*(iu*iv-it*ix)+iy*(iu*ik-it*il));io[14]=-(iw*(ih*iv-ig*ix)-ii*(iu*iv-it*ix)+iy*(iu*ig-it*ih));io[15]=(iw*(ih*ik-ig*il)-ii*(iu*ik-it*il)+im*(iu*ig-it*ih));return io};e.determinant=function(iC){var iH=iC[0],iF=iC[1],iD=iC[2],iB=iC[3],ii=iC[4],ih=iC[5],ig=iC[6],ie=iC[7],iy=iC[8],ix=iC[9],iw=iC[10],iv=iC[11],iJ=iC[12],iI=iC[13],iG=iC[14],iE=iC[15],iu=iH*ih-iF*ii,it=iH*ig-iD*ii,ir=iH*ie-iB*ii,iq=iF*ig-iD*ih,ip=iF*ie-iB*ih,io=iD*ie-iB*ig,im=iy*iI-ix*iJ,il=iy*iG-iw*iJ,ik=iy*iE-iv*iJ,ij=ix*iG-iw*iI,iA=ix*iE-iv*iI,iz=iw*iE-iv*iG;return iu*iz-it*iA+ir*ij+iq*ik-ip*il+io*im};e.multiply=function(it,ix,iu){var iB=ix[0],iA=ix[1],iy=ix[2],iv=ix[3],il=ix[4],ij=ix[5],ih=ix[6],ie=ix[7],ir=ix[8],iq=ix[9],ip=ix[10],io=ix[11],iD=ix[12],iC=ix[13],iz=ix[14],iw=ix[15];var im=iu[0],ik=iu[1],ii=iu[2],ig=iu[3];it[0]=im*iB+ik*il+ii*ir+ig*iD;it[1]=im*iA+ik*ij+ii*iq+ig*iC;it[2]=im*iy+ik*ih+ii*ip+ig*iz;it[3]=im*iv+ik*ie+ii*io+ig*iw;im=iu[4];ik=iu[5];ii=iu[6];ig=iu[7];it[4]=im*iB+ik*il+ii*ir+ig*iD;it[5]=im*iA+ik*ij+ii*iq+ig*iC;it[6]=im*iy+ik*ih+ii*ip+ig*iz;it[7]=im*iv+ik*ie+ii*io+ig*iw;im=iu[8];ik=iu[9];ii=iu[10];ig=iu[11];it[8]=im*iB+ik*il+ii*ir+ig*iD;it[9]=im*iA+ik*ij+ii*iq+ig*iC;it[10]=im*iy+ik*ih+ii*ip+ig*iz;it[11]=im*iv+ik*ie+ii*io+ig*iw;im=iu[12];ik=iu[13];ii=iu[14];ig=iu[15];it[12]=im*iB+ik*il+ii*ir+ig*iD;it[13]=im*iA+ik*ij+ii*iq+ig*iC;it[14]=im*iy+ik*ih+ii*ip+ig*iz;it[15]=im*iv+ik*ie+ii*io+ig*iw;return it};e.mul=e.multiply;e.translate=function(it,iv,im){var il=im[0],ik=im[1],ij=im[2],iy,ix,iw,iu,ii,ih,ig,ie,ir,iq,ip,io;if(iv===it){it[12]=iv[0]*il+iv[4]*ik+iv[8]*ij+iv[12];it[13]=iv[1]*il+iv[5]*ik+iv[9]*ij+iv[13];it[14]=iv[2]*il+iv[6]*ik+iv[10]*ij+iv[14];it[15]=iv[3]*il+iv[7]*ik+iv[11]*ij+iv[15]}else{iy=iv[0];ix=iv[1];iw=iv[2];iu=iv[3];ii=iv[4];ih=iv[5];ig=iv[6];ie=iv[7];ir=iv[8];iq=iv[9];ip=iv[10];io=iv[11];it[0]=iy;it[1]=ix;it[2]=iw;it[3]=iu;it[4]=ii;it[5]=ih;it[6]=ig;it[7]=ie;it[8]=ir;it[9]=iq;it[10]=ip;it[11]=io;it[12]=iy*il+ii*ik+ir*ij+iv[12];it[13]=ix*il+ih*ik+iq*ij+iv[13];it[14]=iw*il+ig*ik+ip*ij+iv[14];it[15]=iu*il+ie*ik+io*ij+iv[15]}return it};e.scale=function(ii,ig,ih){var ie=ih[0],ik=ih[1],ij=ih[2];ii[0]=ig[0]*ie;ii[1]=ig[1]*ie;ii[2]=ig[2]*ie;ii[3]=ig[3]*ie;ii[4]=ig[4]*ik;ii[5]=ig[5]*ik;ii[6]=ig[6]*ik;ii[7]=ig[7]*ik;ii[8]=ig[8]*ij;ii[9]=ig[9]*ij;ii[10]=ig[10]*ij;ii[11]=ig[11]*ij;ii[12]=ig[12];ii[13]=ig[13];ii[14]=ig[14];ii[15]=ig[15];return ii};e.rotate=function(iB,iI,iK,ie){var iq=ie[0],ip=ie[1],io=ie[2],iC=Math.sqrt(iq*iq+ip*ip+io*io),iw,iG,iv,iM,iL,iJ,iH,im,il,ik,ij,iA,iz,iy,ix,iu,it,ir,iF,iE,iD,ii,ih,ig;if(Math.abs(iC)<id){return null}iC=1/iC;iq*=iC;ip*=iC;io*=iC;iw=Math.sin(iK);iG=Math.cos(iK);iv=1-iG;iM=iI[0];iL=iI[1];iJ=iI[2];iH=iI[3];im=iI[4];il=iI[5];ik=iI[6];ij=iI[7];iA=iI[8];iz=iI[9];iy=iI[10];ix=iI[11];iu=iq*iq*iv+iG;it=ip*iq*iv+io*iw;ir=io*iq*iv-ip*iw;iF=iq*ip*iv-io*iw;iE=ip*ip*iv+iG;iD=io*ip*iv+iq*iw;ii=iq*io*iv+ip*iw;ih=ip*io*iv-iq*iw;ig=io*io*iv+iG;iB[0]=iM*iu+im*it+iA*ir;iB[1]=iL*iu+il*it+iz*ir;iB[2]=iJ*iu+ik*it+iy*ir;iB[3]=iH*iu+ij*it+ix*ir;iB[4]=iM*iF+im*iE+iA*iD;iB[5]=iL*iF+il*iE+iz*iD;iB[6]=iJ*iF+ik*iE+iy*iD;iB[7]=iH*iF+ij*iE+ix*iD;iB[8]=iM*ii+im*ih+iA*ig;iB[9]=iL*ii+il*ih+iz*ig;iB[10]=iJ*ii+ik*ih+iy*ig;iB[11]=iH*ii+ij*ih+ix*ig;if(iI!==iB){iB[12]=iI[12];iB[13]=iI[13];iB[14]=iI[14];iB[15]=iI[15]}return iB};e.rotateX=function(ie,im,il){var it=Math.sin(il),ik=Math.cos(il),ir=im[4],iq=im[5],ip=im[6],io=im[7],ij=im[8],ii=im[9],ih=im[10],ig=im[11];if(im!==ie){ie[0]=im[0];ie[1]=im[1];ie[2]=im[2];ie[3]=im[3];ie[12]=im[12];ie[13]=im[13];ie[14]=im[14];ie[15]=im[15]}ie[4]=ir*ik+ij*it;ie[5]=iq*ik+ii*it;ie[6]=ip*ik+ih*it;ie[7]=io*ik+ig*it;ie[8]=ij*ik-ir*it;ie[9]=ii*ik-iq*it;ie[10]=ih*ik-ip*it;ie[11]=ig*ik-io*it;return ie};e.rotateY=function(ij,ir,iq){var it=Math.sin(iq),ip=Math.cos(iq),ii=ir[0],ih=ir[1],ig=ir[2],ie=ir[3],io=ir[8],im=ir[9],il=ir[10],ik=ir[11];if(ir!==ij){ij[4]=ir[4];ij[5]=ir[5];ij[6]=ir[6];ij[7]=ir[7];ij[12]=ir[12];ij[13]=ir[13];ij[14]=ir[14];ij[15]=ir[15]}ij[0]=ii*ip-io*it;ij[1]=ih*ip-im*it;ij[2]=ig*ip-il*it;ij[3]=ie*ip-ik*it;ij[8]=ii*it+io*ip;ij[9]=ih*it+im*ip;ij[10]=ig*it+il*ip;ij[11]=ie*it+ik*ip;return ij};e.rotateZ=function(ij,im,il){var it=Math.sin(il),ik=Math.cos(il),ii=im[0],ih=im[1],ig=im[2],ie=im[3],ir=im[4],iq=im[5],ip=im[6],io=im[7];if(im!==ij){ij[8]=im[8];ij[9]=im[9];ij[10]=im[10];ij[11]=im[11];ij[12]=im[12];ij[13]=im[13];ij[14]=im[14];ij[15]=im[15]}ij[0]=ii*ik+ir*it;ij[1]=ih*ik+iq*it;ij[2]=ig*ik+ip*it;ij[3]=ie*ik+io*it;ij[4]=ir*ik-ii*it;ij[5]=iq*ik-ih*it;ij[6]=ip*ik-ig*it;ij[7]=io*ik-ie*it;return ij};e.fromRotationTranslation=function(iu,ir,ip){var il=ir[0],ik=ir[1],ij=ir[2],im=ir[3],iv=il+il,ie=ik+ik,io=ij+ij,ii=il*iv,ih=il*ie,ig=il*io,it=ik*ie,iq=ik*io,iy=ij*io,iz=im*iv,ix=im*ie,iw=im*io;iu[0]=1-(it+iy);iu[1]=ih+iw;iu[2]=ig-ix;iu[3]=0;iu[4]=ih-iw;iu[5]=1-(ii+iy);iu[6]=iq+iz;iu[7]=0;iu[8]=ig+ix;iu[9]=iq-iz;iu[10]=1-(ii+it);iu[11]=0;iu[12]=ip[0];iu[13]=ip[1];iu[14]=ip[2];iu[15]=1;return iu};e.fromQuat=function(iq,im){var ij=im[0],ii=im[1],ih=im[2],ik=im[3],ir=ij+ij,ie=ii+ii,il=ih+ih,ig=ij*ir,ip=ii*ir,io=ii*ie,iy=ih*ir,ix=ih*ie,iv=ih*il,iw=ik*ir,iu=ik*ie,it=ik*il;iq[0]=1-io-iv;iq[1]=ip+it;iq[2]=iy-iu;iq[3]=0;iq[4]=ip-it;iq[5]=1-ig-iv;iq[6]=ix+iw;iq[7]=0;iq[8]=iy+iu;iq[9]=ix-iw;iq[10]=1-ig-io;iq[11]=0;iq[12]=0;iq[13]=0;iq[14]=0;iq[15]=1;return iq};e.frustum=function(ij,ig,ip,ie,io,il,ik){var im=1/(ip-ig),ii=1/(io-ie),ih=1/(il-ik);ij[0]=(il*2)*im;ij[1]=0;ij[2]=0;ij[3]=0;ij[4]=0;ij[5]=(il*2)*ii;ij[6]=0;ij[7]=0;ij[8]=(ip+ig)*im;ij[9]=(io+ie)*ii;ij[10]=(ik+il)*ih;ij[11]=-1;ij[12]=0;ij[13]=0;ij[14]=(ik*il*2)*ih;ij[15]=0;return ij};e.perspective=function(ii,ih,ig,ij,ie){var il=1/Math.tan(ih/2),ik=1/(ij-ie);ii[0]=il/ig;ii[1]=0;ii[2]=0;ii[3]=0;ii[4]=0;ii[5]=il;ii[6]=0;ii[7]=0;ii[8]=0;ii[9]=0;ii[10]=(ie+ij)*ik;ii[11]=-1;ii[12]=0;ii[13]=0;ii[14]=(2*ie*ij)*ik;ii[15]=0;return ii};e.ortho=function(ii,ig,ip,ie,im,il,ik){var ij=1/(ig-ip),io=1/(ie-im),ih=1/(il-ik);ii[0]=-2*ij;ii[1]=0;ii[2]=0;ii[3]=0;ii[4]=0;ii[5]=-2*io;ii[6]=0;ii[7]=0;ii[8]=0;ii[9]=0;ii[10]=2*ih;ii[11]=0;ii[12]=(ig+ip)*ij;ii[13]=(im+ie)*io;ii[14]=(ik+il)*ih;ii[15]=1;return ii};e.lookAt=function(iv,iC,iD,il){var iB,iA,iy,ih,ig,ie,ip,io,im,iw,iz=iC[0],ix=iC[1],iu=iC[2],ik=il[0],ij=il[1],ii=il[2],it=iD[0],ir=iD[1],iq=iD[2];if(Math.abs(iz-it)<id&&Math.abs(ix-ir)<id&&Math.abs(iu-iq)<id){return e.identity(iv)}ip=iz-it;io=ix-ir;im=iu-iq;iw=1/Math.sqrt(ip*ip+io*io+im*im);ip*=iw;io*=iw;im*=iw;iB=ij*im-ii*io;iA=ii*ip-ik*im;iy=ik*io-ij*ip;iw=Math.sqrt(iB*iB+iA*iA+iy*iy);if(!iw){iB=0;iA=0;iy=0}else{iw=1/iw;iB*=iw;iA*=iw;iy*=iw}ih=io*iy-im*iA;ig=im*iB-ip*iy;ie=ip*iA-io*iB;iw=Math.sqrt(ih*ih+ig*ig+ie*ie);if(!iw){ih=0;ig=0;ie=0}else{iw=1/iw;ih*=iw;ig*=iw;ie*=iw}iv[0]=iB;iv[1]=ih;iv[2]=ip;iv[3]=0;iv[4]=iA;iv[5]=ig;iv[6]=io;iv[7]=0;iv[8]=iy;iv[9]=ie;iv[10]=im;iv[11]=0;iv[12]=-(iB*iz+iA*ix+iy*iu);iv[13]=-(ih*iz+ig*ix+ie*iu);iv[14]=-(ip*iz+io*ix+im*iu);iv[15]=1;return iv};e.str=function(ie){return"mat4("+ie[0]+", "+ie[1]+", "+ie[2]+", "+ie[3]+", "+ie[4]+", "+ie[5]+", "+ie[6]+", "+ie[7]+", "+ie[8]+", "+ie[9]+", "+ie[10]+", "+ie[11]+", "+ie[12]+", "+ie[13]+", "+ie[14]+", "+ie[15]+")"};e.frob=function(ie){return(Math.sqrt(Math.pow(ie[0],2)+Math.pow(ie[1],2)+Math.pow(ie[2],2)+Math.pow(ie[3],2)+Math.pow(ie[4],2)+Math.pow(ie[5],2)+Math.pow(ie[6],2)+Math.pow(ie[6],2)+Math.pow(ie[7],2)+Math.pow(ie[8],2)+Math.pow(ie[9],2)+Math.pow(ie[10],2)+Math.pow(ie[11],2)+Math.pow(ie[12],2)+Math.pow(ie[13],2)+Math.pow(ie[14],2)+Math.pow(ie[15],2)))};h9.mat4=e})(window);function dh(){this.result={bkData:[],eleData:[[],[],[],[],[],[],[],[],[]],tileLabels:[]}}D.extend(dh.prototype,{createLayer:function(T,i){var e=this.result.bkData;i=i||{};if(!e[T]){e[T]=[[],[],[]]}e[T].tileTypeName=i.tileTypeName||"na";e[T].dataType=i.dataType||2;e[T].png8=i.png8||false;e[T].clipTile=i.clipTile||false;e[T].boundary=i.boundary||false},removeLayer:function(i){var e=this.result.bkData;e[i]=null},hasLayerBoundary:function(){var e=this.result.bkData;var T=false;for(var h6=0;h6<e.length;h6++){if(e[h6]&&e[h6].boundary){T=true;break}}return T},getResult:function(){return this.result},setData:function(h8,h7,h9){var e=this.result.bkData;var T=e[h7]?e[h7][h9]:null;if(!T){return}for(var h6=0;h6<T.length;h6++){if(T[h6].key&&T[h6].key===h8.key){T[h6]=h8;return}}T.push(h8)},setLabelData:function(e){this.result.tileLabels=e},getLabelData:function(){return this.result.tileLabels},setOverlayData:function(i,e){if(!this.result.eleData[e]){return}this.result.eleData[e]=i},clearLabelOverlayData:function(){this.result.eleData[2]=[];this.result.eleData[3]=[];this.result.eleData[4]=[]},clearData:function(h6){var e=this.result.bkData;if(typeof h6==="number"){if(e[h6]){e[h6][0]=[];e[h6][1]=[];e[h6][2]=[]}return}for(var T=0;T<e.length;T++){if(!e[T]){continue}e[T][0]=[];e[T][1]=[];e[T][2]=[]}},sortThumbData:function(i){var e=this.result.bkData;var T=e[i];if(!T){return}if(T[0]&&T[0].length>0){T[0].sort(function(h7,h6){return h7.tileInfo.useZoom-h6.tileInfo.useZoom})}}});var ft=(function(){var ih=new Int8Array(4);var T=new Int32Array(ih.buffer,0,1);var ib=new Float32Array(ih.buffer,0,1);function ij(ir){T[0]=ir;return ib[0]}function i(ir){ib[0]=ir;return T[0]}function ic(ir){var iu=(ir[3]<<24|ir[2]<<16|ir[1]<<8|ir[0]);var it=ij(iu&4278190079);return it}var h7=0;var ia=1;var ie=2;var io=0;var ik=1;var ii=2;var h8=9;function ig(ir,it){var iu;if(it%2===0){iu=[-ir[1],ir[0]]}else{iu=[ir[1],-ir[0]]}return iu}function e(ir,it,iu){var iv=ig(ir,it);var iw;if(iu===ia){return iv}else{if(it===4||it===5){iw=[iv[0]-ir[0],iv[1]-ir[1]]}else{iw=[iv[0]+ir[0],iv[1]+ir[1]]}if(iu===h7){vec2.normalize(iw,iw)}return iw}}function im(it,ir){return Math.sqrt(Math.pow(it[0]-ir[0],2)+Math.pow(it[1]-ir[1],2))}function h6(iw,iv,iu,ir){var it=vec2.dot(iw,iv);if(iu===ii||iu===ik){if((ir===0||ir===1)&&it>0){return true}else{if((ir===2||ir===3)&&it<0){return true}}}if((ir===0||ir===1)&&it<0){return true}else{if((ir===2||ir===3)&&it>0){return true}}return false}function id(it,iy,iA){var iz=ig(it,iy);var iv;var ix=it;var iw=iA;var iC=[];vec2.normalize(iC,[ix[0]+iw[0],ix[1]+iw[1]]);var iB=vec2.dot(iz,[-iC[1],iC[0]]);if(Math.abs(iB)<0.1){iB=1}var iu=1/iB;iv=[-iC[1]*iu,iC[0]*iu];var ir=vec2.dot(it,iv);if(ir<0){vec2.negate(iv,iv)}return{cos2:ir,offset:iv}}function iq(it,iy,iA,ir){var iz=ig(it,iy);var ix;var iw;var iv;if(iy===0||iy===1){ix=iA;iw=it}else{ix=it;iw=iA}if(!ix||!iw){return iz}var iC=[ix[0]+iw[0],ix[1]+iw[1]];if(iC[0]===0&&iC[1]===0){vec2.normalize(iC,iw)}else{vec2.normalize(iC,iC)}var iD=h6(iC,iz,ir,iy);if(iD){return iz}var iB=vec2.dot(iz,[-iC[1],iC[0]]);if(Math.abs(iB)<0.1){iB=1}var iu=1/iB;iv=[-iC[1]*iu,iC[0]*iu];return iv}function ip(iD,iE,ix,iw,iF,iC,iv,iy,iu,iB){var iA;var it=0;var ir=false;iA=iC.length/h8-1;h9(iE[0],iD[0],ix[0],iF,iw,4,iy,iu,undefined,iC,iB);iA++;it++;h9(iE[0],iD[0],ix[0],iF,iw,5,iy,iu,undefined,iC,iB);iA++;it++;for(var iz=0;iz<iD.length;iz++){h9(iE[iz],iD[iz],ix[iz],iF,iw,0,iy,iu,iD[iz-1],iC,iB);il(iv,++iA,++it,ir);h9(iE[iz],iD[iz],ix[iz],iF,iw,1,iy,iu,iD[iz-1],iC,iB);il(iv,++iA,++it,ir);h9(iE[iz+1],iD[iz],ix[iz+1],iF,iw,2,iy,iu,iD[iz+1],iC,iB);il(iv,++iA,++it,ir);h9(iE[iz+1],iD[iz],ix[iz+1],iF,iw,3,iy,iu,iD[iz+1],iC,iB);il(iv,++iA,++it,ir);if(iw===ik&&iz!==iD.length-1){h9(iE[iz+1],iD[iz],ix[iz+1],iF,iw,8,iy,iu,iD[iz+1],iC,iB);il(iv,++iA,++it,ir);ir=ir?false:true}}h9(iE[iE.length-1],iD[iD.length-1],ix[iE.length-1],iF,iw,6,iy,iu,undefined,iC,iB);il(iv,++iA,++it,ir);h9(iE[iE.length-1],iD[iD.length-1],ix[iE.length-1],iF,iw,7,iy,iu,undefined,iC,iB);il(iv,++iA,++it,ir)}function h9(iF,iv,iz,iG,iu,iA,ix,it,iD,iC,iB){var iE=iA%2===0?1:-1;var iy;if(iA===4||iA===5||iA===6||iA===7){iy=e(iv,iA,iG)}else{if(iA===0||iA===1||iA===2||iA===3){iy=iq(iv,iA,iD,iu)}else{if(iA===8){var iw=id(iv,iA,iD);iy=iw.offset;vec2.normalize(iy,iy);var ir=iw.cos2;if(ir<0){iE=-iE}}}}iC[iC.length]=iF[0]*10;iC[iC.length]=iF[1]*10;iC[iC.length]=iy[0]*it*10;iC[iC.length]=iy[1]*it*10;iC[iC.length]=ix;iC[iC.length]=iE;iC[iC.length]=0;iC[iC.length]=iB||0;iC[iC.length]=iz}function il(iw,iu,ir,iv){var it;if(ir%2===0){if(iv){iw[iw.length]=iu-2;iw[iw.length]=iu-1;iw[iw.length]=iu}else{iw[iw.length]=iu-1;iw[iw.length]=iu-2;iw[iw.length]=iu}}else{if(iv){iw[iw.length]=iu-1;iw[iw.length]=iu-2;iw[iw.length]=iu}else{iw[iw.length]=iu-2;iw[iw.length]=iu-1;iw[iw.length]=iu}}}return{getVertexCount:function(it,ir){if(ir===ik){return it*5-2}else{return it*4}},buildData:function(iD,iu,iE,iA,ir,ix,it,iB){var iC=[];var iz=0;var iw=[0];for(var iy=0;iy<iD.length;iy++){if(iy>0){iz+=im(iD[iy],iD[iy-1]);iw.push(iz*10)}if(iy!==iD.length-1){var iv=[iD[iy+1][0]-iD[iy][0],iD[iy+1][1]-iD[iy][1]];var iF=[];if(iv[0]===0&&iv[1]===0){iF=[0,0]}else{vec2.normalize(iF,iv)}iC[iC.length]=[iF[0],iF[1]]}}return ip(iC,iD,iw,iu,iE,iA,ir,ic(ix),it,iB)},toTileSolidLineVertices:function(iw,it){var iu=new Float32Array(iw.length/h8*5);var ir=new Int16Array(iu.buffer);var iy=0;var iv=0;for(var ix=0;ix<iw.length;ix+=h8){ir[iy]=~~iw[ix];ir[iy+1]=~~iw[ix+1];ir[iy+2]=~~iw[ix+2];ir[iy+3]=~~iw[ix+3];iu[iv+2]=iw[ix+4];ir[iy+6]=iw[ix+5];ir[iy+7]=it?it:0;ir[iy+8]=iw[ix+7];ir[iy+9]=0;iy+=10;iv+=5}return iu}}})();var eS=1;var gG=2;var f5={drawIndex:0,devicePixelRatio:a9(),zoomState:1,curViewTilesInfo:null,iconSetImg:null,LAST_CALC_ZOOM:-1,LAST_LOAD_VECTOR_ZOOM_CHANGE:false,lastCollisionTestTime:0,remove:function(){this.tileCache.clear()},initDrawData:function(){this.drawIndex=this.zIndex;this.map._featureMgr.createLayer(this.drawIndex,{tileTypeName:this.tileType.getName(),dataType:this.dataType,png8:this.png8,clipTile:this.clipTile,boundary:this.boundary});this.dispatchEvent(new be("oninitDrawData"))},destroyDrawData:function(){this.map._featureMgr.removeLayer(this.drawIndex);var i=new be("onremoveLayerMask");i.hasLayerBoundary=this.map._featureMgr.hasLayerBoundary();this.map.dispatchEvent(i)},setZIndex:function(ia){ia=Math.abs(Math.floor(ia))||1;if(!ia||ia===this.zIndex){return}var i=this.map._featureMgr.result.bkData;var h6=this.map.tileMgr.tileLayers;function T(id){var ic=null;for(var ib=0;ib<h6.length;ib++){if(h6[ib].zIndex===id){ic=h6[ib];break}}return ic}var e=[];var h9=[];var h8=this.zIndex;if(i[ia]){e.push(T(ia));h9.push(i[ia]);this.setTargetZIndex(ia);i[ia]=i[h8];i[h8]=null}else{this.setTargetZIndex(ia);i[ia]=i[h8];i[h8]=null;this.map.dispatchEvent(new be("onrefresh"));return}var h7=ia+1;while(h7){if(i[h7]){e.push(T(h7));h9.push(i[h7]);e.shift().setTargetZIndex(h7);i[h7]=h9.shift();h7+=1}else{e.shift().setTargetZIndex(h7);i[h7]=h9.shift();h7=0}}this.map.dispatchEvent(new be("onrefresh"))},setZIndexTop:function(){var e=this.map._featureMgr.result.bkData;e[e.length]=e[this.zIndex];e[this.zIndex]=null;this.setTargetZIndex(e.length-1);this.map.dispatchEvent(new be("onrefresh"))},getTileKey:function(e,h6){h6=h6||{};var i=typeof h6.useZoom==="number"?h6.useZoom:e.useZoom;var T=e.style||this.mapStyleId||"default";return this.mapType+"_"+T+"_"+e.col+"_"+e.row+"_"+e.zoom+"_"+i},getTileRenderDataKey:function(i){var T=i.col;var h6=i.zoom;var e=i.baseTileSize;T=ed.calcLoopParam(T,h6,e).col;return this.mapType+"_"+T+"_"+i.row+"_"+h6+"_"+i.useZoom},getTileUnits:function(e){var h6=this.map;var T=b9[h6.getMapType()];var i=T.baseUnits*Math.pow(2,T.zoomLevelBase-e);return i},getTilesUrl:function(h7,ih,ii){var i=h7.x;var ij=h7.y;var id=aG("ditu","normal");var h9=id.ver;var ia=id.udt;i=ed.calcLoopParam(i,ih,ii).col;var ig=b9.B_NORMAL_MAP.vectorTileUrls;var h8=Math.abs(i+ij)%ig.length;var ie=ig[h8];if(window.offLineIPAddress){ig=[window.offLineIPAddress+"pvd/"];ie=ig[0]}var T="x="+i+"&y="+ij+"&z="+Math.floor(ih);var ic=this.devicePixelRatio>1?"&scaler=2":"";var ib="&textimg=1";if(this.map.config.textRenderType==="canvas"){ib="&textimg=0"}var h6=this.map.config.style;if(typeof h6==="string"&&h6!=="default"){T+="&styleId="+fe.mapStyleNameIdPair[h6]}T+="&styles=pl"+ib+ic+"&v="+h9+"&udt="+ia+"&json=0";var e=ie+"?qt=vtile&param="+window.encodeURIComponent(gy(T));return e},getRasterTilesUrl:function(T,h8,h6){var h7=b9[this.map.mapType];var i=this.map.config.style;var e=h7.tileUrls[Math.abs(h8+T)%h7.tileUrls.length]+"?qt=tile&x="+T+"&y="+h8+"&z="+h6+((i==="default"||typeof i!=="string")?"":("&styleId="+fe.mapStyleNameIdPair[i]))+"&styles=pl&udt="+this.normalUdt+"&scaler="+this.scaler+"&p=1";e=e.replace(/-(\d+)/gi,"M$1");return e},getZoomState:function(){var T=this.map;var i=T.getZoom();var e=i-this.lastZoom;if(e>0){this.zoomState=1}else{if(e<0){this.zoomState=-1}}this.lastZoom=i;return this.zoomState},releaseOutViewTileData:function(e){var h7=this.map._workerMgr.releasePendingData(e);for(var h6=0,T=h7.length;h6<T;h6++){var h8=this.getTileKey(h7[h6]);this.tileCache.removeData(h8)}},loadLayerData:function(e,h6,i){this.hasZoomChange=i;this.curViewTilesInfo=e;this.mapStyleId=this.map.getMapStyleId();this.releaseOutViewTileData(e);var T=this.getZoomState();if(this.dataType===gG){if(h6){this.getVectorLayerDataFromCache(e,T)}else{this.loadVectorLayerData(e)}}else{this.loadRasterLayerData(e,h6)}},getVectorLayerDataFromCache:function(ib,im){this.map.temp.isPermitSpotOver=false;this.tileLabels=[];if(this.baseLayer===true){var ig=this.map._customLabelMgr.virtualTile;if(ig&&ig.label){this.tileLabels.push(ig.label)}}this.thumbCache={};var io=-1;for(var ij=0,ih=ib.length;ij<ih;ij++){var ik=ib[ij];var h7=ik.col;var h8=ik.row;var T=ik.zoom;var ii=this._getTileTexImgKey(ik);var h6=ik.useZoom;io=T;var h9=this.getTileKey(ik);var iq=this.tileCache.getData(h9);if(iq&&iq.status==="ready"){var ir=iq;this.map._featureMgr.setData(iq,this.drawIndex,2);if(iq.label){if(iq.label.status==="ready"){iq.label.tileInfo=iq.tileInfo;this.tileLabels.push(iq.label);if(iq.label.textureSources&&iq.label.textureSources[h6]&&this.map._webglMapScene){var ip=this.map._webglMapScene._painter;if(!ip._labelTextureAtlasOffset[ii]){ip._addToAsyncJob(iq.label.textureSources[h6])}}}else{if(iq.label.status!=="processing"){this.processLabelData(iq)}}}}else{var il={tileInfo:ik,dataType:gG,key:h9};this.map._featureMgr.setData(il,this.drawIndex,2);if(this.useThumbData){this.setThumbData(h7,h8,T,h6,im)}}}this.tileLabels.labelZoom=io;this.updateLabels(im);var ic=this.map.getZoom();var ia=Math.floor(ic);var ie=ic-ia;var id=Math.floor(this.LAST_CALC_ZOOM);var e=this.LAST_CALC_ZOOM-id;var it=false;if(this.hasZoomChange){if(Math.abs(ic-this.LAST_CALC_ZOOM)>=0.5){it=true}else{if(ie<0.5&&e>=0.5){it=true}else{if(ie>=0.5&&e<0.5){it=true}}}if(it){this.cacheDataCollideLabels(0)}this.LAST_CALC_ZOOM=ic}else{if(this.tileLabels.length>0){this.cacheDataCollideLabels(D.Browser.ie?50:30)}}},loadVectorLayerData:function(ic){this.map.temp.isPermitSpotOver=false;var ib=this;function ia(i,id){var ig=ib.tileCache.getData(id);if(!ig){return}if(!i||i.error){i.event&&br.fetchDebug&&br.fetchDebug.sendError({title:i.event.title,msg:i.event.msg,category:br.fetchDebug.category.AJAX,level:br.fetchDebug.levels.ERROR,url:i.event.title});var ie=new be("ontileloaderror");i=i||{};ie.error=i.error||"";ie.message=i.message||"";ib.map.fire(ie);ig.status="init";ig.reloadTimer=setTimeout(function(){if(ig.retry<3){ig.retry++;ig.status="loading";ib.loadVectorTileData(i.tileInfo,ia)}else{ib.tileCache.removeData(id)}},4000);ib.map._featureMgr.clearData(ib.drawIndex);ib._checkTilesLoaded();ib.getVectorLayerDataFromCache(ib.curViewTilesInfo,ib.getZoomState());return}if(ig.reloadTimer){clearTimeout(ig.reloadTimer);ig.reloadTimer=null}ib.callbackDataQueue.push([i,id]);if(ib.processDataTimer){return}ib.processDataTimer=setTimeout(function(){while(ib.callbackDataQueue.length>0){var ii=ib.callbackDataQueue.shift();ib.vectorTileDataCbk(ii[0],ii[1]);ib._checkTilesLoaded()}ib.map._featureMgr.clearData(ib.drawIndex);ib.getVectorLayerDataFromCache(ib.curViewTilesInfo,ib.getZoomState());var ih=new be("onrefresh");ih.source="webgllayer";ib.map.dispatchEvent(ih);ib.processDataTimer=null},200)}for(var h9=0,h7=ic.length;h9<h7;h9++){var T=ic[h9];var h8=this.getTileKey(T);var e=this.tileCache.getData(h8);if(!e){e={status:"init",tileInfo:T,dataType:gG,key:h8,retry:0}}if(e.status!=="ready"&&e.status!=="loading"){this.numLoading++;e.status="loading";this.tileCache.setData(h8,e);var h6=this.getProcessedLabelZoom(T);if(h6){T.processedLabelZooms=h6}this.loadVectorTileData(T,ia)}}},setThumbData:function(i,h7,h6,e,T){if(T===1){if(this._findParentZoomTile(i,h7,h6,e,8)===false){this._findChildZoomTile(i,h7,h6,e,3)}}else{if(T===-1){if(this._findChildZoomTile(i,h7,h6,e,3)===false){this._findParentZoomTile(i,h7,h6,e,8)}}}this.map._featureMgr.sortThumbData(this.drawIndex)},_findParentZoomTile:function(h9,ij,ii,h7,ic){var h8=b9[this.getMapType()];var T=h8.minDataZoom;var e=h9;var ig=ij;var id=ii;var ie=h7;for(var ib=1;ib<=ic;ib++){var h6=this.tileType.getParentTile(e,ig,id,ie,T);if(h6===null){continue}var ih=this.getTileKey(h6);var ia=this.tileCache.getData(ih);if(ia&&ia.status==="ready"){if(this.thumbCache[ih]){continue}this.map._featureMgr.setData(ia,this.drawIndex,0);this.thumbCache[ih]=true;return true}e=h6.col;ig=h6.row;id=h6.zoom;ie=h6.useZoom}return false},_findChildZoomTile:function(ia,ic,e,h7,im){var ik=b9[this.getMapType()];var ig=ik.maxDataZoom;var h9=ia;var ib=ic;var id=e;var h6=h7;var h8=true;for(var ij=1;ij<=im;ij++){var ih=false;var T=this.tileType.getChildTiles(h9,ib,id,h6,ig,ij);if(!T){continue}for(var ii=0;ii<T.length;ii++){var ie=this.getTileKey(T[ii]);var il=this.tileCache.getData(ie);if(il&&il.status==="ready"){if(!this.thumbCache[ie]){this.map._featureMgr.setData(il,this.drawIndex,1);this.thumbCache[ie]=true}ih=true}else{h8=false}}if(ih){break}}return h8},loadVectorTileData:function(ij,ik){var h7=ij.col;var h8=ij.row;var e=ij.zoom;var ih=ij.baseTileSize;var h6=this.getTilesUrl(new es(h7,h8),e,ih);var h9=this.map.getPrivateRegions();if(!this.processData&&this.map.getPrivateStatus()&&h9){var ie=ij.useZoom;var id=this.tileType.getMercatorSize(ie);var ic=h7*id;var ib=h8*id;var ig=new hH(ic+id/2,ib+id/2);var ia=new dZ(new hH(ic,ib),new hH(ic+id,ib+id));for(var ii=0;ii<h9.length;ii++){if(h9[ii] instanceof dH){if(h9[ii].crossPoint(ig,ia,ie)){var il={x:h7,y:h8,z:e,mapZoom:ie};var T=h9[ii].tileUrlFunction(h6,il);if(T&&T.url){h6=T.url;T.header&&(ij.header=T.header)}break}}}}if(!h6){return}var io=this.getTileKey(ij);bB(this.map);if(!this.processData){this.map._workerMgr.loadTileData(h6,ij,io,ik);return}var ik="cbk"+io.replace(/-/g,"_");var im=this;br[ik]=function(i){var ip=(function(iq){return function(){iq.tileInfo=ij;var ix=im.processData(iq);if(!ix.road){return}var iu={tileInfo:ij,renderData:{base:[]},status:"ready",key:io,mapType:im.mapType};var iA=[];var iD=[];for(var iw=0;iw<ix.road.length;iw++){var iz=ix.road[iw];var iy=-1;for(var iv=0;iv<iz.length;iv++){var iB=iz[iv];var iC=[];if(iA.length/7+iB[0].length/2>65536){iu.renderData.base.push({type:"line",data:[ft.toTileSolidLineVertices(iA,4000),new Uint16Array(iD)]});iA=[];iD=[]}for(var it=0;it<iB[0].length;it+=2){iC[iC.length]=[iB[0][it],iB[0][it+1]]}var ir=iB[3];ft.buildData(iC,iB[1],iB[2],iA,iD,ir,iB[4],iw+20,false)}iu.renderData.base.push({type:"line",data:[ft.toTileSolidLineVertices(iA,4000),new Uint16Array(iD)]})}im.tileCache.setData(io,iu);im.map._featureMgr.clearData(im.drawIndex);im.getVectorLayerDataFromCache(im.curViewTilesInfo,im.getZoomState());im.map.dispatchEvent(new be("onrefresh"))}})(i);im.map.jobScheduler.addJob(ip);delete br[ik]};h6+="&fn="+encodeURIComponent(eL+"."+ik);hB.load(h6)},vectorTileDataCbk:function(h6,h7){var ib=new be("ontileloaded");ib.perfStat=h6.perfStat||[];var e=this.map;e.fire(ib);var i=h6.tileInfo;var T=i.col;var ig=i.row;var ie=i.zoom;var id=i.baseTileSize;var h9=this.tileCache.getData(h7);if(!h9){return}if(!this.showLabel){h6.label=null}h9.renderData=h6;h9.tileInfo=i;var h8=ed.calcLoopParam(T,ie,id);var ic=h8.geoOffsetX;h9.tileInfo.loopOffsetX=ic;h9.status="ready";h9.mapType=this.mapType;this.tileCache.setData(h7,h9);h9.label=h6.label;h6.label=null;if(h6.indoorData&&e._indoorMgr){e._indoorMgr.setData(h6.indoorData)}var ia="id_"+T+"_"+ig+"_"+ie;if(!this.curViewTilesInfo[ia]){e.fire(new be("ontilenotinview"));return}this.processLabelData(h9);if(h6.indoorData&&e._indoorMgr&&e._indoorMgr.currentUid){this._refreshIndoorData(e._indoorMgr.currentUid,e._indoorMgr.currentFloor)}},_refreshIndoorData:function(ie,id){var ih=this.map._indoorMgr.getIndoorData(ie);var ik=ih.tileKeys;var ii=Math.floor(this.map.getZoom());for(var ib=0;ib<ik.length;ib++){var h8=ik[ib];var ia=this.tileCache.getData(h8);if(!ia){continue}var ij=ia.renderData;ij.indoorBase=[];ij.indoorBaseContour=[];ij.indoorBorder3D=[];ij.indoorArea3D=[];ia.label.indoorLabel=[];this.labelProcessor.clearCollisionCache(ia.label);for(var ic in ij.indoorData){if(ic==="tileInfo"){continue}var e=ij.indoorData[ic];var h7=e.defaultFloor;if(ic===ie){h7=id;e.currentFloor=id}if(e.floors[h7]){if(e.floors[h7].base){for(var h9=0;h9<e.floors[h7].base.length;h9++){ij.indoorBase.push(e.floors[h7].base[h9])}}if(e.floors[h7].contour){for(var h9=0;h9<e.floors[h7].contour.length;h9++){ij.indoorBaseContour.push(e.floors[h7].contour[h9])}}if(e.floors[h7].indoorBorder3D){ij.indoorBorder3D.push(e.floors[h7].indoorBorder3D)}if(e.floors[h7].area3D){ij.indoorArea3D.push(e.floors[h7].area3D)}if(e.floors[h7].pois){ia.label.indoorLabel=ia.label.indoorLabel.concat(e.floors[h7].pois)}}}this.updateAllIconsTextureCoords(ia);var ig=this;this.labelProcessor.loadIconImages(ia,function(i){ig.updateAllIconsTextureCoords(i)});var h6=h8.split("_");var T=parseInt(h6[h6.length-1],10);if(T!==ii){continue}ig.map._featureMgr.setData(ia,this.drawIndex,2)}this.dataBackCollideLabels();this.map.dispatchEvent(new be("onrefresh"))},_removeIndoorData:function(i){if(!i.indoorData){return}for(var e in i.indoorData){if(e==="tileInfo"){continue}this.map._indoorMgr.removeData(e,i.key)}},getProcessedLabelZoom:function(h6){var h7=dn.baseZoomInfo[h6.zoom];if(!h7){return false}var T=[];for(var h8=0;h8<h7.length;h8++){var h9=this.getTileKey(h6,{useZoom:h7[h8]});var e=this.tileCache.getData(h9);if(e&&e.status==="ready"&&e.label&&e.label.status==="ready"){T.push(h7[h8])}}if(T.length){return T}else{return false}},getSameZoomDataFromCache:function(T){var h6=dn.baseZoomInfo[T.zoom];for(var h7=0;h7<h6.length;h7++){var h8=this.getTileKey(T,{useZoom:h6[h7]});if(T.useZoom===h6[h7]){continue}var e=this.tileCache.getData(h8);if(e&&e.status==="ready"&&e.label&&e.label.status==="ready"){return e}}return false},hasSameLabelData:function(h6,T){for(var e=0;e<T.length;e++){if(T[e].key===h6){return true}}return false},getDataByFloorName:function(T,h6){for(var e=0;e<T.length;e++){if(T[e].floorName===h6){return T[e]}}return null},mergeIndoorLabelData:function(ib,e){for(var h9 in ib){if(h9==="tileInfo"){continue}if(e[h9]){var T=ib[h9].floors;var ic=e[h9].floors;for(var h7=0;h7<T.length;h7++){var h6=T[h7];var ia=h6.floorName;var h8=this.getDataByFloorName(ic,ia);if(h8){if(h8.pois){h8.pois=h8.pois.concat(h6.pois);h6.pois=h8.pois}else{h8.pois=h6.pois}}}}}},mergeSameZoomLabelData:function(h9){var h7=h9.label;if(!h7){return}var e=h9.tileInfo;var h8=this.getSameZoomDataFromCache(e);if(!h8){return}var h6=h8.label;if(!h6){return}for(var T=0;T<h7.fixedLabel.length;T++){if(!this.hasSameLabelData(h7.fixedLabel[T].key,h6.fixedLabel)){h6.hasNewData=true;h6.fixedLabel.push(h7.fixedLabel[T])}}for(var T=0;T<h7.lineLabel.length;T++){if(!this.hasSameLabelData(h7.lineLabel[T].key,h6.lineLabel)){h6.hasNewData=true;h6.lineLabel.push(h7.lineLabel[T])}}for(var T=0;T<h7.indoorLabel.length;T++){if(!this.hasSameLabelData(h7.indoorLabel[T].key,h6.indoorLabel)){h6.hasNewData=true;h6.indoorLabel.push(h7.indoorLabel[T])}}h9.label=h6;if(h8.renderData.indoorData&&h9.renderData.indoorData){this.mergeIndoorLabelData(h9.renderData.indoorData,h8.renderData.indoorData)}},processLabelData:function(h8){if(!h8.label){return}if(h8.label.status==="processing"){return}h8.label.status="processing";var h6=this;h6.updateAllIconsTextureCoords(h8);this.labelProcessor.loadIconImages(h8,function(h9){h6.updateAllIconsTextureCoords(h9)});if(this.map.config.textRenderType==="canvas"){var e=this.labelProcessor.drawLabelsOnCanvas(h8,function(ib,id){var ia=h8.tileInfo;var ic=h6.map.config.mapStyleId;if(!br["customStyleInfo_"+ic]){h6.mergeSameZoomLabelData(h8)}if(ib){if(!h8.label.textureHeights){h8.label.textureHeights=[]}h8.label.textureHeights[ia.useZoom]=ib.height}if(id){if(!h8.label.indoorTextureHeights){h8.label.indoorTextureHeights=[]}h8.label.indoorTextureHeights[ia.useZoom]=id.height}var h9=h6._getTileTexImgKey(ia);h6._doWorkAfterLabelImageLoad(h8,ib,id,h9)});return}var T=h8.label.textImageBitmap||h8.label.textImgStr;var h7=h8.label.indoorTextImageBitmap||h8.label.indoorTextImgStr;this.labelProcessor.loadImgByStr(T,h7,function i(ie,ic){var ib=h8.label.textureHeight;var ig=h8.label.indoorTextureHeight;h8.label.textureHeight=undefined;h8.label.indoorTextureHeight=undefined;var ia=h8.tileInfo;h6.mergeSameZoomLabelData(h8);var id=h8.label;id.textImgStr="";id.indoorTextImgStr&&(id.indoorTextImgStr="");if(!id.textureHeights){id.textureHeights=[]}id.textureHeights[ia.useZoom]=ib;if(!id.indoorTextureHeights){id.indoorTextureHeights=[]}id.indoorTextureHeights[ia.useZoom]=ig;var h9=h6._getTileTexImgKey(ia);h6._doWorkAfterLabelImageLoad(h8,ie,ic,h9)})},_getTileTexImgKey:function(i){var T=i.style||this.mapStyleId||"default";var e=T+"_"+i.col+"_"+i.row+"_"+i.zoom;if(this.map.config.textRenderType==="canvas"){e+="_"+i.useZoom}return e},_doWorkAfterLabelImageLoad:function(ia,h8,h6,i){var h9=this;var h7=ia.label;h7.tileInfo=ia.tileInfo;h7.status="ready";if(h8||h6){var e=h7.tileInfo;if(h8){h8.id=i;if(!h7.textureSources){h7.textureSources=[]}h7.textureSources[e.useZoom]=h8}if(h6){h6.id=i+"_indoor";if(!h7.indoorTextureSources){h7.indoorTextureSources=[]}h7.indoorTextureSources[e.useZoom]=h6}if(h9.map._webglMapScene){var T=h9.map._webglMapScene._painter;if(h8){T._addToAsyncJob(h7.textureSources[e.useZoom])}}}if(ia.custom!==true){h9.tileLabels.push(h7)}if(h9.collisionTimer){return}h9.collisionTimer=setTimeout(function(){h9.dataBackCollideLabels();h9.collisionTimer=null},300)},_updateIconTextureCoords:function(ia,T){if(!ia){return}var h9=this.map;for(var h6=0;h6<ia.length;h6++){var h8=ia[h6];if(!h8.iconPos){continue}if(h9._webglMapScene){var e=h9._webglMapScene._painter;var h7=T+"_"+h8.iconPos.iconType;h8.iconPos.texcoord=e._iconTextureAtlasCoords[h7]||null}}},updateAllIconsTextureCoords:function(h7){if(this.map.viewAnimationTime){return}if(h7){if(h7.label){var i=h7.tileInfo.style;this._updateIconTextureCoords(h7.label.fixedLabel,i);this._updateIconTextureCoords(h7.label.indoorLabel,i)}}else{var h6=this.tileCache.getAllData();for(var T in h6){var e=h6[T].data;if(e.status==="ready"&&e.label){var i=e.tileInfo.style;this._updateIconTextureCoords(e.label.fixedLabel,i);this._updateIconTextureCoords(e.label.indoorLabel,i)}}}this.updateLabels();this.map.dispatchEvent(new be("onrefresh"))},cacheDataCollideLabels:function(T){var h7=this;var i=this.map._featureMgr;function h6(){h7.cacheLabelTimer=null;var h8;var h9=h7.map.getTilt();var ia=h7.map.getHeading()%360;if(h7.tileLabels.length===0||(h7.tileLabels.length===1&&h7.tileLabels[0].tileInfo.zoom===0)){h8=i.getLabelData();if(h8.length>0){h8=h7.labelProcessor.collisionTest(h8,-1)}}else{if(h9||ia){if(this._collisionTimer){if(!h9){clearTimeout(this._collisionTimer)}else{if(Date.now()-h7.lastCollisionTestTime>500){h7.lastCollisionTestTime=Date.now()}else{clearTimeout(this._collisionTimer)}}}this._collisionTimer=setTimeout(function(){h8=h7.labelProcessor.collisionTest(h7.tileLabels);if(h8){i.setLabelData(h8)}h7.updateLabels();h7.map.dispatchEvent(new be("onrefresh"));h7._collisionTimer=null},60);return}else{h8=h7.labelProcessor.getCachedLabels(h7.tileLabels)}}if(h8){i.setLabelData(h8)}h7.updateLabels();h7.map.dispatchEvent(new be("onrefresh"))}if(!T){clearTimeout(h7.cacheLabelTimer);h6()}else{if(h7.cacheLabelTimer){return}h7.cacheLabelTimer=setTimeout(function e(){h6()},T)}},dataBackCollideLabels:function(){var i=this;if((i.tileLabels&&i.tileLabels.length===0)){return}var e;i.labelProcessor.calcLabelsCollision(i.tileLabels);e=i.labelProcessor.getCachedLabels(i.tileLabels);if(e){i.map._featureMgr.setLabelData(e)}i.updateLabels();i.map.dispatchEvent(new be("onrefresh"));if(gi()){this.labelProcessor._refreshSpotData()}},updateLabels:function(h7){var h8=this.map;var i=h8._featureMgr;var T=i.getLabelData();if(T.length>0){var h6=h8.getZoom();if(T.labelZoom-h6<3){this.labelProcessor.updateLabels(T);var e=this.labelProcessor.fixDataFormat(T);i.setOverlayData(e[0],2);i.setOverlayData(e[1],3);i.setOverlayData(e[2],4)}else{i.clearLabelOverlayData()}h8.temp.isPermitSpotOver=false;this.labelProcessor.curSpotAdded=false}},loadRasterLayerData:function(ib,h6){this.thumbCache={};var ic=this.getZoomState();if(h6){for(var h9=0,h7=ib.length;h9<h7;h9++){var T=ib[h9];var h8=this.getTileKey(T);var e=this.tileCache.getData(h8);if(e&&e.status==="ready"){if(T.tileTypeName==="xyz"){e.tileInfo=T}this.map._featureMgr.setData(e,this.drawIndex,2)}else{if(this.useThumbData){this.setThumbData(T.col,T.row,T.zoom,T.useZoom,ic)}}}return}for(var h9=0,h7=ib.length;h9<h7;h9++){var T=ib[h9];var h8=this.getTileKey(T);var e=this.tileCache.getData(h8);if(!e){this.tileCache.setData(h8,{});var ia=this;this.loadRasterTileData(T,function(i,id){ia.rasterTileDataCbk(i,id)})}}},loadRasterTileData:function(i,e){var T=new Image();var h7=i.col;var ia=i.row;var h8=i.zoom;var h6=this.getTilesUrl(new es(h7,ia),h8,i);if(!h6){return}var h9=this.getTileKey(i);if(i.combine){T=h6;T.tileInfo=i;if(T){e&&e(T,h9)}else{e&&e(null,h9)}}else{T=this.loadTileImage(h6,h9,e)}T.tileInfo=i},loadTileImage:function(h6,T,e){var i=new Image();i.crossOrigin="anonymous";i.onload=function(){e&&e(this,T)};i.onerror=function(){br.fetchDebug&&br.fetchDebug.sendError({title:h6,msg:h6,category:br.fetchDebug.category.RESOURCE,level:br.fetchDebug.levels.ERROR,url:h6});e&&e(null,T)};i.src=h6;return i},rasterTileDataCbk:function(h8,h6){if(!h8||typeof h8==="string"){this.tileCache.removeData(h6);return}var i=h8.tileInfo;var T=i.col;var ie=i.row;var id=i.zoom;var e=this.tileCache.getData(h6);if(!e){return}var h9="id_"+T+"_"+ie+"_"+id;var ic=this;e.dataType=eS;e.tileInfo=i;if(i.tileTypeName==="xyz"){var ib=i.tileSize;e.textureSource=h8;e.renderData={vertexAll:[0,0,0,0,0,ib,0,0,1,0,ib,ib,0,1,1,0,0,0,0,0,ib,ib,0,1,1,0,ib,0,0,1]};ic.setRasterTileData(h6,e,h9)}else{e.textureSource=h8;var h7=ed.calcLoopParam(T,id);var ia=h7.geoOffsetX;h8.tileInfo.loopOffsetX=ia;e.renderData={vertexAll:[0,0,0,0,0,256,0,0,1,0,256,256,0,1,1,0,0,0,0,0,256,256,0,1,1,0,256,0,0,1]};this.setRasterTileData(h6,e,h9)}},setRasterTileData:function(h7,e,h6){e.status="ready";this.tileCache.setData(h7,e);var T=false;if(this.curViewTilesInfo[h6]){e.dataType=eS;e.png8=this.png8||false;this.map._featureMgr.setData(e,this.drawIndex,2);T=true}if(T){var i=new be("onrefresh");i.source="webgllayer";this.map.dispatchEvent(i)}},_checkTilesLoaded:function(){this.numLoading--;if(this.map.firstTileLoad===false){this.map.dispatchEvent(new be("onfirsttilesloaded"));this.map.firstTileLoad=true}var e=this;if(this.numLoading===0){if(this._checkLoadedTimer){clearTimeout(this._checkLoadedTimer);this._checkLoadedTimer=null}this._checkLoadedTimer=setTimeout(function(){if(e.numLoading===0){e.map.dispatchEvent(new be("ontilesloaded"))}e._checkLoadedTimer=null},60)}},isClickableLabel:function(e){if(e.isDel){return false}if(e.zoom>9&&!e.guid){return false}if(e.zoom<=9&&!e.name&&!e.guid){return false}return true}};var cc=5;var d5=4;var hF=3;var fr=2;var hZ=1;var d8=0;function w(e){this._ratio=a9();this._iconCache={};this._map=e;this._drawingCanvasPool=[];this._drawingCanvasHeight=4096}D.extend(w.prototype,{_loadIcons:function(i,ia){var h8=0;var h7=this;var T=this._map.config.style;for(var h9 in i){h8++;var e=new Image();e.id=h9;e.crossOrigin="anonymous";e.onload=function(){h7._iconCache[this.id].loaded=true;h8--;if(h8===0){ia()}this.onload=null};e.onerror=function(){h7._iconCache[this.id]=null;h8--;if(h8===0){ia()}this.onerror=null};var h6=fe.getIconSetPath(T)+h9+".png";e.src=h6;this._iconCache[h9]={loaded:false,image:e}}},_getEmptyDrawingCanvas:function(){for(var T=0;T<this._drawingCanvasPool.length;T++){if(this._drawingCanvasPool[T]._free===true){this._drawingCanvasPool[T]._free=false;return this._drawingCanvasPool[T]}}var e=this._createNewDrawingCanvas();this._drawingCanvasPool.push(e);e._free=false;return e},_createNewDrawingCanvas:function(){var e=U("canvas");e.width=512;e.height=this._drawingCanvasHeight;e._free=true;e._id=br.getGUID();var i=e.getContext("2d");i.textBaseline="bottom";i.lineJoin="round";return e},drawLabelsOnCanvas:function(iq,h6){var ie=iq.label.fixedLabel.slice(0);var il=iq.label.lineLabel.slice(0);var T=iq.label.indoorLabel.slice(0);if(ie.length===0&&il.length===0&&T.length===0){h6();return}var h9=function(iw,i){return iw.styleId-i.styleId};ie.sort(h9);il.sort(h9);T.sort(h9);var ip={};var e=this._getEmptyDrawingCanvas();var ik=e.getContext("2d");ik.clearRect(0,0,e.width,e.height);var iu=0;var ig=null;var h8=0;if(ie.length>0){while(h8<ie.length&&!ie[h8].styleText[0]){h8++}if(ie[h8]&&ie[h8].styleText[0]){ig=ie[h8].styleText[0].fontSize+ie[h8].styleText[0].haloSize*2}}if(ig===null&&T.length>0){h8=0;while(h8<T.length&&!T[h8].styleText[0]){h8++}if(T[h8]&&T[h8].styleText[0]){ig=T[h8].styleText[0].fontSize+T[h8].styleText[0].haloSize*2}}if(ig===null&&il.length>0){h8=0;while(h8<il.length&&!il[h8].styleText[0]){h8++}if(il[h8]&&il[h8].styleText[0]){ig=il[h8].styleText[0].fontSize+il[h8].styleText[0].haloSize*2}}if(ig===null||isNaN(ig)){h6();return}var ib=0;var ia=ig;var ii={};var iv=0;var ij=[];for(var io=0;io<ie.length;io++){var id=ie[io];var ih=id.name;var im=id.styleText;if(!ih||im.length===0){continue}var h7=id.icon;if(id.textOnIcon&&(!this._iconCache[h7]||this._iconCache[h7].loaded===false)){ij.push(id);iv++;if(!ii[h7]){ii[h7]=true}continue}var ir=this._drawEachText(ik,id,iu,ib,ia,ig,ip);if(!ir){continue}ib=ir.curX;ia=ir.curY;ig=ir.curLineHeight;iu=ir.styleId}var ir=this._drawEachTypeOfLabels(ik,T,iu,ib,ia,ig,ip);iu=ir.curStyleId;ib=ir.curX;ia=ir.curY;ig=ir.curLineHeight;var ir=this._drawEachTypeOfLabels(ik,il,iu,ib,ia,ig,ip);iu=ir.curStyleId;ib=ir.curX;ia=ir.curY;ig=ir.curLineHeight;if(iv>0){var it=this;this._loadIcons(ii,function(){ir=it._drawEachTypeOfLabels(ik,ij,iu,ib,ia,ig,ip);iu=ir.curStyleId;ib=ir.curX;ia=ir.curY;ig=ir.curLineHeight;var i=it._generateEachLabelCanvas(e,ia,ie,il,T,iq);h6(i[0],i[1])});return}var ic=this._generateEachLabelCanvas(e,ia,ie,il,T,iq);h6(ic[0],ic[1])},drawCustomLabelsOnCanvas:function(h9,ig){if(h9.length===0){ig();return}var T=0;var e=(h9[0].style.fontSize+(h9[0].style.haloSize||0)*2)||0;var h6=e;var ib=this._getEmptyDrawingCanvas();var ih=ib.getContext("2d");ih.clearRect(0,0,ib.width,ib.height);var ic={};var ie=-1;for(var h7=0;h7<h9.length;h7++){if(!h9[h7].name){continue}var id=this._drawEachText(ih,h9[h7],ie,T,e,h6,ic);if(!id){continue}T=id.curX;e=id.curY;h6=id.curLineHeight;ie=id.styleId}var h8=e;var ia=this._copyToNewCanvas(ib,h8);for(var h7=0;h7<h9.length;h7++){if(!h9[h7].name&&h9[h7].style.iconSize){this._addFixedLabelBounds(h9[h7]);continue}if(!h9[h7].textSize){continue}this._updateFixedLabelCoords(h9[h7],h8);this._addFixedLabelBounds(h9[h7])}ig(ia)},_drawEachTypeOfLabels:function(ig,h9,id,h6,T,h7,ib){for(var h8=0;h8<h9.length;h8++){var ia=h9[h8];var ie=ia.name;var e=ia.styleText;if(!ie||e.length===0){continue}var ic=this._drawEachText(ig,ia,id,h6,T,h7,ib);if(!ic){continue}h6=ic.curX;T=ic.curY;h7=ic.curLineHeight;id=ic.styleId;if(ic.curY>this._drawingCanvasHeight){return{curX:h6,curY:T,curLineHeight:h7,curStyleId:id}}}return{curX:h6,curY:T,curLineHeight:h7,curStyleId:id}},_drawIndoorTextLabelOnCanvas:function(h7){var e=this._getEmptyDrawingCanvas();var ie=e.getContext("2d");ie.clearRect(0,0,e.width,e.height);var io=0;var id=null;var ic=0;var ia;var ik={};var ij=[];for(var h8 in h7){if(h8==="tileInfo"){continue}var h6=h7[h8];var ii=h6.defaultFloor;var ib=h6.floors;for(var ih=0;ih<ib.length;ih++){if(ih===ii){continue}var il=ib[ih];if(!il.pois){continue}var h9=il.pois;for(var ig=0;ig<h9.length;ig++){if(id===null&&h9[ig].styleText[0]){id=h9[ig].styleText[0].fontSize+h9[ig].styleText[0].haloSize*2;ia=id}ij.push(h9[ig])}}}if(id===null){return null}ij.sort(function(ip,i){return i.rank-ip.rank||ip.styleId-i.styleId});var im=this._drawEachTypeOfLabels(ie,ij,io,ic,ia,id,ik);io=im.curStyleId;ic=im.curX;ia=im.curY;id=im.curLineHeight;var T=this._copyToNewCanvas(e,ia);return T},_updateIndoorLabelsCoords:function(id,ie){for(var ic in id){if(ic==="tileInfo"){continue}var e=id[ic];var h8=e.defaultFloor;var h9=e.floors;for(var ia=0;ia<h9.length;ia++){if(ia===h8){continue}var T=h9[ia];if(!T.pois){continue}var h7=T.pois;for(var h6=0;h6<h7.length;h6++){var ib=h7[h6];if(ib.name&&(!ib.textSize||ib.textSize.length===0)){h7.splice(h6,1);h6--;continue}this._updateFixedLabelCoords(ib,ie);this._addFixedLabelBounds(ib)}}}},_generateEachLabelCanvas:function(h9,h8,ia,e,ic,T){h8=Math.min(h8,this._drawingCanvasHeight);var ib=this._copyToNewCanvas(h9,h8);var h6=null;if(T.renderData.indoorData){h6=this._drawIndoorTextLabelOnCanvas(T.renderData.indoorData);if(h6){this._updateIndoorLabelsCoords(T.renderData.indoorData,h6.height)}}for(var h7=0;h7<ia.length;h7++){if(!ia[h7].textSize){continue}this._updateFixedLabelCoords(ia[h7],h8);this._addFixedLabelBounds(ia[h7])}for(var h7=0;h7<ic.length;h7++){if(!ic[h7].textSize){continue}this._updateFixedLabelCoords(ic[h7],h8);this._addFixedLabelBounds(ic[h7])}for(var h7=0;h7<e.length;h7++){this._updateLineLabelCoords(e[h7],h8)}return[ib,h6]},_copyToNewCanvas:function(T,i){if(i===0){return null}var h6=U("canvas");h6.width=T.width;h6.height=i;var e=h6.getContext("2d");e.drawImage(T,0,0,512,i,0,0,512,i);h6._id=T._id;T._free=true;return h6},_drawEachText:function(iq,ia,T,it,ir,iA,h7){var iz=ia.name;var ig=ia.styleText?ia.styleText[0]:ia.style;if(!ig){return null}var ij=ig.fontSize;var iE=ig.fontWeight;var iR=ig.haloSize||0;if(!ik){}if(ig.fontRgba){var iX=ig.fontRgba[3]/255;var ie=[];ie[3]=iX;for(var iW=0;iW<3;iW++){ie[iW]=ig.fontRgba[iW]}}if(ig.haloRgba){var iX=ig.haloRgba[3]/255;var im=[];im[3]=iX;for(var iW=0;iW<3;iW++){im[iW]=ig.haloRgba[iW]}}var iL=ie?"rgba("+ie.join(",")+")":ig.color;var h9=im?"rgba("+im.join(",")+")":ig.strokeColor;var iT=ia.styleId||0;if(iR>4){iR=4}var iB=[];var ip=[];var ix=0;if(h7&&!h7[iT]){h7[iT]={}}var ii=ij+iR*2;var iC=ii;if(ia.containDescendings){iC+=4}if(iR===0){iC+=2}if(ia.textOnIcon){iC=Math.max(iC,ia.iconSize[1])}if(iT!==T||iC>iA){T=iT;if(iE>=10&&iE%10===0){iq.font=iE*10+" "+ij+"px sans-serif"}else{iq.font=ij+"px sans-serif"}if(iC>iA){var iy=iC-iA;iA+=iy;ir+=iy}if(iR>0){iq.lineWidth=iR*2;iq.strokeStyle=h9}iq.fillStyle=iL}if(ia.type==="line"){var ic=iz.split("");for(var iU=0;iU<ic.length;iU++){var iN=ic[iU];var iu;var iF;if(h7[iT][iN]){var ik=h7[iT][iN];iu=ik.displaySize;iF=ik.curWordPosition}else{var h6=Math.ceil(iq.measureText(iN).width);if(it+h6>512){it=0;ir+=iC;iA=iC}if(ir>this._drawingCanvasHeight){return{curX:it,curY:ir,curLineHeight:iA,styleId:iT}}var iO=it;if(iR>0){h6+=iR;iO-=Math.round(iR/2);iq.strokeText(iN,it,ir)}iq.fillText(iN,it,ir);var iK=[h6,iC];iu=[Math.round(iK[0]/2),Math.round(iK[1]/2)];iF=[iO,ir-iC];h7[iT][iN]={displaySize:iu,curWordPosition:iF,totalHeight:ix};it+=h6+2}iB.push(iu);ip.push(iF)}ix=Math.round(iB[0][1])}else{if(h7[iT][iz]){var ik=h7[iT][iz];iB=ik.textSize;ip=ik.labelImagePosition;ix=ik.totalHeight}else{var il=iz.split("\\");if(il.length>1&&ia.textOnIcon){var iV=0;var iS=0;var iY=[];var iv=8;for(var iU=0;iU<il.length;iU++){var iz=il[iU];var ih=Math.ceil(iq.measureText(iz).width);if(ih>iV){iV=ih}iY.push(Math.round(ih/2));iS+=iC}var id=iV+2*iv;var iQ=iS+2*iv;if(it+id>512){it=0;ir+=iA}ir+=iS-iC+2*iv;var iJ=it;var iw=ir-iQ;var e=Math.round(id/2);var io=this._iconCache[ia.icon].image;this.drawStretchedIcon(iq,io,[iJ,iw],iv,iV,iS);for(var iU=0;iU<il.length;iU++){var iz=il[iU];var iP=iJ+(e-iY[iU]);var iM=iw+4+(iU+1)*iC;iq.fillText(iz,iP,iM)}iB.push([Math.round(id/2),Math.round(iQ/2)]);ip.push([iJ,iw]);it+=id;iA=iQ;ix=Math.round(iQ/2)}else{for(var iU=0;iU<il.length;iU++){var iz=il[iU];var ih=Math.ceil(iq.measureText(iz).width);var id=ih;var h8=0;if(ia.textOnIcon){h8=10;id+=h8*2;if(ia.styleId===519){id=ia.iconSize[0];h8=Math.round((id-ih)/2)}}if(it+id>512){it=0;ir+=iC;iA=iC}if(ir>this._drawingCanvasHeight){return{curX:it,curY:ir,curLineHeight:iA,styleId:iT}}var iJ=it;var iw=ir-iC;var iI=it;var iH=ir;if(ia.containDescendings){iH-=4}if(ia.textOnIcon){var iD=false;var io=this._iconCache[ia.icon].image;var iG=ia.iconSize.concat([]);if(ii>iG[1]){iG[1]=ii;iD=true}if(ih>iG[0]){iG[0]=ih;iD=true}if(ia.styleId===519){iq.drawImage(io,0,0,iG[0],iG[1],iJ,iw,iG[0],iG[1])}else{if(iD){this.drawStretchedIcon(iq,io,[iJ,iw],h8,ih,iG[1])}else{this.draw3StretchedIcon(iq,io,[iJ,iw],h8,ih,iG[1])}}iI+=h8;if(ia.iconSize[1]>ii){iH-=(ia.iconSize[1]-ii)/2-1}id+=1}if(iR>0){id+=iR;iJ-=Math.round(iR/2);iw+=Math.round(iR/2);if(iT===71028){iC-=2}if(iT===32){iC-=2}iq.strokeText(iz,iI,iH)}iq.fillText(iz,iI,iH);var ib=[id,iC];var iu=[Math.round(ib[0]/2),Math.round(ib[1]/2)];iB.push(iu);ip.push([iJ,iw]);ix+=Math.round(iu[1]);it+=id}}h7[iT][iz]={textSize:iB,labelImagePosition:ip,totalHeight:ix}}}ia.textSize=iB;ia.labelImagePosition=ip;ia.totalHeight=ix;return{curX:it,curY:ir,curLineHeight:iA,styleId:iT}},drawStretchedIcon:function(e,T,h6,h9,ia,i){var h8=h6[0];var h7=h6[1];e.drawImage(T,0,0,h9,h9,h8,h7,h9,h9);e.drawImage(T,h9,0,1,h9,h8+h9,h7,ia,h9);e.drawImage(T,T.width-h9,0,h9,h9,h8+ia+h9,h7,h9,h9);e.drawImage(T,0,h9,h9,1,h8,h7+h9,h9,i);e.drawImage(T,h9,h9,1,1,h8+h9,h7+h9,ia,i);e.drawImage(T,T.width-h9,h9,h9,1,h8+ia+h9,h7+h9,h9,i);e.drawImage(T,0,T.height-h9,h9,h9,h8,h7+i+h9,h9,h9);e.drawImage(T,h9,T.height-h9,1,h9,h8+h9,h7+i+h9,ia,h9);e.drawImage(T,T.width-h9,T.height-h9,h9,h9,h8+ia+h9,h7+i+h9,h9,h9)},draw3StretchedIcon:function(e,i,T,h8,ia,h9){var h7=T[0];var h6=T[1];e.drawImage(i,0,0,h8,i.height,h7,h6,h8,i.height);e.drawImage(i,h8,0,1,i.height,h7+h8,h6,ia,i.height);e.drawImage(i,i.width-h8,0,h8,i.height,h7+h8+ia,h6,h8,i.height)},_updateFixedLabelCoords:function(h7,io){if(io===0){return}var ii=[];var iw=[];var ix=0;var il=h7.totalHeight;var iF=h7.textSize.length;var h8=h7.direction;if(typeof h8!=="number"){h8=0}for(var iy=0;iy<iF;iy++){var ip=h7.labelImagePosition[iy];var im=h7.textSize[iy];var ik=ip[0];var h6=ip[1];var h9=im[0];var ie=im[1];var ih=0;var iv=0;if(typeof h7.textMargin==="number"){iv=h7.textMargin}var ig;var e;var ib=0;var ij=0;if(!h7.iconPos){if(!h7.custom){h8=d5}}else{ib=h7.iconPos.width;ij=h7.iconPos.height}switch(h8){case hF:var T=il/2-ie+ih*(iF-1)/2;ig=Math.round(-ib/2-h9-iv);e=Math.round(T-ix-ih*iy);break;case hZ:var T=il/2-ie+ih*(iF-1)/2;ig=Math.round(ib/2+iv);e=Math.round(T-ix-ih*iy);break;case fr:var T=ij/2+il-ie+ih*iF;ig=Math.round(-h9/2);e=Math.round(T-ix-ih*iy);break;case d8:var T=-ij/2-ih-ie;ig=Math.round(-h9/2);e=Math.round(T-ix-ih*iy);break;case d5:var T=-il/2-ih*(iF-1)/2;ig=Math.round(-h9/2);e=Math.round(T-ix-ih*iy);break}ix+=ie;var id=ig+h9;var iG=e;var ic=id;var iE=iG+ie;var ia=ig;var iD=iE;ii.push(ig,e,id,iG,ic,iE,ig,e,ic,iE,ia,iD);var iC=ik/512;var iu=(io-h6-ie*2)/io;var iB=(ik+h9*2)/512;var it=iu;var iA=iB;var ir=(io-h6)/io;var iz=iC;var iq=ir;iw.push(iC,iu,iB,it,iA,ir,iC,iu,iA,ir,iz,iq)}if(!h7.textPos){h7.textPos={}}h7.textPos.vertex=ii;h7.textPos.texcoord=iw},_addFixedLabelBounds:function(ic){var h8=1000;var h6=1000;var T=-1000;var e=-1000;if(ic.iconPos){var ia=ic.iconPos["vertex"];for(var ib=0,h7=ia.length;ib<h7;ib+=2){var ih=ia[ib];var ie=ia[ib+1];if(ih<h8){h8=ih}if(ih>T){T=ih}if(ie<h6){h6=ie}if(ie>e){e=ie}}}if(ic.custom&&ic.style.iconSize&&!ic.name){var id=ic.style.iconSize;var ig=ic.direction;switch(ig){case d5:h8=-Math.round(id[0]/2);h6=-Math.round(id[1]/2);T=Math.round(id[0]/2);e=Math.round(id[1]/2);break;case fr:h8=-Math.round(id[0]/2);h6=0;T=Math.round(id[0]/2);e=id[1];break}}if(ic.textPos){var h9=ic.textPos["vertex"];for(var ib=0,h7=h9.length;ib<h7;ib+=2){var ih=h9[ib];var ie=h9[ib+1];if(ih<h8){h8=ih}if(ih>T){T=ih}if(ie<h6){h6=ie}if(ie>e){e=ie}}}ic.bds=[h8,h6,T,e]},_updateLineLabelCoords:function(ip,id){if(id===0){return}var h6=ip.wordsInfo;var il=ip.wordCount;if(!ip.labelImagePosition){return}var ig=ip.labelImagePosition.slice(0);if(ip.reverse){ig.reverse()}var iz=1000;var iw=1000;var ix=-1000;var iv=-1000;for(var iq=0;iq<il;iq++){var iA=ig[iq];var iy=iA[0];var im=iA[1];var ik=ip.textSize[iq];var ic=ik[0];var e=ik[1];var ib=iy/512;var ij=(id-im-e*2)/id;var h9=(iy+ic*2)/512;var ii=ij;var h7=h9;var ih=(id-im)/id;var T=ib;var ie=ih;h6[iq].size=[ic,e];h6[iq].texcoord=[ib,ij,h9,ii,h7,ih,ib,ij,h7,ih,T,ie];var iu=h6[iq].offset[0];var it=h6[iq].offset[1];var ir=iu-ic/2;var ia=it+e/2;var h8=it-e/2;var io=iu+ic/2;if(ir<iz){iz=ir}if(io>ix){ix=io}if(h8<iw){iw=h8}if(ia>iv){iv=ia}}ip.bds=[iz,iw,ix,iv]}});var cX={0:"00000000",16:"00010000",32:"00100000",48:"00110000",64:"01000000",96:"01100000"};function ct(T,h6,h7){var e=T.bds;if(!e){return false}var i=T.tracer;var ia;if(i){if(!cX[i]){ia=i.toString(2);if(ia.length<8){ia=new Array(8-ia.length+1).join("0")+ia}cX[i]=ia}ia=cX[i];var h9=dn.mapZoomStartZoomMapping[h6];return ia[h6-h9]==="1"}var h8=T.displayRange;if(h7>=h8[0]&&h7<=h8[1]){return true}return false}function dp(i,e){this.map=i.map;this.layer=i;e=e||[];this.allLabels=[];this._spotData=[];this._strategyInfo=null;this.RANK1=1000000;this.RANK2=2000000;this.RANK3=3000000;this.RANK4=4000000;this.RANK5=5000000;this._ratio=a9();this._useRound=true;this._sharpenRender=false;if(this._ratio>dd.HIGH_RES_MIN_RATIO){this._useRound=false;this._sharpenRender=true}this._mapIsMoving=false;this._onMapIdleCallback=e.onMapIdleCallback;this.map.temp.isPermitSpotOver=true;this.currentSelectedLabel=null;this.map._labelProcessor=this;this.iconCache={};this.fixedLabelData=[];this.lineLabelData=[];this.highlightLabelData=[];this._iconLoadTimer=null;this._labelTextCanvas=null;if(this.map.config.textRenderType==="canvas"){this._labelTextCanvas=this.map.tileMgr.getLabelTextCanvas()}this.bind()}D.extend(dp.prototype,{bind:function(){var T=this.map;var i=this;T.addEventListener("mapstatusbusy_inner",function(h6){i._mapIsMoving=true;if(i._ratio>dd.HIGH_RES_MIN_RATIO){i._sharpenRender=false}else{i._useRound=false}});T.addEventListener("mapstatusidle_inner",function(h6){if(i._ratio>dd.HIGH_RES_MIN_RATIO){i._sharpenRender=true}else{i._useRound=true}i._mapIsMoving=false});T.addEventListener("onspotmouseover",function(h8){if(!this.temp.isPermitSpotOver){return}if(h8.spots.length>0){var h7=h8.spots[0].userdata.uid;var h9=h8.spots[0].userdata.tilePosStr;var h6=i.getLabelByUid(h7,h9);h6&&h6.formatedData&&i._toHighlightColor(h6.formatedData)}});T.addEventListener("onspotmouseout",function(h8){if(!this.temp.isPermitSpotOver){return}if(h8.spots.length>0){var h7=h8.spots[0].userdata.uid;var h9=h8.spots[0].userdata.tilePosStr;var h6=i.getLabelByUid(h7,h9);h6&&h6.formatedData&&i._toDefaultColor(h6.formatedData)}});T.addEventListener("spotclick",function(h8){if(h8.spots&&h8.spots.length>0){if(h8.spots[0].userdata.zoom<10){return}var h7=h8.spots[0].userdata.uid;var h9=h8.spots[0].userdata.tilePosStr;if(i.currentSelectedLabel&&(i.currentSelectedLabel.uid!==h7||i.currentSelectedLabel.tilePosStr!==h9)){i._recoverNormalState()}var h6=i.getLabelByUid(h7,h9);h6&&i._changeBaseMapState(h6)}else{i._recoverNormalState()}});T.on("spot_status_reset",function(){i._recoverNormalState()});T.on("spot_highlight",function(h7){var h6=i.getLabelByUid(h7.uid,h7.tilePosStr);h6&&h6.formatedData&&i._toHighlightColor(h6.formatedData)});T.addEventListener("mousemove",function(h6){if(i.curSpotAdded){return}if(this.currentOperation!==d1.idle||i._mapIsMoving===true){return}i._refreshSpotData();this.temp.isPermitSpotOver=true;i.curSpotAdded=true});if(gi()){function e(){i._refreshSpotData()}T.addEventListener("mapstatusidle_inner",e)}T.on("style_loaded",function(){if(i.map.config.textRenderType==="canvas"&&!i._labelTextCanvas){i._labelTextCanvas=i.map.tileMgr.getLabelTextCanvas()}})},getLabelByUid:function(ia,ib){var e=this.map._featureMgr.getResult().tileLabels;for(var h9=0;h9<e.length;h9++){var h6=e[h9].fixedLabel;for(var h8=0;h8<h6.length;h8++){if(e[h9].fixedLabel[h8].guid===ia&&e[h9].fixedLabel[h8].tilePosStr===ib){return e[h9].fixedLabel[h8]}}var h7=e[h9].indoorLabel;for(var T=0;T<h7.length;T++){if(e[h9].indoorLabel[T].guid===ia&&e[h9].indoorLabel[T].tilePosStr===ib){return e[h9].indoorLabel[T]}}}return null},getTileByLabelUid:function(ia){var e=this.map._featureMgr.getResult().tileLabels;for(var h9=0;h9<e.length;h9++){var h6=e[h9].fixedLabel;for(var h8=0;h8<h6.length;h8++){if(e[h9].fixedLabel[h8].guid===ia){return e[h9]}}var h7=e[h9].indoorLabel;for(var T=0;T<h7.length;T++){if(e[h9].indoorLabel[T].guid===ia){return e[h9]}}}return null},_toHighlightColor:function(T){if(T.tempRank&&T.tempRank===this.RANK5){return}var e=this.map._featureMgr.getResult().eleData[4]||[];var h7=false;for(var h6=0;h6<e.length;h6++){if(e[h6]===T||(e[h6].guid===T.guid&&e[h6].tilePosStr===T.tilePosStr&&e[h6].zoom===T.zoom)){h7=true;break}}if(h7){return}e.push(T);this.map._featureMgr.setOverlayData(e,4);this.map.dispatchEvent(new be("onrefresh"))},_toDefaultColor:function(T){if(T.tempRank&&T.tempRank===this.RANK5){return}var e=this.map._featureMgr.getResult().eleData[4]||[];for(var h6=0;h6<e.length;h6++){if(T===e[h6]||(T.guid===e[h6].guid&&T.tilePosStr===e[h6].tilePosStr&&T.zoom===e[h6].zoom)){e.splice(h6,1);break}}this.map._featureMgr.setOverlayData(e,4);this.map.dispatchEvent(new be("onrefresh"))},_changeBaseMapState:function(i){var h7=i.guid;var ib=i.formatedData.guidExt;var ic={guid:h7,tilePosStr:i.tilePosStr,guidExt:ib};this._strategyInfo=ic;this.currentSelectedLabel=i;var h6=this.map._featureMgr;var e=h6.getLabelData();e=this.collisionTest(e);this.updateLabels(e);var id=this.fixDataFormat(e);h6.setOverlayData(id[0],2);h6.setOverlayData(id[1],3);h6.setOverlayData(id[2],4);var T=this.getTileByLabelUid(h7);this.currentSelectedLabel.tileInfo=T.tileInfo;var ia=this.layer.tileCache.getAllData();for(var h9 in ia){var h8=ia[h9].data;if(!h8.label){continue}this.clearCollisionCache(h8.label)}this.map.dispatchEvent(new be("onrefresh"))},_recoverNormalState:function(){this._strategyInfo=null;var ia=false;var h8=this.map._featureMgr.getLabelData();if(this.currentSelectedLabel){var T=this.currentSelectedLabel.guid;this.clearCollisionCache(this.getTileByLabelUid(T));var h7=this.layer.tileCache.getAllData();for(var h6 in h7){if(Object.prototype.hasOwnProperty.call(h7,h6)){var h9=h7[h6].data;if(!h9.label){continue}this.clearCollisionCache(h9.label)}}this.currentSelectedLabel.tempRank=null;this.currentSelectedLabel=null;ia=true}h8=this.collisionTest(h8);this.updateLabels(h8);var e=this.fixDataFormat(h8);var i=this.map._featureMgr;i.setOverlayData(e[0],2);i.setOverlayData(e[1],3);i.setOverlayData([],4);this.map.dispatchEvent(new be("onrefresh"));if(ia){this.curSpotAdded=false;this._refreshSpotData()}},loadIconImages:function(h7,ij){var ia=h7.label;var h8=h7.tileInfo.style;var T=ia.fixedLabel;var ig=ia.indoorLabel;var ik=T.length+ig.length;var ic=this;var h6=0;var ii=200;for(var h9=0;h9<ik;h9++){var ib;if(h9<T.length){ib=T[h9]}else{ib=ig[h9-T.length]}if(!ib.iconPos){continue}var ie=ib.iconPos.iconType;var ih=h8+"_"+ie;h6++;if(this.iconCache[ih]){if(this.iconCache[ih].loaded){ij(h7)}continue}var e=fe.getIconSetPath(this.map.config.style)+ie+".png";var id=new Image();id.id=ih;id.iconUrl=e;id.crossOrigin="anonymous";id.onload=function(){ic.iconCache[this.id].loaded=true;ic._addToIconTexture(this);if(ic._iconLoadTimer===null){ic._iconLoadTimer=setTimeout(function(){ij();ic._iconLoadTimer=null},ii)}this.onload=null};id.onerror=function(){if(!ic._iconLoadTimer){ic._iconLoadTimer=setTimeout(function(){ij();ic._iconLoadTimer=null},ii)}ic.iconCache[this.id]=null;this.onerror=null;br.fetchDebug&&br.fetchDebug.sendError({title:this.iconUrl,msg:this.iconUrl,category:br.fetchDebug.category.RESOURCE,level:br.fetchDebug.levels.ERROR,url:this.iconUrl})};id.src=e;this.iconCache[ih]={loaded:false,image:id}}return h6},_addToIconTexture:function(h8){if(!this.map._webglMapScene){return}var ia=this.map._webglMapScene._painter;var e=ia._iconTextureAtlas.addTexture(h8);ia._iconTextureAtlasOffset[h8.id]=e;var id=0*h8.width/1024+e.width;var h7=0*h8.height/1024+e.height;var ic=h8.width/1024+e.width;var h6=h7;var ib=ic;var T=h8.height/1024+e.height;var h9=id;var i=T;ia._iconTextureAtlasCoords[h8.id]=[id,h7,ic,h6,ib,T,id,h7,ib,T,h9,i]},loadImgByStr:function(h6,h7,h8){if(!h6&&!h7){h8&&h8(null,null);return}if(typeof h6==="object"&&typeof h7==="object"){h8(h6,h7);return}var i=0;var T=null;var e=null;if(h6){i++;T=new Image();T.onload=function(){i--;if(i===0){h8&&h8(this,e)}this.onload=null};T.src=h6}if(h7){i++;e=new Image();e.onload=function(){i--;if(i===0){h8&&h8(T,this)}this.onload=null};e.src=h7}},collisionTest:function(ip,jg,iL){if(this.map.viewAnimationTime){return[]}if(!ip){return[]}var iB=this.map;var iU=iB.getHeading();iU=this.calcLoopHeading(iU);var i6=iB.height;var i0=this.allLabels;i0.length=0;ip.sort(function(ii,i){var i5=ii.tileInfo;var i4=i.tileInfo;if(i5.col*i5.row<i4.col*i4.row){return -1}else{return 1}});var iC=iB.getTilt();var ir=iB.getZoom();var iZ;if(iL){iZ=iL}else{iZ=this.getZoomStep()}for(var jc=0,i7=ip.length;jc<i7;jc++){var iG=ip[jc];var im=iG.tileInfo;var ie=im.zoom;var iY=im.loopOffsetX/Math.pow(2,18-ie);if(!iU&&!iC){if(iG.unnecessaryCollisionTest&&iG.unnecessaryCollisionTest[iL]){continue}}var iQ=iG.fixedLabel||[];for(var ja=0,iI=iQ.length;ja<iI;ja++){var ij=iQ[ja];ij.zoom=ie;if(jg===-1&&ij.isDel){continue}if(!ct(ij,im.useZoom,ir)){ij.isDel=true;continue}this.calcCollisionBounds(ij,iZ,iY,i6);i0.push(ij)}var iO=iG.indoorLabel||[];for(var i8=0,h9=iO.length;i8<h9;i8++){var iD=iO[i8];iD.zoom=ie;if(jg===-1&&iD.isDel){continue}if(!ct(iD,im.useZoom)){iD.isDel=true;continue}this.calcCollisionBounds(iD,iZ,iY,i6);i0.push(iD)}var il=iG.lineLabel||[];for(var jd=0,iw=il.length;jd<iw;jd++){var h6=il[jd];if(jg===-1&&h6.isDel){continue}if(!ct(h6,im.useZoom)){h6.isDel=true;continue}var ji=h6.pt;var iK=iB.pointToPixelIn(ji,{zoom:iZ,useRound:this._useRound});var iH=iK.x+iY;var iF=i6-iK.y;var iN=h6.bds;var i3=iN[0];var i1=iN[1];var iz=iN[2];var iy=iN[3];var iV=i3;var iT=i1;var iv=iz;var iu=iy;if((iU>=0&&iU<45)||(iU>=315&&iU<360)){iV=i3;iT=i1;iv=iz;iu=iy}else{if(iU>=45&&iU<135){iV=i1;iT=-iz;iv=iy;iu=-i3}else{if(iU>=135&&iU<225){iV=-iz;iT=-iy;iv=-i3;iu=-i1}else{if(iU>=225&&iU<315){iV=-iy;iT=i3;iv=-i1;iu=iz}}}}h6._tempBds=[iH+iV,iF+iT,iH+iv,iF+iu];var io=iB.pixelToPointIn(new es(h6._tempBds[0],iK.y+iT),{zoom:iZ});var h8=iB.pixelToPointIn(new es(h6._tempBds[2],iK.y+iu),{zoom:iZ});h6._mcBds=[io,h8];i0.push(h6)}}var iX=this._strategyInfo;if(iX){var it=iX.guid;var iE=iX.guidExt;var h7=false;for(var iJ=0,ik=i0.length;iJ<ik;iJ++){var i2=i0[iJ];delete i2.tempRank;if(!this.layer.isClickableLabel(i2)||(iE===1&&!i2.guidExt)){continue}if(it===i2.guid&&iX.tilePosStr===i2.tilePosStr){i2.tempRank=this.RANK5;h7=true}}if(!h7&&this.currentSelectedLabel){this.currentSelectedLabel.tempRank=this.RANK5;var iM=this.currentSelectedLabel.tileInfo;var T=iM.zoom;var iW=iM.loopOffsetX/Math.pow(2,18-T);this.calcCollisionBounds(this.currentSelectedLabel,iZ,iW,i6);i0.push(this.currentSelectedLabel)}}else{for(var ix=0,ih=i0.length;ix<ih;ix++){var jh=i0[ix];if(jh.type==="line"||!jh.iconPos){continue}delete jh.tempRank}}i0.sort(function(i4,ii){var i5=i4.tempRank?i4.tempRank:i4.rank;var i=ii.tempRank?ii.tempRank:ii.rank;return i-i5||i4.startZoom-ii.startZoom||ii.pt.lng-i4.pt.lng||ii.pt.lat-i4.pt.lat});var ia=0;if(iC>0){ia=6}ir=iB.getZoom();if(ir>=8&&ir<9){ir<8.5?(ia=6):(ia=3)}if(iB._displayOptions.labelMargin>0){ia=iB._displayOptions.labelMargin}var e=2;if(ir<6&&ir>=5){e=-1}for(var ig=0,id=i0.length;ig<id;ig++){var iS=i0[ig];var iq=iS._tempBds;iS.isDel=false;iS._intersectIdx=[];for(var jb=ig+1;jb<id;jb++){var iA=i0[jb];var jf=iA._tempBds;if(!(iq[2]+ia+e<jf[0]-ia||iq[0]-ia>jf[2]+ia+e||iq[3]+ia+e<jf[1]-ia||iq[1]-ia>jf[3]+ia+e)){iS._intersectIdx.push(jb)}}}for(var ic=0,ib=i0.length;ic<ib;ic++){var je=i0[ic];if(je.isDel===false){var iR=je._intersectIdx;for(var i9=0,iP=iR.length;i9<iP;i9++){i0[iR[i9]].isDel=true}}}return ip},calcCollisionBounds:function(ic,ia,i,ib){var h8=ic.ptFix||ic.pt;var h6=this.map;var h7=h6.pointToPixelIn(h8,{zoom:ia,useRound:this._useRound});var T=h7.x+i;var ie=ib-h7.y;var e=ic.bds;ic._tempBds=[T+e[0],ie+e[1],T+e[2],ie+e[3]];var h9=h6.pixelToPointIn(new es(ic._tempBds[0],h7.y+e[1]),{zoom:ia});var id=h6.pixelToPointIn(new es(ic._tempBds[2],h7.y+e[3]),{zoom:ia});ic._mcBds=[h9,id]},getZoomStep:function(){var T=this.map.getZoom();var e=Math.floor(T);var i=T-e>=0.5?e+0.5:e;return i},clearCollisionCache:function(e){if(!e){return}e.cacheState=null;e.unnecessaryCollisionTest=null},getCachedLabels:function(e){e=e||[];var T=this.getZoomStep();var h8=false;for(var h6=0;h6<e.length;h6++){var h7=e[h6];if(!h7.cacheState||!h7.cacheState[T]){h8=true;break}if(h7.hasNewData){h8=true;break}}if(h8){this.calcLabelsCollision(e)}return e},calcLabelsCollision:function(T){var h7=this.getZoomStep();var h8={};var ig;var h6;var ii;var ik;var ij;var ih;T=this.collisionTest(T,undefined,h7);bM.addLabelIntoAreaSpots(T);for(var ic=0;ic<T.length;ic++){ig=T[ic];h6=ig.tileInfo;ik=h6.col+","+h6.row;h8[ik]=1}var e={};for(var ia=0;ia<T.length;ia++){ig=T[ia];if(!ig.cacheState){ig.cacheState={}}h6=ig.tileInfo;ij=h6.col;ih=h6.row;ik=ij+","+ih;if(ig.cacheState[h7]==="stable"){e[ik]=1;if(!ig.hasNewData){continue}}for(var ib=0;ib<ig.fixedLabel.length;ib++){ii=ig.fixedLabel[ib];if(!ii.cachedIsDel){ii.cachedIsDel={}}ii.cachedIsDel[h7]=ii.isDel}for(var ie=0;ie<ig.indoorLabel.length;ie++){ii=ig.indoorLabel[ie];if(!ii.cachedIsDel){ii.cachedIsDel={}}ii.cachedIsDel[h7]=ii.isDel}for(var id=0;id<ig.lineLabel.length;id++){ii=ig.lineLabel[id];if(!ii.cachedIsDel){ii.cachedIsDel={}}ii.cachedIsDel[h7]=ii.isDel}if(h8[(ij-1)+","+(ih-1)]&&h8[(ij-1)+","+ih]&&h8[(ij-1)+","+(ih+1)]&&h8[ij+","+(ih-1)]&&h8[ij+","+(ih+1)]&&h8[(ij+1)+","+(ih-1)]&&h8[(ij+1)+","+ih]&&h8[(ij+1)+","+(ih+1)]){ig.cacheState[h7]="stable";e[ik]=1}else{if(!ig.cacheState[h7]){ig.cacheState[h7]="unstable"}}}for(var h9=0;h9<T.length;h9++){ig=T[h9];h6=ig.tileInfo;ik=h6.col+","+h6.row;ij=+h6.col;ih=+h6.row;if(e[(ij-1)+","+(ih-1)]&&e[(ij-1)+","+ih]&&e[(ij-1)+","+(ih+1)]&&e[ij+","+(ih-1)]&&e[ij+","+(ih+1)]&&e[(ij+1)+","+(ih-1)]&&e[(ij+1)+","+ih]&&e[(ij+1)+","+(ih+1)]){if(!ig.unnecessaryCollisionTest){ig.unnecessaryCollisionTest={}}ig.unnecessaryCollisionTest[h7]=1}}T.hasNewData=false},updateLabels:function(h7){var T=this.map;var id=T.getZoom();var ig=T.getHeading();ig=this.calcLoopHeading(ig);var ie=T.getTilt();var h8=this.getZoomStep();for(var ic=0,h9=h7.length;ic<h9;ic++){var ib=h7[ic];var h6=ib.tileInfo;var ia=h6.loopOffsetX||0;var e={zoom:id,mcOffsetX:ia};this.updateFixedLabel(ib.fixedLabel,ie,ig,ib,h8,e);e={zoom:id,mcOffsetX:0};this.updateFixedLabel(ib.indoorLabel,ie,ig,ib,h8,e);this.updateLineLabel(ib.lineLabel,ie,ig,ib,h8)}},updateFixedLabel:function(ib,ie,i,ii,h7,ic){if(ib.length===1){}var e=ic.zoom;var h6=ic.mcOffsetX;var io;for(var ij=0,h9=ib.length;ij<h9;ij++){var id=ib[ij];if(!id.cachedIsDel){continue}if(!ie&&!i&&ii.cacheState&&ii.cacheState[h7]){id.isDel=id.cachedIsDel[h7];if(typeof id.isDel==="undefined"){id.isDel=id.cachedIsDel[h7]=true}}if(id.startScale>e){id.isDel=true}if(id.isDel){continue}var il=id.pt;var T=id.iconPos;if(T&&T.texcoord){if(!T.rtVertex){T.rtVertex=[];io=T.vertex;var ia=aI(il.lng);var ik=aI(il.lat);T.rtVertex=[ia[0],ik[0],ia[1],ik[1],0,io[0],io[1],0,0,T.texcoord[0],T.texcoord[1],ia[0],ik[0],ia[1],ik[1],0,io[2],io[3],0,0,T.texcoord[2],T.texcoord[3],ia[0],ik[0],ia[1],ik[1],0,io[4],io[5],0,0,T.texcoord[4],T.texcoord[5],ia[0],ik[0],ia[1],ik[1],0,io[6],io[7],0,0,T.texcoord[6],T.texcoord[7],ia[0],ik[0],ia[1],ik[1],0,io[8],io[9],0,0,T.texcoord[8],T.texcoord[9],ia[0],ik[0],ia[1],ik[1],0,io[10],io[11],0,0,T.texcoord[10],T.texcoord[11]]}}var im=id.textPos;if(im){if(!im.rtVertex){im.rtVertex=[];io=im.vertex;var h8=im.rtVertex;var ih=aI(il.lng);var ir=aI(il.lat);var iq=aI(h6);for(var ig=0,ip=io.length;ig<ip;ig+=12){h8.push(ih[0],ir[0],ih[1],ir[1],0,io[ig],io[ig+1],iq[0],iq[1],im.texcoord[0],im.texcoord[1]);h8.push(ih[0],ir[0],ih[1],ir[1],0,io[ig+2],io[ig+3],iq[0],iq[1],im.texcoord[2],im.texcoord[3]);h8.push(ih[0],ir[0],ih[1],ir[1],0,io[ig+4],io[ig+5],iq[0],iq[1],im.texcoord[4],im.texcoord[5]);h8.push(ih[0],ir[0],ih[1],ir[1],0,io[ig+6],io[ig+7],iq[0],iq[1],im.texcoord[6],im.texcoord[7]);h8.push(ih[0],ir[0],ih[1],ir[1],0,io[ig+8],io[ig+9],iq[0],iq[1],im.texcoord[8],im.texcoord[9]);h8.push(ih[0],ir[0],ih[1],ir[1],0,io[ig+10],io[ig+11],iq[0],iq[1],im.texcoord[10],im.texcoord[11])}}}}},updateLineLabel:function(ib,iH,ix,ir,it){ib=ib||[];var il=this.map;var ie=il.getZoomUnits();for(var iG=0,iE=ib.length;iG<iE;iG++){var ia=ib[iG];if(!ia.cachedIsDel){continue}if(!iH&&!ix&&ir.cacheState&&ir.cacheState[it]){ia.isDel=ia.cachedIsDel[it];if(typeof ia.isDel==="undefined"){ia.isDel=ia.cachedIsDel[it]=true}}if(ia.isDel){continue}if(!ia.styleText||ia.styleText.length===0){continue}var ic=ia.mcInTile;var iA=ic.x;var iy=ic.y;var iq=ia.wordsInfo;var io=ia.labelAngle;var ij=false;var iz=0;if(ix!==0){var ik=iq[0].angle;var iD=this.calcLoopHeading(ik-ix);if(iD>45&&iD<315){if(iD>45&&iD<=135){iz=270}else{if(iD>135&&iD<=225){iz=180}else{if(iD>225&&iD<315){iz=90}}}if(io>225&&io<=315&&iz<=180){ij=true}else{if((io>=0&&io<=45||io>=315&&io<360)&&iz>=180){ij=true}}}}for(var iF=0,ig=iq.length;iF<ig;iF++){var iC=iq[iF];var ii=iC.calcInfo;var iw=iC.offset[0];var iu=iC.offset[1];if(!iC.size){continue}var e=iC.size[0];var T=iC.size[1];var ih=iC.angle;if(!ii){ii={}}if(ix!==ii.mapHeading||ie!==ii.zoomUnits){ii.mapHeading=ix;ii.zoomUnits=ie;if(ij){var im=iq[ig-1-iF];iw=im.offset[0];iu=im.offset[1];ih=im.angle}var h7=iA+iw*ie;var h6=iy+iu*ie;ii.rotationCenter={lng:h7,lat:h6};ii.calcHeading=iz;ii.angle=ih;ii.offsetX=iw;ii.offsetY=iu;iC.calcInfo=ii}if(!iC.rtVertex){iC.rtVertex=[]}iC.rtVertex.length=0;var ip=ii.calcHeading+ii.angle;var h8=ii.rotationCenter;iw=ii.offsetX;iu=ii.offsetY;var h9=Math.round(iw-e/2);var iB=Math.round(iw+e/2);var iv=Math.round(iu+T/2);var id=Math.round(iu-T/2);iC.rtVertex.push(iA,iy,iC.z,h9,id,h8.lng,h8.lat,ip,iC.texcoord[0],iC.texcoord[1],iA,iy,iC.z,iB,id,h8.lng,h8.lat,ip,iC.texcoord[2],iC.texcoord[3],iA,iy,iC.z,iB,iv,h8.lng,h8.lat,ip,iC.texcoord[4],iC.texcoord[5],iA,iy,iC.z,h9,id,h8.lng,h8.lat,ip,iC.texcoord[6],iC.texcoord[7],iA,iy,iC.z,iB,iv,h8.lng,h8.lat,ip,iC.texcoord[8],iC.texcoord[9],iA,iy,iC.z,h9,iv,h8.lng,h8.lat,ip,iC.texcoord[10],iC.texcoord[11])}}},calcLoopHeading:function(e){while(e>=360){e-=360}while(e<0){e+=360}return e},fixDataFormat:function(ie){var h6=this.fixedLabelData;var e=this.lineLabelData;var T=this.highlightLabelData;var io=0;var ia=0;var ik=0;var il;if(this.currentSelectedLabel){var h9=this.getLabelByUid(this.currentSelectedLabel.guid,this.currentSelectedLabel.tilePosStr);if(!h9||h9.isDel){h6[io]=this.currentSelectedLabel.formatedData;io++;T[ik]=this.currentSelectedLabel.formatedData;ik++}}for(var ij=0;ij<ie.length;ij++){var ic=ie[ij];var ib=ic.fixedLabel;var h7=ic.indoorLabel;var ii=ic.lineLabel;var im={highlightLabelData:T,highlightLabelDataLen:ik};il=this.fixFixedLabelDataFormat(ib,ic,h6,io,im);io=il[0];ik=il[1];il=this.fixFixedLabelDataFormat(h7,ic,h6,io,im,true);io=il[0];ik=il[1];e[ia]={tileInfo:ic.tileInfo,lineLabels:[]};for(var ih=0;ih<ii.length;ih++){if(ii[ih].isDel){continue}var id=ii[ih].wordsInfo;if(id){for(var ig=0;ig<id.length;ig++){if(!id[ig].rtVertex){continue}var h8=id[ig].formatedData;if(!h8){h8={textureSource:ic.textureSources[ii[ih].processedInZoom],textureHeight:ic.textureHeights[ii[ih].processedInZoom],renderData:{vertex:id[ig].rtVertex,textureCoord:id[ig].texcoord}};id[ig].formatedData=h8}e[ia].lineLabels.push(h8)}}}ia++}h6.length=io;e.length=ia;T.length=ik;return[e,h6,T]},fixFixedLabelDataFormat:function(ia,id,ie,ib,T,ic){var h8=T.highlightLabelData;var e=T.highlightLabelDataLen;for(var i=0;i<ia.length;i++){if(ia[i].isDel){continue}var h9=ia[i].textPos;var h7=ia[i].iconPos;var h6=null;if(h9&&h9.rtVertex){if(!ia[i].formatedData){h6={guid:ia[i].guid,guidExt:ia[i].guidExt,tilePosStr:ia[i].tilePosStr,zoom:ia[i].zoom,tempRank:ia[i].tempRank,textureSource:id.textureSources[ia[i].processedInZoom],textureHeight:id.textureHeights[ia[i].processedInZoom],renderData:{vertex:h9.rtVertex,textureCoord:h9.texcoord}};if(ic&&ia[i].onDefaultFloor===false){h6.textureSource=id.indoorTextureSources[ia[i].processedInZoom];h6.textureHeight=id.indoorTextureHeights[ia[i].processedInZoom]}ia[i].formatedData=h6}else{h6=ia[i].formatedData;h6.tempRank=ia[i].tempRank}if(this.currentSelectedLabel&&h6.guid===this.currentSelectedLabel.guid&&h6.tilePosStr===this.currentSelectedLabel.tilePosStr){h8[e]=h6;e++}}if(h7&&h7.rtVertex){if(h6){if(!h6.iconRenderData){h6.iconRenderData={vertex:h7.rtVertex,textureCoord:h7.texcoord}}}else{h6={guid:ia[i].guid,guidExt:ia[i].guidExt,zoom:ia[i].zoom,tempRank:ia[i].tempRank,iconRenderData:{vertex:h7.rtVertex,textureCoord:h7.texcoord}};ia[i].formatedData=h6}}ie[ib]=h6;ib++}return[ib,e]},_refreshSpotData:function(){this._spotData.length=0;var ib=this.map;var h9=Math.floor(ib.getZoom());var T=this.map._featureMgr.getLabelData();if(T){for(var h7=0,h6=T.length;h7<h6;h7++){this._addFixedSpotData(T[h7].fixedLabel,h9);this._addFixedSpotData(T[h7].indoorLabel,h9)}}var ic=this.currentSelectedLabel;if(ic&&!this.getTileByLabelUid(ic.guid,ic.tilePosStr)){var h8=this._getSpotDataFromLabel(this.currentSelectedLabel);if(h8){this._spotData.push(h8)}}var ia=new be("onspotsdataready");ia.spots=this._spotData;ib._spotDataOnCanvas=this._spotData;ib.dispatchEvent(ia)},_addFixedSpotData:function(h7,h6){for(var e=0;e<h7.length;e++){var T=h7[e];if(!this.layer.isClickableLabel(T)||(T.guidExt===1&&T.startScale>h6)){continue}var i=h7[e].spot||this._getSpotDataFromLabel(h7[e]);if(i){this._spotData.push(i)}}},_getSpotDataFromLabel:function(T){var h8=this.map;if(!T.bds){return null}var e=T.bds.slice(0);var h6=null;if(T.iconPos){h6=new hH(T.pt.lng,T.pt.lat)}var i=T.name?T.name.replace("\\\\","<br>"):"";if(T.iconPos&&T.iconPos.iconType.indexOf("ditie")>-1&&h8.getZoom()>14){i=""}var h7={n:i,pt:new hH(T.pt.lng,T.pt.lat),userdata:{iconPoint:h6,uid:T.guid,name:i,mapPoi:true,type:T.iconPos?T.iconPos.iconType:"",rank:T.rank,zoom:T.zoom,tilePosStr:T.tilePosStr},bd:e,tag:"MAP_SPOT_INFO"};T.spot=h7;return h7},drawLabelsOnCanvas:function(i,e){if(this._labelTextCanvas){this._labelTextCanvas.drawLabelsOnCanvas(i,e)}}});function f6(e){this._map=e;this.virtualTile={custom:true,label:{fixedLabel:[],indoorLabel:[],lineLabel:[],textureHeights:[],status:"ready"},tileInfo:{col:0,row:0,zoom:0,useZoom:0,loopOffsetX:0},status:"ready"};this.virtualTile.label.tileInfo=this.virtualTile.tileInfo;this.init()}f6.prototype.init=function(){var T=this._map;var i=this;function e(){i.updateLabels()}T.addEventListener("add_tile_labels",e);T.addEventListener("onremove_tile_labels",e);T.addEventListener("onclear_labels",e)};f6.prototype.updateLabels=function(){var i=this._map.tileMgr.getLabelTextCanvas();var T=this._map;var e=this;i.drawCustomLabelsOnCanvas(T._customTileLabels,function(h7){var h6=e.virtualTile;if(h7){h6.label.textureHeights[0]=[h7.height]}h6.label.fixedLabel=T._customTileLabels;var h8=new be("oncustom_labels_ready");h8.virtualTile=h6;h8.labelCanvas=h7;h8.imgKey=br.getGUID("custom_labels_");T.dispatchEvent(h8)})};br.register(function(e){e._customLabelMgr=new f6(e)});var ap=function(ig,ie){var id={"\x64\x78\x69\x64\x6d":"\x78\x78\x69","\x68\x78\x61\x65\x65":"\x68\x6c\x63\x6d","\x6d\x65\x68\x64\x61":"\x69\x6d\x61","\x6d\x69\x65\x6c\x78":function(T,ir){return T+ir},"\x6d\x68\x65\x68\x6d":"\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72","\x68\x64\x65\x65\x6c":function(ir,T){return ir(T)},"\x61\x61\x61\x69\x65":"\x31\x2e\x31\x2e\x32","\x6d\x6c\x78\x68\x69":"\x43\x68\x61\x72","\x65\x6c\x65\x61\x78":function(it,ir,T){return it(ir,T)},"\x63\x6d\x6d\x69\x63":function(it,ir,T){return it(ir,T)}};var ic=id["\x61\x61\x61\x69\x65"];function ib(ix,iw){var iv=id["\x64\x78\x69\x64\x6d"];while(iv!==id["\x68\x78\x61\x65\x65"]){switch(iv){case"\x64\x63\x78":return ir;case"\x6d\x69\x64":for(var iu=0;iu<T;iu++){var it=iw(ix[iu]);ir["\x70\x75\x73\x68"](it)}iv="\x64\x63\x78";break;case id["\x6d\x65\x68\x64\x61"]:var ir=[];iv="\x6d\x69\x64";break;case id["\x64\x78\x69\x64\x6d"]:var T=ix["\x6c\x65\x6e\x67\x74\x68"];iv=id["\x6d\x65\x68\x64\x61"];break}}}var ia,h9,h8,h7,h6,i=decodeURIComponent,e=id["\x6d\x6c\x78\x68\x69"],iq="";var ip=[ap];ia="\x64\x65";h9="\x66\x72";h8="\x6f";h6=id["\x6d\x69\x65\x6c\x78"](h9,h8)+"\x6d";h7="\x43\x6f"+ia;var io=function(T){return id["\x6d\x69\x65\x6c\x78"](T,iq)[id["\x6d\x68\x65\x68\x6d"]][h6+e+h7](T)};var ik=function(T){return ib(T,function(ir){return io(ir)})};var ii=ik["\x63\x61\x6c\x6c"](io,[39,34,37,96,60,120,97,65,98,66,99,67,100,68,101,69,102,70,103,110,109,111,112,48,49,50,51,52,53,54,55,56,57]);var ih=id["\x65\x6c\x65\x61\x78"](ib,[28782,27702,26416,25167,24183],function(ir){return id["\x68\x64\x65\x65\x6c"](i,ir)});var im=ik["\x63\x61\x6c\x6c"](ih,[22354,22749,24415,23346,22257,22688,24306,25174,23595,25547,22984,25690,22212,27547,21594,27210,23090,29193,22394,29368,29532,29459,29530,24146,24500,26352,27441,28788,29370,27673,26925,25249,24430]),il={};ih=ik(ih);var ij=new RegExp(ih["\x6a\x6f\x69\x6e"]("\x7c"));for(var ia=0;ia<ii["\x6c\x65\x6e\x67\x74\x68"];ia++){il[im[ia]]=ii[ia]}ie=id["\x63\x6d\x6d\x69\x63"](ib,ie["\x73\x70\x6c\x69\x74"](iq),function(T){return il[T]||T})["\x6a\x6f\x69\x6e"](iq);return id["\x63\x6d\x6d\x69\x63"](ib,ie["\x73\x70\x6c\x69\x74"](ij),function(ir){return id["\x68\x64\x65\x65\x6c"](i,ir)})}(this,"\u545a\x69\u5ef2\u5e77\x69\u72b8\x4d\u5ef2\u735a\x48\u7313\x73\x74\u6c36\u545a\u58a0\x69\x6c\u5ef2\u5e77\u545a\u5ef2\u59c8\u545a\u735c\u5e77\u56c4\u545a\u735c\u6c36\u5ef2\u5ef2\x68\u624f\u58a0\u59c8\u56c4\u624f\u5ef2\u59c8\u56c4\u56c4\u624f\u5ef2\u735a\u735a\x6c\x69\u59c8\u5ef2\x74\x69\u7313\u72b8\u5f5f\u66f0\u7209\x6a\u5ef2\x76\u5ef2\x73\u59c8\x72\x69\u735a\x74\u706e\u56c4\x68\x6c\u624f\u735c\u59c8\x69\u59c8\u6c36\u545a\u735c\x6c\u706e\u58a0\u56c4\u56c4\u6730\u735c\x6c\u58a0\u5ef2\u706e\u5ef2\u5ef2\u56c4\u6c36\u545a\u5ef2\u5ef2\x6c\u58a0\u706e\x69\u735c\u735a\u7313\x72\x74\x53\u59c8\x72\x69\u735a\x74\x73\x28\u5f5f\u66f0\u66f0\u706e\u58a0\u5ef2\u59c8\u56c4\u545a\u6730\x6c\u56c4\x6c\x68\u58a0\u624f\u58a0\x68\u735c\u706e\u577a\u545a\x74\u63cb\x6c\u7313\u5c2b\u6730\u58a0\u5ef2\u56c4\u5ef2\u59c8\u624f\u63cb\x6c\u7313\u5c2b\u63cb\x75\x69\x6c\u56c4\u545a\x72\u706e\x57\u545a\u5c2b\x4b\x69\x74\u63cb\x6c\u7313\u5c2b\u63cb\x75\x69\x6c\u56c4\u545a\x72\u706e\x4d\u7313\x7a\u63cb\x6c\u7313\u5c2b\u63cb\x75\x69\x6c\u56c4\u545a\x72\u5e77\u56c4\x69\u545a\u545a\u5ef2\u6730\u56c4\x68\u56c4\u545a\u59c8\u6730\u545a\u5ef2\x69\u59c8\u5ef2\u6730\u59c8\x69\u5ef2\u6c36\u58a0\u58a0\u735c\x68\u735c\u6c36\u59c8\x72\u545a\u5ef2\x74\u545a\x4f\u5c2b\x6a\u545a\u59c8\x74\x55\x52\x4c\u6730\u5ef2\u5ef2\u735c\u6730\x77\u545a\u5c2b\x6b\x69\x74\x55\x52\x4c\u706e\x68\x68\u56c4\x69\u59c8\u706e\x68\u56c4\u735c\u56c4\x68\u706e\u58a0\u545a\x68\x69\u545a\u5e77\x69\u72b8\x69\x74\u6730\u5ef2\u5ef2\u545a\u6730\u5ef2\u5ef2\x69\u59c8\u6c36\u56c4\x68\u735c\u6c36\u545a\u545a\x69\u706e\u58a0\x69\x69\u5e77\u58a0\u59c8\u545a\u624f\x68\u5ef2\x68\u6730\x68\u5ef2\u59c8\u624f\u5ef2\x6c\u735c\u6c36\u545a\u5ef2\u5ef2\u624f\u59c8\u56c4\u56c4\u6730\u5ef2\x69\x69\u6c36\u5ef2\u5ef2\u58a0\u6730\u5ef2\u5ef2\u59c8\u624f\u5ef2\x6c\u58a0\u6c36\x6c\u59c8\x69\u6c36\x6c\u58a0\u59c8\u706e\u58a0\x69\x69\u56c4\u6c36\x68\u545a\x6c\u5e77\x69\u545a\x6c\u5e77\u56c4\u5ef2\x69\x69\u624f\u735c\u545a\u545a\u6c36\x69\u545a\x68\u6c36\x69\u5ef2\u5ef2\u6730\u58a0\u59c8\x69\u706e\x6c\u5ef2\u58a0\u6730\u5ef2\x69\u545a\u6730\u56c4\u545a\x68\u6730\x68\u56c4\x69\u624f\x68\x6c\u56c4\u6730\u5ef2\u735c\u735c\u624f\u545a\u59c8\x68\u5ef2\u56c4\u6c36\u5ef2\u56c4\u5ef2\u5ef2\u545a\u624f\u59c8\x69\u5ef2\x69\x69\u706e\u59c8\u5ef2\x69\u59c8\u5ef2\u6c36\u59c8\u7313\u72b8\u5a32\x69\u577a\u5e77\x73\x74\x79\x6c\u545a\u706e\u735c\u545a\u735c\u545a\x6c\u5e77\x68\u545a\u56c4\u735c\x69\u624f\u545a\u545a\u545a\u6c36\x72\u5ef2\x74\x69\u7313\u6730\x69\u5ef2\u58a0\u6c36\u58a0\u5ef2\x6c\u58a0\x6c\u6730\u7313\u72b8\x73\x74\x79\x6c\u545a\x5f\x6c\u7313\u5ef2\u56c4\u545a\u56c4\u5e77\u545a\x69\x68\u5ef2\u58a0\u6c36\u58a0\u5ef2\u56c4\u58a0\u5ef2\u706e\u5ef2\u56c4\x68\x69\u58a0\u5e77\u5ef2\x72\x72\x57\u7313\x72\x6b\u545a\x72\u5e77\x6c\u545a\u72b8\u577a\x74\x68\u706e\u59c8\u5ef2\u735c\u5ef2\x6c\u6c36\x69\x73\x53\u545a\u72b8\u56c4\u7209\x53\u624f\x68\u735c\x6c\u6c36\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\u645a\x75\x73\x74\u7313\u735c\x53\x74\x79\x6c\u545a\x49\u72b8\u5a32\u7313\u6730\x6c\u56c4\u545a\u5e77\u59c8\u58a0\u5ef2\u5ef2\u59c8\u6c36\x73\x74\x72\x69\u72b8\u577a\u5e77\u5ef2\u58a0\u5ef2\u735c\x69\u6730\u59c8\x68\x68\u545a\u545a\u706e\x68\x68\u56c4\u545a\u735c\u6c36\x68\u5ef2\x72\u56c4\x77\u5ef2\x72\u545a\u645a\u7313\u72b8\u59c8\x75\x72\x72\u545a\u72b8\u59c8\x79\u5e77\u56c4\u58a0\x6c\x6c\u735c\u6730\x6c\u5ef2\u5ef2\x69\u5ef2\u5e77\u59c8\u5ef2\u72b8\x55\x73\u545a\x57\u545a\u5c2b\u6256\x73\x73\u545a\u735c\u5c2b\x6c\x79\u706e\u5ef2\u58a0\u5ef2\u624f\u545a\x68\u56c4\u56c4\u545a\u6c36\u5ef2\u545a\x69\u735c\u5ef2\u706e\u59c8\u545a\u5ef2\u5ef2\u545a\u706e\u545a\u59c8\u59c8\x6c\u59c8\u624f\u5ef2\u59c8\x69\x68\u5ef2\u706e\u58a0\u545a\u5ef2\x69\u545a\u624f\u5ef2\x72\x72\x50\u545a\u72b8\u56c4\x69\u72b8\u577a\u6b9b\u5ef2\x74\u5ef2\u624f\u735c\u5ef2\x69\u6730\x69\u59c8\u5ef2\u59c8\u545a\u6730\u5ef2\u58a0\u545a\u58a0\x69\u6c36\u56c4\x69\u5ef2\u56c4\u5e77\u545a\x6c\x68\u6c36\x5f\u735a\u5ef2\x72\x73\x69\u72b8\u577a\x54\x69\x6c\u545a\x49\u72b8\u5a32\u7313\u5e77\x68\x6c\u5ef2\u59c8\u545a\u6730\x6c\x69\u545a\u56c4\u5ef2\u6c36\x5f\u59c8\u5c2b\x6b\u5e77\u56c4\u5ef2\x74\u5ef2\u6c36\x5f\u735a\u5ef2\x72\x73\x69\u72b8\u577a\x54\x69\x6c\u545a\x4b\u545a\x79\u6c36\u58a0\x69\u56c4\u545a\x69\u6c36\x68\x69\x6c\u545a\u56c4\u6730\u545a\x6c\u56c4\u735c\u56c4\u6c36\x73\x68\x69\u5a32\x74\u6c36\u5ef2\u5ef2\u5ef2\x6c\u5ef2\u706e\u5ef2\u545a\u59c8\u56c4\x68\u6c36\u545a\u545a\u58a0\u6730\x74\x69\x6c\u545a\x49\u72b8\u5a32\u7313\u5e77\u5ef2\u5ef2\u545a\x6c\u545a\u624f\u59c8\u5c2b\x6b\u6c36\x68\u735c\x68\u545a\x69\u5e77\x69\x68\u5ef2\u5e77\x73\u7313\x75\x72\u59c8\u545a\u624f\x77\u7313\x72\x6b\u545a\x72\u735c\u577a\x72\u624f\u56c4\x69\u545a\x68\u56c4\u624f\x5f\x69\x73\u63cb\x75\x73\x79\u706e\u59c8\u5ef2\u545a\u545a\u56c4\u5e77\u735a\x75\x73\x68\u624f\u735c\x69\u72b8\u706e\x6c\u7313\u5ef2\u56c4\x54\x69\x6c\u545a\u6b9b\u5ef2\x74\u5ef2\u5e77\x75\x72\x6c\u706e\x74\x69\x6c\u545a\x4b\u545a\x79\u5e77\u5ef2\u545a\u5ef2\u545a\u5ef2\u6730\x6c\u735c\u56c4\x68\u545a\u6730\u7313\u72b8\x73\x74\x79\x6c\u545a\x7a\u7313\u7313\u735c\x75\u735a\u56c4\u5ef2\x74\u545a\u6730\x68\x6c\u545a\u5ef2\u5ef2\u624f\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\u645a\x75\x73\x74\u7313\u735c\x53\x74\x79\x6c\u545a\x49\u72b8\u5a32\u7313\x5a\u7313\u7313\u735c\u6c36\u5ef2\u5ef2\u5ef2\u5ef2\u56c4\u6730\u63cb\x72\u7313\x77\x73\u545a\x72\u6c36\u59c8\u58a0\u545a\u5ef2\u59c8\u706e\x74\u545a\u58a0\x74\x53\x69\x7a\u545a\x52\u5ef2\x74\x69\u7313\u6c36\u58a0\x6c\u545a\u706e\u545a\u545a\u5ef2\u624f\u735c\u5ef2\u735a\u624f\u56c4\u545a\x73\x74\x72\u7313\x79\u624f\x74\u545a\x72\u735c\x69\u72b8\u5ef2\x74\u545a\u6c36\u5ef2\x6c\u56c4\x68\u5ef2\u624f\u5ef2\u545a\x68\u58a0\u5ef2\u5e77\u545a\u56c4\u59c8\u5ef2\u5ef2\u6c36\x77\u7313\x72\u56c4\x53\u735a\u5ef2\u59c8\u545a\x52\u5ef2\x74\x69\u7313\u6c36\x69\u5ef2\u735c\u56c4\x68\u6c36\x68\x69\u59c8\u545a\x69\u5e77\u59c8\u59c8\u545a\u735c\u6c36\u56c4\x68\u59c8\u6c36\x6c\u735c\u545a\u6c36\x6c\u735c\u545a\x68\u545a\u5e77\x69\u5ef2\x68\u624f\x6c\u735c\u545a\x69\u735c\u6730\x68\x68\x69\x69\u5ef2\u6c36\u59c8\u5ef2\u59c8\u5ef2\x69\u706e\u58a0\u5ef2\u735c\u6730\u58a0\u545a\x68\u545a\u545a\u624f\u56c4\x68\u59c8\u56c4\u5ef2\u624f\x69\u56c4\x5f\u5e77\u545a\u58a0\u56c4\u545a\u5ef2\u624f\x74\x69\x6c\u545a\x54\x79\u735a\u545a\x4e\u5ef2\u735c\u545a\u624f\x69\u545a\u5ef2\u735c\x6c\u706e\u735c\x68\u545a\x68\u59c8\u706e\u735c\u5ef2\u5ef2\x68\u59c8\u6c36\u59c8\u7313\x6c\u6c36\x72\u7313\x77\u5e77\x7a\u7313\u7313\u735c\u706e\x73\u735a\x6c\x69\u59c8\u545a\u6c36\u56c4\x6c\x6c\u56c4\u5e77\u56c4\u545a\u56c4\u6c36\u56c4\u545a\x69\u706e\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\u7209\u545a\u5ef2\x74\x75\x72\u545a\x53\x74\x79\x6c\u545a\u5e77\u7209\u545a\u5ef2\x74\x75\x72\u545a\x53\x74\x79\x6c\u545a\u706e\u545a\x6c\x6c\u6c36\u545a\u5ef2\u545a\u624f\u59c8\x69\x6c\u706e\u545a\u56c4\u59c8\u706e\u735c\u545a\u735c\u6c36\x69\u56c4\u5ef2\u5e77\u735c\x68\u5ef2\u5e77\x6c\x69\u5ef2\u624f\u56c4\x6c\u5ef2\u706e\x69\u58a0\x68\u6730\u545a\u58a0\x68\u5e77\x69\u56c4\u56c4\u6730\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\x49\u59c8\u7313\u72b8\x53\u545a\x74\x49\u72b8\u5a32\u7313\u624f\u58a0\x68\u5ef2\u6730\u59c8\u5ef2\u5ef2\u706e\x69\u56c4\x6c\u6c36\x6c\u545a\x69\u706e\x69\u59c8\u7313\u72b8\x53\u545a\x74\x49\u72b8\u5a32\u7313\u624f\u5ef2\u735c\u56c4\u624f\x5f\u56c4\x69\x73\u735a\x6c\u5ef2\x79\x4f\u735a\x74\x69\u7313\u72b8\x73\u5e77\u735a\u7313\x69\u706e\u735a\u7313\x69\x54\u545a\u58a0\x74\u6730\u735c\u58a0\u5ef2\x69\x6c\u706e\u545a\u545a\x68\u545a\u56c4\u6730\u5ef2\u5ef2\x69\x69\x69\u6c36\u735c\u58a0\u545a\x68\u5ef2\u6c36\u545a\x6c\x6c\u56c4\x6c\u6730\u5ef2\u58a0\u5ef2\u5ef2\u58a0\u6730\u59c8\x6c\u735c\u56c4\u545a\u6730\x69\u72b8\u56c4\u7313\u7313\x72\x53\x74\x79\x6c\u545a\u6730\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\x49\u72b8\u56c4\u7313\u7313\x72\x53\x74\x79\x6c\u545a\u6c36\u59c8\u545a\u545a\u6c36\u735a\u7313\x73\x74\x4d\u545a\x73\x73\u5ef2\u577a\u545a\u624f\x69\u545a\u58a0\u56c4\u58a0\u5e77\u58a0\x6c\x69\u6730\u5ef2\u59c8\x6c\u5e77\u577a\u545a\x74\x4d\u5ef2\u735a\x53\x74\x79\x6c\u545a\x49\u56c4\u5e77\u59c8\u59c8\u5ef2\x69\u5ef2\u706e\u545a\u5ef2\x69\x68\u5ef2\u6730\x69\u5ef2\x69\u545a\x69\u706e\u735c\u5ef2\u58a0\u58a0\x6c\u624f\u645a\x75\x73\x74\u7313\u735c\u624f\u545a\u56c4\u59c8\u58a0\u59c8\u6730\u59c8\x75\x73\x74\u7313\u735c\x53\x74\x79\x6c\u545a\x49\u72b8\u5a32\u7313\x5f\u6c36\u59c8\x68\x68\u624f\u735c\x6c\u58a0\u59c8\u59c8\u5e77\x68\x69\u56c4\u59c8\u58a0\u706e\u5ef2\u59c8\u735c\u735c\u735c\u6730\u56c4\x69\u545a\x68\u59c8\u624f\u5a32\u545a\u5ef2\x74\x75\x72\u545a\x53\x74\x79\x6c\u545a\u5e77\u545a\x6c\u5ef2\u735c\x6c\u624f\x69\u545a\u58a0\u545a\u58a0\u706e\u5ef2\u56c4\u59c8\u545a\u56c4\u624f\x69\u72b8\u56c4\u545a\u58a0\x4f\u5a32\u706e\u59c8\x75\x73\x74\u7313\u735c\u6730\u545a\u545a\u56c4\u5ef2\u545a\u624f\x6c\x68\u545a\x68\x6c\u6c36\u5ef2\u545a\u59c8\u545a\u59c8\u6730\u59c8\x6c\u59c8\x68\u5ef2\u5e77\u58a0\x68\u545a\u5ef2\u58a0\u706e\x69\u5ef2\x69\u59c8\u58a0\u6730\x69\x69\x69\u735c\u58a0\u6c36\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x79\u706e\u5ef2\x69\x68\u6730\u735c\x69\u59c8\u56c4\u5ef2\u624f\u58a0\x68\u545a\u5ef2\u5ef2\u5e77\u545a\u59c8\x68\u59c8\x68\u6c36\u545a\u58a0\x6c\u735c\x69\u6c36\u735c\x69\x6c\x69\u545a\u624f\u59c8\x75\x73\x74\u7313\u735c\x4d\u5ef2\u735a\x53\x74\x79\x6c\u545a\u5e77\u735c\u58a0\u58a0\u735c\u545a\u706e\u545a\u58a0\x74\u545a\u72b8\u56c4\u5e77\u735a\x72\u7313\x74\u7313\x74\x79\u735a\u545a\u624f\u58a0\u58a0\u5ef2\u624f\u58a0\u59c8\u5ef2\u59c8\u5e77\u545a\u58a0\x6c\u6c36\u545a\u58a0\u545a\u706e\u735c\x68\u59c8\u5e77\u5ef2\u545a\u735c\u58a0\u545a\u6730\u59c8\u59c8\x6c\u735c\x68\u624f\u735c\u56c4\u735c\u706e\x69\x69\u545a\u58a0\u624f\u735c\u545a\u58a0\u5ef2\u5ef2\u706e\u7313\u72b8\u545a\x72\x72\u7313\x72\u6c36\u735a\x72\u545a\x76\u545a\u72b8\x74\u6b9b\u545a\u5a32\u5ef2\x75\x6c\x74\u6c36\u56c4\u545a\x6c\u545a\u58a0\u5e77\u5ef2\x68\u59c8\u706e\x6c\u5ef2\u735c\x68\u5ef2");(function(e,T){var i=function(h6){while(--h6){e.push(e.shift())}};i(++T)}(ap,260));var ao=function(e,T){e=e-0;var i=ap[e];return i};function eX(i){var h8={"\x64\x65\x6c\x65\x78":function(ia,h9){return ia(h9)},"\x61\x65\x6d\x78\x65":ao("0x0"),"\x63\x63\x6c\x6d\x68":function(ia,h9){return ia!==h9},"\x61\x61\x61\x65\x78":ao("0x1"),"\x6d\x65\x78\x61\x61":ao("0x2"),"\x65\x78\x68\x61\x61":ao("0x3"),"\x6c\x61\x6d\x68\x61":function(ia,h9){return ia(h9)},"\x65\x78\x69\x6c\x61":function(ia,h9){return ia(h9)},"\x65\x61\x63\x65\x6d":ao("0x4")};var h7=h8[ao("0x5")];while(h8[ao("0x6")](h7,h8["\x61\x61\x61\x65\x78"])){switch(h7){case"\x6d\x68\x63":return h6;case"\x78\x78\x61":var h6=null;h7=ao("0x7");break;case ao("0x7"):try{var T="\x65\x69\x61";while(h8[ao("0x6")](T,ao("0x8"))){switch(T){case h8[ao("0x9")]:h6[ao("0xa")]=function(h9){h9[ao("0xb")]();h6=h8[ao("0xc")](u,i)};T="\x69\x69\x65\x78";break;case ao("0xd"):h6=new Worker(i);T=h8[ao("0x9")];break;case h8["\x65\x78\x68\x61\x61"]:h6=h8[ao("0xe")](u,i);T=ao("0x8");break;case ao("0xf"):T=dB[ao("0x10")]?ao("0xd"):ao("0x3");break}}}catch(e){h6=h8[ao("0x11")](u,i)}h7=h8[ao("0x12")];break}}}function u(ig){var ie={"\x61\x78\x65\x6d\x65":ao("0x13"),"\x65\x61\x61\x6c\x78":ao("0x14"),"\x78\x61\x6d\x78\x61":"\x22\x29\x3b","\x78\x61\x63\x64\x65":ao("0x15"),"\x6c\x64\x6c\x68\x78":ao("0x16"),"\x78\x61\x64\x61\x63":ao("0x17"),"\x64\x69\x65\x65\x61":"\x61\x65\x6c","\x64\x68\x64\x65\x63":function(ih,T){return ih+T},"\x65\x61\x69\x63\x61":"\x69\x6d\x70\x6f\x72\x74\x53\x63\x72\x69\x70\x74\x73\x28\x22","\x78\x78\x6d\x68\x6d":ao("0x18"),"\x68\x68\x64\x69\x63":ao("0x19"),"\x68\x64\x6d\x64\x68":ao("0x1a"),"\x78\x65\x68\x69\x65":ao("0x1b")};var id=ao("0x1b");while(id!==ao("0x1c")){switch(id){case ao("0x1d"):try{var ic=ie["\x61\x78\x65\x6d\x65"];while(ic!==ao("0x19")){switch(ic){case ie[ao("0x1e")]:try{h8=new Blob([ao("0x1f")+ig+ie["\x78\x61\x6d\x78\x61"]],{type:ao("0x17")})}catch(ib){var ia=ie[ao("0x20")];while(ia!==ie[ao("0x21")]){switch(ia){case ao("0x22"):h8=h9[ao("0x23")](ie[ao("0x24")]);ia=ao("0x16");break;case"\x78\x63\x64":var h9=new (window[(ao("0x25"))]||window[(ao("0x26"))]||window[(ao("0x27"))])();ia=ie[ao("0x28")];break;case"\x61\x65\x6c":h9["\x61\x70\x70\x65\x6e\x64"](ie[ao("0x29")](ie[ao("0x2a")],ig)+"\x22\x29\x3b");ia=ao("0x22");break}}}ic=ao("0x2b");break;case ao("0x13"):var h8;ic=ie[ao("0x1e")];break;case ie[ao("0x2c")]:var h7=h6[ao("0x2d")](h8);ic=ao("0x2e");break;case ao("0x2b"):var h6=window["\x55\x52\x4c"]||window[ao("0x2f")];ic=ao("0x18");break;case ao("0x2e"):e=new Worker(h7);ic=ie[ao("0x30")];break}}}catch(i){}id=ie[ao("0x31")];break;case ie[ao("0x32")]:var e=null;id=ao("0x1d");break;case ao("0x1a"):return e}}}function gm(e){this[ao("0x33")](e)}var bj={"\x69\x6e\x69\x74":function(T){var i={"\x61\x64\x68\x69\x78":ao("0x34"),"\x65\x69\x68\x61\x78":function(h9,h8){return h9!==h8},"\x78\x61\x64\x78\x61":ao("0x35"),"\x63\x61\x6d\x61\x6c":function(h9,h8){return h9<h8},"\x63\x78\x61\x61\x63":"\x68\x6d\x6c","\x61\x78\x61\x6d\x69":ao("0x36"),"\x63\x68\x68\x65\x65":"\x6c\x64\x65","\x69\x63\x61\x63\x65":ao("0x37"),"\x61\x78\x65\x78\x69":function(h9,h8){return h9!==h8},"\x68\x6c\x61\x63\x65":"\x65\x65\x78","\x6c\x69\x65\x64\x61":ao("0x38"),"\x78\x69\x64\x65\x69":function(h8,h9){return h8>h9},"\x68\x69\x6c\x65\x64":ao("0x39"),"\x65\x6c\x64\x6d\x64":ao("0x3a"),"\x61\x61\x61\x6c\x61":ao("0x3b"),"\x61\x65\x63\x64\x68":ao("0x3c"),"\x61\x64\x65\x78\x6d":ao("0x3d"),"\x61\x61\x65\x6c\x65":ao("0x3e"),"\x68\x6d\x68\x65\x69":ao("0x3f"),"\x64\x69\x65\x68\x64":ao("0x40"),"\x63\x61\x65\x65\x64":ao("0x41"),"\x65\x68\x64\x64\x65":ao("0x42"),"\x61\x65\x69\x6d\x61":"\x61\x78\x61","\x63\x65\x61\x61\x65":(window.location.protocol === "http:" ? "http:" : "https:") + "//api.map.baidu.com/res/webgl/10/worker_wasm_4i3lbq.js","\x6c\x61\x61\x69\x61":ao("0x43"),"\x65\x63\x63\x6c\x63":(window.location.protocol === "http:" ? "http:" : "https:") + "//api.map.baidu.com/res/webgl/10/worker_asm_44f4nb.js","\x61\x63\x69\x68\x61":ao("0x44"),"\x78\x65\x61\x69\x65":function(h9,h8){return h9>h8},"\x61\x65\x61\x65\x61":ao("0x45"),"\x63\x61\x65\x78\x6c":"\x61\x69\x6c","\x6c\x6d\x64\x68\x65":ao("0x46"),"\x68\x6c\x65\x61\x61":function(h9,h8){return h9<h8},"\x65\x63\x68\x61\x64":ao("0x47"),"\x61\x64\x61\x61\x65":function(h9,h8){return h9!==h8},"\x63\x69\x61\x69\x69":ao("0x48"),"\x63\x61\x69\x63\x61":ao("0x49"),"\x6d\x65\x6d\x65\x6c":"\x73\x74\x72\x69\x6e\x67","\x61\x6c\x64\x68\x61":"\x61\x78\x68","\x68\x65\x64\x6d\x69":ao("0x4a"),"\x78\x61\x6c\x78\x6c":ao("0x4b"),"\x68\x68\x64\x65\x6d":ao("0x4c"),"\x78\x68\x69\x64\x6d":ao("0x4d"),"\x64\x78\x6c\x6c\x6d":ao("0x4e"),"\x61\x61\x61\x61\x64":ao("0x4f"),"\x63\x78\x65\x61\x63":ao("0x50"),"\x78\x6c\x61\x65\x64":ao("0x0"),"\x61\x65\x68\x78\x61":ao("0x51"),"\x65\x64\x63\x61\x61":ao("0x52"),"\x69\x61\x6d\x64\x68":function(h8){return h8()},"\x68\x69\x63\x65\x69":"\x69\x61\x78"};var e=i[ao("0x53")];while(i[ao("0x54")](e,i[ao("0x55")])){switch(e){case i[ao("0x56")]:if(typeof this["\x6d\x61\x70"][ao("0x57")][ao("0x58")]===i[ao("0x59")]){e=i["\x61\x6c\x64\x68\x61"];break}e=ao("0x43");break;case i[ao("0x5a")]:h7=2;e="\x68\x64\x69";break;case ao("0x5b"):e=this[ao("0x5c")]>1?ao("0x5d"):ao("0x0");break;case i[ao("0x5e")]:T["\x6f\x6e"](ao("0x5f"),function(){var ia=i["\x61\x64\x68\x69\x78"];while(i[ao("0x60")](ia,i[ao("0x61")])){switch(ia){case i[ao("0x62")]:for(var h9=0,h8=h6[ao("0x63")][ao("0x64")];i[ao("0x65")](h9,h8);h9++){h6[ao("0x63")][h9][ao("0x66")]=![]}ia=ao("0x67");break;case ao("0x36"):h6[ao("0x68")]=null;ia=ao("0x69");break;case i[ao("0x6a")]:if(typeof this[ao("0x57")][ao("0x58")]!==ao("0x6b")){ia=i[ao("0x6c")];break}ia=i[ao("0x61")];break;case i[ao("0x6d")]:h6["\x73\x74\x72\x69\x6e\x67\x69\x66\x69\x65\x64\x43\x75\x73\x74\x6f\x6d\x53\x74\x79\x6c\x65\x49\x6e\x66\x6f\x5a\x6f\x6f\x6d"]=[];ia=ao("0x35");break}}});e=i[ao("0x6e")];break;case i["\x78\x68\x69\x64\x6d"]:var h7=navigator[ao("0x6f")]||4;e=i[ao("0x70")];break;case i[ao("0x71")]:c4[ao("0x72")](function(id){var ib="\x61\x69\x6c";while(ib!==ao("0x45")){switch(ib){case"\x68\x65\x6c":ib=id?ao("0x73"):i[ao("0x74")];break;case i[ao("0x75")]:ic=i[ao("0x76")];ib=i[ao("0x71")];break;case ao("0x42"):ic=i[ao("0x77")];ib=i[ao("0x71")];break;case i[ao("0x78")]:if(i[ao("0x79")](h6[ao("0x7a")][ao("0x64")],0)){ib=ao("0x7b");break}ib=ao("0x45");break;case ao("0x43"):for(var ia=0;ia<h7;ia++){var h9=eX(ic);h9["\x6f\x6e\x6d\x65\x73\x73\x61\x67\x65"]=function h8(ij){var ii=i[ao("0x7c")];while(i[ao("0x7d")](ii,ao("0x7e"))){switch(ii){case ao("0x7f"):this[ao("0x80")]=null;ii=i[ao("0x81")];break;case ao("0x40"):T["\x66\x69\x72\x65"](ik);ii=ao("0x7e");break;case i[ao("0x82")]:this[ao("0x83")]&&this[ao("0x83")](ij[ao("0x84")],this[ao("0x85")]);ii=ao("0x3c");break;case ao("0x3d"):if(i[ao("0x86")](h6[ao("0x7a")][ao("0x64")],0)){ii=i[ao("0x87")];break}ii=i[ao("0x88")];break;case"\x78\x63\x65":var ih=h6[ao("0x7a")][ao("0x89")]();ii="\x63\x64\x64";break;case i[ao("0x8a")]:this["\x5f\x63\x62\x6b"]&&this["\x5f\x63\x62\x6b"](null,this[ao("0x85")]);ii=i[ao("0x8b")];break;case ao("0x8c"):this[ao("0x85")]=null;ii=i["\x61\x64\x65\x78\x6d"];break;case i[ao("0x7c")]:ii=ij["\x64\x61\x74\x61"]?"\x78\x69\x69":i["\x61\x61\x61\x6c\x61"];break;case ao("0x3f"):h6["\x6c\x6f\x61\x64\x54\x69\x6c\x65\x44\x61\x74\x61"](ih["\x75\x72\x6c"],ih[ao("0x8d")],ih["\x74\x69\x6c\x65\x4b\x65\x79"],il);ii=ao("0x3a");break;case i[ao("0x8e")]:var il=ih[ao("0x8f")];ii=i[ao("0x90")];break;case ao("0x91"):ik[ao("0x92")]=ao("0x93");ii=i[ao("0x94")];break;case ao("0x3a"):var ik=new be("\x6f\x6e\x72\x65\x66\x72\x65\x73\x68");ii=ao("0x91");break;case ao("0x41"):this[ao("0x83")]=null;ii=ao("0x7f");break;case ao("0x3c"):this[ao("0x95")]=![];ii=i[ao("0x96")];break}}};h6[ao("0x63")][ao("0x97")](h9)}ib="\x6c\x78\x63";break;case ao("0x7b"):for(var ig=0;ig<Math[ao("0x98")](h6[ao("0x7a")][ao("0x64")],h7);ig++){var ie=h6[ao("0x7a")][ao("0x89")]();h6[ao("0x99")](ie[ao("0x9a")],ie[ao("0x8d")],ie[ao("0x9b")],ie[ao("0x8f")])}ib=i[ao("0x9c")];break;case i["\x63\x61\x65\x78\x6c"]:var ic;ib=i[ao("0x9d")];break}}});e=ao("0x4b");break;case i[ao("0x6e")]:T["\x6f\x6e"](ao("0x9e"),function(){for(var h8=0,h9=h6["\x61\x72\x72\x57\x6f\x72\x6b\x65\x72"][ao("0x64")];i[ao("0x9f")](h8,h9);h8++){h6[ao("0x63")][h8][ao("0x66")]=![]}if(typeof this[ao("0x57")][ao("0x58")]!==ao("0x6b")){h6[ao("0x68")]=null;h6[ao("0xa0")]=[]}});e=i[ao("0xa1")];break;case ao("0x51"):this[ao("0xa0")]=[];e=ao("0x43");break;case i["\x63\x78\x65\x61\x63"]:this[ao("0x63")]=[];e=ao("0x73");break;case i[ao("0x70")]:if((gi()||D[ao("0xa2")]["\x69\x65"])&&h7>2){e="\x69\x65\x68";break}e=i[ao("0xa3")];break;case i["\x78\x6c\x61\x65\x64"]:this[ao("0xa4")]=1;e=i[ao("0x56")];break;case ao("0xa5"):this[ao("0x7a")]=[];e=ao("0x4d");break;case i["\x65\x63\x68\x61\x64"]:var h6=this;e="\x65\x65\x61";break;case ao("0xa6"):this[ao("0xa7")]=T;e=ao("0xa5");break;case ao("0x4f"):T["\x6f\x6e"](ao("0xa8"),function(){for(var h8=0;h8<h6["\x61\x72\x72\x57\x6f\x72\x6b\x65\x72"][ao("0x64")];h8++){if(h6[ao("0x63")][h8]){h6[ao("0x63")][h8][ao("0xa9")]()}}h6["\x61\x72\x72\x57\x6f\x72\x6b\x65\x72"]["\x6c\x65\x6e\x67\x74\x68"]=0});e=ao("0x48");break;case i[ao("0xaa")]:this[ao("0x68")]=null;e=i[ao("0xab")];break;case i[ao("0xac")]:this[ao("0xad")]=this[ao("0x5c")];e=ao("0x5b");break;case ao("0x73"):this[ao("0x5c")]=i[ao("0xae")](a9);e=ao("0x52");break;case i[ao("0xaf")]:this["\x74\x65\x78\x74\x53\x69\x7a\x65\x52\x61\x74\x69\x6f"]=2;e=ao("0x49");break}}},"\x67\x65\x74\x49\x64\x6c\x65\x57\x6f\x72\x6b\x65\x72":function(){var e={"\x6c\x6d\x65\x68\x65":function(h9,h8){return h9<h8},"\x6c\x6d\x65\x69\x6d":function(h9,h8){return h9!==h8},"\x68\x68\x69\x69\x61":ao("0xb0"),"\x63\x61\x63\x61\x69":ao("0xb1"),"\x78\x65\x68\x65\x65":ao("0xb2"),"\x64\x68\x63\x64\x61":"\x69\x61\x68"};for(var h7=0,h6=this[ao("0x63")][ao("0x64")];e[ao("0xb3")](h7,h6);h7++){var T=ao("0xb4");while(e[ao("0xb5")](T,e[ao("0xb6")])){switch(T){case e[ao("0xb7")]:return i;case e["\x78\x65\x68\x65\x65"]:i[ao("0x95")]=!![];T=ao("0xb1");break;case ao("0xb8"):if(!i["\x5f\x69\x73\x42\x75\x73\x79"]){T=e[ao("0xb9")];break}T=ao("0xb0");break;case e[ao("0xba")]:var i=this[ao("0x63")][h7];T=ao("0xb8");break}}}return null},"\x72\x65\x6c\x65\x61\x73\x65\x50\x65\x6e\x64\x69\x6e\x67\x44\x61\x74\x61":function(h9){var h7={"\x65\x78\x64\x65\x61":function(ic,ib){return ic>=ib},"\x69\x65\x61\x6d\x6c":function(ic,ib){return ic+ib},"\x64\x61\x64\x61\x64":function(ib,ic){return ib+ic},"\x6d\x68\x65\x68\x63":function(ic,ib){return ic+ib},"\x6d\x61\x61\x68\x63":ao("0xbb")};var ia=[];var h8=this[ao("0x7a")];for(var h6=h8["\x6c\x65\x6e\x67\x74\x68"]-1;h7[ao("0xbc")](h6,0);h6--){var T=h8[h6];var i=T[ao("0x8d")];if(h9[ao("0xbd")]!==i[ao("0xbd")]){continue}var e=h7[ao("0xbe")](h7["\x64\x61\x64\x61\x64"](h7[ao("0xbf")](h7[ao("0xc0")]+i[ao("0xc1")],"\x5f")+i[ao("0xc2")],"\x5f"),i[ao("0xc3")]);if(!h9[e]){h8[ao("0xc4")](h6,1);ia["\x70\x75\x73\x68"](i)}}return ia},"\x6c\x6f\x61\x64\x54\x69\x6c\x65\x44\x61\x74\x61":function(ih,ig,ie,id){var ic={"\x69\x65\x63\x61\x69":ao("0xc5"),"\x6d\x78\x61\x69\x6c":ao("0xc6"),"\x65\x65\x68\x65\x64":ao("0xc7"),"\x61\x61\x69\x69\x69":ao("0xc8"),"\x6d\x78\x65\x68\x61":ao("0xc9"),"\x65\x6c\x6c\x64\x6c":ao("0xca"),"\x61\x65\x63\x65\x63":ao("0xcb"),"\x61\x78\x61\x61\x78":"\x68\x64\x68","\x63\x6c\x6d\x64\x65":ao("0xcc"),"\x69\x65\x78\x64\x78":ao("0xcd"),"\x69\x65\x78\x65\x78":ao("0xce"),"\x63\x63\x61\x69\x61":ao("0xcf"),"\x65\x61\x69\x68\x61":ao("0xd0"),"\x69\x61\x69\x65\x69":"\x61\x69\x68","\x6d\x61\x78\x78\x6c":ao("0xd1"),"\x65\x64\x63\x78\x63":function(ij,ii){return ij+ii},"\x6d\x6c\x78\x63\x63":ao("0xd2"),"\x68\x69\x64\x63\x78":ao("0xd3"),"\x61\x63\x6d\x6d\x6d":"\x61\x64\x65","\x64\x69\x65\x68\x63":ao("0xd4"),"\x65\x6c\x61\x6d\x6c":function(ii,ij){return ii+ij},"\x61\x64\x63\x65\x64":function(ij,ii){return ij===ii},"\x65\x65\x64\x61\x65":ao("0xd5"),"\x6c\x68\x65\x68\x6c":"\x6c\x6f\x61\x64\x54\x69\x6c\x65\x44\x61\x74\x61","\x63\x6c\x63\x68\x61":function(ij,ii){return ij+ii},"\x78\x68\x65\x61\x78":ao("0xd6"),"\x69\x61\x69\x63\x78":"\x78\x6c\x69","\x69\x69\x69\x6d\x78":ao("0xd7"),"\x6d\x69\x63\x64\x61":ao("0xd8"),"\x6d\x78\x65\x6c\x6d":ao("0xd9"),"\x78\x68\x65\x61\x61":ao("0xda"),"\x65\x63\x68\x63\x68":ao("0x4b"),"\x65\x78\x6c\x6d\x69":function(ij,ii){return ij+ii},"\x6d\x69\x6c\x69\x65":ao("0xdb"),"\x6d\x78\x78\x6d\x65":ao("0xdc")};var ib=this["\x67\x65\x74\x49\x64\x6c\x65\x57\x6f\x72\x6b\x65\x72"]();var ia=this[ao("0xa7")][ao("0xdd")][ao("0xde")];var h9=ia?this[ao("0xa7")][ao("0xdd")][ao("0xdf")]:![];if(ib){var h8="\x69\x64\x61";while(h8!==ic["\x69\x65\x63\x61\x69"]){switch(h8){case ic[ao("0xe0")]:i[ao("0xdb")]=this[ao("0xd6")+h7];h8=ic[ao("0xe1")];break;case ao("0x3"):if(!this[ic[ao("0xe2")]+h6]&&br[ic[ao("0xe3")]+h6]){h8=ic[ao("0xe4")];break}h8=ic["\x61\x65\x63\x65\x63"];break;case ic[ao("0xe5")]:var h7=h6;h8=ic[ao("0xe6")];break;case ic[ao("0xe1")]:i[ao("0xe7")]=this[ao("0xe8")];h8="\x69\x78\x68";break;case ao("0xe9"):ib[ao("0xea")](i);h8=ao("0xc5");break;case ic[ao("0xeb")]:if(!ib[ao("0x66")]){h8=ao("0x3");break}h8=ao("0xe9");break;case ao("0xec"):if(!this[ao("0xe8")]){h8=ao("0xd8");break}h8=ao("0xd9");break;case ao("0xed"):var h6=this[ao("0xa7")][ao("0xee")]();h8=ic["\x69\x65\x78\x65\x78"];break;case ic[ao("0xef")]:ib[ao("0x83")]=id;h8="\x6c\x63\x69";break;case ic[ao("0xf0")]:i["\x6d\x61\x70\x53\x74\x79\x6c\x65\x49\x64"]=h6;h8=ic[ao("0xf1")];break;case ic[ao("0xf2")]:h7=ao("0xf3");h8=ic["\x69\x65\x78\x64\x78"];break;case ao("0xd9"):if(T&&br[ic[ao("0xf4")](ao("0xf5"),h6)]){h8=ao("0xf6");break}h8=ic[ao("0xf7")];break;case ic[ao("0xf8")]:if(T&&this[ao("0x68")]){h8=ic[ao("0xf9")];break}h8=ao("0xda");break;case ic[ao("0xfa")]:i[ao("0xfb")]=this[ic[ao("0xe2")]+h6];h8=ao("0xc6");break;case ic[ao("0xf7")]:if(this[ic[ao("0xfc")](ao("0xc8"),h6)]){h8=ic[ao("0xfa")];break}h8=ic[ao("0xe0")];break;case ao("0x43"):ib[ao("0x80")]=ig;h8=ao("0xd7");break;case ic[ao("0xfd")]:var T=!!ic[ao("0xfe")](h6[ao("0xff")](ao("0x100")),0);h8=ic[ao("0xe5")];break;case ic[ao("0x101")]:var i={"\x61\x63\x74\x69\x6f\x6e":ic[ao("0x102")],"\x75\x72\x6c":ih,"\x74\x69\x6c\x65\x49\x6e\x66\x6f":ig,"\x74\x69\x6c\x65\x4b\x65\x79":ie,"\x69\x73\x54\x65\x78\x74":h9,"\x69\x73\x50\x6f\x69":ia};h8=ao("0xed");break;case ic[ao("0x103")]:if(!this[ic[ao("0x104")](ic[ao("0x105")],h7)]){h8="\x69\x61\x61";break}h8=ic[ao("0x106")];break;case ic[ao("0x107")]:ib[ao("0x85")]=ie;h8=ic["\x65\x65\x64\x61\x65"];break;case ic[ao("0xe6")]:if(T){h8=ao("0xd1");break}h8=ic[ao("0xeb")];break;case ic[ao("0xe4")]:this[ao("0xc8")+h6]=JSON[ao("0x108")](br[ao("0xc9")+h6]);h8=ic[ao("0x103")];break;case ao("0x109"):ib[ao("0x66")]=!![];h8=ao("0xe9");break;case ic[ao("0x10a")]:this["\x73\x74\x72\x69\x6e\x67\x69\x66\x69\x65\x64\x49\x6e\x64\x6f\x6f\x72\x53\x74\x79\x6c\x65"]=JSON[ao("0x108")](br[ao("0xe7")]);h8=ic["\x6d\x78\x65\x6c\x6d"];break;case ic[ao("0x10b")]:i["\x69\x63\x6f\x6e\x49\x6e\x66\x6f"]={"\x77\x6f\x72\x64\x53\x70\x61\x63\x65\x52\x61\x74\x69\x6f":this["\x77\x6f\x72\x64\x53\x70\x61\x63\x65\x52\x61\x74\x69\x6f"],"\x74\x65\x78\x74\x53\x69\x7a\x65\x52\x61\x74\x69\x6f":this[ao("0xa4")]};h8=ic[ao("0xf0")];break;case ic[ao("0x10c")]:this[ic[ao("0x10d")](ao("0xd6"),h7)]=JSON[ao("0x108")](br[ic[ao("0x10e")]+h7]);h8=ic[ao("0x106")];break;case ic[ao("0xf9")]:i[ao("0x10f")]=this[ao("0x68")];h8=ic["\x78\x68\x65\x61\x61"];break;case ao("0xf6"):if(!this[ao("0x68")]){h8=ic["\x6d\x78\x78\x6d\x65"];break}h8="\x64\x6c\x61";break;case ic[ao("0x110")]:this[ao("0x68")]=JSON["\x73\x74\x72\x69\x6e\x67\x69\x66\x79"](br[ic[ao("0x10d")](ao("0xf5"),h6)]);h8=ic[ao("0xf7")];break}}}else{var e={"\x75\x72\x6c":ih,"\x74\x69\x6c\x65\x49\x6e\x66\x6f":ig,"\x74\x69\x6c\x65\x4b\x65\x79":ie,"\x63\x62\x6b":id};this["\x61\x72\x72\x50\x65\x6e\x64\x69\x6e\x67\x44\x61\x74\x61"][ao("0x97")](e)}}};D[ao("0x111")](gm[ao("0x112")],bj);function d0(i){this.tileLayers=[];this.map=i;var e=this.config=b9[this.map.mapType];this.errorUrl=e.errorUrl;this.tileSize=e.tileSize;this.baseUnits=e.baseUnits;this.baseZoomLevel=e.zoomLevelBase;this.tileURLs=e.tileUrls;this.tilesInfoCache={};this.loadDelay=10;this._labelTextCanvas=null}br.register(function(i){if(i._renderType!=="webgl"){return}var e=i.tileMgr=new d0(i);i.addEventListener("addtilelayer",function(h6){e.addWebGLLayer(h6.target)});i.addEventListener("removetilelayer",function(h6){e.removeWebGLLayer(h6.target)});i.on("update",function T(h7){if(i.getFeatureStyleTags().length===0||!i.customLoaded){return}var h6=false;if(h7.changedStatus&&h7.changedStatus.onzoom_changed){h6=true}e.loadLayersData({zoomChanged:h6})});i.on("style_changed",function(){e.loadLayersData()})});D.extend(d0.prototype,{addWebGLLayer:function(T){this.tileLayers.push(T);T.initDrawData();if(this.tileLayers.length>1){for(var e=1;e<this.tileLayers.length;e++){if(this.tileLayers[e].isFlat){this.map.setDisplayOptions({isFlat:true});break}}}if(this.map.getFeatureStyleTags().length>0&&this.map.customLoaded){this.loadLayersData()}else{var h6=this;this.map.loadMapStyleFiles(function(){h6.loadLayersData()})}},removeWebGLLayer:function(h8){var h9=false;for(var h7=0,h6=this.tileLayers.length;h7<h6;h7++){if(h8===this.tileLayers[h7]){h9=true;this.tileLayers.splice(h7,1);break}}if(h9===false){return}h8.destroyDrawData();if(this.map.getFeatureStyleTags().length>0){this.loadLayersData()}if(this.tileLayers.length===1){this.map.setDisplayOptions({isFlat:false})}else{var e=false;for(var h7=1;h7<this.tileLayers.length;h7++){if(this.tileLayers[h7].isFlat){e=true;break}}this.map.setDisplayOptions({isFlat:e})}var T=new be("onrefresh");T.source="removewebgllayer";this.map.fire(T)},getLabelTextCanvas:function(){if(!this._labelTextCanvas){this._labelTextCanvas=new w(this.map)}return this._labelTextCanvas},loadLayersData:function(i){if(this.map.suspendLoad){return}var h6=this;i=i||{};var T=!!i.zoomChanged;var e=(T===true||this.map.getTilt()>50);if(!e){if(!this.syncLoadTimer){this.syncLoadTimer=setTimeout(function(){h6._loadLayersFromCache(T);h6.syncLoadTimer=null},40)}}else{this._loadLayersFromCache(T)}if(!h6.map.viewAnimationTime){this.timer&&window.clearTimeout(this.timer)}this.timer=window.setTimeout(function(){if(h6.map.viewAnimationTime){if(new Date().getTime()-h6.map.viewAnimationTime<1000){return}h6.map.viewAnimationTime=new Date().getTime()}var h8=h6.tileLayers.length;h6.tilesInfoCache={};for(var h9=0;h9<h8;h9++){var ib=h6.tileLayers[h9];var ia=ib.tileType;var h7=null;if(h6.tilesInfoCache[ia.getName()]){h7=h6.tilesInfoCache[ia.getName()]}else{h7=h6.calcTilesInfo(ia,ib);h6.tilesInfoCache[ia.getName()]=h7}ib.loadLayerData(h7,false,T)}h6.timer=null},this.loadDelay);if((gi()||D.Browser.ie)&&T){this.loadDelay=200}else{this.loadDelay=80}},_loadLayersFromCache:function(h7){this.map._featureMgr.clearData();var ia=this.tileLayers;ia.sort(function(ib,i){return ib.zIndex-i.zIndex>0});var T=ia.length;this.tilesInfoCache={};for(var h6=0;h6<T;h6++){var h9=ia[h6];var h8=h9.tileType;var e=null;if(this.tilesInfoCache[h8.getName()]){e=this.tilesInfoCache[h8.getName()]}else{e=this.calcTilesInfo(h8,h9);this.tilesInfoCache[h8.getName()]=e}h9.loadLayerData(e,true,h7)}},calcTilesInfo:function(il,iO){var iA=this.map;var iG=iA.getMapType();var iB=b9[iG];var iu=iA.getZoom();var e=Math.floor(iu);var h9=il.getDataZoom(iu);var iT=il.getName();h9=fR(h9,iB.minDataZoom,iB.maxDataZoom);var iJ=e;if(il._name==="web"||il._name==="xyz"){iJ=h9}else{if(iJ<3){iJ=3}}var iy=il.getTileSize(iu);var h8=il.getBaseTileSize(iu);var iw=iA.getBoundsIn();var iq=il.getMercatorSize(iu,h9);var ip;var iH;var ix;var iL;var iC=iA.getCenterIn();if(iG!==BMAP_SATELLITE_MAP){iC=ed.calcLoopCenterPoint(iC)}if(iT==="xyz"){return this.calcXYZTilesInfo(iC,iw,h9,iT,iO,iA)}var iv=Math.floor(iC.lng/iq);var ib=Math.floor(iC.lat/iq);var iE=0;var h6=0;if(iT!=="web"){iw=ed.calcLoopMapBounds(iw,iA.getCenter())}if(iw.ne.lng>ed._mc180X){var ij=ed.getSpaceDistanceInPixel(h9);iE=Math.ceil(ij/h8)}if(iw.sw.lng<ed._mcM180X){var ij=ed.getSpaceDistanceInPixel(h9);h6=Math.ceil(ij/h8)}if(iw.ne.lat>19505879.362428114||iw.sw.lat<-15949096.637571886){iw.ne.lat=19505879.362428114;iw.sw.lat=-15949096.637571886}var ie=[Math.floor(iw.sw.lng/iq)-h6,Math.floor(iw.sw.lat/iq)];var iR=[Math.floor(iw.ne.lng/iq)+iE,Math.floor(iw.ne.lat/iq)];ip=ie[0];iH=iR[0]+1;ix=ie[1];iL=iR[1]+1;var ik=[];for(var ih=ip;ih<iH;ih++){if(ed.isTileBlank(ih,h9,h8)===true){continue}for(var im=ix;im<iL;im++){var iN=false;var ig=256;if(iT==="web"){var iI=ed.calcLoopParam(ih,h9);var iQ={col:iI.col,row:im,baseTileSize:256,zoom:h9};var iz=ew.prototype.tileToBound(iQ,iA.getCenter());if(iz.LL.sw.lng*iz.LL.ne.lng<0&&Math.floor(iz.LL.ne.lng)<0){iN=true;ig=ed.pixelWidth(iz.MC.sw.lng,iA.getZoom())}}var ii={col:ih,row:im,zoom:h9,useZoom:iJ,tileTypeName:iT,loopOffsetX:0,tileSize:iy,baseTileSize:h8,mercatorSize:iq,combine:iN,dataIndex:ig};ik.push(ii);var iF="id_"+ih+"_"+im+"_"+h9;ik[iF]=true}}if(iG!==BMAP_SATELLITE_MAP){ik=ed.calcLoopTiles(ik,h9,h8,iq)}if(h9===3){for(var iP=0,iM=ik.length;iP<iM;iP++){var ih=ik[iP].col;var im=ik[iP].row;var iI=ed.calcLoopParam(ih,h9);var ia=iI.T;var ir=ih>=0?ih-ia:ih+ia;var it="id_"+ir+"_"+im+"_"+h9;if(!ik[it]){var ii={col:ir,row:im,zoom:h9,useZoom:iJ,loopOffsetX:0,tileSize:iy,baseTileSize:h8,mercatorSize:iq,combine:false};ik.push(ii);ik[it]=true}}}if(this.map._tilt>0){for(var iP=0;iP<ik.length;iP++){var ic=ik[iP];var iK=ic.col;var iS=ic.row;var iD=[];iD.minX=iK*iq;iD.maxX=(iK+1)*iq;iD.minY=iS*iq;iD.maxY=(iS+1)*iq;var h7=new hH(0,0);h7.lng=(iD.minX+iD.maxX)/2;h7.lat=(iD.minY+iD.maxY)/2;var io=iA.pointToPixelIn(h7);if(io.x>0&&io.x<this.map.width&&io.y>0&&io.y<this.map.height){continue}if(iD.minX<iC.lng&&iD.maxX>iC.lng&&iD.minY<iC.lat&&iD.maxY>iC.lat){continue}if(!this.ifTileInMapBounds(iD,iw,iK,iS)){ik.splice(iP,1);iP--}}}ik.sort((function(i){return function(T,id){return((0.4*Math.abs(T.col-i[0])+0.6*Math.abs(T.row-i[1]))-(0.4*Math.abs(id.col-i[0])+0.6*Math.abs(id.row-i[1])))}})([iv,ib]));ik.zoom=h9;ik.tileTypeName=iT;return ik},calcXYZTilesInfo:function(ij,ia,ii,io,h9,ir){var ic=ir.width;var ip=ir.height;var ib=Math.floor(ii);var h6=eE.transformBDmcPoint(ij);if(!h6){return[]}var ie=null;if(h9.transform.source==="BD09MC"){var h7=eE.getRangeExtent(h6,ic,ip,ib,h9.transform);ie=[h7.minX,h7.minY,h7.maxX,h7.maxY]}else{var h8=eE.transformBDmcPoint(ia.ne);var ih=eE.transformBDmcPoint(ia.sw);ie=eE.getLoopBox(h6,[ih[0],ih[1],h8[0],h8[1]])}if(!ie){return[]}if(h9.transform.source==="BD09MC"){ib+=1}var T=eE.getTileRangeForExtentFactory(ie,ib,h9.transform);var e=[];var it=eE.getResolutionScale(ib,h9.transform);for(var im=T.minX;im<=T.maxX;im++){for(var ik=T.minY;ik<=T.maxY;ik++){var il={col:im,row:ik,zoom:ib,useZoom:ib,tileTypeName:io,loopOffsetX:0,tileSize:256*it,transform:h9.transform,combine:false,dataIndex:0};e.push(il);var ig="id_"+im+"_"+ik+"_"+ib;e[ig]=true}}var iq=eE.getTileCoordForCoordAndZ(h6,ib);e.sort((function(i){return function(id,iu){return((0.4*Math.abs(id.col-i[0])+0.6*Math.abs(id.row-i[1]))-(0.4*Math.abs(iu.col-i[0])+0.6*Math.abs(iu.row-i[1])))}})([iq[1],iq[2]]));e.zoom=ib;e.tileTypeName=io;return e},getCurrentViewTilesInfo:function(i){var e=this.tilesInfoCache[i.getName()];if(!e){return this.calcTilesInfo(i)}return e},ifTileInMapBounds:function(e,h8,T,h7){var i=h8.normalizedBottomLeft;var ik=h8.normalizedTopRight;var ib=h8.normalizedTopLeft;var h9=h8.normalizedBottomRight;var h6=false;var ij=new hH(e.minX,e.minY);var ig=new hH(e.maxX,e.maxY);var ia=new hH(ig.lng,ij.lat);var ih=new hH(ij.lng,ig.lat);var id=[ih,ig,ia,ij];for(var ii=0,ic=id.length;ii<ic;ii++){var ie=ii+1;if(ie===ic){ie=0}var il=ii;var im=gK(id[ie],id[il],ib,i);if(im){h6=true;break}im=gK(id[ie],id[il],h9,ik);if(im){h6=true;break}im=gK(id[ie],id[il],ik,ib);if(im){h6=true;break}im=gK(id[ie],id[il],i,h9);if(im){h6=true;break}}return h6},getTileLayer:function(h7){for(var h6=0,e=this.tileLayers.length;h6<e;h6++){var T=this.tileLayers[h6];if(T.mapType===h7){return T}}return null},getZoomState:function(i){var e=i-this.lastZoom;if(e>0){this.zoomState=1}else{if(e<0){this.zoomState=-1}}this.lastZoom=i;return this.zoomState}});function aU(e){this._map=e;this._spotsId=null;this._init()}aU.prototype._init=function(){var e=this._map;e.addEventListener("onspotsdataready",function(T){var i=T.spots;if(this._spotsId){e.removeSpots(this._spotsId)}this._spotsId=e.addSpots(i)})};br.register(function(e){if(!e.config.enableIconClick){return}e._mapIcon=new aU(e)});function aX(e){this._indoorData={};this._map=e;this.currentUid=null;this.currentFloor=null;this._indoorControl=null;this.enterMethod=null;this.showMask=false;this._isMobile=gi();this._autoEnterZoom=19;if(this._isMobile){this._autoEnterZoom=17}this._init(e);window._indoorMgr=this}aX.prototype._init=function(i){var e=this;i.on("indoor_status_changed",function(h9){var T=h9.uid;var h7=h9.floor;if(T===null){T=e.currentUid;if(e._indoorData[T]){h7=e._indoorData[T].defaultFloor}if(e._indoorControl){e._indoorControl.hide()}e.currentUid=null;e.currentFloor=null;e.enterMethod=null}else{if(e._indoorData[T]){var h8=e._indoorData[T];h7=(typeof h7==="number")?h7:h8.defaultFloor;if(!e._indoorControl){if(i.config.showControls&&i._displayOptions.indoor){e._indoorControl=new gO(i,h8)}}else{e._indoorControl.setInfo(h8);e._indoorControl.show()}e.currentUid=T;e.currentFloor=h7}}if(!e._indoorData||!e._indoorData[T]||e._indoorData[T].currentFloor===h7){this.fire(new be("onrefresh"));return}var h6=new be("onindoor_data_refresh");h6.uid=T;h6.floor=h7;h6.tileKey=e._indoorData[T].tileKey;e._indoorData[T].currentFloor=h7;e.currentFloor=h7;this.fire(h6)});i.on("spotclick",function(h6){var T=null;if(h6.curAreaSpot&&this.areaSpots[h6.curAreaSpot]){T=this.areaSpots[h6.curAreaSpot].userData.uid}if(T===e.currentUid){if(h6.curAreaSpot){e.enterMethod="byClick"}return}if(T===null){if(e.currentUid&&e.enterMethod==="byClick"){i.showIndoor(null);e.enterMethod=null}}else{e.enterMethod="byClick";if(e.currentUid){i.showIndoor(e.currentUid,e._indoorData[e.currentUid].defaultFloor)}i.showIndoor(T,e._indoorData[T].defaultFloor)}});i.on("moveend",function(){if(this.getZoom()>=e._autoEnterZoom){e._checkIndoorByMove()}});i.on("zoomend",function(){if(this.getZoom()>=e._autoEnterZoom){e._checkIndoorByMove()}else{if(e.enterMethod!=="byClick"&&e.currentUid!==null){this.showIndoor(null)}}})};aX.prototype._checkIndoorByMove=function(){var T=this._map;var ic=T.getSize();var ii={x:ic.width/2,y:ic.height/2};var ih=Math.max(ic.width,ic.height);var ij=[];for(var id in this._indoorData){var e=this._indoorData[id].center;var h6=T.pointToPixelIn(new br.Point(e[0],e[1]));var h9=ha(ii,h6);ij.push({uid:id,distance:h9})}if(ij.length===0){return}ij.sort(function(ik,i){return ik.distance-i.distance});var h8=ij[0];var ie=T.getCenterIn();var h7=false;for(var ib=0;ib<this._indoorData[h8.uid].contour.length;ib++){if(dl([ie.lng,ie.lat],this._indoorData[h8.uid].contour[ib])){h7=true;break}}if(h7===false&&h8.uid==="e96b44200baa3b4082288acc"){var ia=this._indoorData[h8.uid].boundsMin;var ig=this._indoorData[h8.uid].boundsMax;if(ie.lng>ia[0]&&ie.lat>ia[1]&&ie.lng<ig[0]&&ie.lat<ig[1]){h7=true}}if(h7){if(this.enterMethod!=="byClick"){if(this.currentUid!==null&&this.currentUid!==h8.uid){this._map.showIndoor(this.currentUid,this._indoorData[this.currentUid].defaultFloor)}if(this.currentUid!==h8.uid){this._map.showIndoor(h8.uid,this._indoorData[h8.uid].defaultFloor)}this.enterMethod="byMove"}}else{if(this.enterMethod!=="byClick"){this._map.showIndoor(null)}}};aX.prototype.setData=function(h6){if(h6===null){return}for(var T in h6){if(T==="tileInfo"){continue}var h7=h6[T].tileKey;if(this._indoorData[T]){if(!this._indoorData[T][h7]){this._indoorData[T].tileKeys.push(h7);this._indoorData[T][h7]=true}}else{this._indoorData[T]=h6[T];this._indoorData[T].tileKeys=[h6[T].tileKey];this._indoorData[T][h7]=true;for(var e=0;e<this._indoorData[T].contour.length;e++){this._map.addAreaSpot(this._indoorData[T].contour[e],{id:T+e,userData:{uid:T}})}}}if(this._map.getZoom()>=this._autoEnterZoom){this._checkIndoorByMove()}};aX.prototype.removeData=function(T,h7){if(!this._indoorData[T]){return}var h6=this._indoorData[T];for(var e=0;e<h6.tileKeys.length;e++){if(h6.tileKeys[e]===h7){h6.tileKeys.splice(e,1);break}}delete h6[h7];if(h6.tileKeys.length===0){delete this._indoorData[T]}};aX.prototype.getIndoorData=function(e){return this._indoorData[e]||null};aX.prototype.getData=function(){return this._indoorData};br.register(function(e){e._indoorMgr=new aX(e)});var eu=(function(){var h6={};var ig={};var ib={};function id(ii){if(Object.prototype.toString.call(ii)==="[object Object]"){for(var ih in ii){return false}return true}else{return false}}function ic(ip,iq,iu,il,it){var ih=ih||null;il=il||ih;var ij;if(il){ij=ie(ip,iq,iu,il)}else{ij=T(ip,iq,iu,it)}var io=ij.drawId;var ii=ij.style;var ir=ij.styleUpdate;var iv=[];if(!io){return iv}for(var ik=0;ik<io.length;ik++){var im=ir[io[ik]]||ii[io[ik]];if(im){switch(iq){case"polygon":im=h7(im,ip);break;case"line":im=ia(im,ip);break;case"pointText":im=h8(im,ip);break;case"point":im=e(im,ip);break;case"polygon3d":im=h9(im,ip);break}if(im){im.did=io[ik];iv[iv.length]=im}}}return iv}function ie(ii,ik,il,ih){var ij=ih[2];switch(ik){case"point":ij=ij[0];break;case"pointText":ij=ij[1];break;case"line":ij=ij[3];break;case"polygon":ij=ij[4];break;case"polygon3d":ij=ij[5];break}var io=il-1;if(ik==="line"&&il===12){io=il}var ip=ih[1][io][0];var im=ip[ii];if(!im){if(ik==="point"||ik==="pointText"){ip=ih[1][il][0];im=ip[ii]}}return{drawId:im,style:ij,styleUpdate:[]}}function T(il,im,iq,ip){if(!ip){return{drawId:null,style:[],styleUpdate:[]}}var io;var ij=ip.baseFs;if(id(ip.zoomRegion)){io=ip.StyleBody||[]}else{io=ip.zoomStyleBody[iq]||[]}var ii=ij[2];switch(im){case"point":ii=ii[0];io=io[0]||{};break;case"pointText":ii=ii[1];io=io[1]||{};break;case"line":ii=ii[3];io=io[3]||{};break;case"polygon":ii=ii[4];io=io[4]||{};break;case"polygon3d":ii=ii[5];io=io[5]||{};break}var ih=ij[1][iq-1][0];var ik=ih[il];return{drawId:ik,style:ii,styleUpdate:io}}function h8(ii,ih){if(!ii||ii.length===0){return null}return{sid:ih,fontRgba:i(ii[0]),haloRgba:i(ii[1]),backRgba:i(ii[2]),fontSize:ii[3],haloSize:ii[4],fontWeight:ii[5],fontStyle:ii[6],density:ii[7]}}function e(ii,ih){return{sid:ih,rank:ii[0],ucflag:ii[1],icon:ii[2],iconType:ii[3],nineGG:ii[4],density:ii[5],zoom:ii[6]}}function ia(ii,ih){return{sid:ih,borderRgba:i(ii[0]),fillRgba:i(ii[1]),borderWidth:ii[2],fillWidth:ii[3],borderCap:ii[4],fillCap:ii[5],haveBorderLine:ii[6],haveBorderTexture:ii[7],haveFillTexture:ii[8],isUseBorderRgba:ii[9],isUseFillRgba:ii[10],borderTexture:ii[11],fillTexture:ii[12],borderTextureType:ii[13],fillTextureType:ii[14],isRealWidth:ii[15],haveArrow:ii[16],needRound:ii[17],realBorderWidth:ii[18]}}function h7(ii,ih){return{sid:ih,fillRgba:i(ii[0]),borderRgba:i(ii[1]),borderWidth:ii[2],borderTexture:ii[3],borderTextureType:ii[4],waterStyle:ii[5],haloStyle:ii[6],textureStyle:ii[7],thickRgba:i(ii[8])}}function h9(ii,ih){return{sid:ih,filter:ii[0],ratio:ii[1],haveBorder:ii[2],borderWidth:ii[3],borderRgba:i(ii[4]),fillTop:i(ii[5]),fillSide:i(ii[6]),polyTexture:ii[7]}}function i(im){var il=im;if(ib[il]){return ib[il]}im=im>>>0;var ik=(im)&255;var ij=(im>>8)&255;var ih=(im>>16)&255;var ii=(im>>24)&255;ib[il]=[ik,ij,ih,ii];return ib[il]}return{getStyleFromCache:function(ip,ij,im,io,ii,il,ih){ip=ip||"default";var ik=ip+"-"+ij+"-"+im+"-"+io;if(il){ik+="-indoor"}if(ii){if(!ig[ik]){ig[ik]=ic(ij,im,io,ii)}return ig[ik]}if(!h6[ik]){h6[ik]=ic(ij,im,io,ii,ih)}return h6[ik]}}})();br.register(function(i){var e=new dM(i)});function dM(e){e.container.appendChild(this.render());this.bind(e)}dM.prototype.render=function(){var i=document.createElement("div");i.className="click-ripple-container";var e=document.createElement("div");e.className="click-ripple";i.appendChild(e);this._div=i;this._ripple=e;return i};dM.prototype.bind=function(i){var e=this;i.addEventListener("spotclick",function(T){if(!T.spots||T.spots.length===0){return}e._div.style.left=T.pixel.x+"px";e._div.style.top=T.pixel.y+"px";D.ac(e._ripple,"ripple-playing")});D.on(e._ripple,"transitionend",function(){D.rc(e._ripple,"ripple-playing")})};function ge(e){em.call(this);if(!e){return}this._opts={};this._map=e;this._maxLat=84.6;this._minLat=-80.6;this._maxLatMC=ew.convertLL2MC(new c8(this._maxLat,0)).lat;this._minLatMC=ew.convertLL2MC(new c8(this._minLat,0)).lat}ge.inherits(em,"ToolbarItem");D.extend(ge.prototype,{open:function(){if(this._isOpen==true){return true}if(this._map._toolInUse){return false}this._map._toolInUse=true;this._isOpen=true;return true},close:function(){if(!this._isOpen){return}this._map._toolInUse=false;this._isOpen=false},_checkStr:function(e){if(!e){return""}return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}});function gZ(T,i){ge.call(this,T);i=i||{};this._opts=D.extend(D.extend(this._opts||{},{autoClear:false,tips:"测距",followText:"单击确定起点，双击结束绘制",unit:"metric",showResult:true,lineColor:"blue",lineStroke:2,opacity:1,lineStyle:"solid",cursor:fe.distCursor,styleCodes:{lnCode:0,spCode:0,slCode:0,tlCode:0},enableMassClear:true}),i);if(this._opts.showResult===false){if(typeof i.tips==="undefined"){this._opts.tips="绘制折线"}if(!i.cursor){this._opts.cursor="crosshair"}}if(this._opts.lineStroke<=0){this._opts.lineStroke=2}if(this._opts.opacity>1){this._opts.opacity=1}else{if(this._opts.opacity<0){this._opts.opacity=0}}if(this._opts.lineStyle!=="solid"&&this._opts.lineStyle!=="dashed"){this._opts.lineStyle="solid"}this._checked=false;this._drawing=null;this.followTitle=null;this._totalDis={};this._points=[];this._paths=[];this._dots=[];this._segDistance=[];this._overlays=[];this._units={metric:{name:"metric",conv:1,incon:1000,u1:"米",u2:"公里"},us:{name:"us",conv:3.2808,incon:5279.856,u1:"英尺",u2:"英里"}};if(!this._units[this._opts.unit]){this._opts.unit="metric"}this._dLineColor="#ff6319";this._dLineStroke=3;this._dOpacity=0.8;this._dLineStyle="solid";this._dCursor=fe.distCursor;if(this._opts.showResult){this._opts.followText="单击确定起点"}this._followTextM="单击确定地点，双击结束";this._sectionMarkerTip="单击可删除此点，拖拽可调整位置";this._movingTimerId=null;if(this._opts.showResult){this.text="测距"}else{this.text="绘线"}this._isOpen=false;var e=this;ej.load("tools",function(){e._draw()})}gZ.inherits(ge,"PolylineTItem");D.extend(gZ.prototype,{setLineColor:function(e){this._opts.lineColor=e},setLineStroke:function(e){if(Math.round(e)>0){this._opts.lineStroke=Math.round(e)}},setOpacity:function(e){if(e>=0&&e<=1){this._opts.opacity=e}},setLineStyle:function(e){if(e==="solid"||e==="dashed"){this._opts.lineStyle=e}},clear:function(){for(var T=0,e=this._overlays.length;T<e;T++){if(this._overlays[T]){this._map.removeOverlay(this._overlays[T])}}this._overlays.length=0;for(var T=0,e=this._dots.length;T<e;T++){if(this._dots[T]&&this._dots[T].parentNode){this._dots[T].parentNode.removeChild(this._dots[T])}}this._dots.length=0},setCursor:function(e){if(this._opts.showResult===true){return}this._opts.cursor=e},getCursor:function(){if(this._opts.showResult===true){return this._dCursor}var e=this._opts.cursor.match(/^url\((.+)\)(,.*)?/);if(e!==null){return e[1]}else{return this._opts.cursor}},showResult:function(e){this._opts.showResult=!!e}});function cx(){var h7=3;var ie=256;var h6=Math.pow(2,18-h7)*ie;var ig=2;var id=(ig+1)*h6;var T=ew.convertLL2MC(new hH(180,0));var ib=T.lng;var h9=id-ib;var ic=-3;var e=ic*h6;var h8=ew.convertLL2MC(new hH(-180,0));var ia=h8.lng;var i=ia-e;this._validPixels=ib/Math.pow(2,18-h7);this._mc180X=ib;this._mcM180X=ia;this._loopOffset=h9+i;this._mcTSpan=ib-ia;this._spaceDistance=h9;this._mSpaceDistance=i}cx.prototype={calcLoopParam:function(h6,i,id){id=id||256;var ia=0;var h7=3;var h9=6;var h8=h9*Math.pow(2,(i-h7))*256/id;var ic=h8/2-1;var ib=-h8/2;while(h6>ic){h6-=h8;ia-=this._loopOffset}while(h6<ib){h6+=h8;ia+=this._loopOffset}var e=ia;ia=Math.round(ia/Math.pow(2,18-i));return{offsetX:ia,geoOffsetX:e,col:h6,T:h8,maxCol:ic,minCol:ib}},calcLoopCenterPoint:function(i){var e=i.lng;while(e>this._mc180X){e-=this._mcTSpan}while(e<this._mcM180X){e+=this._mcTSpan}i.lng=e;return i},calcLoopMapBounds:function(T,h6){var i=h6||T.getCenter();var e=T.sw.lng;var h7=T.ne.lng;while(i.lng>this._mc180X){i.lng-=this._mcTSpan;e-=this._mcTSpan;h7-=this._mcTSpan}while(i.lng<this._mcM180X){i.lng+=this._mcTSpan;e+=this._mcTSpan;h7+=this._mcTSpan}T.sw.lng=e;T.ne.lng=h7;if(T.pointBottomLeft){T.pointBottomLeft=this.calcLoopCenterPoint(T.pointBottomLeft);T.pointTopLeft=this.calcLoopCenterPoint(T.pointTopLeft);T.pointTopRight=this.calcLoopCenterPoint(T.pointTopRight);T.pointBottomRight=this.calcLoopCenterPoint(T.pointBottomRight)}return T},calcLoopTiles:function(ie,e,ij,ib){ij=ij||256;var h7=ib||Math.pow(2,18-e)*ij;var id=Math.floor(this._mc180X/h7);var h9=Math.floor(this._mcM180X/h7);var ig=Math.floor(this._loopOffset/h7);var ih=[];for(var ia=0;ia<ie.length;ia++){var ii=ie[ia];var h6=ii[0];var ik=ii[1];if(h6>=id){var ic=h6+ig;if(this.isTileBlank(ic,e,ij)===true){continue}var T="id_"+ic+"_"+ik+"_"+e;if(!ie[T]){ie[T]=true;ih.push([ic,ik,e,0])}}else{if(h6<=h9){var ic=h6-ig;if(this.isTileBlank(ic,e,ij)===true){continue}var T="id_"+ic+"_"+ik+"_"+e;if(!ie[T]){ie[T]=true;ih.push([ic,ik,e,0])}}}}for(var ia=0,h8=ih.length;ia<h8;ia++){ie.push(ih[ia])}for(var ia=ie.length-1;ia>=0;ia--){var h6=ie[ia][0];if(this.isTileBlank(h6,e,ij)){ie.splice(ia,1)}}return ie},isTileBlank:function(T,h7,e){var h8=Math.pow(2,h7-3);var i=Math.round(this._validPixels*h8);var h6=6*h8*256/e;while(T>h6/2-1){T-=h6}while(T<-(h6/2)){T+=h6}if(T>0&&T*e>i){return true}if(T<0&&Math.abs((T+1)*e)>i){return true}return false},isAddWidth:function(e,i){return e<this._mcM180X||i>this._mc180X},pixelWidth:function(e,i){if(e<0){e=-e}return Math.abs(e-this._mc180X)/(Math.pow(2,18-i))},getSpaceDistanceInPixel:function(i){var e=Math.round((this._spaceDistance+this._mSpaceDistance)/Math.pow(2,18-i));return e}};var ed=new cx();var ch=(function(){var i=true;var h7=256;var e=true;var h9=aG("ditu","normalTraffic");var h6=h9.udt;var ia="//its.map.baidu.com/traffic/";var h8=[[2,"79,210,125,1",3,2,0,[],0,0],[2,"79,210,125,1",3,2,0,[],0,0],[2,"79,210,125,1",4,2,0,[],0,0],[2,"79,210,125,1",5,2,0,[],0,0],[2,"79,210,125,1",6,2,0,[],0,0],[2,"255,208,69,1",3,2,0,[],0,0],[2,"255,208,69,1",3,2,0,[],0,0],[2,"255,208,69,1",4,2,0,[],0,0],[2,"255,208,69,1",5,2,0,[],0,0],[2,"255,208,69,1",6,2,0,[],0,0],[2,"232,14,14,1",3,2,0,[],0,0],[2,"232,14,14,1",3,2,0,[],0,0],[2,"232,14,14,1",4,2,0,[],0,0],[2,"232,14,14,1",5,2,0,[],0,0],[2,"232,14,14,1",6,2,0,[],0,0],[2,"181,0,0,1",3,2,0,[],0,0],[2,"181,0,0,1",3,2,0,[],0,0],[2,"181,0,0,1",4,2,0,[],0,0],[2,"181,0,0,1",5,2,0,[],0,0],[2,"181,0,0,1",6,2,0,[],0,0],[2,"255,255,255,1",4,0,0,[],0,0],[2,"255,255,255,1",5.5,0,0,[],0,0],[2,"255,255,255,1",7,0,0,[],0,0],[2,"255,255,255,1",8.5,0,0,[],0,0],[2,"255,255,255,1",10,0,0,[],0,0]];var T=new cV({transparentPng:true,dataType:2,cacheSize:256,clipTile:true,isFlat:true});T.zIndex=2;T.getTilesUrl=function(id,ie){if(!id||ie<7){return null}var ic=id.x;var ig=id.y;var ib=ia+"TrafficTileService?level="+ie+"&x="+ic+"&y="+ig+"&time="+(+new Date());if(this.map.getRenderType()==="webgl"){ib=ia+"?qt=vtraffic&z="+ie+"&x="+ic+"&y="+ig+"&udt="+h6}return ib};T.setColors=function(ib){for(var ie=0;ie<h8.length;ie++){var id=Math.floor(ie/5);var ic=ib[id];if(ic){if(Object.prototype.toString.call(ic)==="[object String]"){ic=he.parseCSSColor(ic)}h8[ie][1]=[ic[0],ic[1],ic[2],ic[3]/255].join(",")}}};T.setEdge=function(ib){e=!!ib};T.processData=function(ie){var ij=ie.content;var ih=10;if(typeof ie.precision==="number"){ih=ie.precision*10}var ir={road:[[],[]]};if(!ij){return ir}var ip=ij.tf;if(!ip){return ir}for(var ig=0;ig<ip.length;ig++){var iq=ip[ig][1];var io=[];var il=0;var ik=0;var im=h8[ip[ig][3]];for(var id=0,ib=iq.length;id<ib/2;id++){il+=iq[id*2]/ih;ik+=iq[id*2+1]/ih;io.push(il,256-ik)}var ic=im[1].split(",");ic[3]=ic[3]*255;var ii=im[2]/2;if(e){ir.road[0].push([io,1,2,[255,255,255,255],ii+2])}ir.road[1].push([io,1,2,ic,ii])}return ir};return T})();function hg(e){cZ.call(this);e=e||{};this._opts={};this._opts.districts=e.name||"";this._opts.kind=e.kind||0;this._config={};this._config.strokeColor=e.strokeColor||"#00f";this._config.strokeOpacity=typeof e.strokeOpacity==="number"?e.strokeOpacity:1;fR(this._config.strokeOpacity,0,1);this._config.fillColor=e.fillColor||"#ff0";this._config.fillOpacity=typeof e.fillOpacity==="number"?e.fillOpacity:0.6;fR(this._config.fillOpacity,0,1);this._config.strokeWeight=e.strokeWeight||1;this._config.viewport=e.viewport||false;this.disOverlays=[];this.eventAndCallback={};var i=this;ej.load("layer",function(){i._asyncSearch()})}hg.inherits(em,"DistrictLayer");D.extend(hg.prototype,{initialize:function(e){this._map=e;this.addDistrict()},removeDistrict:function(i,e){this._map=i;this.deleteDistrict(e)},toString:function(){return"DistrictLayer"}});var fl=function(i){var i=i||{};const h7=i.transform||{source:"EPSG3857",target:"BD09MC"};const h6=i.tileUrlTemplate||"";const ia=i.xTemplate||function(ii,ik,ij){return ii};const ie=i.yTemplate||(i.tms?function(ii,ik,ij){return Math.pow(2,ij)-ik-1}:function(ii,ik,ij){return ik});const h9=i.zTemplate||function(ii,ik,ij){return ij};const id=i.bTemplate||function(ii,il,ik){const ij=eE.getTileRangeExtent([ik,ii,il]);return ij.minX+","+ij.minY+","+ij.maxX+","+ij.maxY};var ig=i.extent||[];const h8=i.extentCRSIsWGS84||false;var T=i.minZoom||0;var ic=i.maxZoom||23;var ib=true;var ih=new cV({transform:h7,transparentPng:ib,dataType:1,tileTypeName:"xyz",cacheSize:256,customLayer:true,clipTile:false,boundary:i.boundary||false,useThumbData:i.useThumbData||false});ih.zIndex=2;(ig.length===4)&&h8&&(ig=eE.fromEPSG4326(ig));ih.getTilesUrl=function(ij,iq,io){if(!ij||iq<0||iq<T||iq>ic){ih.tileCache.clear();return null}if(h7.source!=="BD09MC"){ij.x=eE.getTilesLoop(iq,ij.x)}var ip=eE.getTileRangeExtent([iq,ij.x,ij.y]);var im=e([ip.minX,ip.minY,ip.maxX,ip.maxY]);if(!im){return null}var ik="";if(h6){ik=h6;var il=/[^\{}]*\{(.*)\}[^\}]*/;ik.match(il);var ii=[];if(RegExp.$1){ii=RegExp.$1.split(",")}ik=ik.replace(/\{(.*)\}/,ii[(ij.x+ij.y)%ii.length]);ik=ik.replace(/\[x\]/gi,ia(ij.x,ij.y,iq));ik=ik.replace(/\[y\]/gi,ie(ij.x,ij.y,iq));ik=ik.replace(/\[z\]/gi,h9(ij.x,ij.y,iq));ik=ik.replace(/\[b\]/gi,id(ij.x,ij.y,iq))}else{return null}return ik};function e(ii){if(ig&&ig instanceof Array&&ig.length===4){if((ig[0]<=ii[2]&&ig[1]<=ii[3])&&(ig[2]>=ii[0]&&ig[3]>=ii[1])){return true}else{return false}}return true}return ih};var aY=function(e){var e=e||{};this.inputCRS=e.inputCRS||"EPSG3857";this.outCRS=e.outCRS||"EPSG3857";this.minZoom=e.minZoom||3;this.maxZoom=e.maxZoom||19;this.retry=e.retry||false;this.retryTime=e.retryTime||600;this.useThumbData=e.useThumbData||true;this.lastZoom=3;this.cacheSize=e.cacheSize||128;this.tileType=cP.getInstance("web");this._mapCenter={};this._featureMgr=[[],[],[]];this._gridRefs={row:{},col:{}};this.tileCache=new fa(this.cacheSize,{clearCallback:function(i){}})};aY.inherits(em,"BaiduLayer");D.extend(aY.prototype,{fetch:function(i,h6,h7){var h6=Math.ceil(h6)||3;var i=i||[];if(i.length!==4||h6>19){h7(null);return}var e=this.getZoomState(h6);var T=this.calCoord(i,h6,e);this.curViewTilesInfo=this.calTilesOrders(T.sw,T.ne,h6);this.clearData();this.clearRefs();this.loadLayerData(this.curViewTilesInfo,e,true,h7)},calCoord:function(T,h6,i){if(T.length!==4){return}var e=gcoord.transform([T[0],T[1]],gcoord[this.inputCRS],gcoord.BD09MC);var h7=gcoord.transform([T[2],T[3]],gcoord[this.inputCRS],gcoord.BD09MC);if(h7[1]>19505879.362428114||e[1]<-15949096.637571886){h7[1]=19505879.362428114;e[1]=-15949096.637571886}this._mapCenter[h6]=new hH((e[0]+h7[0])/2,(e[1]+h7[1])/2);return{sw:e,ne:h7}},calTilesOrders:function(ib,ii,id){var ie=this.tileType.getMercatorSize(id,id);var h9=[Math.floor(ib[0]/ie),Math.floor(ib[1]/ie)];var i=[Math.floor(ii[0]/ie),Math.floor(ii[1]/ie)];var ia=h9[0]-1;var h8=i[0]+2;var h7=h9[1]-1;var ih=i[1]+2;var ic=[];for(var h6=ia;h6<h8;h6++){for(var ig=h7;ig<ih;ig++){var T={col:h6,row:ig,zoom:id,useZoom:id,tileTypeName:"web",loopOffsetX:0,tileSize:256,baseTileSize:256,mercatorSize:ie,combine:false,dataIndex:256};ic.push(T);var e="id_"+h6+"_"+ig+"_"+id;ic[e]=true}}ic.sort((function(ij){return function(ik,il){return((0.4*Math.abs(ik.col-ij[0])+0.6*Math.abs(ik.row-ij[1]))-(0.4*Math.abs(il.col-ij[0])+0.6*Math.abs(il.row-ij[1])))}})([(ia+h8)/2,(h7+ih)/2]));ic.zoom=id;ic.tileTypeName="web";return ic},getZoomState:function(i){var e=i-this.lastZoom;if(e>0){this.zoomState=1}else{if(e<0){this.zoomState=-1}}this.lastZoom=i;return this.zoomState||0},loadLayerData:function(id,h6,h7,ic){this.thumbCache={};if(h7){for(var ia=0,h8=id.length;ia<h8;ia++){var T=id[ia];var h9=this.getTileKey(T);var e=this.tileCache.getData(h9);if(e&&e.status==="ready"){e.key=h9;this.setData(e,2)}else{if(this.useThumbData){h6===1&&this.setThumbData(T.col,T.row,T.zoom,T.useZoom,h6)}}}this.calOutData(ic)}for(var ia=0,h8=id.length;ia<h8;ia++){var T=id[ia];var h9=this.getTileKey(T);var e=this.tileCache.getData(h9);if(!e){this.tileCache.setData(h9,{});var ib=this;this.loadRasterTileData(T,function(i,ie){ib.rasterTileDataCbk(i,ie,ic)})}}},loadRasterTileData:function(i,e){var T=new Image();var h7=i.col;var ia=i.row;var h8=i.zoom;var h6=this.getTilesUrl(new es(h7,ia),h8);if(!h6){return}var h9=this.getTileKey(i);T=this.loadTileImage(h6,i,h9,e);T.tileInfo=i},loadTileImage:function(ia,e,T,h8){var h6=new Image();h6.crossOrigin="anonymous";var h9=this;var h7;function ib(){if(h9.retry){h7&&clearInterval(h7);h7=null}}if(this.retry){var i=1;h7=setInterval(function(){if(i>3){ib();return}var ic=h9.getTilesUrl(new es(e.col,e.row),e.zoom,i);h6.src=ic;i++},this.retryTime)}h6.onload=function(){ib();h8&&h8(this,T)};h6.onerror=function(){ib();h8&&h8(null,T)};h6.src=ia;return h6},rasterTileDataCbk:function(h7,h6,ia){if(!h7||typeof h7==="string"){this.tileCache.removeData(h6);return}var i=h7.tileInfo;var T=i.col;var ic=i.row;var ib=i.zoom;var e=this.tileCache.getData(h6);if(!e){return}e.textureSource=h7;e.dataType=eS;e.tileInfo=i;e.status="ready";this.tileCache.setData(h6,e);var h8="id_"+T+"_"+ic+"_"+ib;var h9=false;if(this.curViewTilesInfo[h8]){e.png8=this.png8||false;e.key=h6;this.setData(e,2);h9=true}if(h9){this.calOutData(ia,e)}},getTilesUrl:function(h7,ie,i){var h9=i||0;var T=h7.x;var ig=h7.y;var ib=aG("ditu","normal");var ia=ib.udt;var id=b9.B_NORMAL_MAP.tileUrls;var h8=Math.abs(T+ig+h9)%id.length;var ic=id[h8];if(T<0){T="M"+(-T)}if(ig<0){ig="M"+(-ig)}var h6="x="+T+"&y="+ig+"&z="+Math.floor(ie);h6+="&styles=pl&scaler=2&udt="+ia+"&from=jsapi3_0";var e=ic+"?qt=vtile&"+h6;return e},calOutData:function(ic,T){if(!T){for(var h9=0;h9<this._featureMgr.length;h9++){var e=this._featureMgr[h9];for(var h7=0;h7<e.length;h7++){var h6=e[h7].tileInfo;if(h9===2){var ia=e[h7].extent;if(ia){this.addRefs(ia,h6.col,h6.row)}else{var ib=this.calBoxCoord(h6);if(!ib){continue}e[h7].extent=this.findRefs(ib,h6.col,h6.row)}}}}ic({size:this.curViewTilesInfo.length,zoom:this.lastZoom,data:this._featureMgr})}else{var h8=this.calBoxCoord(T.tileInfo);if(!h8){return}T.extent=this.findRefs(h8,T.tileInfo.col,T.tileInfo.row);ic({zoom:this.lastZoom,size:this.curViewTilesInfo.length,data:[[],[],[T]]})}},calOutData_back:function(ie,h6){if(!h6){var h8;var ig;var ic;for(var ia=0;ia<this._featureMgr.length;ia++){var T=this._featureMgr[ia];for(var h9=0;h9<T.length;h9++){var h7=T[h9].tileInfo;if(ia===2){if(h9===0){var ib=this.calBoxCoord(h7);T[0].extent=ib;h8=T[0];ig=ib[2]-ib[0];ic=ib[3]-ib[1]}else{if(h8&&ig&&ic){var e=(h7.row-h8.tileInfo.row)*ic;var id=(h7.col-h8.tileInfo.col)*ig;var ib=h8.extent;T[h9].extent=[ib[0]+id,ib[1]+e,ib[2]+id,ib[3]+e]}}}else{var ib=this.calBoxCoord(h7);T[h9].extent=ib}}}ie({size:this.curViewTilesInfo.length,zoom:this.lastZoom,data:this._featureMgr})}else{if(this._featureMgr[2].length===1){var ib=this.calBoxCoord(h6.tileInfo);h6.extent=ib;this.featureCell=h6;this.cellW=ib[2]-ib[0];this.cellH=ib[3]-ib[1]}else{var e=(h6.tileInfo.row-this.featureCell.tileInfo.row)*this.cellH;var id=(h6.tileInfo.col-this.featureCell.tileInfo.col)*this.cellW;var ib=this.featureCell.extent;h6.extent=[ib[0]+id,ib[1]+e,ib[2]+id,ib[3]+e]}ie({zoom:this.lastZoom,size:this.curViewTilesInfo.length,data:[[],[],[h6]]})}},calBoxCoord:function(e){var i=ew.prototype.tileToBound(e,this._mapCenter[e.zoom]).LL;var T=gcoord.transform([i.sw.lng,i.sw.lat],gcoord.BD09LL,gcoord[this.outCRS]);var h6=gcoord.transform([i.ne.lng,i.ne.lat],gcoord.BD09LL,gcoord[this.outCRS]);return[T[0],T[1],h6[0],h6[1]]},clearData:function(){this._featureMgr=[[],[],[]]},addRefs:function(i,e,T){this._gridRefs.row[T]=i[1];this._gridRefs.row[T+1]=i[3];this._gridRefs.col[e]=i[0];this._gridRefs.col[e+1]=i[2]},findRefs:function(i,e,h6){var T=[];this._gridRefs.row[h6]&&(T[1]=this._gridRefs.row[h6]);this._gridRefs.row[h6+1]&&(T[3]=this._gridRefs.row[h6+1]);this._gridRefs.col[e]&&(T[0]=this._gridRefs.col[e]);this._gridRefs.col[e+1]&&(T[2]=this._gridRefs.col[e+1]);!this._gridRefs.row[h6]&&(this._gridRefs.row[h6]=i[1])&&(T[1]=i[1]);!this._gridRefs.row[h6+1]&&(this._gridRefs.row[h6+1]=i[3])&&(T[3]=i[3]);!this._gridRefs.col[e]&&(this._gridRefs.col[e]=i[0])&&(T[0]=i[0]);!this._gridRefs.col[e+1]&&(this._gridRefs.col[e+1]=i[2])&&(T[2]=i[2]);return T},clearRefs:function(){this._gridRefs={row:{},col:{}}},destroy:function(){this.tileCache.clear();this.clearData();this.clearRefs();this._mapCenter={}},setData:function(h7,T){var e=this._featureMgr[T];for(var h6=0;h6<e.length;h6++){if(e[h6].key&&e[h6].key===h7.key){e[h6]=h7;return}}e.push(h7)},getTileKey:function(e,h6){h6=h6||{};var i=typeof h6.useZoom==="number"?h6.useZoom:e.useZoom;var T="default";return"web_"+T+"_"+e.col+"_"+e.row+"_"+e.zoom+"_"+i},setThumbData:function(i,h7,h6,e,T){if(T===1){if(this._findParentZoomTile(i,h7,h6,e,8)===false){this._findChildZoomTile(i,h7,h6,e,3)}}else{if(T===-1){if(this._findChildZoomTile(i,h7,h6,e,3)===false){this._findParentZoomTile(i,h7,h6,e,8)}}}this.sortThumbData()},_findParentZoomTile:function(h9,ij,ii,h7,ic){var h8="web";var T=3;var e=h9;var ig=ij;var id=ii;var ie=h7;for(var ib=1;ib<=ic;ib++){var h6=this.tileType.getParentTile(e,ig,id,ie,T);if(h6===null){continue}var ih=this.getTileKey(h6);var ia=this.tileCache.getData(ih);if(ia&&ia.status==="ready"){if(this.thumbCache[ih]){continue}ia.key=ih;this.setData(ia,0);this.thumbCache[ih]=true;return true}e=h6.col;ig=h6.row;id=h6.zoom;ie=h6.useZoom}return false},_findChildZoomTile:function(ia,ic,e,h7,im){var ik="web";var ig=21;var h9=ia;var ib=ic;var id=e;var h6=h7;var h8=true;for(var ij=1;ij<=im;ij++){var ih=false;var T=this.tileType.getChildTiles(h9,ib,id,h6,ig,ij);if(!T){continue}for(var ii=0;ii<T.length;ii++){var ie=this.getTileKey(T[ii]);var il=this.tileCache.getData(ie);if(il&&il.status==="ready"){if(!this.thumbCache[ie]){il.key=ie;this.setData(il,1);this.thumbCache[ie]=true}ih=true}else{h8=false}}if(ih){break}}return h8},sortThumbData:function(){var e=this._featureMgr;if(!e){return}if(e[0]&&e[0].length>0){e[0].sort(function(T,i){return T.tileInfo.useZoom-i.tileInfo.useZoom})}}});br.register(function(i){if(i.config&&i.config.isOverviewMap){return}if(i.isLoaded()){fO(i)}else{i.addEventListener("load",function(){fO(this)})}i.cityName="中国";i.cCode="1";var e={};e.enableRequest=true;e.request=function(){if(e.enableRequest){e.enableRequest=false;setTimeout(function(){e._request()},500)}};e._request=function(){var h6=i.getBoundsIn();var h8=i.getZoom();var T=h6.getSouthWest();var h7=h6.getNorthEast();cF.request(function(ic){if(ic.current_city["code"]>=9000&&ic.current_city["code"]<=9378){ic.current_city["name"]="台湾省"}if(ic.current_city["code"]>=20000&&ic.current_city["code"]<=20499){ic.current_city["name"]="新加坡"}if(ic.current_city["code"]>=20500&&ic.current_city["code"]<=25999){ic.current_city["name"]="泰国"}if(ic.current_city["code"]>=26000&&ic.current_city["code"]<=29999){ic.current_city["name"]="日本"}if(ic.current_city["code"]>=30000&&ic.current_city["code"]<=30999){ic.current_city["name"]="韩国"}if(ic.current_city["code"]>=31000&&ic.current_city["code"]<=37000){ic.current_city["name"]="亚太"}if(ic.current_city["code"]>=46609&&ic.current_city["code"]<=52505){ic.current_city["name"]="欧洲"}if(ic.current_city["code"]>=39509&&ic.current_city["code"]<=53500){ic.current_city["name"]="南美洲"}if(ic.current_city["code"]>=54000&&ic.current_city["code"]<=70000){ic.current_city["name"]="北美洲"}if(ic.current_city["code"]===54003&&ic.current_city["code"]>=60731&&ic.current_city["code"]<=61123){ic.current_city["name"]="美国"}if(ic.current_city["code"]===54015||ic.current_city["code"]>=57970&&ic.current_city["code"]<=60223){ic.current_city["name"]="加拿大"}if(ic.current_city["code"]===54025||ic.current_city["code"]>=54338&&ic.current_city["code"]<=57374){ic.current_city["name"]="墨西哥"}e.enableRequest=true;if(ic&&ic.current_city){var ib=ic.current_city["name"];var ia=ic.current_city["code"];if(ia!==i.cCode){var h9=new be("oncitychange");h9.name=ib;h9.code=ia;i.dispatchEvent(h9)}i.cityName=ib;i.cCode=ia;if(!gi()){eG(i)}}},{qt:"cen",b:T.lng+","+T.lat+";"+h7.lng+","+h7.lat,l:h8},"","",true)};i.addEventListener("load",function(T){e.request()});i.addEventListener("moveend",function(T){e.request()});i.addEventListener("zoomend",function(T){e.request()});e.request()});function fO(i){if(i.temp.copyadded){return}i.temp.copyadded=true;if(!i.cpyCtrl){var h6=new ei(2,2);i.config.cpyCtrlOffset=h6;if(gi()){h6.width=72;h6.height=0}var T=new dN({offset:h6,printable:true});i.cpyCtrl=T}if(!gi()){eG(i);i.addEventListener("maptypechange",function(){eG(i)})}i.addControl(T);var e=new ah();e._opts={printable:true};i.logoCtrl=e;i.addControl(e);i.addEventListener("resize",function(){if(this.getSize().width>=300&&i.getSize().height>=100){e.show();T.setOffset(i.config.cpyCtrlOffset)}else{e.hide();T.setOffset(new ei(4,2))}});if(i.getSize().width>=300&&i.getSize().height>=100){e.show()}else{e.hide();T.setOffset(new ei(4,2))}i.addEventListener("oncopyrightoffsetchange",function(h7){i.logoCtrl.setOffset(h7.target.logo);i.cpyCtrl.setOffset(h7.target.cpy)});i.dispatchEvent(new be("oncopyrightaddend"))}function eG(im){if(!im.cpyCtrl){var iw=new ei(2,2);if(gi()){iw.width=72;iw.height=0}var iq=new dN({offset:iw,printable:true});im.cpyCtrl=iq}var iF=im.cityName||"中国";var io=im.getMapType();var ip=["常州市","南昌市","乌鲁木齐市","无锡市","福州市","泉州市","珠海市","贵阳市"];var ig=["北京市","上海市","广州市","深圳市","宁波市","石家庄市","沈阳市","长春市","青岛市","温州市","台州市","金华市","佛山市","中山市","昆明市","南宁市","苏州市","西安市","济南市","郑州市","合肥市","呼和浩特市","杭州市","成都市","武汉市","长沙市","天津市","南京市","重庆市","大连市","东莞市","厦门市"];var ii=["香港特别行政区"];var ib=["台湾省"];var ix=["日本"];var iD=["韩国"];var ir=["泰国"];var iv=["亚太"];var ic=["新加坡"];var iE=["欧洲"];var h6=["南美洲"];var iA=["北美洲"];var T=["美国"];var iu=["墨西哥"];var h9=["加拿大"];for(var iB in ip){if(ip[iB]===iF){var ij=true;break}}for(var iB in ig){if(ig[iB]===iF){var h7=true;break}}for(var iB in ii){if(ii[iB]===iF){var iH=true;break}}if(ib[0]===iF){var iz=true}if(ic[0]===iF){var i=true}if(ix[0]===iF){var ie=true}if(iD[0]===iF){var il=true}if(ir[0]===iF){var ik=true}if(iv[0]===iF){var ia=true}if(iE[0]===iF){var ih=true}if(h6[0]===iF){var id=true}if(iA[0]===iF){var e=true}if(T[0]===iF){var iC=true}if(h9[0]===iF){var iy=true}if(iu[0]===iF){var h8=true}var iG=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字11111342 - 京ICP证030173号 - Data &copy; "];var it="rgba(255, 255, 255, 0.701961)";if(im.getZoom()<=9){iG=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字11111342 - 京ICP证030173号 - Data &copy; "]}else{if(iz){iG=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字11111342 - 京ICP证030173号 - Data &copy; "]}else{if(ie||il){iG=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字11111342 - 京ICP证030173号 - Data &copy; "]}else{if(i||ik){iG=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字11111342 - 京ICP证030173号 - Data &copy; "]}else{if(ia){iG=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字11111342 - 京ICP证030173号 - Data &copy; "]}else{if(ih){iG=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字11111342 - 京ICP证030173号 - Data &copy; "]}else{if(id){iG=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字11111342 - 京ICP证030173号 - Data &copy; "]}else{if(e){iG=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字11111342 - 京ICP证030173号 - Data &copy; "]}}}}}}}}if(im.getZoom()<=9){iG.push("长地万方");iG.push(\' &amp; <a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>\');iG.push(\' &amp; <a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>\');if(io===BMAP_SATELLITE_MAP||io===BMAP_HYBRID_MAP){iG.push(\' &amp; <a target="_blank" href="http://www.eso.org/public/">ESO</a>\');it="rgba(0,0,0,.7)"}}else{if(ie||il){iG.push(\'<a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>\')}else{if(i||ik){iG.push(\'<a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>\')}else{if(ia){iG.push(\'<a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>\');iG.push(\' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>\')}else{if(ih){iG.push(\'<a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>\');iG.push(\' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>\')}else{if(id){iG.push(\'<a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>\');iG.push(\' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>\')}else{if(iC||h8||iy){iG.push(\'<a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>\');iG.push(\' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>\')}else{if(e){iG.push(\'<a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>\');iG.push(\' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>\')}else{iG.push("长地万方");if(ij){iG.push(\' &amp; <a target="_blank" href="http://www.palmcity.cn/palmcity/">PalmCity</a>\')}if(iH){iG.push(\' &amp; <a target="_blank" href="http://www.mapking.com/HongKong/eng/home/MapKing_Webmap.html">MapKing</a>\')}if(iz){iG.push(\' &amp; <a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>\');iG.push(\' &amp; <a target="_blank" href="http://www.localking.com.tw/about/localking.aspx">樂客LocalKing</a>\')}if(io===BMAP_SATELLITE_MAP||io===BMAP_HYBRID_MAP){it="rgba(0,0,0,.7)"}}}}}}}}}iG.unshift(\'<span style="background: \'+it+\';padding: 0px 1px;line-height: 16px;display: inline;height: 16px;">\');iG.push("</span>");iG=iG.join("");im.cpyCtrl.addCopyright({id:1,content:iG})}window.BMAP_STATUS_SUCCESS=0;window.BMAP_STATUS_CITY_LIST=1;window.BMAP_STATUS_UNKNOWN_LOCATION=2;window.BMAP_STATUS_UNKNOWN_ROUTE=3;window.BMAP_STATUS_INVALID_KEY=4;window.BMAP_STATUS_INVALID_REQUEST=5;window.BMAP_STATUS_PERMISSION_DENIED=6;window.BMAP_STATUS_SERVICE_UNAVAILABLE=7;window.BMAP_STATUS_TIMEOUT=8;window.BMAP_ROUTE_TYPE_WALKING=2;window.BMAP_ROUTE_TYPE_DRIVING=3;window.BMAP_ROUTE_TYPE_RIDING=6;window.BMAP_ROUTE_STATUS_NORMAL=0;window.BMAP_ROUTE_STATUS_EMPTY=1;window.BMAP_ROUTE_STATUS_ADDRESS=2;var eQ="cur";var b5="cen";var ev="s";var Q="con";var dS="bd";var gq="nb";var hX="bt";var cT="nav";var et="walk";var hT="gc";var fY="rgc";var eI="dec";var fn="bse";var fy="nse";var g="bl";var bf="bsl";var bs="bda";var Z="sa";var aC="nba";var b2="drag";var I="ext";var d9="exts";var aR="hip";var S="ride";var f3="drct";var gC=2;var f0=4;var hm=7;var hk=11;var fJ=12;var hR=14;var bT=15;var dP=18;var fq=20;var cM=21;var cr=19;var fj=23;var cl=26;var at=28;var er=31;var cJ=35;var gu=44;var h4=45;var eT=46;var cH=47;var gL=-1;var hb=0;var hr=1;var cp=2;var cb=3;window.BMAP_POI_TYPE_NORMAL=0;var R=1;var cf=2;BMapGL.I=D.I;var P={};P.removeHtml=function(e){e=e.replace(/<\/?[^>]*>/g,"");e=e.replace(/[ | ]* /g," ");return e};P.parseGeoExtReg1=function(e){return e.replace(/([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*),([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*)(,)/g,"$1,$2;")};P.parseGeoExtReg2=function(i,e){var T=new RegExp("(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);)(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);){"+e+"}","ig");return i.replace(T,"$1")};var fH=0;var cL=1;var hn=2;P.unique=function(T){var h8=false;var h7=[];var h9={};for(var h6=0,e=T.length;h6<e;h6++){if(!h9[T[h6]]){h9[T[h6]]=true;h7.push(T[h6])}}return h7};P.getBestLevel=function(T,i){if(i){var e=Math.min(i.width/1100,i.height/660);T=Math.round(T+(Math.log(e)/Math.log(2)))}if(T<1){T=1}if(T>21){T=21}return T};P.parseGeo=function(h9,ic){if(typeof h9!="string"||!h9){return}var ie=h9.split("|");var e;var h7;var T;if(ie.length==1){e=gn(h9)}else{e=gn(ie[2]);h7=gn(ie[0]);T=gn(ie[1]);if(!ic){return e}}var ia={type:e.geoType};if(ic){switch(ia.type){case hn:var ib=new hH(e.geo[0][0],e.geo[0][1]);var id=ew.convertMC2LL(ib);ia.point=id;ia.points=[id];break;case cL:ia.points=[];var ig=e.geo[0];for(var h8=0,h6=ig.length-1;h8<h6;h8+=2){var ih=new hH(ig[h8],ig[h8+1]);ih=ew.convertMC2LL(ih);ia.points.push(ih)}h7=new hH(h7.geo[0][0],h7.geo[0][1]);T=new hH(T.geo[0][0],T.geo[0][1]);h7=ew.convertMC2LL(h7);T=ew.convertMC2LL(T);ia.bounds=new dZ(h7,T);break;default:break}}return ia};P.parseGeoExt=function(ir,ih){if(!ih){ih=0}else{if(ih<0.25){ih=0}else{if(ih>0.25&&ih<1){ih=1}else{if(ih>32){ih=32}}}}var ib=ir.split("|");if(ib.length==1){var h6=gn(ib[0]);return{type:h6.type,bound:"",points:h6.geo.join(",")}}else{if(ib.length>1){var ii=ir.split(";.=");var id=[];var h7=[];var ij=0;var io=ii.length;for(var ik=0;ik<io;ik++){var iq=ii[ik];if(io>1){if(ik==0){iq=iq+";"}if(ik>0&&ik<io-1){iq=".="+iq+";"}if(ik==io-1){iq=".="+iq}}var h8=iq.split("|");var im=gn(h8[0]);var il=gn(h8[1]);id.push(im.geo.join(","));id.push(il.geo.join(","));var h6=gn(h8[2]);ij=h6.type;var ip=h6.geo.join(",");ip=P.parseGeoExtReg1(ip);if(ih>0){ip=P.parseGeoExtReg2(ip,ih)}h7.push(ip)}if(io<=1){h7=h7.join(";")}if(io==2){var T=h7[0]+";"+h7[1];var h9=T.split(";");var e=[];for(var ik=0;ik<h9.length;ik++){var ic=h9[ik].split(",")[0];var ia=h9[ik].split(",")[1];var ie=new hH(ic,ia);var ig=ew.convertMC2LL(ie);e.push(ig)}h7=e}return{type:ij,bound:id.join(";"),points:h7}}}};P.getPoiPoint=function(e){var T=[];var i=null;if(e.toString()=="Point"){i=e}else{if(typeof e=="string"){T=D.trim(e).split(",");if(T.length<2){return}T[0]=parseFloat(D.trim(T[0]));T[1]=parseFloat(D.trim(T[1]))}else{T=e.slice(0);if(T.length<2){return}}i=new BMap.Point(T[0],T[1])}return i};P.parseGeoStr=function(T){var i=T.split(",");var e=new hH(i[0],i[1]);return ew.convertMC2LL(e)};P.level={country:4,province:11,city:12,area:13};var hY=["=",".","-","*"];var gh=1<<23;function gn(ic){var ib=bc(ic.charAt(0));var T=ic.substr(1);var ie=0;var e=T.length;var ig=[];var h9=[];var ia=[];while(ie<e){if(T.charAt(ie)==hY[0]){if((e-ie)<13){return 0}ia=aO(T.substr(ie,13),ig);if(ia<0){return 0}ie+=13}else{if(T.charAt(ie)==";"){h9.push(ig.slice(0));ig.length=0;++ie}else{if((e-ie)<8){return 0}ia=da(T.substr(ie,8),ig);if(ia<0){return 0}ie+=8}}}for(var h8=0,h6=h9.length;h8<h6;h8++){for(var h7=0,id=h9[h8].length;h7<id;h7++){h9[h8][h7]/=100}}return{geoType:ib,geo:h9}}function bc(i){var e=-1;if(i==hY[1]){e=hn}else{if(i==hY[2]){e=cL}else{if(i==hY[3]){e=fH}}}return e}function aO(h7,T){var e=0;var h9=0;var h8=0;for(var h6=0;h6<6;h6++){h8=cS(h7.substr(1+h6,1));if(h8<0){return -1-h6}e+=h8<<(6*h6);h8=cS(h7.substr(7+h6,1));if(h8<0){return -7-h6}h9+=h8<<(6*h6)}T.push(e);T.push(h9);return 0}function da(h8,h6){var T=h6.length;if(T<2){return -1}var e=0;var ia=0;var h9=0;for(var h7=0;h7<4;h7++){h9=cS(h8.substr(h7,1));if(h9<0){return -1-h7}e+=h9<<(6*h7);h9=cS(h8.substr(4+h7,1));if(h9<0){return -5-h7}ia+=h9<<(6*h7)}if(e>gh){e=gh-e}if(ia>gh){ia=gh-ia}h6.push(h6[T-2]+e);h6.push(h6[T-1]+ia);return 0}function cS(i){var e=i.charCodeAt(0);if(i>="A"&&i<="Z"){return e-"A".charCodeAt(0)}else{if(i>="a"&&i<="z"){return(26+e-"a".charCodeAt(0))}else{if(i>="0"&&i<="9"){return(52+e-"0".charCodeAt(0))}else{if(i=="+"){return 62}else{if(i=="/"){return 63}}}}}return -1}P.pathToPoints=function(h8){var h6=[];if(typeof h8!=="string"){return h6}else{var h7=h8.split(";");for(var T=0;T<h7.length;T++){var e=h7[T].split(",");h6.push(new hH(e[0],e[1]))}}return h6};window.BMAP_POI_TYPE_NORMAL=0;window.BMAP_POI_TYPE_BUSSTOP=1;window.BMAP_POI_TYPE_BUSLINE=2;window.BMAP_POI_TYPE_SUBSTOP=3;window.BMAP_POI_TYPE_SUBLINE=4;var hK=0;var f9=1;var c7={};window.APIPack=c7;function fM(i,e){em.call(this);this._loc={};this.setLocation(i);e=e||{};e.renderOptions=e.renderOptions||{};this._opts={renderOptions:{panel:e.renderOptions.panel||null,map:e.renderOptions.map||null,autoViewport:e.renderOptions.autoViewport||true,selectFirstResult:e.renderOptions.selectFirstResult,highlightMode:e.renderOptions.highlightMode,enableDragging:e.renderOptions.enableDragging||false},onSearchComplete:e.onSearchComplete||function(){},onMarkersSet:e.onMarkersSet||function(){},onInfoHtmlSet:e.onInfoHtmlSet||function(){},onResultsHtmlSet:e.onResultsHtmlSet||function(){},onGetBusListComplete:e.onGetBusListComplete||function(){},onGetBusLineComplete:e.onGetBusLineComplete||function(){},onBusListHtmlSet:e.onBusListHtmlSet||function(){},onBusLineHtmlSet:e.onBusLineHtmlSet||function(){},onPolylinesSet:e.onPolylinesSet||function(){},reqFrom:e.reqFrom||""};if(typeof e!="undefined"&&typeof e.renderOptions!="undefined"&&typeof e.renderOptions["autoViewport"]!="undefined"){this._opts.renderOptions.autoViewport=e.renderOptions["autoViewport"]}else{this._opts.renderOptions.autoViewport=true}this._opts.renderOptions.panel=D.G(this._opts.renderOptions.panel)}fM.inherits(em,"BaseSearch");D.extend(fM.prototype,{getResults:function(){if(!this._isMultiKey){return this._results}else{return this._arrResults}},enableAutoViewport:function(){this._opts.renderOptions.autoViewport=true},disableAutoViewport:function(){this._opts.renderOptions.autoViewport=false},setLocation:function(e){if(!e){return}this._loc.src=e},setSearchCompleteCallback:function(e){this._opts.onSearchComplete=e||function(){}},setMarkersSetCallback:function(e){this._opts.onMarkersSet=e||function(){}},setPolylinesSetCallback:function(e){this._opts.onPolylinesSet=e||function(){}},setInfoHtmlSetCallback:function(e){this._opts.onInfoHtmlSet=e||function(){}},setResultsHtmlSetCallback:function(e){this._opts.onResultsHtmlSet=e||function(){}},getStatus:function(){return this._status}});var dT=function(T,i){fM.call(this,T,i);i=i||{};i.renderOptions=i.renderOptions||{};this.setPageCapacity(i.pageCapacity);if(typeof i.renderOptions["selectFirstResult"]!="undefined"&&!i.renderOptions["selectFirstResult"]){this.disableFirstResultSelection()}else{this.enableFirstResultSelection()}this._overlays=[];this._arrPois=[];this._curIndex=-1;this._queryList=[];var e=this;ej.load("localSearch",function(){e._check()},true)};dT.inherits(fM,"LocalSearch");dT.DEFAULT_PAGE_CAPACITY=10;dT.MIN_PAGE_CAPACITY=1;dT.MAX_PAGE_CAPACITY=100;dT.DEFAULT_RADIUS=2000;dT.MAX_RADIUS=100000;D.extend(dT.prototype,{search:function(e,i){this._queryList.push({method:"search",arguments:[e,i]})},searchInBounds:function(e,T,i){this._queryList.push({method:"searchInBounds",arguments:[e,T,i]})},searchNearby:function(T,i,e,h6){this._queryList.push({method:"searchNearby",arguments:[T,i,e,h6]})},clearResults:function(){delete this._json;delete this._status;delete this._results;delete this._ud;this._curIndex=-1;this._setStatus();if(this._opts.renderOptions.panel){this._opts.renderOptions.panel.innerHTML=""}},gotoPage:function(){},enableFirstResultSelection:function(){this._opts.renderOptions.selectFirstResult=true},disableFirstResultSelection:function(){this._opts.renderOptions.selectFirstResult=false},setPageCapacity:function(e){if(typeof e=="number"&&!isNaN(e)){this._opts.pageCapacity=e<1?dT.DEFAULT_PAGE_CAPACITY:(e>dT.MAX_PAGE_CAPACITY?dT.DEFAULT_PAGE_CAPACITY:e)}else{this._opts.pageCapacity=dT.DEFAULT_PAGE_CAPACITY}},getPageCapacity:function(){return this._opts.pageCapacity},toString:function(){return"LocalSearch"}});function W(i){this._opts={};D.extend(this._opts,i);this._queryList=[];var e=this;ej.load("otherSearch",function(){e._asyncSearch()})}W.inherits(em,"Geocoder");D.extend(W.prototype,{getPoint:function(e,T,i){this._queryList.push({method:"getPoint",arguments:[e,T,i]})},getLocation:function(e,T,i){this._queryList.push({method:"getLocation",arguments:[e,T,i]})},toString:function(){return"Geocoder"}});function cW(e){e=e||{};this.config={timeout:e.timeout||1000*10,maximumAge:e.maximumAge||0,enableHighAccuracy:e.enableHighAccuracy||true,SDKLocation:e.SDKLocation||false};this._pendingCalls=[];var i=this;ej.load("otherSearch",function(){var T=i._pendingCalls.length;for(var h6=0;h6<T;h6++){var h7=i._pendingCalls[h6];i[h7.method].apply(i,h7.arguments)}})}D.extend(cW.prototype,{getCurrentPosition:function(e,i){this._pendingCalls.push({method:"getCurrentPosition",arguments:arguments})},getStatus:function(){return BMAP_STATUS_UNKNOWN_LOCATION},enableSDKLocation:function(){if(gi()){this.config.SDKLocation=true}},disableSDKLocation:function(){this.config.SDKLocation=false}});function gM(){this._queryList=[];var e=this;ej.load("otherSearch",function(){e._asyncSearch()})}gM.inherits(em,"Boundary");D.extend(gM.prototype,{get:function(i,e){this._queryList.push({method:"get",arguments:[i,e]})},toString:function(){return"Boundary"},parsebdStr:function(i,e){}});function X(i){i=i||{};i.renderOptions=i.renderOptions||{};this._opts={renderOptions:{map:i.renderOptions.map||null}};this._queryList=[];var e=this;ej.load("otherSearch",function(){e._asyncSearch()})}X.inherits(em,"LocalCity");D.extend(X.prototype,{get:function(e){this._queryList.push({method:"get",arguments:[e]})},toString:function(){return"LocalCity"}});function cR(e,T){em.call(this);this.markersList=[];this.destList=[];this.pointsList=[];this._opts=T;this.json=e;this.map=this._opts.renderOptions.map||null;this.sType=this._opts.sType;this.infoWindow=null;this.curPointIndex=0;this.startName="";this.endIndex=1;this.endName="";this.resCity=[0,0,0,0,0,0,0];this.locPois=[];this.curPageIndex=[1,1,1,1,1,1,1];this.totalPage=[1,1,1,1,1,1,1];this.resCount=[0,0,0,0,0,0,0];this.resType=[0,0,0,0,0,0,0];this.qInfo=[{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1}];this.curSelectedIndex=-1;this.tpList=[];this.tpListInMap=[];var i=this;ej.load("route",function(){})}cR.inherits(em,"RouteAddr");function eb(T,i){fM.call(this,T,i);this.QUERY_TYPE_BUSLIST=g;this.RETURN_TYPE_BUSLIST=bT;this.QUERY_TYPE_BUSLINE=bf;this.RETURN_TYPE_BUSLINE=dP;this._queryList=[];var e=this;ej.load("buslineSearch",function(){e._asyncSearch()})}var bq=fe.staticHost+"/wolfman/static/common/images/";eb._iconOpen=fe.apiIMG+"/iw_plus.gif";eb._iconClose=fe.apiIMG+"/iw_minus.gif";eb._stopUrl=bq+"new/bus-stop-1x_ddd4723.png";eb.inherits(fM,"BusLineSearch");D.extend(eb.prototype,{getBusList:function(e){this._queryList.push({method:"getBusList",arguments:[e]})},getBusLine:function(e){this._queryList.push({method:"getBusLine",arguments:[e]})},setGetBusListCompleteCallback:function(e){this._opts.onGetBusListComplete=e||function(){}},setGetBusLineCompleteCallback:function(e){this._opts.onGetBusLineComplete=e||function(){}},setBusListHtmlSetCallback:function(e){this._opts.onBusListHtmlSet=e||function(){}},setBusLineHtmlSetCallback:function(e){this._opts.onBusLineHtmlSet=e||function(){}},setPolylinesSetCallback:function(e){this._opts.onPolylinesSet=e||function(){}}});function hh(i){fM.call(this,i);i=i||{};this._options={input:i.input||null,baseDom:i.baseDom||null,types:i.types||[],onSearchComplete:i.onSearchComplete||function(){}};this._loc.src=i.location||"全国";this._word="";this._show=false;this._suggestion=null;this._inputValue="";this._initialize();var e=this;ej.load("autocomplete",function(){e._asyncSearch()},true)}hh.inherits(fM,"Autocomplete");D.extend(hh.prototype,{_initialize:function(){},show:function(){this._show=true},hide:function(){this._show=false},setTypes:function(e){this._options.types=e},setLocation:function(e){this._loc.src=e},search:function(e){this._word=e},setInputValue:function(e){this._inputValue=e},setSearchCompleteCallback:function(e){this._options.onSearchComplete=e}});var hu=function(i,e){fM.call(this,i,e)};D.inherit(hu,fM,"BaseRoute");D.extend(hu.prototype,{clearResults:function(){}});window.BMAP_TRANSIT_POLICY_RECOMMEND=0;window.BMAP_TRANSIT_POLICY_LEAST_TIME=4;window.BMAP_TRANSIT_POLICY_LEAST_TRANSFER=1;window.BMAP_TRANSIT_POLICY_LEAST_WALKING=2;window.BMAP_TRANSIT_POLICY_AVOID_SUBWAYS=3;window.BMAP_TRANSIT_POLICY_FIRST_SUBWAYS=5;window.BMAP_LINE_TYPE_BUS=0;window.BMAP_LINE_TYPE_SUBWAY=1;window.BMAP_LINE_TYPE_FERRY=2;window.BMAP_LINE_TYPE_TRAIN=3;window.BMAP_LINE_TYPE_AIRPLANE=4;window.BMAP_LINE_TYPE_COACH=5;var dq=3;var fv=4;var hN=1;var d7=2;var g3=5;var hl=6;window.BMAP_TRANSIT_TYPE_IN_CITY=0;window.BMAP_TRANSIT_TYPE_CROSS_CITY=1;window.BMAP_TRANSIT_PLAN_TYPE_ROUTE=0;window.BMAP_TRANSIT_PLAN_TYPE_LINE=1;window.BMAP_TRANSIT_TYPE_POLICY_TRAIN=0;window.BMAP_TRANSIT_TYPE_POLICY_AIRPLANE=1;window.BMAP_TRANSIT_TYPE_POLICY_COACH=2;window.BMAP_INTERCITY_POLICY_LEAST_TIME=0;window.BMAP_INTERCITY_POLICY_EARLY_START=1;window.BMAP_INTERCITY_POLICY_CHEAP_PRICE=2;function bL(T,i){hu.call(this,T,i);i=i||{};this.setPolicy(i.policy);this.setIntercityPolicy(i.intercityPolicy);this.setTransitTypePolicy(i.transitTypePolicy);this.setPageCapacity(i.pageCapacity);this.QUERY_TYPE=hX;this.RETURN_TYPE=hR;this.ROUTE_TYPE=f9;this._overlays=[];this._curIndex=-1;this._opts._enableTraffic=i.enableTraffic||false;this._queryList=[];var e=this;ej.load("route",function(){e._asyncSearch()},true)}bL.MAX_PAGE_CAPACITY=100;bL.LINE_TYPE_MAPPING=[0,1,0,0,0,0,0,0,2,0,0,0,1,1,1];bL.LINE_TYPE_MAPPING_CROSS_CITY=[0,3,4,0,0,0,5];D.inherit(bL,hu,"TransitRoute");D.extend(bL.prototype,{setPolicy:function(e){if(e>=BMAP_TRANSIT_POLICY_RECOMMEND&&e<=BMAP_TRANSIT_POLICY_FIRST_SUBWAYS){this._opts.policy=e}else{this._opts.policy=BMAP_TRANSIT_POLICY_RECOMMEND}},setIntercityPolicy:function(e){if(e>=BMAP_INTERCITY_POLICY_LEAST_TIME&&e<=BMAP_INTERCITY_POLICY_CHEAP_PRICE){this._opts.intercityPolicy=e}else{this._opts.intercityPolicy=BMAP_INTERCITY_POLICY_LEAST_TIME}},setTransitTypePolicy:function(e){if(e>=BMAP_TRANSIT_TYPE_POLICY_TRAIN&&e<=BMAP_TRANSIT_TYPE_POLICY_COACH){this._opts.transitTypePolicy=e}else{this._opts.transitTypePolicy=BMAP_TRANSIT_TYPE_POLICY_TRAIN}},_internalSearch:function(i,e){this._queryList.push({method:"_internalSearch",arguments:[i,e]})},search:function(i,e){this._queryList.push({method:"search",arguments:[i,e]})},setPageCapacity:function(e){if(typeof e==="string"){e=parseInt(e,10);if(isNaN(e)){this._opts.pageCapacity=bL.MAX_PAGE_CAPACITY;return}}if(typeof e!=="number"){this._opts.pageCapacity=bL.MAX_PAGE_CAPACITY;return}if(e>=1&&e<=bL.MAX_PAGE_CAPACITY){this._opts.pageCapacity=Math.round(e)}else{this._opts.pageCapacity=bL.MAX_PAGE_CAPACITY}},toString:function(){return"TransitRoute"},_shortTitle:function(e){return e.replace(/\(.*\)/,"")}});window.BMAP_HIGHLIGHT_STEP=1;window.BMAP_HIGHLIGHT_ROUTE=2;var cO=function(e,h6){hu.call(this,e,h6);this._overlays=[];this._curIndex=-1;this._queryList=[];var T=this;var i=this._opts.renderOptions;if(i.highlightMode!==BMAP_HIGHLIGHT_STEP&&i.highlightMode!==BMAP_HIGHLIGHT_ROUTE){i.highlightMode=BMAP_HIGHLIGHT_STEP}this._enableDragging=this._opts.renderOptions.enableDragging?true:false;ej.load("route",function(){T._asyncSearch()},true);if(this.init_d){this.init_d()}};cO.ROAD_TYPE=["","环岛","无属性道路","主路","高速连接路","交叉点内路段","连接道路","停车场内部道路","服务区内部道路","桥","步行街","辅路","匝道","全封闭道路","未定义交通区域","POI连接路","隧道","步行道","公交专用道","提前右转道"];D.inherit(cO,hu,"DWRoute");D.extend(cO.prototype,{search:function(T,e,i){this._queryList.push({method:"search",arguments:[T,e,i]})}});window.BMAP_DRIVING_POLICY_DEFAULT=0;window.BMAP_DRIVING_POLICY_AVOID_HIGHWAYS=3;window.BMAP_DRIVING_POLICY_FIRST_HIGHWAYS=4;window.BMAP_DRIVING_POLICY_AVOID_CONGESTION=5;window.BMAP_TRAFFICE_STATUS_NONE=0;window.BMAP_TRAFFICE_STATUS_NORMAL=1;window.BMAP_TRAFFICE_STATUS_SLOW=2;window.BMAP_TRAFFICE_STATUS_JAM=3;function fQ(e,i){cO.call(this,e,i);i=i||{};this._opts._enableTraffic=i.enableTraffic||false;this.setPolicy(i.policy);this.QUERY_TYPE=cT;this.RETURN_TYPE=fq;this.ROUTE_TYPE=BMAP_ROUTE_TYPE_DRIVING}D.inherit(fQ,cO,"DrivingRoute");fQ.prototype.setPolicy=function(e){if(e>=BMAP_DRIVING_POLICY_DEFAULT&&e<=BMAP_DRIVING_POLICY_AVOID_CONGESTION){this._opts.policy=e}else{this._opts.policy=BMAP_DRIVING_POLICY_DEFAULT}};function bd(e,i){cO.call(this,e,i);this.QUERY_TYPE=et;this.RETURN_TYPE=er;this.ROUTE_TYPE=BMAP_ROUTE_TYPE_WALKING;this._enableDragging=false}D.inherit(bd,cO,"WalkingRoute");function bp(e,i){cO.call(this,e,i);this.QUERY_TYPE=S;this.ROUTE_TYPE=BMAP_ROUTE_TYPE_RIDING;this._enableDragging=false}D.inherit(bp,cO,"RidingRoute");window.BMAP_MODE_DRIVING="driving";window.BMAP_MODE_TRANSIT="transit";window.BMAP_MODE_WALKING="walking";window.BMAP_MODE_NAVIGATION="navigation";var bi={web:"//api.map.baidu.com/direction?",android:"bdapp://map/direction?",ios:"baidumap://map/direction?"};function hI(e){this.opts=e||{}}D.extend(hI.prototype,{routeCall:function(h6,e,T){var i=this;ej.load("route",function(){i._asyncSearch(h6,e,T)})}});br.Map=dd;br.MapType=b9;br.Point=hH;br.Pixel=es;br.Size=ei;br.Bounds=dZ;br.PrivateRegionDataModel=dH;br.TileLayer=cV;br.Copyright=c9;br.Projection=br.Project=ew;br.XYZProjection=br.XYZProject=eE;br.Convertor=aB;br.RenderTypeUtils=bb;br.Overlay=bo;br.Label=f2;br.Marker=aF;br.Icon=hq;br.Polyline=am;br.BezierCurve=fz;br.PolylineMultipart=fx;br.Polygon=hj;br.Prism=cj;br.Marker3D=cy;br.GroundOverlay=cs;br.InfoWindow=ar;br.SimpleInfoWindow=hW;br.Circle=dL;br.Control=ba;br.NavigationControl=dy;br.NavigationControl3D=e5;br.CopyrightControl=dN;br.ScaleControl=hw;br.CityListControl=ek;br.MapTypeControl=bF;br.ZoomControl=cB;br.LocationControl=bD;br.LogoControl=ah;br.DistanceTool=gZ;br.ContextMenu=ci;br.MenuItem=fK;br.OperationMask=eq;br.Animation=p;br.ViewAnimation=cQ;br.Transitions=cq;br.Event=be;br.trafficLayer=ch;br.XYZLayer=fl;br.BaiduLayer=aY;br.Geolocation=cW;br.Geocoder=W;br.Boundary=gM;br.DistrictLayer=hg;br.LocalCity=X;br.LocalSearch=dT;br.Autocomplete=hh;br.BusLineSearch=eb;br.WalkingRoute=bd;br.RidingRoute=bp;br.DrivingRoute=fQ;br.TransitRoute=bL;br.RouteSearch=hI;function ea(e,i){for(var T in i){e[T]=i[T]}}br.fetchDebug&&br.fetchDebug.init();br.verify();br.apiLoad();br.frequency();br.getSeckeyCid();window._layer=1;D.extend(hg.prototype,{_asyncSearch:function(){for(var T=0,e=this._queryList.length;T<e;T++){var h6=this._queryList[T];this[h6.method].apply(this,h6.arguments)}delete this._queryList},addDistrict:function(){if(this._opts.districts){var e=this._opts.districts;if(typeof e==="string"){this.getDistrictData(e)}else{if(Object.prototype.toString.call(e)==="[object Array]"){var i=this.parseArrayParams(e);this.getDistrictData(i)}}}},parseArrayParams:function(e){var h7="";for(var h6=0;h6<e.length;h6++){if(e[h6] instanceof Array){h7+="(";for(var T=0;T<e.length;T++){h7+=e[T]}h7+=")"}else{h7+="("+e[h6]+")"}}return h7},getDistrictData:function(e){var i=this;cF.request(function(h6){var T=i._parseGeoData(h6);i._drawToMap(i,T)},{qt:d9,adnames:e,level:i._opts.kind})},_drawToMap:function(ig,ib){var ie=ib.boundaries.length;if(ie===0){alert("未能获取当前输入行政区域");return}var ih=this._config.fillColor;var h8=this._config.fillOpacity;var T=this._config.strokeColor;var e=this._config.strokeOpacity;var ic=this._config.strokeWeight;if(typeof ih==="string"){var h6=ih;var ii=[];for(var ia=0;ia<ie;ia++){var id=new BMapGL.Polygon(ib.boundaries[ia],{strokeWeight:ic,strokeColor:T,strokeOpacity:e,fillColor:h6,fillOpacity:h8});id.style={strokeWeight:ic,strokecolor:T,strokeOpacity:e,fillColor:h6,fillOpacity:h8};this.disOverlays.push(id);this.addEventListenerIn();ig._map.addOverlay(id);ii=ii.concat(id.getPath())}if(this._config.viewport){ig._map.setViewport(ii)}}else{if(Object.prototype.toString.call(ih)==="[object Array]"){var ii=[];var h9=ih.length;if(h9<ie){for(var ia=0,h7=0;ia<ie-h9;ia++){if(h7<h9-1){ih.push(ih[h7++])}else{ih.push(ih[0])}}}for(var ia=0;ia<ie;ia++){var h6=ih[ia];var id=new BMapGL.Polygon(ib.boundaries[ia],{strokeWeight:ic,strokeColor:T,strokeOpacity:e,fillColor:h6,fillOpacity:h8});id.style={strokeWeight:ic,strokecolor:T,strokeOpacity:e,fillColor:h6,fillOpacity:h8};this.disOverlays.push(id);this.addEventListenerIn();ig._map.addOverlay(id);ii=ii.concat(id.getPath())}if(this._config.viewport){ig._map.setViewport(ii)}}}},_parseGeoData:function(ig){var ij={};ij.boundaries=[];if(ig&&ig.content&&ig.content["geo"]){for(var ip=0;ip<ig.content["geo"].length;ip++){var h6=P.parseGeo(ig.content["geo"][ip],false);if(h6.geo&&h6.geo.length&&h6.geo.length>0){var im=h6.geo.length;for(gF=0;gF<im;gF++){var T=h6.geo[gF];if(T&&T.length&&T.length>0){var id=T.length-1;var il=[];var ic=false;var ik=0;var ii=0;for(var io=0;io<id;io+=2){var ia=T[io];var h8=T[io+1];var ih=new hH(ia,h8);ih=ew.convertMC2LL(ih);if(io<id-3){var i=T[io+2];var e=T[io+3];var ie=new hH(i,e);ie=ew.convertMC2LL(ie)}il.push(ih.lng+", "+ih.lat)}if(ic===true){if(ik>ii){var iq=ik;ik=ii;ii=iq}var ib=il;var h9=il.splice(ik+1);var h7=h9.splice(ii-ik);ib=ib.concat(h7);ij.boundaries.push(ib.join(";"));ij.boundaries.push(h9.join(";"));ic=false;continue}if(il.length!==0){ij.boundaries.push(il.join(";"))}}}}}}return ij},deleteDistrict:function(h6){var T=h6.disOverlays;for(var e=0;e<T.length;e++){this._map.removeOverlay(T[e])}},addEventListener:function(e,i){this.eventAndCallback[e]=i},addEventListenerIn:function(){var h6=this;var h8=Object.keys(h6.eventAndCallback);if(h8.length>0){for(var T=0;T<h8.length;T++){var h7=h6.eventAndCallback[h8[T]];for(var e=0;e<h6.disOverlays.length;e++){h6.disOverlays[e].addEventListener(h8[T],h7)}}}},searchBoundary:function(i,h7){i=i||{};var e=i.name||"";var T=i.kind||0;var h6=this;cF.request(function(h9){var h8=h6._parseGeoData(h9);h7&&h7(h8)},{qt:d9,adnames:e,level:T})}});window._layer=2;})(BMapGL,"BMapGL")\');document.write(\'<link rel="stylesheet" type="text/css" href="http://api.map.baidu.com/res/webgl/10/bmap.css"/>');})();